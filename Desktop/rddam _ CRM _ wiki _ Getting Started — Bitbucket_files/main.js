var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1&&(!e[n]||!t(e[n],n,e));n-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,i){return t&&eachProp(t,function(t,r){(n||!hasProp(e,r))&&(i&&"string"!=typeof t?(e[r]||(e[r]={}),mixin(e[r],t,n,i)):e[r]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,i){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return r.requireType=e,r.requireModules=i,n&&(r.originalError=n),r}function newContext(e){function t(e){var t,n;for(t=0;e[t];t+=1)if(n=e[t],"."===n)e.splice(t,1),t-=1;else if(".."===n){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function n(e,n,i){var r,o,s,a,l,u,c,d,h,p,f,m=n&&n.split("/"),g=m,v=k.map,y=v&&v["*"];if(e&&"."===e.charAt(0)&&(n?(g=getOwn(k.pkgs,n)?m=[n]:m.slice(0,m.length-1),e=g.concat(e.split("/")),t(e),o=getOwn(k.pkgs,r=e[0]),e=e.join("/"),o&&e===r+"/"+o.main&&(e=r)):0===e.indexOf("./")&&(e=e.substring(2))),i&&v&&(m||y)){for(a=e.split("/"),l=a.length;l>0;l-=1){if(c=a.slice(0,l).join("/"),m)for(u=m.length;u>0;u-=1)if(s=getOwn(v,m.slice(0,u).join("/")),s&&(s=getOwn(s,c))){d=s,h=l;break}if(d)break;!p&&y&&getOwn(y,c)&&(p=getOwn(y,c),f=l)}!d&&p&&(d=p,h=f),d&&(a.splice(0,h,d),e=a.join("/"))}return e}function i(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function r(e){var t=getOwn(k.paths,e);return t&&isArray(t)&&t.length>1?(i(e),t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function s(e,t,i,r){var s,a,l,u,c=null,d=t?t.name:null,h=e,p=!0,f="";return e||(p=!1,e="_@r"+(j+=1)),u=o(e),c=u[0],e=u[1],c&&(c=n(c,d,r),a=getOwn(A,c)),e&&(c?f=a&&a.normalize?a.normalize(e,function(e){return n(e,d,r)}):n(e,d,r):(f=n(e,d,r),u=o(f),c=u[0],f=u[1],i=!0,s=w.nameToUrl(f))),l=!c||a||i?"":"_unnormalized"+(D+=1),{prefix:c,name:f,parentMap:t,unnormalized:!!l,url:s,originalName:h,isDefine:p,id:(c?c+"!"+f:f)+l}}function a(e){var t=e.id,n=getOwn(C,t);return n||(n=C[t]=new w.Module(e)),n}function l(e,t,n){var i=e.id,r=getOwn(C,i);!hasProp(A,i)||r&&!r.defineEmitComplete?(r=a(e),r.error&&"error"===t?n(r.error):r.on(t,n)):"defined"===t&&n(A[i])}function u(e,t){var n=e.requireModules,i=!1;t?t(e):(each(n,function(t){var n=getOwn(C,t);n&&(n.error=e,n.events.error&&(i=!0,n.emit("error",e)))}),i||req.onError(e))}function c(){globalDefQueue.length&&(apsp.apply(T,[T.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function d(e){delete C[e],delete S[e]}function h(e,t,n){var i=e.map.id;e.error?e.emit("error",e.error):(t[i]=!0,each(e.depMaps,function(i,r){var o=i.id,s=getOwn(C,o);!s||e.depMatched[r]||n[o]||(getOwn(t,o)?(e.defineDep(r,A[o]),e.check()):h(s,t,n))}),n[i]=!0)}function p(){var e,t,n,o,s=1e3*k.waitSeconds,a=s&&w.startTime+s<(new Date).getTime(),l=[],c=[],d=!1,f=!0;if(!y){if(y=!0,eachProp(S,function(n){if(e=n.map,t=e.id,n.enabled&&(e.isDefine||c.push(n),!n.error))if(!n.inited&&a)r(t)?(o=!0,d=!0):(l.push(t),i(t));else if(!n.inited&&n.fetched&&e.isDefine&&(d=!0,!e.prefix))return f=!1}),a&&l.length)return n=makeError("timeout","Load timeout for modules: "+l,null,l),n.contextName=w.contextName,u(n);f&&each(c,function(e){h(e,{},{})}),a&&!o||!d||!isBrowser&&!isWebWorker||_||(_=setTimeout(function(){_=0,p()},50)),y=!1}}function f(e){hasProp(A,e[0])||a(s(e[0],null,!0)).init(e[1],e[2])}function m(e,t,n,i){e.detachEvent&&!isOpera?i&&e.detachEvent(i,t):e.removeEventListener(n,t,!1)}function g(e){var t=e.currentTarget||e.srcElement;return m(t,w.onScriptLoad,"load","onreadystatechange"),m(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function v(){var e;for(c();T.length;){if(e=T.shift(),null===e[0])return u(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));f(e)}}var y,b,w,x,_,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},C={},S={},$={},T=[],A={},E={},j=1,D=1;return x={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=A[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,n=getOwn(k.pkgs,e.map.id);return t=n?getOwn(k.config,e.map.id+"/"+n.main):getOwn(k.config,e.map.id),t||{}},exports:A[e.map.id]}}},b=function(e){this.events=getOwn($,e.id)||{},this.map=e,this.shim=getOwn(k.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(e,t,n,i){i=i||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=i.ignore,i.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?void w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;E[e]||(E[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id,i=this.depExports,r=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{r=w.execCb(n,o,i,r)}catch(s){e=s}else r=w.execCb(n,o,i,r);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?r=t.exports:void 0===r&&this.usingExports&&(r=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",u(this.error=e)}else r=o;this.exports=r,this.map.isDefine&&!this.ignore&&(A[n]=r,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),d(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,i=s(e.prefix);this.depMaps.push(i),l(i,"defined",bind(this,function(i){var r,o,c,h=this.map.name,p=this.map.parentMap?this.map.parentMap.name:null,f=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(i.normalize&&(h=i.normalize(h,function(e){return n(e,p,!0)})||""),o=s(e.prefix+"!"+h,this.map.parentMap),l(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),c=getOwn(C,o.id),void(c&&(this.depMaps.push(o),this.events.error&&c.on("error",bind(this,function(e){this.emit("error",e)})),c.enable()))):(r=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),r.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(C,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&d(e.map.id)}),u(e)}),r.fromText=bind(this,function(n,i){var o=e.name,l=s(o),c=useInteractive;i&&(n=i),c&&(useInteractive=!1),a(l),hasProp(k.config,t)&&(k.config[o]=k.config[t]);try{req.exec(n)}catch(d){return u(makeError("fromtexteval","fromText eval for "+t+" failed: "+d,d,[t]))}c&&(useInteractive=!0),this.depMaps.push(l),w.completeLoad(o),f([o],r)}),void i.load(e.name,f,r,k))})),w.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){S[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,i,r;if("string"==typeof e){if(e=s(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,r=getOwn(x,e.id))return void(this.depExports[t]=r(this));this.depCount+=1,l(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&l(e,"error",bind(this,this.errback))}n=e.id,i=C[n],hasProp(x,n)||!i||i.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(C,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:k,contextName:e,registry:C,defined:A,urlFetched:E,defQueue:T,Module:b,makeModuleMap:s,nextTick:req.nextTick,onError:u,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=k.pkgs,n=k.shim,i={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){i[t]?"map"===t?(k.map||(k.map={}),mixin(k[t],e,!0,!0)):mixin(k[t],e,!0):k[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),n[t]=e}),k.shim=n),e.packages&&(each(e.packages,function(e){var n;e="string"==typeof e?{name:e}:e,n=e.location,t[e.name]={name:e.name,location:n||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),k.pkgs=t),eachProp(C,function(e,t){e.inited||e.map.unnormalized||(e.map=s(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,i){function r(n,o,l){var c,d,h;return i.enableBuildCallback&&o&&isFunction(o)&&(o.__requireJsBuild=!0),"string"==typeof n?isFunction(o)?u(makeError("requireargs","Invalid require call"),l):t&&hasProp(x,n)?x[n](C[t.id]):req.get?req.get(w,n,t,r):(d=s(n,t,!1,!0),c=d.id,hasProp(A,c)?A[c]:u(makeError("notloaded",'Module name "'+c+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(v(),w.nextTick(function(){v(),h=a(s(null,t)),h.skipMap=i.skipMap,h.init(n,o,l,{enabled:!0}),p()}),r)}return i=i||{},mixin(r,{isBrowser:isBrowser,toUrl:function(e){var i,r=e.lastIndexOf("."),o=e.split("/")[0],s="."===o||".."===o;return-1!==r&&(!s||r>1)&&(i=e.substring(r,e.length),e=e.substring(0,r)),w.nameToUrl(n(e,t&&t.id,!0),i,!0)},defined:function(e){return hasProp(A,s(e,t,!1,!0).id)},specified:function(e){return e=s(e,t,!1,!0).id,hasProp(A,e)||hasProp(C,e)}}),t||(r.undef=function(e){c();var n=s(e,t,!0),i=getOwn(C,e);delete A[e],delete E[n.url],delete $[e],i&&(i.events.defined&&($[e]=i.events),d(e))}),r},enable:function(e){var t=getOwn(C,e.id);t&&a(e).enable()},completeLoad:function(e){var t,n,i,o=getOwn(k.shim,e)||{},s=o.exports;for(c();T.length;){if(n=T.shift(),null===n[0]){if(n[0]=e,t)break;t=!0}else n[0]===e&&(t=!0);f(n)}if(i=getOwn(C,e),!t&&!hasProp(A,e)&&i&&!i.inited){if(!(!k.enforceDefine||s&&getGlobal(s)))return r(e)?void 0:u(makeError("nodefine","No define call for "+e,null,[e]));f([e,o.deps||[],o.exportsFn])}p()},nameToUrl:function(e,t,n){var i,r,o,s,a,l,u,c,d;if(req.jsExtRegExp.test(e))c=e+(t||"");else{for(i=k.paths,r=k.pkgs,a=e.split("/"),l=a.length;l>0;l-=1){if(u=a.slice(0,l).join("/"),o=getOwn(r,u),d=getOwn(i,u)){isArray(d)&&(d=d[0]),a.splice(0,l,d);break}if(o){s=e===o.name?o.location+"/"+o.main:o.location,a.splice(0,l,s);break}}c=a.join("/"),c+=t||(/\?/.test(c)||n?"":".js"),c=("/"===c.charAt(0)||c.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+c}return k.urlArgs?c+((-1===c.indexOf("?")?"?":"&")+k.urlArgs):c},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,n,i){return t.apply(i,n)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=g(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=g(e);return r(t.id)?void 0:u(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.6",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||!navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,n,i){var r,o,s=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=n,n=i):e=[]),o&&o.context&&(s=o.context),r=getOwn(contexts,s),r||(r=contexts[s]=req.s.newContext(s)),o&&r.configure(o),r.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.load=function(e,t,n){var i,r=e&&e.config||{};if(isBrowser)return i=r.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),i.type=r.scriptType||"text/javascript",i.charset="utf-8",i.async=!0,i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),!i.attachEvent||i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0||isOpera?(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,o,[t]))}},isBrowser&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,n){var i,r;"string"!=typeof e&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(i=currentlyAddingScript||getInteractiveScript(),i&&(e||(e=i.getAttribute("data-requiremodule")),r=contexts[i.getAttribute("data-requirecontext")])),(r?r.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("require-lib",function(){}),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t=e.length,n=Z.type(e);return"function"===n||Z.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e}function i(e,t,n){if(Z.isFunction(t))return Z.grep(e,function(e,i){return!!t.call(e,i,e)!==n});if(t.nodeType)return Z.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(at.test(t))return Z.filter(t,e,n);t=Z.filter(t,e)}return Z.grep(e,function(e){return W.call(t,e)>=0!==n})}function r(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function o(e){var t=ft[e]={};return Z.each(e.match(pt)||[],function(e,n){t[n]=!0}),t}function s(){Y.removeEventListener("DOMContentLoaded",s,!1),e.removeEventListener("load",s,!1),Z.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+a.uid++}function l(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(wt,"-$1").toLowerCase(),n=e.getAttribute(i),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:bt.test(n)?Z.parseJSON(n):n}catch(r){}yt.set(e,t,n)}else n=void 0;return n}function u(){return!0}function c(){return!1}function d(){try{return Y.activeElement}catch(e){}}function h(e,t){return Z.nodeName(e,"table")&&Z.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function f(e){var t=Mt.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function m(e,t){for(var n=0,i=e.length;i>n;n++)vt.set(e[n],"globalEval",!t||vt.get(t[n],"globalEval"))}function g(e,t){var n,i,r,o,s,a,l,u;if(1===t.nodeType){if(vt.hasData(e)&&(o=vt.access(e),s=vt.set(t,o),u=o.events)){delete s.handle,s.events={};for(r in u)for(n=0,i=u[r].length;i>n;n++)Z.event.add(t,r,u[r][n])}yt.hasData(e)&&(a=yt.access(e),l=Z.extend({},a),yt.set(t,l))}}function v(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Z.nodeName(e,t)?Z.merge([e],n):n}function y(e,t){var n=t.nodeName.toLowerCase();"input"===n&&Ct.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function b(t,n){var i,r=Z(n.createElement(t)).appendTo(n.body),o=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(r[0]))?i.display:Z.css(r[0],"display");return r.detach(),o}function w(e){var t=Y,n=Ht[e];return n||(n=b(e,t),"none"!==n&&n||(Lt=(Lt||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement),t=Lt[0].contentDocument,t.write(),t.close(),n=b(e,t),Lt.detach()),Ht[e]=n),n}function x(e,t,n){var i,r,o,s,a=e.style;return n=n||Ut(e),n&&(s=n.getPropertyValue(t)||n[t]),n&&(""!==s||Z.contains(e.ownerDocument,e)||(s=Z.style(e,t)),Bt.test(s)&&Ft.test(t)&&(i=a.width,r=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=i,a.minWidth=r,a.maxWidth=o)),void 0!==s?s+"":s}function _(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function k(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,r=Kt.length;r--;)if(t=Kt[r]+n,t in e)return t;return i}function C(e,t,n){var i=Jt.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function S(e,t,n,i,r){for(var o=n===(i?"border":"content")?4:"width"===t?1:0,s=0;4>o;o+=2)"margin"===n&&(s+=Z.css(e,n+_t[o],!0,r)),i?("content"===n&&(s-=Z.css(e,"padding"+_t[o],!0,r)),"margin"!==n&&(s-=Z.css(e,"border"+_t[o]+"Width",!0,r))):(s+=Z.css(e,"padding"+_t[o],!0,r),"padding"!==n&&(s+=Z.css(e,"border"+_t[o]+"Width",!0,r)));return s}function $(e,t,n){var i=!0,r="width"===t?e.offsetWidth:e.offsetHeight,o=Ut(e),s="border-box"===Z.css(e,"boxSizing",!1,o);if(0>=r||null==r){if(r=x(e,t,o),(0>r||null==r)&&(r=e.style[t]),Bt.test(r))return r;i=s&&(Q.boxSizingReliable()||r===e.style[t]),r=parseFloat(r)||0}return r+S(e,t,n||(s?"border":"content"),i,o)+"px"}function T(e,t){for(var n,i,r,o=[],s=0,a=e.length;a>s;s++)i=e[s],i.style&&(o[s]=vt.get(i,"olddisplay"),n=i.style.display,t?(o[s]||"none"!==n||(i.style.display=""),""===i.style.display&&kt(i)&&(o[s]=vt.access(i,"olddisplay",w(i.nodeName)))):(r=kt(i),"none"===n&&r||vt.set(i,"olddisplay",r?n:Z.css(i,"display"))));for(s=0;a>s;s++)i=e[s],i.style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?o[s]||"":"none"));return e}function A(e,t,n,i,r){return new A.prototype.init(e,t,n,i,r)}function E(){return setTimeout(function(){Qt=void 0}),Qt=Z.now()}function j(e,t){var n,i=0,r={height:e};for(t=t?1:0;4>i;i+=2-t)n=_t[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function D(e,t,n){for(var i,r=(nn[t]||[]).concat(nn["*"]),o=0,s=r.length;s>o;o++)if(i=r[o].call(n,t,e))return i}function q(e,t,n){var i,r,o,s,a,l,u,c,d=this,h={},p=e.style,f=e.nodeType&&kt(e),m=vt.get(e,"fxshow");n.queue||(a=Z._queueHooks(e,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,d.always(function(){d.always(function(){a.unqueued--,Z.queue(e,"fx").length||a.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],u=Z.css(e,"display"),c="none"===u?vt.get(e,"olddisplay")||w(e.nodeName):u,"inline"===c&&"none"===Z.css(e,"float")&&(p.display="inline-block")),n.overflow&&(p.overflow="hidden",d.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(i in t)if(r=t[i],Xt.exec(r)){if(delete t[i],o=o||"toggle"===r,r===(f?"hide":"show")){if("show"!==r||!m||void 0===m[i])continue;f=!0}h[i]=m&&m[i]||Z.style(e,i)}else u=void 0;if(Z.isEmptyObject(h))"inline"===("none"===u?w(e.nodeName):u)&&(p.display=u);else{m?"hidden"in m&&(f=m.hidden):m=vt.access(e,"fxshow",{}),o&&(m.hidden=!f),f?Z(e).show():d.done(function(){Z(e).hide()}),d.done(function(){var t;vt.remove(e,"fxshow");for(t in h)Z.style(e,t,h[t])});for(i in h)s=D(f?m[i]:0,i,d),i in m||(m[i]=s.start,f&&(s.end=s.start,s.start="width"===i||"height"===i?1:0))}}function P(e,t){var n,i,r,o,s;for(n in e)if(i=Z.camelCase(n),r=t[i],o=e[n],Z.isArray(o)&&(r=o[1],o=e[n]=o[0]),n!==i&&(e[i]=o,delete e[n]),s=Z.cssHooks[i],s&&"expand"in s){o=s.expand(o),delete e[i];for(n in o)n in e||(e[n]=o[n],t[n]=r)}else t[i]=r}function I(e,t,n){var i,r,o=0,s=tn.length,a=Z.Deferred().always(function(){delete l.elem}),l=function(){if(r)return!1;for(var t=Qt||E(),n=Math.max(0,u.startTime+u.duration-t),i=n/u.duration||0,o=1-i,s=0,l=u.tweens.length;l>s;s++)u.tweens[s].run(o);return a.notifyWith(e,[u,o,n]),1>o&&l?n:(a.resolveWith(e,[u]),!1)},u=a.promise({elem:e,props:Z.extend({},t),opts:Z.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Qt||E(),duration:n.duration,tweens:[],createTween:function(t,n){var i=Z.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(i),i},stop:function(t){var n=0,i=t?u.tweens.length:0;if(r)return this;for(r=!0;i>n;n++)u.tweens[n].run(1);return t?a.resolveWith(e,[u,t]):a.rejectWith(e,[u,t]),this}}),c=u.props;for(P(c,u.opts.specialEasing);s>o;o++)if(i=tn[o].call(u,e,c,u.opts))return i;return Z.map(c,D,u),Z.isFunction(u.opts.start)&&u.opts.start.call(e,u),Z.fx.timer(Z.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function R(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,r=0,o=t.toLowerCase().match(pt)||[];if(Z.isFunction(n))for(;i=o[r++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function M(e,t,n,i){function r(a){var l;return o[a]=!0,Z.each(e[a]||[],function(e,a){var u=a(t,n,i);return"string"!=typeof u||s||o[u]?s?!(l=u):void 0:(t.dataTypes.unshift(u),r(u),!1)}),l}var o={},s=e===wn;return r(t.dataTypes[0])||!o["*"]&&r("*")}function N(e,t){var n,i,r=Z.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((r[n]?e:i||(i={}))[n]=t[n]);return i&&Z.extend(!0,e,i),e}function O(e,t,n){for(var i,r,o,s,a=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(r in a)if(a[r]&&a[r].test(i)){l.unshift(r);break}if(l[0]in n)o=l[0];else{for(r in n){if(!l[0]||e.converters[r+" "+l[0]]){o=r;break}s||(s=r)}o=o||s}return o?(o!==l[0]&&l.unshift(o),n[o]):void 0}function L(e,t,n,i){var r,o,s,a,l,u={},c=e.dataTypes.slice();if(c[1])for(s in e.converters)u[s.toLowerCase()]=e.converters[s];for(o=c.shift();o;)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift())if("*"===o)o=l;else if("*"!==l&&l!==o){if(s=u[l+" "+o]||u["* "+o],!s)for(r in u)if(a=r.split(" "),a[1]===o&&(s=u[l+" "+a[0]]||u["* "+a[0]])){s===!0?s=u[r]:u[r]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&e["throws"])t=s(t);else try{t=s(t)}catch(d){return{state:"parsererror",error:s?d:"No conversion from "+l+" to "+o}}}return{state:"success",data:t}}function H(e,t,n,i){var r;if(Z.isArray(t))Z.each(t,function(t,r){n||Sn.test(e)?i(e,r):H(e+"["+("object"==typeof r?t:"")+"]",r,n,i)});else if(n||"object"!==Z.type(t))i(e,t);else for(r in t)H(e+"["+r+"]",t[r],n,i)}function F(e){return Z.isWindow(e)?e:9===e.nodeType&&e.defaultView}var B=[],U=B.slice,z=B.concat,J=B.push,W=B.indexOf,V={},G=V.toString,K=V.hasOwnProperty,Q={},Y=e.document,X="2.1.3",Z=function(e,t){return new Z.fn.init(e,t)},et=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,tt=/^-ms-/,nt=/-([\da-z])/gi,it=function(e,t){return t.toUpperCase()};Z.fn=Z.prototype={jquery:X,constructor:Z,selector:"",length:0,toArray:function(){return U.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:U.call(this)},pushStack:function(e){var t=Z.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Z.each(this,e,t)},map:function(e){return this.pushStack(Z.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(U.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:B.sort,splice:B.splice},Z.extend=Z.fn.extend=function(){var e,t,n,i,r,o,s=arguments[0]||{},a=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===l&&(s=this,a--);l>a;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],i=e[t],s!==i&&(u&&i&&(Z.isPlainObject(i)||(r=Z.isArray(i)))?(r?(r=!1,o=n&&Z.isArray(n)?n:[]):o=n&&Z.isPlainObject(n)?n:{},s[t]=Z.extend(u,o,i)):void 0!==i&&(s[t]=i));return s},Z.extend({expando:"jQuery"+(X+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Z.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Z.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"!==Z.type(e)||e.nodeType||Z.isWindow(e)?!1:e.constructor&&!K.call(e.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?V[G.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;e=Z.trim(e),e&&(1===e.indexOf("use strict")?(t=Y.createElement("script"),t.text=e,Y.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(tt,"ms-").replace(nt,it)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var r,o=0,s=e.length,a=n(e);if(i){if(a)for(;s>o&&(r=t.apply(e[o],i),r!==!1);o++);else for(o in e)if(r=t.apply(e[o],i),r===!1)break}else if(a)for(;s>o&&(r=t.call(e[o],o,e[o]),r!==!1);o++);else for(o in e)if(r=t.call(e[o],o,e[o]),r===!1)break;return e},trim:function(e){return null==e?"":(e+"").replace(et,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?Z.merge(i,"string"==typeof e?[e]:e):J.call(i,e)),i},inArray:function(e,t,n){return null==t?-1:W.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,r=e.length;n>i;i++)e[r++]=t[i];return e.length=r,e},grep:function(e,t,n){for(var i,r=[],o=0,s=e.length,a=!n;s>o;o++)i=!t(e[o],o),i!==a&&r.push(e[o]);return r},map:function(e,t,i){var r,o=0,s=e.length,a=n(e),l=[];if(a)for(;s>o;o++)r=t(e[o],o,i),null!=r&&l.push(r);else for(o in e)r=t(e[o],o,i),null!=r&&l.push(r);return z.apply([],l)},guid:1,proxy:function(e,t){var n,i,r;return"string"==typeof t&&(n=e[t],t=e,e=n),Z.isFunction(e)?(i=U.call(arguments,2),r=function(){return e.apply(t||this,i.concat(U.call(arguments)))},r.guid=e.guid=e.guid||Z.guid++,r):void 0},now:Date.now,support:Q}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){V["[object "+t+"]"]=t.toLowerCase()});var rt=function(e){function t(e,t,n,i){var r,o,s,a,l,u,d,p,f,m;if((t?t.ownerDocument||t:H)!==q&&D(t),t=t||q,n=n||[],a=t.nodeType,"string"!=typeof e||!e||1!==a&&9!==a&&11!==a)return n;if(!i&&I){if(11!==a&&(r=yt.exec(e)))if(s=r[1]){if(9===a){if(o=t.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(s))&&O(t,o)&&o.id===s)return n.push(o),n}else{if(r[2])return X.apply(n,t.getElementsByTagName(e)),n;if((s=r[3])&&x.getElementsByClassName)return X.apply(n,t.getElementsByClassName(s)),n}if(x.qsa&&(!R||!R.test(e))){if(p=d=L,f=t,m=1!==a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){for(u=S(e),(d=t.getAttribute("id"))?p=d.replace(wt,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=u.length;l--;)u[l]=p+h(u[l]);f=bt.test(e)&&c(t.parentNode)||t,m=u.join(",")}if(m)try{return X.apply(n,f.querySelectorAll(m)),n}catch(g){}finally{d||t.removeAttribute("id")}}}return T(e.replace(lt,"$1"),t,n,i)}function n(){function e(n,i){return t.push(n+" ")>_.cacheLength&&delete e[t.shift()],e[n+" "]=i}var t=[];return e}function i(e){return e[L]=!0,e}function r(e){var t=q.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function o(e,t){for(var n=e.split("|"),i=e.length;i--;)_.attrHandle[n[i]]=t}function s(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||V)-(~e.sourceIndex||V);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function a(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function u(e){return i(function(t){return t=+t,i(function(n,i){for(var r,o=e([],n.length,t),s=o.length;s--;)n[r=o[s]]&&(n[r]=!(i[r]=n[r]))})})}function c(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function d(){}function h(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function p(e,t,n){var i=t.dir,r=n&&"parentNode"===i,o=B++;return t.first?function(t,n,o){for(;t=t[i];)if(1===t.nodeType||r)return e(t,n,o)}:function(t,n,s){var a,l,u=[F,o];if(s){for(;t=t[i];)if((1===t.nodeType||r)&&e(t,n,s))return!0}else for(;t=t[i];)if(1===t.nodeType||r){if(l=t[L]||(t[L]={}),(a=l[i])&&a[0]===F&&a[1]===o)return u[2]=a[2];
if(l[i]=u,u[2]=e(t,n,s))return!0}}}function f(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1;return!0}:e[0]}function m(e,n,i){for(var r=0,o=n.length;o>r;r++)t(e,n[r],i);return i}function g(e,t,n,i,r){for(var o,s=[],a=0,l=e.length,u=null!=t;l>a;a++)(o=e[a])&&(!n||n(o,i,r))&&(s.push(o),u&&t.push(a));return s}function v(e,t,n,r,o,s){return r&&!r[L]&&(r=v(r)),o&&!o[L]&&(o=v(o,s)),i(function(i,s,a,l){var u,c,d,h=[],p=[],f=s.length,v=i||m(t||"*",a.nodeType?[a]:a,[]),y=!e||!i&&t?v:g(v,h,e,a,l),b=n?o||(i?e:f||r)?[]:s:y;if(n&&n(y,b,a,l),r)for(u=g(b,p),r(u,[],a,l),c=u.length;c--;)(d=u[c])&&(b[p[c]]=!(y[p[c]]=d));if(i){if(o||e){if(o){for(u=[],c=b.length;c--;)(d=b[c])&&u.push(y[c]=d);o(null,b=[],u,l)}for(c=b.length;c--;)(d=b[c])&&(u=o?et(i,d):h[c])>-1&&(i[u]=!(s[u]=d))}}else b=g(b===s?b.splice(f,b.length):b),o?o(null,s,b,l):X.apply(s,b)})}function y(e){for(var t,n,i,r=e.length,o=_.relative[e[0].type],s=o||_.relative[" "],a=o?1:0,l=p(function(e){return e===t},s,!0),u=p(function(e){return et(t,e)>-1},s,!0),c=[function(e,n,i){var r=!o&&(i||n!==A)||((t=n).nodeType?l(e,n,i):u(e,n,i));return t=null,r}];r>a;a++)if(n=_.relative[e[a].type])c=[p(f(c),n)];else{if(n=_.filter[e[a].type].apply(null,e[a].matches),n[L]){for(i=++a;r>i&&!_.relative[e[i].type];i++);return v(a>1&&f(c),a>1&&h(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(lt,"$1"),n,i>a&&y(e.slice(a,i)),r>i&&y(e=e.slice(i)),r>i&&h(e))}c.push(n)}return f(c)}function b(e,n){var r=n.length>0,o=e.length>0,s=function(i,s,a,l,u){var c,d,h,p=0,f="0",m=i&&[],v=[],y=A,b=i||o&&_.find.TAG("*",u),w=F+=null==y?1:Math.random()||.1,x=b.length;for(u&&(A=s!==q&&s);f!==x&&null!=(c=b[f]);f++){if(o&&c){for(d=0;h=e[d++];)if(h(c,s,a)){l.push(c);break}u&&(F=w)}r&&((c=!h&&c)&&p--,i&&m.push(c))}if(p+=f,r&&f!==p){for(d=0;h=n[d++];)h(m,v,s,a);if(i){if(p>0)for(;f--;)m[f]||v[f]||(v[f]=Q.call(l));v=g(v)}X.apply(l,v),u&&!i&&v.length>0&&p+n.length>1&&t.uniqueSort(l)}return u&&(F=w,A=y),m};return r?i(s):s}var w,x,_,k,C,S,$,T,A,E,j,D,q,P,I,R,M,N,O,L="sizzle"+1*new Date,H=e.document,F=0,B=0,U=n(),z=n(),J=n(),W=function(e,t){return e===t&&(j=!0),0},V=1<<31,G={}.hasOwnProperty,K=[],Q=K.pop,Y=K.push,X=K.push,Z=K.slice,et=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},tt="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",it="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",rt=it.replace("w","w#"),ot="\\["+nt+"*("+it+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+rt+"))|)"+nt+"*\\]",st=":("+it+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ot+")*)|.*)\\)|)",at=new RegExp(nt+"+","g"),lt=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),ut=new RegExp("^"+nt+"*,"+nt+"*"),ct=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),dt=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),ht=new RegExp(st),pt=new RegExp("^"+rt+"$"),ft={ID:new RegExp("^#("+it+")"),CLASS:new RegExp("^\\.("+it+")"),TAG:new RegExp("^("+it.replace("w","w*")+")"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+st),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+tt+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,vt=/^[^{]+\{\s*\[native \w/,yt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,wt=/'|\\/g,xt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),_t=function(e,t,n){var i="0x"+t-65536;return i!==i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},kt=function(){D()};try{X.apply(K=Z.call(H.childNodes),H.childNodes),K[H.childNodes.length].nodeType}catch(Ct){X={apply:K.length?function(e,t){Y.apply(e,Z.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}x=t.support={},C=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},D=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:H;return i!==q&&9===i.nodeType&&i.documentElement?(q=i,P=i.documentElement,n=i.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",kt,!1):n.attachEvent&&n.attachEvent("onunload",kt)),I=!C(i),x.attributes=r(function(e){return e.className="i",!e.getAttribute("className")}),x.getElementsByTagName=r(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),x.getElementsByClassName=vt.test(i.getElementsByClassName),x.getById=r(function(e){return P.appendChild(e).id=L,!i.getElementsByName||!i.getElementsByName(L).length}),x.getById?(_.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&I){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},_.filter.ID=function(e){var t=e.replace(xt,_t);return function(e){return e.getAttribute("id")===t}}):(delete _.find.ID,_.filter.ID=function(e){var t=e.replace(xt,_t);return function(e){var n="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),_.find.TAG=x.getElementsByTagName?function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e);if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n);return i}return o},_.find.CLASS=x.getElementsByClassName&&function(e,t){return I?t.getElementsByClassName(e):void 0},M=[],R=[],(x.qsa=vt.test(i.querySelectorAll))&&(r(function(e){P.appendChild(e).innerHTML="<a id='"+L+"'></a><select id='"+L+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&R.push("[*^$]="+nt+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||R.push("\\["+nt+"*(?:value|"+tt+")"),e.querySelectorAll("[id~="+L+"-]").length||R.push("~="),e.querySelectorAll(":checked").length||R.push(":checked"),e.querySelectorAll("a#"+L+"+*").length||R.push(".#.+[+~]")}),r(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&R.push("name"+nt+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||R.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),R.push(",.*:")})),(x.matchesSelector=vt.test(N=P.matches||P.webkitMatchesSelector||P.mozMatchesSelector||P.oMatchesSelector||P.msMatchesSelector))&&r(function(e){x.disconnectedMatch=N.call(e,"div"),N.call(e,"[s!='']:x"),M.push("!=",st)}),R=R.length&&new RegExp(R.join("|")),M=M.length&&new RegExp(M.join("|")),t=vt.test(P.compareDocumentPosition),O=t||vt.test(P.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},W=t?function(e,t){if(e===t)return j=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n?n:(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!x.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===H&&O(H,e)?-1:t===i||t.ownerDocument===H&&O(H,t)?1:E?et(E,e)-et(E,t):0:4&n?-1:1)}:function(e,t){if(e===t)return j=!0,0;var n,r=0,o=e.parentNode,a=t.parentNode,l=[e],u=[t];if(!o||!a)return e===i?-1:t===i?1:o?-1:a?1:E?et(E,e)-et(E,t):0;if(o===a)return s(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;l[r]===u[r];)r++;return r?s(l[r],u[r]):l[r]===H?-1:u[r]===H?1:0},i):q},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==q&&D(e),n=n.replace(dt,"='$1']"),!(!x.matchesSelector||!I||M&&M.test(n)||R&&R.test(n)))try{var i=N.call(e,n);if(i||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(r){}return t(n,q,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==q&&D(e),O(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==q&&D(e);var n=_.attrHandle[t.toLowerCase()],i=n&&G.call(_.attrHandle,t.toLowerCase())?n(e,t,!I):void 0;return void 0!==i?i:x.attributes||!I?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,r=0;if(j=!x.detectDuplicates,E=!x.sortStable&&e.slice(0),e.sort(W),j){for(;t=e[r++];)t===e[r]&&(i=n.push(r));for(;i--;)e.splice(n[i],1)}return E=null,e},k=t.getText=function(e){var t,n="",i=0,r=e.nodeType;if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=k(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i++];)n+=k(t);return n},_=t.selectors={cacheLength:50,createPseudo:i,match:ft,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xt,_t),e[3]=(e[3]||e[4]||e[5]||"").replace(xt,_t),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return ft.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ht.test(n)&&(t=S(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xt,_t).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=U[e+" "];return t||(t=new RegExp("(^|"+nt+")"+e+"("+nt+"|$)"))&&U(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,i){return function(r){var o=t.attr(r,e);return null==o?"!="===n:n?(o+="","="===n?o===i:"!="===n?o!==i:"^="===n?i&&0===o.indexOf(i):"*="===n?i&&o.indexOf(i)>-1:"$="===n?i&&o.slice(-i.length)===i:"~="===n?(" "+o.replace(at," ")+" ").indexOf(i)>-1:"|="===n?o===i||o.slice(0,i.length+1)===i+"-":!1):!0}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),s="last"!==e.slice(-4),a="of-type"===t;return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,h,p,f,m=o!==s?"nextSibling":"previousSibling",g=t.parentNode,v=a&&t.nodeName.toLowerCase(),y=!l&&!a;if(g){if(o){for(;m;){for(d=t;d=d[m];)if(a?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;f=m="only"===e&&!f&&"nextSibling"}return!0}if(f=[s?g.firstChild:g.lastChild],s&&y){for(c=g[L]||(g[L]={}),u=c[e]||[],p=u[0]===F&&u[1],h=u[0]===F&&u[2],d=p&&g.childNodes[p];d=++p&&d&&d[m]||(h=p=0)||f.pop();)if(1===d.nodeType&&++h&&d===t){c[e]=[F,p,h];break}}else if(y&&(u=(t[L]||(t[L]={}))[e])&&u[0]===F)h=u[1];else for(;(d=++p&&d&&d[m]||(h=p=0)||f.pop())&&((a?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++h||(y&&((d[L]||(d[L]={}))[e]=[F,h]),d!==t)););return h-=r,h===i||h%i===0&&h/i>=0}}},PSEUDO:function(e,n){var r,o=_.pseudos[e]||_.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return o[L]?o(n):o.length>1?(r=[e,e,"",n],_.setFilters.hasOwnProperty(e.toLowerCase())?i(function(e,t){for(var i,r=o(e,n),s=r.length;s--;)i=et(e,r[s]),e[i]=!(t[i]=r[s])}):function(e){return o(e,0,r)}):o}},pseudos:{not:i(function(e){var t=[],n=[],r=$(e.replace(lt,"$1"));return r[L]?i(function(e,t,n,i){for(var o,s=r(e,null,i,[]),a=e.length;a--;)(o=s[a])&&(e[a]=!(t[a]=o))}):function(e,i,o){return t[0]=e,r(t,null,o,n),t[0]=null,!n.pop()}}),has:i(function(e){return function(n){return t(e,n).length>0}}),contains:i(function(e){return e=e.replace(xt,_t),function(t){return(t.textContent||t.innerText||k(t)).indexOf(e)>-1}}),lang:i(function(e){return pt.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(xt,_t).toLowerCase(),function(t){var n;do if(n=I?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===P},focus:function(e){return e===q.activeElement&&(!q.hasFocus||q.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!_.pseudos.empty(e)},header:function(e){return gt.test(e.nodeName)},input:function(e){return mt.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:u(function(){return[0]}),last:u(function(e,t){return[t-1]}),eq:u(function(e,t,n){return[0>n?n+t:n]}),even:u(function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e}),odd:u(function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e}),lt:u(function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e}),gt:u(function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e})}},_.pseudos.nth=_.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})_.pseudos[w]=a(w);for(w in{submit:!0,reset:!0})_.pseudos[w]=l(w);return d.prototype=_.filters=_.pseudos,_.setFilters=new d,S=t.tokenize=function(e,n){var i,r,o,s,a,l,u,c=z[e+" "];if(c)return n?0:c.slice(0);for(a=e,l=[],u=_.preFilter;a;){(!i||(r=ut.exec(a)))&&(r&&(a=a.slice(r[0].length)||a),l.push(o=[])),i=!1,(r=ct.exec(a))&&(i=r.shift(),o.push({value:i,type:r[0].replace(lt," ")}),a=a.slice(i.length));for(s in _.filter)!(r=ft[s].exec(a))||u[s]&&!(r=u[s](r))||(i=r.shift(),o.push({value:i,type:s,matches:r}),a=a.slice(i.length));if(!i)break}return n?a.length:a?t.error(e):z(e,l).slice(0)},$=t.compile=function(e,t){var n,i=[],r=[],o=J[e+" "];if(!o){for(t||(t=S(e)),n=t.length;n--;)o=y(t[n]),o[L]?i.push(o):r.push(o);o=J(e,b(r,i)),o.selector=e}return o},T=t.select=function(e,t,n,i){var r,o,s,a,l,u="function"==typeof e&&e,d=!i&&S(e=u.selector||e);if(n=n||[],1===d.length){if(o=d[0]=d[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&x.getById&&9===t.nodeType&&I&&_.relative[o[1].type]){if(t=(_.find.ID(s.matches[0].replace(xt,_t),t)||[])[0],!t)return n;u&&(t=t.parentNode),e=e.slice(o.shift().value.length)}for(r=ft.needsContext.test(e)?0:o.length;r--&&(s=o[r],!_.relative[a=s.type]);)if((l=_.find[a])&&(i=l(s.matches[0].replace(xt,_t),bt.test(o[0].type)&&c(t.parentNode)||t))){if(o.splice(r,1),e=i.length&&h(o),!e)return X.apply(n,i),n;break}}return(u||$(e,d))(i,t,!I,n,bt.test(e)&&c(t.parentNode)||t),n},x.sortStable=L.split("").sort(W).join("")===L,x.detectDuplicates=!!j,D(),x.sortDetached=r(function(e){return 1&e.compareDocumentPosition(q.createElement("div"))}),r(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||o("type|href|height|width",function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),x.attributes&&r(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||o("value",function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue}),r(function(e){return null==e.getAttribute("disabled")})||o(tt,function(e,t,n){var i;return n?void 0:e[t]===!0?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null}),t}(e);Z.find=rt,Z.expr=rt.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=rt.uniqueSort,Z.text=rt.getText,Z.isXMLDoc=rt.isXML,Z.contains=rt.contains;var ot=Z.expr.match.needsContext,st=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,at=/^.[^:#\[\.,]*$/;Z.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?Z.find.matchesSelector(i,e)?[i]:[]:Z.find.matches(e,Z.grep(t,function(e){return 1===e.nodeType}))},Z.fn.extend({find:function(e){var t,n=this.length,i=[],r=this;if("string"!=typeof e)return this.pushStack(Z(e).filter(function(){for(t=0;n>t;t++)if(Z.contains(r[t],this))return!0}));for(t=0;n>t;t++)Z.find(e,r[t],i);return i=this.pushStack(n>1?Z.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&ot.test(e)?Z(e):e||[],!1).length}});var lt,ut=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ct=Z.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:ut.exec(e),!n||!n[1]&&t)return!t||t.jquery?(t||lt).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Z?t[0]:t,Z.merge(this,Z.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:Y,!0)),st.test(n[1])&&Z.isPlainObject(t))for(n in t)Z.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return i=Y.getElementById(n[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=Y,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Z.isFunction(e)?"undefined"!=typeof lt.ready?lt.ready(e):e(Z):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Z.makeArray(e,this))};ct.prototype=Z.fn,lt=Z(Y);var dt=/^(?:parents|prev(?:Until|All))/,ht={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(e,t,n){for(var i=[],r=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(r&&Z(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),Z.fn.extend({has:function(e){var t=Z(e,this),n=t.length;return this.filter(function(){for(var e=0;n>e;e++)if(Z.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,i=0,r=this.length,o=[],s=ot.test(e)||"string"!=typeof e?Z(e,t||this.context):0;r>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&Z.find.matchesSelector(n,e))){o.push(n);break}return this.pushStack(o.length>1?Z.unique(o):o)},index:function(e){return e?"string"==typeof e?W.call(Z(e),this[0]):W.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Z.unique(Z.merge(this.get(),Z(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Z.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Z.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Z.dir(e,"parentNode",n)},next:function(e){return r(e,"nextSibling")},prev:function(e){return r(e,"previousSibling")},nextAll:function(e){return Z.dir(e,"nextSibling")},prevAll:function(e){return Z.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Z.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Z.dir(e,"previousSibling",n)},siblings:function(e){return Z.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Z.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Z.merge([],e.childNodes)}},function(e,t){Z.fn[e]=function(n,i){var r=Z.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(r=Z.filter(i,r)),this.length>1&&(ht[e]||Z.unique(r),dt.test(e)&&r.reverse()),this.pushStack(r)}});var pt=/\S+/g,ft={};Z.Callbacks=function(e){e="string"==typeof e?ft[e]||o(e):Z.extend({},e);var t,n,i,r,s,a,l=[],u=!e.once&&[],c=function(o){for(t=e.memory&&o,n=!0,a=r||0,r=0,s=l.length,i=!0;l&&s>a;a++)if(l[a].apply(o[0],o[1])===!1&&e.stopOnFalse){t=!1;break}i=!1,l&&(u?u.length&&c(u.shift()):t?l=[]:d.disable())},d={add:function(){if(l){var n=l.length;!function o(t){Z.each(t,function(t,n){var i=Z.type(n);"function"===i?e.unique&&d.has(n)||l.push(n):n&&n.length&&"string"!==i&&o(n)})}(arguments),i?s=l.length:t&&(r=n,c(t))}return this},remove:function(){return l&&Z.each(arguments,function(e,t){for(var n;(n=Z.inArray(t,l,n))>-1;)l.splice(n,1),i&&(s>=n&&s--,a>=n&&a--)}),this},has:function(e){return e?Z.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],s=0,this},disable:function(){return l=u=t=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,t||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||n&&!u||(t=t||[],t=[e,t.slice?t.slice():t],i?u.push(t):c(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},Z.extend({Deferred:function(e){var t=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return r.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Z.Deferred(function(n){Z.each(t,function(t,o){var s=Z.isFunction(e[t])&&e[t];r[o[1]](function(){var e=s&&s.apply(this,arguments);e&&Z.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===i?n.promise():this,s?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Z.extend(e,i):i}},r={};return i.pipe=i.then,Z.each(t,function(e,o){var s=o[2],a=o[3];i[o[1]]=s.add,a&&s.add(function(){n=a},t[1^e][2].disable,t[2][2].lock),r[o[0]]=function(){return r[o[0]+"With"](this===r?i:this,arguments),this},r[o[0]+"With"]=s.fireWith}),i.promise(r),e&&e.call(r,r),r},when:function(e){var t,n,i,r=0,o=U.call(arguments),s=o.length,a=1!==s||e&&Z.isFunction(e.promise)?s:0,l=1===a?e:Z.Deferred(),u=function(e,n,i){return function(r){n[e]=this,i[e]=arguments.length>1?U.call(arguments):r,i===t?l.notifyWith(n,i):--a||l.resolveWith(n,i)}};if(s>1)for(t=new Array(s),n=new Array(s),i=new Array(s);s>r;r++)o[r]&&Z.isFunction(o[r].promise)?o[r].promise().done(u(r,i,o)).fail(l.reject).progress(u(r,n,t)):--a;return a||l.resolveWith(i,o),l.promise()}});var mt;Z.fn.ready=function(e){return Z.ready.promise().done(e),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Z.readyWait++:Z.ready(!0)},ready:function(e){(e===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,e!==!0&&--Z.readyWait>0||(mt.resolveWith(Y,[Z]),Z.fn.triggerHandler&&(Z(Y).triggerHandler("ready"),Z(Y).off("ready"))))}}),Z.ready.promise=function(t){return mt||(mt=Z.Deferred(),"complete"===Y.readyState?setTimeout(Z.ready):(Y.addEventListener("DOMContentLoaded",s,!1),e.addEventListener("load",s,!1))),mt.promise(t)},Z.ready.promise();var gt=Z.access=function(e,t,n,i,r,o,s){var a=0,l=e.length,u=null==n;if("object"===Z.type(n)){r=!0;for(a in n)Z.access(e,t,a,n[a],!0,o,s)}else if(void 0!==i&&(r=!0,Z.isFunction(i)||(s=!0),u&&(s?(t.call(e,i),t=null):(u=t,t=function(e,t,n){return u.call(Z(e),n)})),t))for(;l>a;a++)t(e[a],n,s?i:i.call(e[a],a,t(e[a],n)));return r?e:u?t.call(e):l?t(e[0],n):o};Z.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},a.uid=1,a.accepts=Z.acceptData,a.prototype={key:function(e){if(!a.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=a.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,Z.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,r=this.key(e),o=this.cache[r];if("string"==typeof t)o[t]=n;else if(Z.isEmptyObject(o))Z.extend(this.cache[r],t);else for(i in t)o[i]=t[i];return o},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?(i=this.get(e,t),void 0!==i?i:this.get(e,Z.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,r,o=this.key(e),s=this.cache[o];if(void 0===t)this.cache[o]={};else{Z.isArray(t)?i=t.concat(t.map(Z.camelCase)):(r=Z.camelCase(t),t in s?i=[t,r]:(i=r,i=i in s?[i]:i.match(pt)||[])),n=i.length;for(;n--;)delete s[i[n]]}},hasData:function(e){return!Z.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var vt=new a,yt=new a,bt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,wt=/([A-Z])/g;Z.extend({hasData:function(e){return yt.hasData(e)||vt.hasData(e)},data:function(e,t,n){return yt.access(e,t,n)},removeData:function(e,t){yt.remove(e,t)},_data:function(e,t,n){return vt.access(e,t,n)},_removeData:function(e,t){vt.remove(e,t)}}),Z.fn.extend({data:function(e,t){var n,i,r,o=this[0],s=o&&o.attributes;if(void 0===e){if(this.length&&(r=yt.get(o),1===o.nodeType&&!vt.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(i=s[n].name,0===i.indexOf("data-")&&(i=Z.camelCase(i.slice(5)),l(o,i,r[i])));vt.set(o,"hasDataAttrs",!0)}return r}return"object"==typeof e?this.each(function(){yt.set(this,e)}):gt(this,function(t){var n,i=Z.camelCase(e);if(o&&void 0===t){if(n=yt.get(o,e),void 0!==n)return n;if(n=yt.get(o,i),void 0!==n)return n;if(n=l(o,i,void 0),void 0!==n)return n}else this.each(function(){var n=yt.get(this,i);yt.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&yt.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){yt.remove(this,e)})}}),Z.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=vt.get(e,t),n&&(!i||Z.isArray(n)?i=vt.access(e,t,Z.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=Z.queue(e,t),i=n.length,r=n.shift(),o=Z._queueHooks(e,t),s=function(){Z.dequeue(e,t)};"inprogress"===r&&(r=n.shift(),i--),r&&("fx"===t&&n.unshift("inprogress"),delete o.stop,r.call(e,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return vt.get(e,n)||vt.access(e,n,{empty:Z.Callbacks("once memory").add(function(){vt.remove(e,[t+"queue",n])})})}}),Z.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?Z.queue(this[0],e):void 0===t?this:this.each(function(){var n=Z.queue(this,e,t);Z._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&Z.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Z.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,r=Z.Deferred(),o=this,s=this.length,a=function(){--i||r.resolveWith(o,[o])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";s--;)n=vt.get(o[s],e+"queueHooks"),n&&n.empty&&(i++,n.empty.add(a));return a(),r.promise(t)}});var xt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_t=["Top","Right","Bottom","Left"],kt=function(e,t){return e=t||e,"none"===Z.css(e,"display")||!Z.contains(e.ownerDocument,e)},Ct=/^(?:checkbox|radio)$/i;!function(){var e=Y.createDocumentFragment(),t=e.appendChild(Y.createElement("div")),n=Y.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),t.appendChild(n),Q.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",Q.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var St="undefined";Q.focusinBubbles="onfocusin"in e;var $t=/^key/,Tt=/^(?:mouse|pointer|contextmenu)|click/,At=/^(?:focusinfocus|focusoutblur)$/,Et=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(e,t,n,i,r){var o,s,a,l,u,c,d,h,p,f,m,g=vt.get(e);if(g)for(n.handler&&(o=n,n=o.handler,r=o.selector),n.guid||(n.guid=Z.guid++),(l=g.events)||(l=g.events={}),(s=g.handle)||(s=g.handle=function(t){return typeof Z!==St&&Z.event.triggered!==t.type?Z.event.dispatch.apply(e,arguments):void 0}),t=(t||"").match(pt)||[""],u=t.length;u--;)a=Et.exec(t[u])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p&&(d=Z.event.special[p]||{},p=(r?d.delegateType:d.bindType)||p,d=Z.event.special[p]||{},c=Z.extend({type:p,origType:m,data:i,handler:n,guid:n.guid,selector:r,needsContext:r&&Z.expr.match.needsContext.test(r),namespace:f.join(".")},o),(h=l[p])||(h=l[p]=[],h.delegateCount=0,d.setup&&d.setup.call(e,i,f,s)!==!1||e.addEventListener&&e.addEventListener(p,s,!1)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,c):h.push(c),Z.event.global[p]=!0)},remove:function(e,t,n,i,r){var o,s,a,l,u,c,d,h,p,f,m,g=vt.hasData(e)&&vt.get(e);if(g&&(l=g.events)){for(t=(t||"").match(pt)||[""],u=t.length;u--;)if(a=Et.exec(t[u])||[],p=m=a[1],f=(a[2]||"").split(".").sort(),p){for(d=Z.event.special[p]||{},p=(i?d.delegateType:d.bindType)||p,h=l[p]||[],a=a[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=h.length;o--;)c=h[o],!r&&m!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||i&&i!==c.selector&&("**"!==i||!c.selector)||(h.splice(o,1),c.selector&&h.delegateCount--,d.remove&&d.remove.call(e,c));s&&!h.length&&(d.teardown&&d.teardown.call(e,f,g.handle)!==!1||Z.removeEvent(e,p,g.handle),delete l[p])}else for(p in l)Z.event.remove(e,p+t[u],n,i,!0);Z.isEmptyObject(l)&&(delete g.handle,vt.remove(e,"events"))}},trigger:function(t,n,i,r){var o,s,a,l,u,c,d,h=[i||Y],p=K.call(t,"type")?t.type:t,f=K.call(t,"namespace")?t.namespace.split("."):[];if(s=a=i=i||Y,3!==i.nodeType&&8!==i.nodeType&&!At.test(p+Z.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),u=p.indexOf(":")<0&&"on"+p,t=t[Z.expando]?t:new Z.Event(p,"object"==typeof t&&t),t.isTrigger=r?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:Z.makeArray(n,[t]),d=Z.event.special[p]||{},r||!d.trigger||d.trigger.apply(i,n)!==!1)){if(!r&&!d.noBubble&&!Z.isWindow(i)){for(l=d.delegateType||p,At.test(l+p)||(s=s.parentNode);s;s=s.parentNode)h.push(s),a=s;a===(i.ownerDocument||Y)&&h.push(a.defaultView||a.parentWindow||e)}for(o=0;(s=h[o++])&&!t.isPropagationStopped();)t.type=o>1?l:d.bindType||p,c=(vt.get(s,"events")||{})[t.type]&&vt.get(s,"handle"),c&&c.apply(s,n),c=u&&s[u],c&&c.apply&&Z.acceptData(s)&&(t.result=c.apply(s,n),t.result===!1&&t.preventDefault());return t.type=p,r||t.isDefaultPrevented()||d._default&&d._default.apply(h.pop(),n)!==!1||!Z.acceptData(i)||u&&Z.isFunction(i[p])&&!Z.isWindow(i)&&(a=i[u],a&&(i[u]=null),Z.event.triggered=p,i[p](),Z.event.triggered=void 0,a&&(i[u]=a)),t.result}},dispatch:function(e){e=Z.event.fix(e);var t,n,i,r,o,s=[],a=U.call(arguments),l=(vt.get(this,"events")||{})[e.type]||[],u=Z.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,e)!==!1){for(s=Z.event.handlers.call(this,e,l),t=0;(r=s[t++])&&!e.isPropagationStopped();)for(e.currentTarget=r.elem,n=0;(o=r.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(o.namespace))&&(e.handleObj=o,e.data=o.data,i=((Z.event.special[o.origType]||{}).handle||o.handler).apply(r.elem,a),void 0!==i&&(e.result=i)===!1&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,r,o,s=[],a=t.delegateCount,l=e.target;if(a&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(l.disabled!==!0||"click"!==e.type){for(i=[],n=0;a>n;n++)o=t[n],r=o.selector+" ",void 0===i[r]&&(i[r]=o.needsContext?Z(r,this).index(l)>=0:Z.find(r,this,null,[l]).length),i[r]&&i.push(o);i.length&&s.push({elem:l,handlers:i})}return a<t.length&&s.push({elem:this,handlers:t.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,r,o=t.button;
return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||Y,i=n.documentElement,r=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||r&&r.scrollLeft||0)-(i&&i.clientLeft||r&&r.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||r&&r.scrollTop||0)-(i&&i.clientTop||r&&r.clientTop||0)),e.which||void 0===o||(e.which=1&o?1:2&o?3:4&o?2:0),e}},fix:function(e){if(e[Z.expando])return e;var t,n,i,r=e.type,o=e,s=this.fixHooks[r];for(s||(this.fixHooks[r]=s=Tt.test(r)?this.mouseHooks:$t.test(r)?this.keyHooks:{}),i=s.props?this.props.concat(s.props):this.props,e=new Z.Event(o),t=i.length;t--;)n=i[t],e[n]=o[n];return e.target||(e.target=Y),3===e.target.nodeType&&(e.target=e.target.parentNode),s.filter?s.filter(e,o):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==d()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===d()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return Z.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var r=Z.extend(new Z.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?Z.event.trigger(r,null,t):Z.event.dispatch.call(t,r),r.isDefaultPrevented()&&n.preventDefault()}},Z.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},Z.Event=function(e,t){return this instanceof Z.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&e.returnValue===!1?u:c):this.type=e,t&&Z.extend(this,t),this.timeStamp=e&&e.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(e,t)},Z.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=u,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=u,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=u,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Z.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,r=e.relatedTarget,o=e.handleObj;return(!r||r!==i&&!Z.contains(i,r))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n}}}),Q.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){Z.event.simulate(t,e.target,Z.event.fix(e),!0)};Z.event.special[t]={setup:function(){var i=this.ownerDocument||this,r=vt.access(i,t);r||i.addEventListener(e,n,!0),vt.access(i,t,(r||0)+1)},teardown:function(){var i=this.ownerDocument||this,r=vt.access(i,t)-1;r?vt.access(i,t,r):(i.removeEventListener(e,n,!0),vt.remove(i,t))}}}),Z.fn.extend({on:function(e,t,n,i,r){var o,s;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(s in e)this.on(s,t,n,e[s],r);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),i===!1)i=c;else if(!i)return this;return 1===r&&(o=i,i=function(e){return Z().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=Z.guid++)),this.each(function(){Z.event.add(this,e,i,n,t)})},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,r;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,Z(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(r in e)this.off(r,t,e[r]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=void 0),n===!1&&(n=c),this.each(function(){Z.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){Z.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?Z.event.trigger(e,t,n,!0):void 0}});var jt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Dt=/<([\w:]+)/,qt=/<|&#?\w+;/,Pt=/<(?:script|style|link)/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Rt=/^$|\/(?:java|ecma)script/i,Mt=/^true\/(.*)/,Nt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ot={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ot.optgroup=Ot.option,Ot.tbody=Ot.tfoot=Ot.colgroup=Ot.caption=Ot.thead,Ot.th=Ot.td,Z.extend({clone:function(e,t,n){var i,r,o,s,a=e.cloneNode(!0),l=Z.contains(e.ownerDocument,e);if(!(Q.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Z.isXMLDoc(e)))for(s=v(a),o=v(e),i=0,r=o.length;r>i;i++)y(o[i],s[i]);if(t)if(n)for(o=o||v(e),s=s||v(a),i=0,r=o.length;r>i;i++)g(o[i],s[i]);else g(e,a);return s=v(a,"script"),s.length>0&&m(s,!l&&v(e,"script")),a},buildFragment:function(e,t,n,i){for(var r,o,s,a,l,u,c=t.createDocumentFragment(),d=[],h=0,p=e.length;p>h;h++)if(r=e[h],r||0===r)if("object"===Z.type(r))Z.merge(d,r.nodeType?[r]:r);else if(qt.test(r)){for(o=o||c.appendChild(t.createElement("div")),s=(Dt.exec(r)||["",""])[1].toLowerCase(),a=Ot[s]||Ot._default,o.innerHTML=a[1]+r.replace(jt,"<$1></$2>")+a[2],u=a[0];u--;)o=o.lastChild;Z.merge(d,o.childNodes),o=c.firstChild,o.textContent=""}else d.push(t.createTextNode(r));for(c.textContent="",h=0;r=d[h++];)if((!i||-1===Z.inArray(r,i))&&(l=Z.contains(r.ownerDocument,r),o=v(c.appendChild(r),"script"),l&&m(o),n))for(u=0;r=o[u++];)Rt.test(r.type||"")&&n.push(r);return c},cleanData:function(e){for(var t,n,i,r,o=Z.event.special,s=0;void 0!==(n=e[s]);s++){if(Z.acceptData(n)&&(r=n[vt.expando],r&&(t=vt.cache[r]))){if(t.events)for(i in t.events)o[i]?Z.event.remove(n,i):Z.removeEvent(n,i,t.handle);vt.cache[r]&&delete vt.cache[r]}delete yt.cache[n[yt.expando]]}}}),Z.fn.extend({text:function(e){return gt(this,function(e){return void 0===e?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=h(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,i=e?Z.filter(e,this):this,r=0;null!=(n=i[r]);r++)t||1!==n.nodeType||Z.cleanData(v(n)),n.parentNode&&(t&&Z.contains(n.ownerDocument,n)&&m(v(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Z.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return Z.clone(this,e,t)})},html:function(e){return gt(this,function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Pt.test(e)&&!Ot[(Dt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(jt,"<$1></$2>");try{for(;i>n;n++)t=this[n]||{},1===t.nodeType&&(Z.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(r){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Z.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=z.apply([],e);var n,i,r,o,s,a,l=0,u=this.length,c=this,d=u-1,h=e[0],m=Z.isFunction(h);if(m||u>1&&"string"==typeof h&&!Q.checkClone&&It.test(h))return this.each(function(n){var i=c.eq(n);m&&(e[0]=h.call(this,n,i.html())),i.domManip(e,t)});if(u&&(n=Z.buildFragment(e,this[0].ownerDocument,!1,this),i=n.firstChild,1===n.childNodes.length&&(n=i),i)){for(r=Z.map(v(n,"script"),p),o=r.length;u>l;l++)s=n,l!==d&&(s=Z.clone(s,!0,!0),o&&Z.merge(r,v(s,"script"))),t.call(this[l],s,l);if(o)for(a=r[r.length-1].ownerDocument,Z.map(r,f),l=0;o>l;l++)s=r[l],Rt.test(s.type||"")&&!vt.access(s,"globalEval")&&Z.contains(a,s)&&(s.src?Z._evalUrl&&Z._evalUrl(s.src):Z.globalEval(s.textContent.replace(Nt,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Z.fn[e]=function(e){for(var n,i=[],r=Z(e),o=r.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),Z(r[s])[t](n),J.apply(i,n.get());return this.pushStack(i)}});var Lt,Ht={},Ft=/^margin/,Bt=new RegExp("^("+xt+")(?!px)[a-z%]+$","i"),Ut=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",r.appendChild(o);var t=e.getComputedStyle(s,null);n="1%"!==t.top,i="4px"===t.width,r.removeChild(o)}var n,i,r=Y.documentElement,o=Y.createElement("div"),s=Y.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",Q.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(s),e.getComputedStyle&&Z.extend(Q,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==i&&t(),i},reliableMarginRight:function(){var t,n=s.appendChild(Y.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",r.appendChild(o),t=!parseFloat(e.getComputedStyle(n,null).marginRight),r.removeChild(o),s.removeChild(n),t}}))}(),Z.swap=function(e,t,n,i){var r,o,s={};for(o in t)s[o]=e.style[o],e.style[o]=t[o];r=n.apply(e,i||[]);for(o in t)e.style[o]=s[o];return r};var zt=/^(none|table(?!-c[ea]).+)/,Jt=new RegExp("^("+xt+")(.*)$","i"),Wt=new RegExp("^([+-])=("+xt+")","i"),Vt={position:"absolute",visibility:"hidden",display:"block"},Gt={letterSpacing:"0",fontWeight:"400"},Kt=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=x(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var r,o,s,a=Z.camelCase(t),l=e.style;return t=Z.cssProps[a]||(Z.cssProps[a]=k(l,a)),s=Z.cssHooks[t]||Z.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(r=s.get(e,!1,i))?r:l[t]:(o=typeof n,"string"===o&&(r=Wt.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(Z.css(e,t)),o="number"),null!=n&&n===n&&("number"!==o||Z.cssNumber[a]||(n+="px"),Q.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),s&&"set"in s&&void 0===(n=s.set(e,n,i))||(l[t]=n)),void 0)}},css:function(e,t,n,i){var r,o,s,a=Z.camelCase(t);return t=Z.cssProps[a]||(Z.cssProps[a]=k(e.style,a)),s=Z.cssHooks[t]||Z.cssHooks[a],s&&"get"in s&&(r=s.get(e,!0,n)),void 0===r&&(r=x(e,t,i)),"normal"===r&&t in Gt&&(r=Gt[t]),""===n||n?(o=parseFloat(r),n===!0||Z.isNumeric(o)?o||0:r):r}}),Z.each(["height","width"],function(e,t){Z.cssHooks[t]={get:function(e,n,i){return n?zt.test(Z.css(e,"display"))&&0===e.offsetWidth?Z.swap(e,Vt,function(){return $(e,t,i)}):$(e,t,i):void 0},set:function(e,n,i){var r=i&&Ut(e);return C(e,n,i?S(e,t,i,"border-box"===Z.css(e,"boxSizing",!1,r),r):0)}}}),Z.cssHooks.marginRight=_(Q.reliableMarginRight,function(e,t){return t?Z.swap(e,{display:"inline-block"},x,[e,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(e,t){Z.cssHooks[e+t]={expand:function(n){for(var i=0,r={},o="string"==typeof n?n.split(" "):[n];4>i;i++)r[e+_t[i]+t]=o[i]||o[i-2]||o[0];return r}},Ft.test(e)||(Z.cssHooks[e+t].set=C)}),Z.fn.extend({css:function(e,t){return gt(this,function(e,t,n){var i,r,o={},s=0;if(Z.isArray(t)){for(i=Ut(e),r=t.length;r>s;s++)o[t[s]]=Z.css(e,t[s],!1,i);return o}return void 0!==n?Z.style(e,t,n):Z.css(e,t)},e,t,arguments.length>1)},show:function(){return T(this,!0)},hide:function(){return T(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){kt(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=A,A.prototype={constructor:A,init:function(e,t,n,i,r,o){this.elem=e,this.prop=n,this.easing=r||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=o||(Z.cssNumber[n]?"":"px")},cur:function(){var e=A.propHooks[this.prop];return e&&e.get?e.get(this):A.propHooks._default.get(this)},run:function(e){var t,n=A.propHooks[this.prop];return this.pos=t=this.options.duration?Z.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):A.propHooks._default.set(this),this}},A.prototype.init.prototype=A.prototype,A.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Z.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Z.fx.step[e.prop]?Z.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Z.cssProps[e.prop]]||Z.cssHooks[e.prop])?Z.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},A.propHooks.scrollTop=A.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Z.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Z.fx=A.prototype.init,Z.fx.step={};var Qt,Yt,Xt=/^(?:toggle|show|hide)$/,Zt=new RegExp("^(?:([+-])=|)("+xt+")([a-z%]*)$","i"),en=/queueHooks$/,tn=[q],nn={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),r=Zt.exec(t),o=r&&r[3]||(Z.cssNumber[e]?"":"px"),s=(Z.cssNumber[e]||"px"!==o&&+i)&&Zt.exec(Z.css(n.elem,e)),a=1,l=20;if(s&&s[3]!==o){o=o||s[3],r=r||[],s=+i||1;do a=a||".5",s/=a,Z.style(n.elem,e,s+o);while(a!==(a=n.cur()/i)&&1!==a&&--l)}return r&&(s=n.start=+s||+i||0,n.unit=o,n.end=r[1]?s+(r[1]+1)*r[2]:+r[2]),n}]};Z.Animation=Z.extend(I,{tweener:function(e,t){Z.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,r=e.length;r>i;i++)n=e[i],nn[n]=nn[n]||[],nn[n].unshift(t)},prefilter:function(e,t){t?tn.unshift(e):tn.push(e)}}),Z.speed=function(e,t,n){var i=e&&"object"==typeof e?Z.extend({},e):{complete:n||!n&&t||Z.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Z.isFunction(t)&&t};return i.duration=Z.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in Z.fx.speeds?Z.fx.speeds[i.duration]:Z.fx.speeds._default,(null==i.queue||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){Z.isFunction(i.old)&&i.old.call(this),i.queue&&Z.dequeue(this,i.queue)},i},Z.fn.extend({fadeTo:function(e,t,n,i){return this.filter(kt).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var r=Z.isEmptyObject(e),o=Z.speed(t,n,i),s=function(){var t=I(this,Z.extend({},e),o);(r||vt.get(this,"finish"))&&t.stop(!0)};return s.finish=s,r||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,r=null!=e&&e+"queueHooks",o=Z.timers,s=vt.get(this);if(r)s[r]&&s[r].stop&&i(s[r]);else for(r in s)s[r]&&s[r].stop&&en.test(r)&&i(s[r]);for(r=o.length;r--;)o[r].elem!==this||null!=e&&o[r].queue!==e||(o[r].anim.stop(n),t=!1,o.splice(r,1));(t||!n)&&Z.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=vt.get(this),i=n[e+"queue"],r=n[e+"queueHooks"],o=Z.timers,s=i?i.length:0;for(n.finish=!0,Z.queue(this,e,[]),r&&r.stop&&r.stop.call(this,!0),t=o.length;t--;)o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1));for(t=0;s>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish})}}),Z.each(["toggle","show","hide"],function(e,t){var n=Z.fn[t];Z.fn[t]=function(e,i,r){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(j(t,!0),e,i,r)}}),Z.each({slideDown:j("show"),slideUp:j("hide"),slideToggle:j("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Z.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}}),Z.timers=[],Z.fx.tick=function(){var e,t=0,n=Z.timers;for(Qt=Z.now();t<n.length;t++)e=n[t],e()||n[t]!==e||n.splice(t--,1);n.length||Z.fx.stop(),Qt=void 0},Z.fx.timer=function(e){Z.timers.push(e),e()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Yt||(Yt=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Yt),Yt=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(e,t){return e=Z.fx?Z.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}})},function(){var e=Y.createElement("input"),t=Y.createElement("select"),n=t.appendChild(Y.createElement("option"));e.type="checkbox",Q.checkOn=""!==e.value,Q.optSelected=n.selected,t.disabled=!0,Q.optDisabled=!n.disabled,e=Y.createElement("input"),e.value="t",e.type="radio",Q.radioValue="t"===e.value}();var rn,on,sn=Z.expr.attrHandle;Z.fn.extend({attr:function(e,t){return gt(this,Z.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Z.removeAttr(this,e)})}}),Z.extend({attr:function(e,t,n){var i,r,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===St?Z.prop(e,t,n):(1===o&&Z.isXMLDoc(e)||(t=t.toLowerCase(),i=Z.attrHooks[t]||(Z.expr.match.bool.test(t)?on:rn)),void 0===n?i&&"get"in i&&null!==(r=i.get(e,t))?r:(r=Z.find.attr(e,t),null==r?void 0:r):null!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):void Z.removeAttr(e,t))},removeAttr:function(e,t){var n,i,r=0,o=t&&t.match(pt);if(o&&1===e.nodeType)for(;n=o[r++];)i=Z.propFix[n]||n,Z.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!Q.radioValue&&"radio"===t&&Z.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),on={set:function(e,t,n){return t===!1?Z.removeAttr(e,n):e.setAttribute(n,n),n}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(e,t){var n=sn[t]||Z.find.attr;sn[t]=function(e,t,i){var r,o;return i||(o=sn[t],sn[t]=r,r=null!=n(e,t,i)?t.toLowerCase():null,sn[t]=o),r}});var an=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(e,t){return gt(this,Z.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Z.propFix[e]||e]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var i,r,o,s=e.nodeType;if(e&&3!==s&&8!==s&&2!==s)return o=1!==s||!Z.isXMLDoc(e),o&&(t=Z.propFix[t]||t,r=Z.propHooks[t]),void 0!==n?r&&"set"in r&&void 0!==(i=r.set(e,n,t))?i:e[t]=n:r&&"get"in r&&null!==(i=r.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||an.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),Q.optSelected||(Z.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var ln=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(e){var t,n,i,r,o,s,a="string"==typeof e&&e,l=0,u=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(pt)||[];u>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ln," "):" ")){for(o=0;r=t[o++];)i.indexOf(" "+r+" ")<0&&(i+=r+" ");s=Z.trim(i),n.className!==s&&(n.className=s)}return this},removeClass:function(e){var t,n,i,r,o,s,a=0===arguments.length||"string"==typeof e&&e,l=0,u=this.length;if(Z.isFunction(e))return this.each(function(t){Z(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(pt)||[];u>l;l++)if(n=this[l],i=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ln," "):"")){for(o=0;r=t[o++];)for(;i.indexOf(" "+r+" ")>=0;)i=i.replace(" "+r+" "," ");s=e?Z.trim(i):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(Z.isFunction(e)?function(n){Z(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,r=Z(this),o=e.match(pt)||[];t=o[i++];)r.hasClass(t)?r.removeClass(t):r.addClass(t);else(n===St||"boolean"===n)&&(this.className&&vt.set(this,"__className__",this.className),this.className=this.className||e===!1?"":vt.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ln," ").indexOf(t)>=0)return!0;return!1}});var un=/\r/g;Z.fn.extend({val:function(e){var t,n,i,r=this[0];{if(arguments.length)return i=Z.isFunction(e),this.each(function(n){var r;1===this.nodeType&&(r=i?e.call(this,n,Z(this).val()):e,null==r?r="":"number"==typeof r?r+="":Z.isArray(r)&&(r=Z.map(r,function(e){return null==e?"":e+""})),t=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&void 0!==t.set(this,r,"value")||(this.value=r))});if(r)return t=Z.valHooks[r.type]||Z.valHooks[r.nodeName.toLowerCase()],t&&"get"in t&&void 0!==(n=t.get(r,"value"))?n:(n=r.value,"string"==typeof n?n.replace(un,""):null==n?"":n)}}}),Z.extend({valHooks:{option:{get:function(e){var t=Z.find.attr(e,"value");return null!=t?t:Z.trim(Z.text(e))}},select:{get:function(e){for(var t,n,i=e.options,r=e.selectedIndex,o="select-one"===e.type||0>r,s=o?null:[],a=o?r+1:i.length,l=0>r?a:o?r:0;a>l;l++)if(n=i[l],!(!n.selected&&l!==r||(Q.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&Z.nodeName(n.parentNode,"optgroup"))){if(t=Z(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,i,r=e.options,o=Z.makeArray(t),s=r.length;s--;)i=r[s],(i.selected=Z.inArray(i.value,o)>=0)&&(n=!0);return n||(e.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(e,t){return Z.isArray(t)?e.checked=Z.inArray(Z(e).val(),t)>=0:void 0}},Q.checkOn||(Z.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Z.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Z.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var cn=Z.now(),dn=/\?/;Z.parseJSON=function(e){return JSON.parse(e+"")},Z.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(i){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+e),t};var hn=/#.*$/,pn=/([?&])_=[^&]*/,fn=/^(.*?):[ \t]*([^\r\n]*)$/gm,mn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,gn=/^(?:GET|HEAD)$/,vn=/^\/\//,yn=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,bn={},wn={},xn="*/".concat("*"),_n=e.location.href,kn=yn.exec(_n.toLowerCase())||[];Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:_n,type:"GET",isLocal:mn.test(kn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":xn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?N(N(e,Z.ajaxSettings),t):N(Z.ajaxSettings,e)},ajaxPrefilter:R(bn),ajaxTransport:R(wn),ajax:function(e,t){function n(e,t,n,s){var l,c,v,y,w,_=t;2!==b&&(b=2,a&&clearTimeout(a),i=void 0,o=s||"",x.readyState=e>0?4:0,l=e>=200&&300>e||304===e,n&&(y=O(d,x,n)),y=L(d,y,x,l),l?(d.ifModified&&(w=x.getResponseHeader("Last-Modified"),w&&(Z.lastModified[r]=w),w=x.getResponseHeader("etag"),w&&(Z.etag[r]=w)),204===e||"HEAD"===d.type?_="nocontent":304===e?_="notmodified":(_=y.state,c=y.data,v=y.error,l=!v)):(v=_,(e||!_)&&(_="error",0>e&&(e=0))),x.status=e,x.statusText=(t||_)+"",l?f.resolveWith(h,[c,_,x]):f.rejectWith(h,[x,_,v]),x.statusCode(g),g=void 0,u&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,d,l?c:v]),m.fireWith(h,[x,_]),u&&(p.trigger("ajaxComplete",[x,d]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,r,o,s,a,l,u,c,d=Z.ajaxSetup({},t),h=d.context||d,p=d.context&&(h.nodeType||h.jquery)?Z(h):Z.event,f=Z.Deferred(),m=Z.Callbacks("once memory"),g=d.statusCode||{},v={},y={},b=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!s)for(s={};t=fn.exec(o);)s[t[1].toLowerCase()]=t[2];t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,v[e]=t),this},overrideMimeType:function(e){return b||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)g[t]=[g[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return i&&i.abort(t),n(0,t),this}};if(f.promise(x).complete=m.add,x.success=x.done,x.error=x.fail,d.url=((e||d.url||_n)+"").replace(hn,"").replace(vn,kn[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=Z.trim(d.dataType||"*").toLowerCase().match(pt)||[""],null==d.crossDomain&&(l=yn.exec(d.url.toLowerCase()),d.crossDomain=!(!l||l[1]===kn[1]&&l[2]===kn[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(kn[3]||("http:"===kn[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=Z.param(d.data,d.traditional)),M(bn,d,t,x),2===b)return x;u=Z.event&&d.global,u&&0===Z.active++&&Z.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!gn.test(d.type),r=d.url,d.hasContent||(d.data&&(r=d.url+=(dn.test(r)?"&":"?")+d.data,delete d.data),d.cache===!1&&(d.url=pn.test(r)?r.replace(pn,"$1_="+cn++):r+(dn.test(r)?"&":"?")+"_="+cn++)),d.ifModified&&(Z.lastModified[r]&&x.setRequestHeader("If-Modified-Since",Z.lastModified[r]),Z.etag[r]&&x.setRequestHeader("If-None-Match",Z.etag[r])),(d.data&&d.hasContent&&d.contentType!==!1||t.contentType)&&x.setRequestHeader("Content-Type",d.contentType),x.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+xn+"; q=0.01":""):d.accepts["*"]);for(c in d.headers)x.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(d.beforeSend.call(h,x,d)===!1||2===b))return x.abort();w="abort";for(c in{success:1,error:1,complete:1})x[c](d[c]);if(i=M(wn,d,t,x)){x.readyState=1,u&&p.trigger("ajaxSend",[x,d]),d.async&&d.timeout>0&&(a=setTimeout(function(){x.abort("timeout")},d.timeout));try{b=1,i.send(v,n)}catch(_){if(!(2>b))throw _;n(-1,_)}}else n(-1,"No Transport");return x},getJSON:function(e,t,n){return Z.get(e,t,n,"json")},getScript:function(e,t){return Z.get(e,void 0,t,"script")}}),Z.each(["get","post"],function(e,t){Z[t]=function(e,n,i,r){return Z.isFunction(n)&&(r=r||i,i=n,n=void 0),Z.ajax({url:e,type:t,dataType:r,data:n,success:i})}}),Z._evalUrl=function(e){return Z.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(e){var t;return Z.isFunction(e)?this.each(function(t){Z(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Z(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return this.each(Z.isFunction(e)?function(t){Z(this).wrapInner(e.call(this,t))}:function(){var t=Z(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Z.isFunction(e);return this.each(function(n){Z(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Z.expr.filters.visible=function(e){return!Z.expr.filters.hidden(e)};var Cn=/%20/g,Sn=/\[\]$/,$n=/\r?\n/g,Tn=/^(?:submit|button|image|reset|file)$/i,An=/^(?:input|select|textarea|keygen)/i;Z.param=function(e,t){var n,i=[],r=function(e,t){t=Z.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(e)||e.jquery&&!Z.isPlainObject(e))Z.each(e,function(){r(this.name,this.value)});else for(n in e)H(n,e[n],t,r);return i.join("&").replace(Cn,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Z.prop(this,"elements");return e?Z.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Z(this).is(":disabled")&&An.test(this.nodeName)&&!Tn.test(e)&&(this.checked||!Ct.test(e))}).map(function(e,t){var n=Z(this).val();return null==n?null:Z.isArray(n)?Z.map(n,function(e){return{name:t.name,value:e.replace($n,"\r\n")}}):{name:t.name,value:n.replace($n,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var En=0,jn={},Dn={0:200,1223:204},qn=Z.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in jn)jn[e]()}),Q.cors=!!qn&&"withCredentials"in qn,Q.ajax=qn=!!qn,Z.ajaxTransport(function(e){var t;return Q.cors||qn&&!e.crossDomain?{send:function(n,i){var r,o=e.xhr(),s=++En;if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(r in e.xhrFields)o[r]=e.xhrFields[r];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(r in n)o.setRequestHeader(r,n[r]);t=function(e){return function(){t&&(delete jn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?i(o.status,o.statusText):i(Dn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=jn[s]=t("abort");try{o.send(e.hasContent&&e.data||null)}catch(a){if(t)throw a}},abort:function(){t&&t()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Z.globalEval(e),e}}}),Z.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Z.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(i,r){t=Z("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&r("error"===e.type?404:200,e.type)
}),Y.head.appendChild(t[0])},abort:function(){n&&n()}}}});var Pn=[],In=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Pn.pop()||Z.expando+"_"+cn++;return this[e]=!0,e}}),Z.ajaxPrefilter("json jsonp",function(t,n,i){var r,o,s,a=t.jsonp!==!1&&(In.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&In.test(t.data)&&"data");return a||"jsonp"===t.dataTypes[0]?(r=t.jsonpCallback=Z.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,a?t[a]=t[a].replace(In,"$1"+r):t.jsonp!==!1&&(t.url+=(dn.test(t.url)?"&":"?")+t.jsonp+"="+r),t.converters["script json"]=function(){return s||Z.error(r+" was not called"),s[0]},t.dataTypes[0]="json",o=e[r],e[r]=function(){s=arguments},i.always(function(){e[r]=o,t[r]&&(t.jsonpCallback=n.jsonpCallback,Pn.push(r)),s&&Z.isFunction(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),Z.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||Y;var i=st.exec(e),r=!n&&[];return i?[t.createElement(i[1])]:(i=Z.buildFragment([e],t,r),r&&r.length&&Z(r).remove(),Z.merge([],i.childNodes))};var Rn=Z.fn.load;Z.fn.load=function(e,t,n){if("string"!=typeof e&&Rn)return Rn.apply(this,arguments);var i,r,o,s=this,a=e.indexOf(" ");return a>=0&&(i=Z.trim(e.slice(a)),e=e.slice(0,a)),Z.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(r="POST"),s.length>0&&Z.ajax({url:e,type:r,dataType:"html",data:t}).done(function(e){o=arguments,s.html(i?Z("<div>").append(Z.parseHTML(e)).find(i):e)}).complete(n&&function(e,t){s.each(n,o||[e.responseText,t,e])}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Z.fn[t]=function(e){return this.on(t,e)}}),Z.expr.filters.animated=function(e){return Z.grep(Z.timers,function(t){return e===t.elem}).length};var Mn=e.document.documentElement;Z.offset={setOffset:function(e,t,n){var i,r,o,s,a,l,u,c=Z.css(e,"position"),d=Z(e),h={};"static"===c&&(e.style.position="relative"),a=d.offset(),o=Z.css(e,"top"),l=Z.css(e,"left"),u=("absolute"===c||"fixed"===c)&&(o+l).indexOf("auto")>-1,u?(i=d.position(),s=i.top,r=i.left):(s=parseFloat(o)||0,r=parseFloat(l)||0),Z.isFunction(t)&&(t=t.call(e,n,a)),null!=t.top&&(h.top=t.top-a.top+s),null!=t.left&&(h.left=t.left-a.left+r),"using"in t?t.using.call(e,h):d.css(h)}},Z.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Z.offset.setOffset(this,e,t)});var t,n,i=this[0],r={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,Z.contains(t,i)?(typeof i.getBoundingClientRect!==St&&(r=i.getBoundingClientRect()),n=F(o),{top:r.top+n.pageYOffset-t.clientTop,left:r.left+n.pageXOffset-t.clientLeft}):r},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===Z.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Z.nodeName(e[0],"html")||(i=e.offset()),i.top+=Z.css(e[0],"borderTopWidth",!0),i.left+=Z.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-Z.css(n,"marginTop",!0),left:t.left-i.left-Z.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Mn;e&&!Z.nodeName(e,"html")&&"static"===Z.css(e,"position");)e=e.offsetParent;return e||Mn})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var i="pageYOffset"===n;Z.fn[t]=function(r){return gt(this,function(t,r,o){var s=F(t);return void 0===o?s?s[n]:t[r]:void(s?s.scrollTo(i?e.pageXOffset:o,i?o:e.pageYOffset):t[r]=o)},t,r,arguments.length,null)}}),Z.each(["top","left"],function(e,t){Z.cssHooks[t]=_(Q.pixelPosition,function(e,n){return n?(n=x(e,t),Bt.test(n)?Z(e).position()[t]+"px":n):void 0})}),Z.each({Height:"height",Width:"width"},function(e,t){Z.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,i){Z.fn[i]=function(i,r){var o=arguments.length&&(n||"boolean"!=typeof i),s=n||(i===!0||r===!0?"margin":"border");return gt(this,function(t,n,i){var r;return Z.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(r=t.documentElement,Math.max(t.body["scroll"+e],r["scroll"+e],t.body["offset"+e],r["offset"+e],r["client"+e])):void 0===i?Z.css(t,n,s):Z.style(t,n,i,s)},t,o?i:void 0,o,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Nn=e.jQuery,On=e.$;return Z.noConflict=function(t){return e.$===Z&&(e.$=On),t&&e.jQuery===Z&&(e.jQuery=Nn),Z},typeof t===St&&(e.jQuery=e.$=Z),Z}),function(e,t){if("function"==typeof define&&define.amd)define("backbone",["underscore","jquery","exports"],function(n,i,r){e.Backbone=t(e,r,n,i)});else if("undefined"!=typeof exports){var n=require("underscore");t(e,exports,n)}else e.Backbone=t(e,{},e._,e.jQuery||e.Zepto||e.ender||e.$)}(this,function(e,t,n,i){{var r=e.Backbone,o=[],s=(o.push,o.slice);o.splice}t.VERSION="1.1.2",t.$=i,t.noConflict=function(){return e.Backbone=r,this},t.emulateHTTP=!1,t.emulateJSON=!1;var a=t.Events={on:function(e,t,n){if(!u(this,"on",e,[t,n])||!t)return this;this._events||(this._events={});var i=this._events[e]||(this._events[e]=[]);return i.push({callback:t,context:n,ctx:n||this}),this},once:function(e,t,i){if(!u(this,"once",e,[t,i])||!t)return this;var r=this,o=n.once(function(){r.off(e,o),t.apply(this,arguments)});return o._callback=t,this.on(e,o,i)},off:function(e,t,i){var r,o,s,a,l,c,d,h;if(!this._events||!u(this,"off",e,[t,i]))return this;if(!e&&!t&&!i)return this._events=void 0,this;for(a=e?[e]:n.keys(this._events),l=0,c=a.length;c>l;l++)if(e=a[l],s=this._events[e]){if(this._events[e]=r=[],t||i)for(d=0,h=s.length;h>d;d++)o=s[d],(t&&t!==o.callback&&t!==o.callback._callback||i&&i!==o.context)&&r.push(o);r.length||delete this._events[e]}return this},trigger:function(e){if(!this._events)return this;var t=s.call(arguments,1);if(!u(this,"trigger",e,t))return this;var n=this._events[e],i=this._events.all;return n&&c(n,t),i&&c(i,arguments),this},stopListening:function(e,t,i){var r=this._listeningTo;if(!r)return this;var o=!t&&!i;i||"object"!=typeof t||(i=this),e&&((r={})[e._listenId]=e);for(var s in r)e=r[s],e.off(t,i,this),(o||n.isEmpty(e._events))&&delete this._listeningTo[s];return this}},l=/\s+/,u=function(e,t,n,i){if(!n)return!0;if("object"==typeof n){for(var r in n)e[t].apply(e,[r,n[r]].concat(i));return!1}if(l.test(n)){for(var o=n.split(l),s=0,a=o.length;a>s;s++)e[t].apply(e,[o[s]].concat(i));return!1}return!0},c=function(e,t){var n,i=-1,r=e.length,o=t[0],s=t[1],a=t[2];switch(t.length){case 0:for(;++i<r;)(n=e[i]).callback.call(n.ctx);return;case 1:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o);return;case 2:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s);return;case 3:for(;++i<r;)(n=e[i]).callback.call(n.ctx,o,s,a);return;default:for(;++i<r;)(n=e[i]).callback.apply(n.ctx,t);return}},d={listenTo:"on",listenToOnce:"once"};n.each(d,function(e,t){a[t]=function(t,i,r){var o=this._listeningTo||(this._listeningTo={}),s=t._listenId||(t._listenId=n.uniqueId("l"));return o[s]=t,r||"object"!=typeof i||(r=this),t[e](i,r,this),this}}),a.bind=a.on,a.unbind=a.off,n.extend(t,a);var h=t.Model=function(e,t){var i=e||{};t||(t={}),this.cid=n.uniqueId("c"),this.attributes={},t.collection&&(this.collection=t.collection),t.parse&&(i=this.parse(i,t)||{}),i=n.defaults({},i,n.result(this,"defaults")),this.set(i,t),this.changed={},this.initialize.apply(this,arguments)};n.extend(h.prototype,a,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(){return n.clone(this.attributes)},sync:function(){return t.sync.apply(this,arguments)},get:function(e){return this.attributes[e]},escape:function(e){return n.escape(this.get(e))},has:function(e){return null!=this.get(e)},set:function(e,t,i){var r,o,s,a,l,u,c,d;if(null==e)return this;if("object"==typeof e?(o=e,i=t):(o={})[e]=t,i||(i={}),!this._validate(o,i))return!1;s=i.unset,l=i.silent,a=[],u=this._changing,this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={}),d=this.attributes,c=this._previousAttributes,this.idAttribute in o&&(this.id=o[this.idAttribute]);for(r in o)t=o[r],n.isEqual(d[r],t)||a.push(r),n.isEqual(c[r],t)?delete this.changed[r]:this.changed[r]=t,s?delete d[r]:d[r]=t;if(!l){a.length&&(this._pending=i);for(var h=0,p=a.length;p>h;h++)this.trigger("change:"+a[h],this,d[a[h]],i)}if(u)return this;if(!l)for(;this._pending;)i=this._pending,this._pending=!1,this.trigger("change",this,i);return this._pending=!1,this._changing=!1,this},unset:function(e,t){return this.set(e,void 0,n.extend({},t,{unset:!0}))},clear:function(e){var t={};for(var i in this.attributes)t[i]=void 0;return this.set(t,n.extend({},e,{unset:!0}))},hasChanged:function(e){return null==e?!n.isEmpty(this.changed):n.has(this.changed,e)},changedAttributes:function(e){if(!e)return this.hasChanged()?n.clone(this.changed):!1;var t,i=!1,r=this._changing?this._previousAttributes:this.attributes;for(var o in e)n.isEqual(r[o],t=e[o])||((i||(i={}))[o]=t);return i},previous:function(e){return null!=e&&this._previousAttributes?this._previousAttributes[e]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=this,i=e.success;return e.success=function(n){return t.set(t.parse(n,e),e)?(i&&i(t,n,e),void t.trigger("sync",t,n,e)):!1},N(this,e),this.sync("read",this,e)},save:function(e,t,i){var r,o,s,a=this.attributes;if(null==e||"object"==typeof e?(r=e,i=t):(r={})[e]=t,i=n.extend({validate:!0},i),r&&!i.wait){if(!this.set(r,i))return!1}else if(!this._validate(r,i))return!1;r&&i.wait&&(this.attributes=n.extend({},a,r)),void 0===i.parse&&(i.parse=!0);var l=this,u=i.success;return i.success=function(e){l.attributes=a;var t=l.parse(e,i);return i.wait&&(t=n.extend(r||{},t)),n.isObject(t)&&!l.set(t,i)?!1:(u&&u(l,e,i),void l.trigger("sync",l,e,i))},N(this,i),o=this.isNew()?"create":i.patch?"patch":"update","patch"===o&&(i.attrs=r),s=this.sync(o,this,i),r&&i.wait&&(this.attributes=a),s},destroy:function(e){e=e?n.clone(e):{};var t=this,i=e.success,r=function(){t.trigger("destroy",t,t.collection,e)};if(e.success=function(n){(e.wait||t.isNew())&&r(),i&&i(t,n,e),t.isNew()||t.trigger("sync",t,n,e)},this.isNew())return e.success(),!1;N(this,e);var o=this.sync("delete",this,e);return e.wait||r(),o},url:function(){var e=n.result(this,"urlRoot")||n.result(this.collection,"url")||M();return this.isNew()?e:e.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(e){return e},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(e){return this._validate({},n.extend(e||{},{validate:!0}))},_validate:function(e,t){if(!t.validate||!this.validate)return!0;e=n.extend({},this.attributes,e);var i=this.validationError=this.validate(e,t)||null;return i?(this.trigger("invalid",this,i,n.extend(t,{validationError:i})),!1):!0}});var p=["keys","values","pairs","invert","pick","omit"];n.each(p,function(e){h.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.attributes),n[e].apply(n,t)}});var f=t.Collection=function(e,t){t||(t={}),t.model&&(this.model=t.model),void 0!==t.comparator&&(this.comparator=t.comparator),this._reset(),this.initialize.apply(this,arguments),e&&this.reset(e,n.extend({silent:!0},t))},m={add:!0,remove:!0,merge:!0},g={add:!0,remove:!1};n.extend(f.prototype,a,{model:h,initialize:function(){},toJSON:function(e){return this.map(function(t){return t.toJSON(e)})},sync:function(){return t.sync.apply(this,arguments)},add:function(e,t){return this.set(e,n.extend({merge:!1},t,g))},remove:function(e,t){var i=!n.isArray(e);e=i?[e]:n.clone(e),t||(t={});var r,o,s,a;for(r=0,o=e.length;o>r;r++)a=e[r]=this.get(e[r]),a&&(delete this._byId[a.id],delete this._byId[a.cid],s=this.indexOf(a),this.models.splice(s,1),this.length--,t.silent||(t.index=s,a.trigger("remove",a,this,t)),this._removeReference(a,t));return i?e[0]:e},set:function(e,t){t=n.defaults({},t,m),t.parse&&(e=this.parse(e,t));var i=!n.isArray(e);e=i?e?[e]:[]:n.clone(e);var r,o,s,a,l,u,c,d=t.at,p=this.model,f=this.comparator&&null==d&&t.sort!==!1,g=n.isString(this.comparator)?this.comparator:null,v=[],y=[],b={},w=t.add,x=t.merge,_=t.remove,k=!f&&w&&_?[]:!1;for(r=0,o=e.length;o>r;r++){if(l=e[r]||{},s=l instanceof h?a=l:l[p.prototype.idAttribute||"id"],u=this.get(s))_&&(b[u.cid]=!0),x&&(l=l===a?a.attributes:l,t.parse&&(l=u.parse(l,t)),u.set(l,t),f&&!c&&u.hasChanged(g)&&(c=!0)),e[r]=u;else if(w){if(a=e[r]=this._prepareModel(l,t),!a)continue;v.push(a),this._addReference(a,t)}a=u||a,!k||!a.isNew()&&b[a.id]||k.push(a),b[a.id]=!0}if(_){for(r=0,o=this.length;o>r;++r)b[(a=this.models[r]).cid]||y.push(a);y.length&&this.remove(y,t)}if(v.length||k&&k.length)if(f&&(c=!0),this.length+=v.length,null!=d)for(r=0,o=v.length;o>r;r++)this.models.splice(d+r,0,v[r]);else{k&&(this.models.length=0);var C=k||v;for(r=0,o=C.length;o>r;r++)this.models.push(C[r])}if(c&&this.sort({silent:!0}),!t.silent){for(r=0,o=v.length;o>r;r++)(a=v[r]).trigger("add",a,this,t);(c||k&&k.length)&&this.trigger("sort",this,t)}return i?e[0]:e},reset:function(e,t){t||(t={});for(var i=0,r=this.models.length;r>i;i++)this._removeReference(this.models[i],t);return t.previousModels=this.models,this._reset(),e=this.add(e,n.extend({silent:!0},t)),t.silent||this.trigger("reset",this,t),e},push:function(e,t){return this.add(e,n.extend({at:this.length},t))},pop:function(e){var t=this.at(this.length-1);return this.remove(t,e),t},unshift:function(e,t){return this.add(e,n.extend({at:0},t))},shift:function(e){var t=this.at(0);return this.remove(t,e),t},slice:function(){return s.apply(this.models,arguments)},get:function(e){return null==e?void 0:this._byId[e]||this._byId[e.id]||this._byId[e.cid]},at:function(e){return this.models[e]},where:function(e,t){return n.isEmpty(e)?t?void 0:[]:this[t?"find":"filter"](function(t){for(var n in e)if(e[n]!==t.get(n))return!1;return!0})},findWhere:function(e){return this.where(e,!0)},sort:function(e){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return e||(e={}),n.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(n.bind(this.comparator,this)),e.silent||this.trigger("sort",this,e),this},pluck:function(e){return n.invoke(this.models,"get",e)},fetch:function(e){e=e?n.clone(e):{},void 0===e.parse&&(e.parse=!0);var t=e.success,i=this;return e.success=function(n){var r=e.reset?"reset":"set";i[r](n,e),t&&t(i,n,e),i.trigger("sync",i,n,e)},N(this,e),this.sync("read",this,e)},create:function(e,t){if(t=t?n.clone(t):{},!(e=this._prepareModel(e,t)))return!1;t.wait||this.add(e,t);var i=this,r=t.success;return t.success=function(e,n){t.wait&&i.add(e,t),r&&r(e,n,t)},e.save(null,t),e},parse:function(e){return e},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(e,t){if(e instanceof h)return e;t=t?n.clone(t):{},t.collection=this;var i=new this.model(e,t);return i.validationError?(this.trigger("invalid",this,i.validationError,t),!1):i},_addReference:function(e){this._byId[e.cid]=e,null!=e.id&&(this._byId[e.id]=e),e.collection||(e.collection=this),e.on("all",this._onModelEvent,this)},_removeReference:function(e){this===e.collection&&delete e.collection,e.off("all",this._onModelEvent,this)},_onModelEvent:function(e,t,n,i){("add"!==e&&"remove"!==e||n===this)&&("destroy"===e&&this.remove(t,i),t&&e==="change:"+t.idAttribute&&(delete this._byId[t.previous(t.idAttribute)],null!=t.id&&(this._byId[t.id]=t)),this.trigger.apply(this,arguments))}});var v=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];n.each(v,function(e){f.prototype[e]=function(){var t=s.call(arguments);return t.unshift(this.models),n[e].apply(n,t)}});var y=["groupBy","countBy","sortBy","indexBy"];n.each(y,function(e){f.prototype[e]=function(t,i){var r=n.isFunction(t)?t:function(e){return e.get(t)};return n[e](this.models,r,i)}});var b=t.View=function(e){this.cid=n.uniqueId("view"),e||(e={}),n.extend(this,n.pick(e,x)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},w=/^(\S+)\s*(.*)$/,x=["model","collection","el","id","attributes","className","tagName","events"];n.extend(b.prototype,a,{tagName:"div",$:function(e){return this.$el.find(e)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(e,n){return this.$el&&this.undelegateEvents(),this.$el=e instanceof t.$?e:t.$(e),this.el=this.$el[0],n!==!1&&this.delegateEvents(),this},delegateEvents:function(e){if(!e&&!(e=n.result(this,"events")))return this;this.undelegateEvents();for(var t in e){var i=e[t];if(n.isFunction(i)||(i=this[e[t]]),i){var r=t.match(w),o=r[1],s=r[2];i=n.bind(i,this),o+=".delegateEvents"+this.cid,""===s?this.$el.on(o,i):this.$el.on(o,s,i)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"),!1);else{var e=n.extend({},n.result(this,"attributes"));this.id&&(e.id=n.result(this,"id")),this.className&&(e["class"]=n.result(this,"className"));var i=t.$("<"+n.result(this,"tagName")+">").attr(e);this.setElement(i,!1)}}}),t.sync=function(e,i,r){var o=k[e];n.defaults(r||(r={}),{emulateHTTP:t.emulateHTTP,emulateJSON:t.emulateJSON});var s={type:o,dataType:"json"};if(r.url||(s.url=n.result(i,"url")||M()),null!=r.data||!i||"create"!==e&&"update"!==e&&"patch"!==e||(s.contentType="application/json",s.data=JSON.stringify(r.attrs||i.toJSON(r))),r.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),r.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",r.emulateJSON&&(s.data._method=o);var a=r.beforeSend;r.beforeSend=function(e){return e.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===s.type||r.emulateJSON||(s.processData=!1),"PATCH"===s.type&&_&&(s.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var l=r.xhr=t.ajax(n.extend(s,r));return i.trigger("request",i,l,r),l};var _=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),k={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};t.ajax=function(){return t.$.ajax.apply(t.$,arguments)};var C=t.Router=function(e){e||(e={}),e.routes&&(this.routes=e.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},S=/\((.*?)\)/g,$=/(\(\?)?:\w+/g,T=/\*\w+/g,A=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(C.prototype,a,{initialize:function(){},route:function(e,i,r){n.isRegExp(e)||(e=this._routeToRegExp(e)),n.isFunction(i)&&(r=i,i=""),r||(r=this[i]);var o=this;return t.history.route(e,function(n){var s=o._extractParameters(e,n);o.execute(r,s),o.trigger.apply(o,["route:"+i].concat(s)),o.trigger("route",i,s),t.history.trigger("route",o,i,s)}),this},execute:function(e,t){e&&e.apply(this,t)},navigate:function(e,n){return t.history.navigate(e,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var e,t=n.keys(this.routes);null!=(e=t.pop());)this.route(e,this.routes[e])}},_routeToRegExp:function(e){return e=e.replace(A,"\\$&").replace(S,"(?:$1)?").replace($,function(e,t){return t?e:"([^/?]+)"}).replace(T,"([^?]*?)"),new RegExp("^"+e+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(e,t){var i=e.exec(t).slice(1);return n.map(i,function(e,t){return t===i.length-1?e||null:e?decodeURIComponent(e):null})}});var E=t.History=function(){this.handlers=[],n.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},j=/^[#\/]|\s+$/g,D=/^\/+|\/+$/g,q=/msie [\w.]+/,P=/\/$/,I=/#.*$/;E.started=!1,n.extend(E.prototype,a,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(e){var t=(e||this).location.href.match(/#(.*)$/);return t?t[1]:""},getFragment:function(e,t){if(null==e)if(this._hasPushState||!this._wantsHashChange||t){e=decodeURI(this.location.pathname+this.location.search);var n=this.root.replace(P,"");e.indexOf(n)||(e=e.slice(n.length))}else e=this.getHash();return e.replace(j,"")},start:function(e){if(E.started)throw new Error("Backbone.history has already been started");E.started=!0,this.options=n.extend({root:"/"},this.options,e),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var i=this.getFragment(),r=document.documentMode,o=q.exec(navigator.userAgent.toLowerCase())&&(!r||7>=r);if(this.root=("/"+this.root+"/").replace(D,"/"),o&&this._wantsHashChange){var s=t.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=s.hide().appendTo("body")[0].contentWindow,this.navigate(i)}this._hasPushState?t.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!o?t.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=i;var a=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&a.hash&&(this.fragment=this.getHash().replace(j,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){t.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),E.started=!1},route:function(e,t){this.handlers.unshift({route:e,callback:t})},checkUrl:function(){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getFragment(this.getHash(this.iframe))),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(e){return e=this.fragment=this.getFragment(e),n.any(this.handlers,function(t){return t.route.test(e)?(t.callback(e),!0):void 0})},navigate:function(e,t){if(!E.started)return!1;t&&t!==!0||(t={trigger:!!t});var n=this.root+(e=this.getFragment(e||""));if(e=e.replace(I,""),this.fragment!==e){if(this.fragment=e,""===e&&"/"!==n&&(n=n.slice(0,-1)),this._hasPushState)this.history[t.replace?"replaceState":"pushState"]({},document.title,n);else{if(!this._wantsHashChange)return this.location.assign(n);this._updateHash(this.location,e,t.replace),this.iframe&&e!==this.getFragment(this.getHash(this.iframe))&&(t.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,e,t.replace))}return t.trigger?this.loadUrl(e):void 0}},_updateHash:function(e,t,n){if(n){var i=e.href.replace(/(javascript:|#).*$/,"");e.replace(i+"#"+t)}else e.hash="#"+t}}),t.history=new E;var R=function(e,t){var i,r=this;i=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(i,r,t);var o=function(){this.constructor=i};return o.prototype=r.prototype,i.prototype=new o,e&&n.extend(i.prototype,e),i.__super__=r.prototype,i};h.extend=f.extend=C.extend=b.extend=E.extend=R;var M=function(){throw new Error('A "url" property or function must be specified')},N=function(e,t){var n=t.error;t.error=function(i){n&&n(e,i,t),e.trigger("error",e,i,t)}};return t});var goog=goog||{};goog.inherits=function(e,t){function n(){}n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e},goog.userAgent||(goog.userAgent=function(){var e="";"undefined"!=typeof navigator&&navigator&&"string"==typeof navigator.userAgent&&(e=navigator.userAgent);var t=0==e.indexOf("Opera");return{HAS_JSCRIPT:"string"in this,IS_OPERA:t,IS_IE:!t&&-1!=e.indexOf("MSIE"),IS_WEBKIT:!t&&-1!=e.indexOf("WebKit")}}()),goog.asserts||(goog.asserts={fail:function(){}}),goog.dom||(goog.dom={},goog.dom.DomHelper=function(e){this.document_=e||document},goog.dom.DomHelper.prototype.getDocument=function(){return this.document_},goog.dom.DomHelper.prototype.createElement=function(e){return this.document_.createElement(e)},goog.dom.DomHelper.prototype.createDocumentFragment=function(){return this.document_.createDocumentFragment()}),goog.format||(goog.format={insertWordBreaks:function(e,t){e=String(e);for(var n=[],i=0,r=!1,o=!1,s=0,a=0,l=0,u=e.length;u>l;++l){var c=e.charCodeAt(l);if(s>=t&&32!=c&&(n[i++]=e.substring(a,l),a=l,n[i++]=goog.format.WORD_BREAK,s=0),r)62==c&&(r=!1);else if(o)switch(c){case 59:o=!1,++s;break;case 60:o=!1,r=!0;break;case 32:o=!1,s=0}else switch(c){case 60:r=!0;break;case 38:o=!0;break;case 32:s=0;break;default:++s}}return n[i++]=e.substring(a),n.join("")},WORD_BREAK:goog.userAgent.IS_WEBKIT?"<wbr></wbr>":goog.userAgent.IS_OPERA?"&shy;":"<wbr>"}),goog.i18n||(goog.i18n={bidi:{detectRtlDirectionality:function(e,t){return e=soyshim.$$bidiStripHtmlIfNecessary_(e,t),soyshim.$$bidiRtlWordRatio_(e)>soyshim.$$bidiRtlDetectionThreshold_}}}),goog.i18n.bidi.Dir={RTL:-1,UNKNOWN:0,LTR:1},goog.i18n.bidi.toDir=function(e){return"number"==typeof e?e>0?goog.i18n.bidi.Dir.LTR:0>e?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.UNKNOWN:e?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR},goog.i18n.BidiFormatter=function(e){this.dir_=goog.i18n.bidi.toDir(e)},goog.i18n.BidiFormatter.prototype.dirAttr=function(e,t){var n=soy.$$bidiTextDir(e,t);return n&&n!=this.dir_?0>n?"dir=rtl":"dir=ltr":""},goog.i18n.BidiFormatter.prototype.endEdge=function(){return this.dir_<0?"left":"right"},goog.i18n.BidiFormatter.prototype.mark=function(){return this.dir_>0?"":this.dir_<0?"":""},goog.i18n.BidiFormatter.prototype.markAfter=function(e,t){var n=soy.$$bidiTextDir(e,t);return soyshim.$$bidiMarkAfterKnownDir_(this.dir_,n,e,t)},goog.i18n.BidiFormatter.prototype.spanWrap=function(e){e=String(e);var t=soy.$$bidiTextDir(e,!0),n=soyshim.$$bidiMarkAfterKnownDir_(this.dir_,t,e,!0);return t>0&&this.dir_<=0?e="<span dir=ltr>"+e+"</span>":0>t&&this.dir_>=0&&(e="<span dir=rtl>"+e+"</span>"),e+n},goog.i18n.BidiFormatter.prototype.startEdge=function(){return this.dir_<0?"right":"left"},goog.i18n.BidiFormatter.prototype.unicodeWrap=function(e){e=String(e);var t=soy.$$bidiTextDir(e,!0),n=soyshim.$$bidiMarkAfterKnownDir_(this.dir_,t,e,!0);return t>0&&this.dir_<=0?e=""+e+"":0>t&&this.dir_>=0&&(e=""+e+""),e+n},goog.string={newLineToBr:function(e,t){return e=String(e),goog.string.NEWLINE_TO_BR_RE_.test(e)?e.replace(/(\r\n|\r|\n)/g,t?"<br />":"<br>"):e},urlEncode:encodeURIComponent,NEWLINE_TO_BR_RE_:/[\r\n]/},goog.string.StringBuffer=function(e){this.buffer_=goog.userAgent.HAS_JSCRIPT?[]:"",null!=e&&this.append.apply(this,arguments)},goog.string.StringBuffer.prototype.bufferLength_=0,goog.string.StringBuffer.prototype.append=function(e,t){if(goog.userAgent.HAS_JSCRIPT)if(null==t)this.buffer_[this.bufferLength_++]=e;else{var n=this.buffer_;n.push.apply(n,arguments),this.bufferLength_=this.buffer_.length}else if(this.buffer_+=e,null!=t)for(var i=1;i<arguments.length;i++)this.buffer_+=arguments[i];return this},goog.string.StringBuffer.prototype.clear=function(){goog.userAgent.HAS_JSCRIPT?(this.buffer_.length=0,this.bufferLength_=0):this.buffer_=""},goog.string.StringBuffer.prototype.toString=function(){if(goog.userAgent.HAS_JSCRIPT){var e=this.buffer_.join("");return this.clear(),e&&this.append(e),e}return this.buffer_},goog.soy||(goog.soy={renderAsElement:function(e,t,n,i){return soyshim.$$renderWithWrapper_(e,t,i,!0,n)},renderAsFragment:function(e,t,n,i){return soyshim.$$renderWithWrapper_(e,t,i,!1,n)},renderElement:function(e,t,n,i){e.innerHTML=t(n,null,i)}});var soy={esc:{}},soydata={},soyshim={$$DEFAULT_TEMPLATE_DATA_:{}};if(soyshim.$$renderWithWrapper_=function(e,t,n,i,r){var o=n||document,s=o.createElement("div");if(s.innerHTML=e(t||soyshim.$$DEFAULT_TEMPLATE_DATA_,void 0,r),1==s.childNodes.length){var a=s.firstChild;if(!i||1==a.nodeType)return a}if(i)return s;for(var l=o.createDocumentFragment();s.firstChild;)l.appendChild(s.firstChild);return l},soyshim.$$bidiMarkAfterKnownDir_=function(e,t,n,i){return e>0&&(0>t||soyshim.$$bidiIsRtlExitText_(n,i))?"":0>e&&(t>0||soyshim.$$bidiIsLtrExitText_(n,i))?"":""},soyshim.$$bidiStripHtmlIfNecessary_=function(e,t){return t?e.replace(soyshim.$$BIDI_HTML_SKIP_RE_," "):e},soyshim.$$BIDI_HTML_SKIP_RE_=/<[^>]*>|&[^;]+;/g,soyshim.$$bidiLtrChars_="A-Za-z--------",soyshim.$$bidiNeutralChars_="\x00- !-@[-`{---",soyshim.$$bidiRtlChars_="---",soyshim.$$bidiRtlDirCheckRe_=new RegExp("^[^"+soyshim.$$bidiLtrChars_+"]*["+soyshim.$$bidiRtlChars_+"]"),soyshim.$$bidiNeutralDirCheckRe_=new RegExp("^["+soyshim.$$bidiNeutralChars_+"]*$|^http://"),soyshim.$$bidiIsRtlText_=function(e){return soyshim.$$bidiRtlDirCheckRe_.test(e)},soyshim.$$bidiIsNeutralText_=function(e){return soyshim.$$bidiNeutralDirCheckRe_.test(e)},soyshim.$$bidiRtlDetectionThreshold_=.4,soyshim.$$bidiRtlWordRatio_=function(e){for(var t=0,n=0,i=e.split(" "),r=0;r<i.length;r++)soyshim.$$bidiIsRtlText_(i[r])?(t++,n++):soyshim.$$bidiIsNeutralText_(i[r])||n++;return 0==n?0:t/n},soyshim.$$bidiLtrExitDirCheckRe_=new RegExp("["+soyshim.$$bidiLtrChars_+"][^"+soyshim.$$bidiRtlChars_+"]*$"),soyshim.$$bidiRtlExitDirCheckRe_=new RegExp("["+soyshim.$$bidiRtlChars_+"][^"+soyshim.$$bidiLtrChars_+"]*$"),soyshim.$$bidiIsLtrExitText_=function(e,t){return e=soyshim.$$bidiStripHtmlIfNecessary_(e,t),soyshim.$$bidiLtrExitDirCheckRe_.test(e)},soyshim.$$bidiIsRtlExitText_=function(e,t){return e=soyshim.$$bidiStripHtmlIfNecessary_(e,t),soyshim.$$bidiRtlExitDirCheckRe_.test(e)},soy.StringBuilder=goog.string.StringBuffer,soydata.SanitizedContentKind={HTML:0,JS_STR_CHARS:1,URI:2,HTML_ATTRIBUTE:3},soydata.SanitizedContent=function(e){this.content=e},soydata.SanitizedContent.prototype.contentKind,soydata.SanitizedContent.prototype.toString=function(){return this.content},soydata.SanitizedHtml=function(e){soydata.SanitizedContent.call(this,e)},goog.inherits(soydata.SanitizedHtml,soydata.SanitizedContent),soydata.SanitizedHtml.prototype.contentKind=soydata.SanitizedContentKind.HTML,soydata.SanitizedJsStrChars=function(e){soydata.SanitizedContent.call(this,e)},goog.inherits(soydata.SanitizedJsStrChars,soydata.SanitizedContent),soydata.SanitizedJsStrChars.prototype.contentKind=soydata.SanitizedContentKind.JS_STR_CHARS,soydata.SanitizedUri=function(e){soydata.SanitizedContent.call(this,e)},goog.inherits(soydata.SanitizedUri,soydata.SanitizedContent),soydata.SanitizedUri.prototype.contentKind=soydata.SanitizedContentKind.URI,soydata.SanitizedHtmlAttribute=function(e){soydata.SanitizedContent.call(this,e)},goog.inherits(soydata.SanitizedHtmlAttribute,soydata.SanitizedContent),soydata.SanitizedHtmlAttribute.prototype.contentKind=soydata.SanitizedContentKind.HTML_ATTRIBUTE,soy.renderElement=goog.soy.renderElement,soy.renderAsFragment=function(e,t,n,i){return goog.soy.renderAsFragment(e,t,i,new goog.dom.DomHelper(n))},soy.renderAsElement=function(e,t,n,i){return goog.soy.renderAsElement(e,t,i,new goog.dom.DomHelper(n))},soy.$$augmentData=function(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return i},soy.$$getMapKeys=function(e){var t=[];for(var n in e)t.push(n);return t},soy.$$getDelegateId=function(e){return e},soy.$$DELEGATE_REGISTRY_PRIORITIES_={},soy.$$DELEGATE_REGISTRY_FUNCTIONS_={},soy.$$registerDelegateFn=function(e,t,n){var i="key_"+e,r=soy.$$DELEGATE_REGISTRY_PRIORITIES_[i];if(void 0===r||t>r)soy.$$DELEGATE_REGISTRY_PRIORITIES_[i]=t,soy.$$DELEGATE_REGISTRY_FUNCTIONS_[i]=n;else if(t==r)throw Error('Encountered two active delegates with same priority (id/name "'+e+'").')
},soy.$$getDelegateFn=function(e){var t=soy.$$DELEGATE_REGISTRY_FUNCTIONS_["key_"+e];return t?t:soy.$$EMPTY_TEMPLATE_FN_},soy.$$EMPTY_TEMPLATE_FN_=function(){return""},soy.$$escapeHtml=function(e){return"object"==typeof e&&e&&e.contentKind===soydata.SanitizedContentKind.HTML?e.content:soy.esc.$$escapeHtmlHelper(e)},soy.$$escapeHtmlRcdata=function(e){return"object"==typeof e&&e&&e.contentKind===soydata.SanitizedContentKind.HTML?soy.esc.$$normalizeHtmlHelper(e.content):soy.esc.$$escapeHtmlHelper(e)},soy.$$stripHtmlTags=function(e){return String(e).replace(soy.esc.$$HTML_TAG_REGEX_,"")},soy.$$escapeHtmlAttribute=function(e){return"object"==typeof e&&e&&e.contentKind===soydata.SanitizedContentKind.HTML?soy.esc.$$normalizeHtmlHelper(soy.$$stripHtmlTags(e.content)):soy.esc.$$escapeHtmlHelper(e)},soy.$$escapeHtmlAttributeNospace=function(e){return"object"==typeof e&&e&&e.contentKind===soydata.SanitizedContentKind.HTML?soy.esc.$$normalizeHtmlNospaceHelper(soy.$$stripHtmlTags(e.content)):soy.esc.$$escapeHtmlNospaceHelper(e)},soy.$$filterHtmlAttribute=function(e){return"object"==typeof e&&e&&e.contentKind===soydata.SanitizedContentKind.HTML_ATTRIBUTE?e.content.replace(/=([^"']*)$/,'="$1"'):soy.esc.$$filterHtmlAttributeHelper(e)},soy.$$filterHtmlElementName=function(e){return soy.esc.$$filterHtmlElementNameHelper(e)},soy.$$escapeJs=function(e){return soy.$$escapeJsString(e)},soy.$$escapeJsString=function(e){return"object"==typeof e&&e.contentKind===soydata.SanitizedContentKind.JS_STR_CHARS?e.content:soy.esc.$$escapeJsStringHelper(e)},soy.$$escapeJsValue=function(e){if(null==e)return" null ";switch(typeof e){case"boolean":case"number":return" "+e+" ";default:return"'"+soy.esc.$$escapeJsStringHelper(String(e))+"'"}},soy.$$escapeJsRegex=function(e){return soy.esc.$$escapeJsRegexHelper(e)},soy.$$problematicUriMarks_=/['()]/g,soy.$$pctEncode_=function(e){return"%"+e.charCodeAt(0).toString(16)},soy.$$escapeUri=function(e){if("object"==typeof e&&e.contentKind===soydata.SanitizedContentKind.URI)return soy.$$normalizeUri(e);var t=soy.esc.$$escapeUriHelper(e);return soy.$$problematicUriMarks_.lastIndex=0,soy.$$problematicUriMarks_.test(t)?t.replace(soy.$$problematicUriMarks_,soy.$$pctEncode_):t},soy.$$normalizeUri=function(e){return soy.esc.$$normalizeUriHelper(e)},soy.$$filterNormalizeUri=function(e){return soy.esc.$$filterNormalizeUriHelper(e)},soy.$$escapeCssString=function(e){return soy.esc.$$escapeCssStringHelper(e)},soy.$$filterCssValue=function(e){return null==e?"":soy.esc.$$filterCssValueHelper(e)},soy.$$changeNewlineToBr=function(e){return goog.string.newLineToBr(String(e),!1)},soy.$$insertWordBreaks=function(e,t){return goog.format.insertWordBreaks(String(e),t)},soy.$$truncate=function(e,t,n){return e=String(e),e.length<=t?e:(n&&(t>3?t-=3:n=!1),soy.$$isHighSurrogate_(e.charAt(t-1))&&soy.$$isLowSurrogate_(e.charAt(t))&&(t-=1),e=e.substring(0,t),n&&(e+="..."),e)},soy.$$isHighSurrogate_=function(e){return e>=55296&&56319>=e},soy.$$isLowSurrogate_=function(e){return e>=56320&&57343>=e},soy.$$bidiFormatterCache_={},soy.$$getBidiFormatterInstance_=function(e){return soy.$$bidiFormatterCache_[e]||(soy.$$bidiFormatterCache_[e]=new goog.i18n.BidiFormatter(e))},soy.$$bidiTextDir=function(e,t){return e?goog.i18n.bidi.detectRtlDirectionality(e,t)?-1:1:0},soy.$$bidiDirAttr=function(e,t,n){return new soydata.SanitizedHtmlAttribute(soy.$$getBidiFormatterInstance_(e).dirAttr(t,n))},soy.$$bidiMarkAfter=function(e,t,n){var i=soy.$$getBidiFormatterInstance_(e);return i.markAfter(t,n)},soy.$$bidiSpanWrap=function(e,t){var n=soy.$$getBidiFormatterInstance_(e);return n.spanWrap(t+"",!0)},soy.$$bidiUnicodeWrap=function(e,t){var n=soy.$$getBidiFormatterInstance_(e);return n.unicodeWrap(t+"",!0)},soy.esc.$$escapeUriHelper=function(e){return encodeURIComponent(String(e))},soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_={"\x00":"&#0;",'"':"&quot;","&":"&amp;","'":"&#39;","<":"&lt;",">":"&gt;","	":"&#9;","\n":"&#10;","":"&#11;","\f":"&#12;","\r":"&#13;"," ":"&#32;","-":"&#45;","/":"&#47;","=":"&#61;","`":"&#96;","":"&#133;","":"&#160;","\u2028":"&#8232;","\u2029":"&#8233;"},soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_=function(e){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_[e]},soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_={"\x00":"\\x00","\b":"\\x08","	":"\\t","\n":"\\n","":"\\x0b","\f":"\\f","\r":"\\r",'"':"\\x22","&":"\\x26","'":"\\x27","/":"\\/","<":"\\x3c","=":"\\x3d",">":"\\x3e","\\":"\\\\","":"\\x85","\u2028":"\\u2028","\u2029":"\\u2029",$:"\\x24","(":"\\x28",")":"\\x29","*":"\\x2a","+":"\\x2b",",":"\\x2c","-":"\\x2d",".":"\\x2e",":":"\\x3a","?":"\\x3f","[":"\\x5b","]":"\\x5d","^":"\\x5e","{":"\\x7b","|":"\\x7c","}":"\\x7d"},soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_=function(e){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_[e]},soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_={"\x00":"\\0 ","\b":"\\8 ","	":"\\9 ","\n":"\\a ","":"\\b ","\f":"\\c ","\r":"\\d ",'"':"\\22 ","&":"\\26 ","'":"\\27 ","(":"\\28 ",")":"\\29 ","*":"\\2a ","/":"\\2f ",":":"\\3a ",";":"\\3b ","<":"\\3c ","=":"\\3d ",">":"\\3e ","@":"\\40 ","\\":"\\5c ","{":"\\7b ","}":"\\7d ","":"\\85 ","":"\\a0 ","\u2028":"\\2028 ","\u2029":"\\2029 "},soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_=function(e){return soy.esc.$$ESCAPE_MAP_FOR_ESCAPE_CSS_STRING_[e]},soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_={"\x00":"%00","":"%01","":"%02","":"%03","":"%04","":"%05","":"%06","":"%07","\b":"%08","	":"%09","\n":"%0A","":"%0B","\f":"%0C","\r":"%0D","":"%0E","":"%0F","":"%10","":"%11","":"%12","":"%13","":"%14","":"%15","":"%16","":"%17","":"%18","":"%19","":"%1A","":"%1B","":"%1C","":"%1D","":"%1E","":"%1F"," ":"%20",'"':"%22","'":"%27","(":"%28",")":"%29","<":"%3C",">":"%3E","\\":"%5C","{":"%7B","}":"%7D","":"%7F","":"%C2%85","":"%C2%A0","\u2028":"%E2%80%A8","\u2029":"%E2%80%A9","":"%EF%BC%81","":"%EF%BC%83","":"%EF%BC%84","":"%EF%BC%86","":"%EF%BC%87","":"%EF%BC%88","":"%EF%BC%89","":"%EF%BC%8A","":"%EF%BC%8B","":"%EF%BC%8C","":"%EF%BC%8F","":"%EF%BC%9A","":"%EF%BC%9B","":"%EF%BC%9D","":"%EF%BC%9F","":"%EF%BC%A0","":"%EF%BC%BB","":"%EF%BC%BD"},soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=function(e){return soy.esc.$$ESCAPE_MAP_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_[e]},soy.esc.$$MATCHER_FOR_ESCAPE_HTML_=/[\x00\x22\x26\x27\x3c\x3e]/g,soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_=/[\x00\x22\x27\x3c\x3e]/g,soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x26\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g,soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_=/[\x00\x09-\x0d \x22\x27\x2d\/\x3c-\x3e`\x85\xa0\u2028\u2029]/g,soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_=/[\x00\x08-\x0d\x22\x26\x27\/\x3c-\x3e\\\x85\u2028\u2029]/g,soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_=/[\x00\x08-\x0d\x22\x24\x26-\/\x3a\x3c-\x3f\x5b-\x5e\x7b-\x7d\x85\u2028\u2029]/g,soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_=/[\x00\x08-\x0d\x22\x26-\x2a\/\x3a-\x3e@\\\x7b\x7d\x85\xa0\u2028\u2029]/g,soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_=/[\x00- \x22\x27-\x29\x3c\x3e\\\x7b\x7d\x7f\x85\xa0\u2028\u2029\uff01\uff03\uff04\uff06-\uff0c\uff0f\uff1a\uff1b\uff1d\uff1f\uff20\uff3b\uff3d]/g,soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_=/^(?!-*(?:expression|(?:moz-)?binding))(?:[.#]?-?(?:[_a-z0-9-]+)(?:-[_a-z0-9-]+)*-?|-?(?:[0-9]+(?:\.[0-9]*)?|\.[0-9]+)(?:[a-z]{1,2}|%)?|!important|)$/i,soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_=/^(?:(?:https?|mailto):|[^&:\/?#]*(?:[\/?#]|$))/i,soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTE_=/^(?!style|on|action|archive|background|cite|classid|codebase|data|dsync|href|longdesc|src|usemap)(?:[a-z0-9_$:-]*)$/i,soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_=/^(?!script|style|title|textarea|xmp|no)[a-z0-9_$:-]*$/i,soy.esc.$$escapeHtmlHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)},soy.esc.$$normalizeHtmlHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)},soy.esc.$$escapeHtmlNospaceHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_ESCAPE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)},soy.esc.$$normalizeHtmlNospaceHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_HTML_NOSPACE_,soy.esc.$$REPLACER_FOR_ESCAPE_HTML__AND__NORMALIZE_HTML__AND__ESCAPE_HTML_NOSPACE__AND__NORMALIZE_HTML_NOSPACE_)},soy.esc.$$escapeJsStringHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)},soy.esc.$$escapeJsRegexHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_ESCAPE_JS_REGEX_,soy.esc.$$REPLACER_FOR_ESCAPE_JS_STRING__AND__ESCAPE_JS_REGEX_)},soy.esc.$$escapeCssStringHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_ESCAPE_CSS_STRING_,soy.esc.$$REPLACER_FOR_ESCAPE_CSS_STRING_)},soy.esc.$$filterCssValueHelper=function(e){var t=String(e);return soy.esc.$$FILTER_FOR_FILTER_CSS_VALUE_.test(t)?t:"zSoyz"},soy.esc.$$normalizeUriHelper=function(e){var t=String(e);return t.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_)},soy.esc.$$filterNormalizeUriHelper=function(e){var t=String(e);return soy.esc.$$FILTER_FOR_FILTER_NORMALIZE_URI_.test(t)?t.replace(soy.esc.$$MATCHER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_,soy.esc.$$REPLACER_FOR_NORMALIZE_URI__AND__FILTER_NORMALIZE_URI_):"zSoyz"},soy.esc.$$filterHtmlAttributeHelper=function(e){var t=String(e);return soy.esc.$$FILTER_FOR_FILTER_HTML_ATTRIBUTE_.test(t)?t:"zSoyz"},soy.esc.$$filterHtmlElementNameHelper=function(e){var t=String(e);return soy.esc.$$FILTER_FOR_FILTER_HTML_ELEMENT_NAME_.test(t)?t:"zSoyz"},soy.esc.$$HTML_TAG_REGEX_=/<(?:!|\/?[a-zA-Z])(?:[^>'"]|"[^"]*"|'[^']*')*>/g,"undefined"==typeof aui)var aui={};if(aui.renderExtraAttributes=function(e,t){var n=t||new soy.StringBuilder;if(null!=e&&e.extraAttributes)if("[object Object]"===Object.prototype.toString.call(e.extraAttributes))for(var i=soy.$$getMapKeys(e.extraAttributes),r=i.length,o=0;r>o;o++){var s=i[o];n.append(" ",soy.$$escapeHtml(s),'="',soy.$$escapeHtml(e.extraAttributes[s]),'"')}else n.append(" ",e.extraAttributes);return t?"":n.toString()},aui.renderExtraClasses=function(e,t){var n=t||new soy.StringBuilder;if(null!=e&&e.extraClasses)if(e.extraClasses instanceof Array)for(var i=e.extraClasses,r=i.length,o=0;r>o;o++){var s=i[o];n.append(" ",soy.$$escapeHtml(s))}else n.append(" ",soy.$$escapeHtml(e.extraClasses));return t?"":n.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.badges&&(aui.badges={}),aui.badges.badge=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"span"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-badge'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",soy.$$escapeHtml(e.text),"</",soy.$$escapeHtml(e.tagName?e.tagName:"span"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.buttons&&(aui.buttons={}),aui.buttons.button=function(e,t,n){var i=t||new soy.StringBuilder;if(e.href)i.append('<a href="',soy.$$escapeHtml(e.href),'"'),aui.buttons.buttonAttributes(soy.$$augmentData(e,{tagName:"a"}),i,n),i.append(">"),aui.buttons.buttonIcon(e,i,n),i.append(e.hasLabel?'<span class="aui-button-label">':"",soy.$$escapeHtml(e.text),e.hasLabel?"</span>":"","</a>");else if("input"==e.tagName)i.append('<input type="',soy.$$escapeHtml(e.inputType?e.inputType:"button"),'" '),aui.buttons.buttonAttributes(e,i,n),i.append(' value="',soy.$$escapeHtml(e.text),'" />');else{var r=e.tagName?e.tagName:"button";i.append("<",soy.$$escapeHtml(r)),aui.buttons.buttonAttributes(soy.$$augmentData(e,{tagName:r}),i,n),i.append(">"),aui.buttons.buttonIcon(e,i,n),i.append(e.hasLabel?'<span class="aui-button-label">':"",soy.$$escapeHtml(e.text),e.hasLabel?"</span>":"","</",soy.$$escapeHtml(r),">")}return t?"":i.toString()},aui.buttons.buttons=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-buttons'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div>"),t?"":i.toString()},aui.buttons.buttonAttributes=function(e,t,n){var i=t||new soy.StringBuilder;switch(i.append(e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-button',"main"==e.splitButtonType?" aui-button-split-main":"",e.dropdown2Target?" aui-dropdown2-trigger"+("more"==e.splitButtonType?" aui-button-split-more":""):""),e.type){case"primary":i.append(" aui-button-primary");break;case"link":i.append(" aui-button-link");break;case"subtle":i.append(" aui-button-subtle")}return aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(e.isPressed?' aria-pressed="'+soy.$$escapeHtml(e.isPressed)+'"':"",e.isDisabled?' aria-disabled="'+soy.$$escapeHtml(e.isDisabled)+'"'+(1==e.isDisabled&&("button"==e.tagName||"input"==e.tagName)?' disabled="disabled" ':""):"",e.dropdown2Target?' aria-owns="'+soy.$$escapeHtml(e.dropdown2Target)+'" aria-haspopup="true"':"","a"==e.tagName?' tabindex="0"':""),t?"":i.toString()},aui.buttons.buttonIcon=function(e,t){var n=t||new soy.StringBuilder;return n.append(e.iconType?'<span class="'+("aui"==e.iconType?"aui-icon":"")+(e.iconClass?" "+soy.$$escapeHtml(e.iconClass):"")+'">'+(e.iconText?soy.$$escapeHtml(e.iconText)+" ":"")+"</span>":""),t?"":n.toString()},aui.buttons.splitButton=function(e,t,n){var i=t||new soy.StringBuilder;return aui.buttons.button(soy.$$augmentData(e.splitButtonMain,{splitButtonType:"main"}),i,n),aui.buttons.button(soy.$$augmentData(e.splitButtonMore,{splitButtonType:"more"}),i,n),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.dialog&&(aui.dialog={}),aui.dialog.dialog2=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder;return aui.dialog.dialog2Content({id:null,titleText:e.titleText,titleContent:e.titleContent,headerActionContent:e.headerActionContent,headerSecondaryContent:e.headerSecondaryContent,modal:e.modal,content:e.content,footerHintText:e.footerHintText,footerHintContent:e.footerHintContent,footerActionContent:e.footerActionContent},r,n),aui.dialog.dialog2Chrome({id:e.id,titleId:e.id?e.id+"-dialog-title":null,modal:e.modal,tagName:e.tagName,removeOnHide:e.removeOnHide,visible:e.visible,size:e.size,extraClasses:e.extraClasses,extraAttributes:e.extraAttributes,content:r.toString()},i,n),t?"":i.toString()},aui.dialog.dialog2Chrome=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"section"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",e.titleId?' aria-labelledby="'+soy.$$escapeHtml(e.titleId)+'"':"",' role="dialog" class=" aui-layer aui-dialog2 aui-dialog2-',soy.$$escapeHtml(e.size?e.size:"medium")),aui.renderExtraClasses(e,i,n),i.append('"',e.modal?'data-aui-modal="true"':"",e.removeOnHide?'data-aui-remove-on-hide="true"':"",1!=e.visible?'aria-hidden="true"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content?e.content:"","</",soy.$$escapeHtml(e.tagName?e.tagName:"section"),">"),t?"":i.toString()},aui.dialog.dialog2Content=function(e,t,n){var i=t||new soy.StringBuilder;return aui.dialog.dialog2Header({titleId:e.id?e.id+"-dialog-title":null,titleText:e.titleText,titleContent:e.titleContent,actionContent:e.headerActionContent,secondaryContent:e.headerSecondaryContent,modal:e.modal},i,n),aui.dialog.dialog2Panel(e,i,n),aui.dialog.dialog2Footer({hintText:e.footerHintText,hintContent:e.footerHintContent,actionContent:e.footerActionContent},i,n),t?"":i.toString()},aui.dialog.dialog2Header=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<header",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dialog2-header'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append("><h2 ",e.titleId?' id="'+soy.$$escapeHtml(e.titleId)+'"':"",' class="aui-dialog2-header-main">',e.titleText?soy.$$escapeHtml(e.titleText):"",e.titleContent?e.titleContent:"","</h2>",e.actionContent?'<div class="aui-dialog2-header-actions">'+e.actionContent+"</div>":"",e.secondaryContent?'<div class="aui-dialog2-header-secondary">'+e.secondaryContent+"</div>":"",1!=e.modal?'<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">'+soy.$$escapeHtml("Close")+"</span></a>":"","</header>"),t?"":i.toString()},aui.dialog.dialog2Footer=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<footer",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dialog2-footer'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.actionContent?'<div class="aui-dialog2-footer-actions">'+e.actionContent+"</div>":"",e.hintText||e.hintContent?'<div class="aui-dialog2-footer-hint">'+(e.hintText?soy.$$escapeHtml(e.hintText):"")+(e.hintContent?e.hintContent:"")+"</div>":"","</footer>"),t?"":i.toString()},aui.dialog.dialog2Panel=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dialog2-content'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content?e.content:"","</div>"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.dropdown&&(aui.dropdown={}),aui.dropdown.trigger=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<a",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dd-trigger'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><span class="dropdown-text">',e.accessibilityText?soy.$$escapeHtml(e.accessibilityText):"","</span>",0!=e.showIcon?'<span class="icon icon-dropdown"></span>':"","</a>"),t?"":i.toString()},aui.dropdown.menu=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"ul"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dropdown hidden'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"ul"),">"),t?"":i.toString()},aui.dropdown.parent=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dd-parent'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},aui.dropdown.item=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"li"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="dropdown-item'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><a href="',soy.$$escapeHtml(e.url?e.url:"#"),'">',soy.$$escapeHtml(e.text),"</a></",soy.$$escapeHtml(e.tagName?e.tagName:"li"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.dropdown2&&(aui.dropdown2={}),aui.dropdown2.dropdown2=function(e,t,n){var i=t||new soy.StringBuilder;return aui.dropdown2.trigger(soy.$$augmentData(e.trigger,{menu:e.menu}),i,n),aui.dropdown2.contents(e.menu,i,n),t?"":i.toString()},aui.dropdown2.trigger=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder("aui-dropdown2-trigger");return aui.renderExtraClasses(e,r,n),aui.trigger.trigger(soy.$$augmentData(e,{extraClasses:r.toString()}),i,n),t?"":i.toString()},aui.dropdown2.contents=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div id="',soy.$$escapeHtml(e.id),'" class="aui-dropdown2'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content?e.content:"","</div>"),t?"":i.toString()},aui.dropdown2.section=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-dropdown2-section'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.label?"<strong>"+soy.$$escapeHtml(e.label)+"</strong>":"",e.content,"</div>"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.expander&&(aui.expander={}),aui.expander.content=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div id="',soy.$$escapeHtml(e.id),'" class="aui-expander-content'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(e.initiallyExpanded?' aria-expanded="'+soy.$$escapeHtml(e.initiallyExpanded)+'"':"",">",e.content?e.content:"","</div>"),t?"":i.toString()},aui.expander.trigger=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tag?e.tag:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",e.replaceText?' data-replace-text="'+soy.$$escapeHtml(e.replaceText)+'"':"",e.replaceSelector?' data-replace-selector="'+soy.$$escapeHtml(e.replaceSelector)+'"':"",' class="aui-expander-trigger'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(' aria-controls="',soy.$$escapeHtml(e.contentId),'"',e.collapsible?' data-collapsible="'+soy.$$escapeHtml(e.collapsible)+'"':"",">",e.content?e.content:"","</",soy.$$escapeHtml(e.tag?e.tag:"div"),">"),t?"":i.toString()},aui.expander.revealText=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder(soy.$$escapeHtml(e.contentContent));return aui.expander.trigger({id:e.triggerId,contentId:e.contentId,tag:"a",content:"<span class='reveal-text-trigger-text'>Show more</span>",replaceSelector:".reveal-text-trigger-text",replaceText:"Show less",extraAttributes:e.triggerExtraAttributes,extraClasses:(e.triggerExtraClasses?soy.$$escapeHtml(e.triggerExtraClasses)+"  ":"")+" aui-expander-reveal-text"},r,n),aui.expander.content({id:e.contentId,content:r.toString(),extraAttributes:e.contentExtraAttributes,extraClasses:e.contentExtraClasses},i,n),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.form&&(aui.form={}),aui.form.form=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<form",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui',e.isUnsectioned?" unsectioned":"",e.isLongLabels?" long-label":"",e.isTopLabels?" top-label":""),aui.renderExtraClasses(e,i,n),i.append('" action="',soy.$$escapeHtml(e.action),'" method="',soy.$$escapeHtml(e.method?e.method:"post"),'"',e.enctype?' enctype="'+soy.$$escapeHtml(e.enctype)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</form>"),t?"":i.toString()},aui.form.formDescription=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="field-group'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div>"),t?"":i.toString()},aui.form.fieldset=function(e,t,n){var i=t||new soy.StringBuilder,r=e.isInline||e.isDateSelect||e.isGroup||e.extraClasses;return i.append("<fieldset",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),r&&(i.append(' class="',soy.$$escapeHtml(e.isInline?"inline":e.isDateSelect?"date-select":e.isGroup?"group":"")),aui.renderExtraClasses(e,i,n),i.append('"')),aui.renderExtraAttributes(e,i,n),i.append("><legend><span>",e.legendContent,"</span></legend>",e.content,"</fieldset>"),t?"":i.toString()},aui.form.fieldGroup=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="field-group'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div>"),t?"":i.toString()},aui.form.buttons=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div class="buttons-container',e.alignment?" "+soy.$$escapeHtml(e.alignment):""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><div class="buttons">',e.content,"</div></div>"),t?"":i.toString()},aui.form.label=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<label",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",e.forField?' for="'+soy.$$escapeHtml(e.forField)+'"':""),e.extraClasses&&(i.append(' class="'),aui.renderExtraClasses(e,i,n),i.append('"')),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,e.isRequired?'<span class="aui-icon icon-required"></span>':"","</label>"),t?"":i.toString()},aui.form.input=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder;switch(e.type){case"password":case"email":case"url":case"tel":case"search":r.append("text");break;case"submit":case"reset":r.append("button");break;default:r.append(soy.$$escapeHtml(e.type))}return r=r.toString(),i.append('<input class="',soy.$$escapeHtml(r)),aui.renderExtraClasses(e,i,n),i.append(e.icon&&"text"==r?" aui-field-has-icon":"",'" type="',soy.$$escapeHtml(e.type),'" name="',soy.$$escapeHtml(e.name?e.name:e.id),'"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",e.value?' value="'+soy.$$escapeHtml(e.value)+'"':"","checkbox"!=e.type&&"radio"!=e.type||!e.isChecked?"":' checked="checked"',"text"==r&&"password"!=e.type&&e.maxLength?' maxlength="'+soy.$$escapeHtml(e.maxLength)+'"':"","text"==r&&"password"!=e.type&&e.size?' size="'+soy.$$escapeHtml(e.size)+'"':"","text"==r&&e.placeholderText?' placeholder="'+soy.$$escapeHtml(e.placeholderText)+'"':"","text"==r&&e.autocomplete?' autocomplete="'+soy.$$escapeHtml(e.autocomplete)+'"':"",e.isDisabled?" disabled":"",e.isAutofocus?" autofocus":""),aui.renderExtraAttributes(e,i,n),aui.form.renderValidationArguments(e,i,n),aui.form.renderInfoMessage(e,i,n),aui.form.renderFieldComponentAttribute(e,i,n),aui.form.renderTooltipArguments(e,i,n),i.append("/>"),e.icon&&"text"==r&&aui.icons.icon({icon:e.icon,useIconFont:!0,size:"small"},i,n),t?"":i.toString()},aui.form.renderValidationArguments=function(e,t){var n=t||new soy.StringBuilder;if(e.validationArguments)for(var i=soy.$$getMapKeys(e.validationArguments),r=i.length,o=0;r>o;o++){var s=i[o];n.append(" ",soy.$$escapeHtml("data-aui-validation-"+s),'="',soy.$$escapeHtml(e.validationArguments[s]),'"')}return t?"":n.toString()},aui.form.renderTooltipArguments=function(e,t){var n=t||new soy.StringBuilder;if(e.tooltipArguments)for(var i=soy.$$getMapKeys(e.tooltipArguments),r=i.length,o=0;r>o;o++){var s=i[o];n.append(" ",soy.$$escapeHtml("data-aui-notification-"+s),'="',soy.$$escapeHtml(e.tooltipArguments[s]),'"')}return t?"":n.toString()},aui.form.renderInfoMessage=function(e,t){var n=t||new soy.StringBuilder;return n.append(e.infoMessage?' data-aui-notification-info="'+soy.$$escapeHtml(e.infoMessage)+'"':""),t?"":n.toString()},aui.form.renderFieldComponentAttribute=function(e,t){var n=t||new soy.StringBuilder;return n.append(e.infoMessage?" data-aui-notification-field":"",e.validationArguments?" data-aui-validation-field":""),t?"":n.toString()},aui.form.submit=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.button(soy.$$augmentData(e,{tagName:"input",inputType:"submit"}),i,n),t?"":i.toString()},aui.form.button=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder(e.name?'name="'+soy.$$escapeHtml(e.name)+'"':"");return aui.renderExtraAttributes(e,r,n),aui.buttons.button(soy.$$augmentData(e,{extraClasses:e.extraClasses,extraAttributes:r.toString()}),i,n),t?"":i.toString()},aui.form.linkButton=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder("cancel");aui.renderExtraClasses(e,r,n);var o=new soy.StringBuilder(e.name?'name="'+soy.$$escapeHtml(e.name)+'"':"");return aui.renderExtraAttributes(e,o,n),aui.buttons.button(soy.$$augmentData(e,{tagName:"a",type:"link",href:e.href?e.href:e.url,extraClasses:r.toString(),extraAttributes:o.toString()}),i,n),t?"":i.toString()},aui.form.textarea=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<textarea name="',soy.$$escapeHtml(e.name?e.name:e.id),'" class="textarea'),aui.renderExtraClasses(e,i,n),i.append(" ",e.icon?"aui-field-has-icon":"",'"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",e.rows?' rows="'+soy.$$escapeHtml(e.rows)+'"':"",e.cols?' cols="'+soy.$$escapeHtml(e.cols)+'"':"",e.autocomplete?' autocomplete="'+soy.$$escapeHtml(e.autocomplete)+'"':"",e.isDisabled?" disabled":"",e.isAutofocus?" autofocus":"",e.placeholderText?' placeholder="'+soy.$$escapeHtml(e.placeholderText)+'"':""),aui.renderExtraAttributes(e,i,n),aui.form.renderValidationArguments(e,i,n),aui.form.renderInfoMessage(e,i,n),aui.form.renderFieldComponentAttribute(e,i,n),aui.form.renderTooltipArguments(e,i,n),i.append(">",e.value?soy.$$escapeHtml(e.value):"","</textarea>"),e.icon&&aui.icons.icon({icon:e.icon,useIconFont:!0,size:"small"},i,n),t?"":i.toString()},aui.form.select=function(e,t,n){var i=t||new soy.StringBuilder;i.append("<select",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' name="',soy.$$escapeHtml(e.name?e.name:e.id),'" class="',soy.$$escapeHtml(e.isMultiple?"multi-select":"select")),aui.renderExtraClasses(e,i,n),i.append('"',e.size?' size="'+soy.$$escapeHtml(e.size)+'"':"",e.isDisabled?" disabled":"",e.isAutofocus?" autofocus":"",e.isMultiple?" multiple":""),aui.renderExtraAttributes(e,i,n),aui.form.renderValidationArguments(e,i,n),aui.form.renderInfoMessage(e,i,n),aui.form.renderFieldComponentAttribute(e,i,n),aui.form.renderTooltipArguments(e,i,n),i.append(">");for(var r=e.options,o=r.length,s=0;o>s;s++){var a=r[s];aui.form.optionOrOptgroup(soy.$$augmentData(a,{defaultValue:e.value}),i,n)}return i.append("</select>"),t?"":i.toString()},aui.form.optionOrOptgroup=function(e,t,n){var i=t||new soy.StringBuilder;if(e.options){i.append('<optgroup label="',soy.$$escapeHtml(e.text),'"',e.disabled?" disabled":"",">");for(var r=e.options,o=r.length,s=0;o>s;s++){var a=r[s];aui.form.optionOrOptgroup(soy.$$augmentData(a,{defaultValue:e.defaultValue}),i,n)}i.append("</optgroup>")}else i.append('<option value="',soy.$$escapeHtml(e.value),'"',e.selected||e.defaultValue==e.value?" selected":"",e.disabled?" disabled":"",">",soy.$$escapeHtml(e.text),"</option>");return t?"":i.toString()},aui.form.value=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<span",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="field-value'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</span>"),t?"":i.toString()},aui.form.field=function(e,t,n){var i=t||new soy.StringBuilder,r="checkbox"==e.type||"radio"==e.type,o=e.fieldWidth?e.fieldWidth+"-field":"";switch(i.append('<div class="',r?soy.$$escapeHtml(e.type):"field-group"),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">"),e.labelContent&&!r&&aui.form.label({forField:e.id,isRequired:e.isRequired,content:e.labelContent},i,n),e.type){case"textarea":aui.form.textarea({id:e.id,name:e.name,value:e.value,rows:e.rows,cols:e.cols,autocomplete:e.autocomplete,placeholderText:e.placeholderText,isDisabled:e.isDisabled?!0:!1,isAutofocus:e.isAutofocus,extraClasses:o,icon:e.icon,validationArguments:e.validationArguments,infoMessage:e.infoMessage,tooltipArguments:e.tooltipArguments},i,n);break;case"select":aui.form.select({id:e.id,name:e.name,value:e.value,options:e.options,isMultiple:e.isMultiple,size:e.size,isDisabled:e.isDisabled?!0:!1,isAutofocus:e.isAutofocus,extraClasses:o,validationArguments:e.validationArguments,infoMessage:e.infoMessage,tooltipArguments:e.tooltipArguments},i,n);
break;case"value":aui.form.value({id:e.id,content:soy.$$escapeHtml(e.value)},i,n);break;case"text":case"password":case"email":case"url":case"tel":case"search":case"file":case"radio":case"checkbox":case"button":case"submit":case"reset":aui.form.input({id:e.id,name:e.name,type:e.type,value:e.value,maxLength:e.maxLength,size:e.size,autocomplete:e.autocomplete,placeholderText:e.placeholderText,isChecked:e.isChecked,isDisabled:e.isDisabled?!0:!1,isAutofocus:e.isAutofocus,extraClasses:o,icon:e.icon,validationArguments:e.validationArguments,infoMessage:e.infoMessage,tooltipArguments:e.tooltipArguments},i,n)}if(e.labelContent&&r&&aui.form.label({forField:e.id,isRequired:e.isRequired,content:e.labelContent},i,n),(e.descriptionText||e.descriptionContent)&&aui.form.fieldDescription({text:e.descriptionText,content:e.descriptionContent},i,n),e.errorTexts)for(var s=e.errorTexts,a=s.length,l=0;a>l;l++){var u=s[l];aui.form.fieldError({message:u},i,n)}return i.append("</div>"),t?"":i.toString()},aui.form.fieldError=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div class="error'),aui.renderExtraClasses(e,i,n),i.append('">',soy.$$escapeHtml(e.message),"</div>"),t?"":i.toString()},aui.form.fieldDescription=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div class="description'),aui.renderExtraClasses(e,i,n),i.append('">',e.text?soy.$$escapeHtml(e.text):e.message?soy.$$escapeHtml(e.message):e.content,"</div>"),t?"":i.toString()},aui.form.textField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"text"}),i,n),t?"":i.toString()},aui.form.textareaField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"textarea"}),i,n),t?"":i.toString()},aui.form.passwordField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"password"}),i,n),t?"":i.toString()},aui.form.fileField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"file"}),i,n),t?"":i.toString()},aui.form.selectField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"select"}),i,n),t?"":i.toString()},aui.form.checkboxField=function(e,t,n){for(var i=t||new soy.StringBuilder,r=new soy.StringBuilder(e.isMatrix?'<div class="matrix">':""),o=e.fields,s=o.length,a=0;s>a;a++){var l=o[a];aui.form.field(soy.$$augmentData(l,{type:"checkbox",labelContent:soy.$$escapeHtml(l.labelText)}),r,n)}return r.append(e.isMatrix?"</div>":""),(e.descriptionText||e.descriptionContent||e.errorTexts&&e.errorTexts.length)&&aui.form.field({descriptionText:e.descriptionText,descriptionContent:e.descriptionContent,errorTexts:e.errorTexts,isDisabled:!1},r,n),aui.form.fieldset({legendContent:e.legendContent+(e.isRequired?'<span class="aui-icon icon-required"></span>':""),isGroup:!0,id:e.id,extraClasses:e.extraClasses,extraAttributes:e.extraAttributes,content:r.toString()},i,n),t?"":i.toString()},aui.form.radioField=function(e,t,n){for(var i=t||new soy.StringBuilder,r=new soy.StringBuilder(e.isMatrix?'<div class="matrix">':""),o=e.fields,s=o.length,a=0;s>a;a++){var l=o[a];aui.form.field(soy.$$augmentData(l,{type:"radio",name:e.name?e.name:e.id,labelContent:soy.$$escapeHtml(l.labelText)}),r,n)}return r.append(e.isMatrix?"</div>":""),(e.descriptionText||e.descriptionContent||e.errorTexts&&e.errorTexts.length)&&aui.form.field({descriptionText:e.descriptionText,descriptionContent:e.descriptionContent,errorTexts:e.errorTexts,isDisabled:!1},r,n),aui.form.fieldset({legendContent:e.legendContent+(e.isRequired?'<span class="aui-icon icon-required"></span>':""),isGroup:!0,id:e.id,extraClasses:e.extraClasses,extraAttributes:e.extraAttributes,content:r.toString()},i,n),t?"":i.toString()},aui.form.valueField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"value"}),i,n),t?"":i.toString()},aui.form.emailField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"email"}),i,n),t?"":i.toString()},aui.form.urlField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"url"}),i,n),t?"":i.toString()},aui.form.telephoneField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"tel"}),i,n),t?"":i.toString()},aui.form.searchField=function(e,t,n){var i=t||new soy.StringBuilder;return aui.form.field(soy.$$augmentData(e,{type:"search"}),i,n),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.group&&(aui.group={}),aui.group.group=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-group',e.isSplit?" aui-group-split":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},aui.group.item=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-item'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.icons&&(aui.icons={}),aui.icons.icon=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"span"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-icon',e.useIconFont?" aui-icon-"+soy.$$escapeHtml(e.size?e.size:"small"):""," aui",soy.$$escapeHtml(e.useIconFont?"-iconfont":"-icon"),soy.$$escapeHtml(e.iconFontSet?"-"+e.iconFontSet:""),"-",soy.$$escapeHtml(e.icon)),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.accessibilityText?soy.$$escapeHtml(e.accessibilityText):"","</",soy.$$escapeHtml(e.tagName?e.tagName:"span"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.inlineDialog2&&(aui.inlineDialog2={}),aui.inlineDialog2.inlineDialog2=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<aui-inline-dialog2 ",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",'  class="aui-layer aui-inline-dialog'),aui.renderExtraClasses(e,i,n),i.append('" data-aui-alignment="',soy.$$escapeHtml(e.alignment?e.alignment:""),'" data-aui-responds-to="',soy.$$escapeHtml(e.respondsTo?e.respondsTo:""),'" aria-hidden="true"'),aui.renderExtraAttributes(e,i,n),i.append(">"),aui.inlineDialog2.inlineDialog2Content(e,i,n),i.append("</aui-inline-dialog2>"),t?"":i.toString()},aui.inlineDialog2.inlineDialog2Content=function(e,t){var n=t||new soy.StringBuilder;return n.append('<div class="aui-inline-dialog-contents">',e.content?e.content:"","</div>"),t?"":n.toString()},aui.inlineDialog2.trigger=function(e,t,n){var i=t||new soy.StringBuilder;return aui.trigger.trigger(soy.$$augmentData(e,{showIcon:e.showIcon?e.showIcon:!1}),i,n),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.lozenges&&(aui.lozenges={}),aui.lozenges.lozenge=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"span"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",e.title?' title="'+soy.$$escapeHtml(e.title)+'"':"",' class="aui-lozenge',soy.$$escapeHtml(e.type?" aui-lozenge-"+e.type:""),soy.$$escapeHtml(e.isSubtle?" aui-lozenge-subtle":"")),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.maxLength?soy.$$truncate(soy.$$escapeHtml(e.text),e.maxLength,!0):soy.$$escapeHtml(e.text),"</",soy.$$escapeHtml(e.tagName?e.tagName:"span"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.labels&&(aui.labels={}),aui.labels.label=function(e,t,n){var i=t||new soy.StringBuilder;return e.url&&1==e.isCloseable?(i.append("<span",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-label aui-label-closeable aui-label-split'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><a class="aui-label-split-main" href="',soy.$$escapeHtml(e.url),'">',soy.$$escapeHtml(e.text),'</a><span class="aui-label-split-close" >'),aui.labels.closeIcon(e,i,n),i.append("</span></span>")):(i.append("<",soy.$$escapeHtml(e.url?"a":"span"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-label',e.isCloseable?" aui-label-closeable":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(e.url?' href="'+soy.$$escapeHtml(e.url)+'"':"",">",soy.$$escapeHtml(e.text)),e.isCloseable&&aui.labels.closeIcon(e,i,n),i.append("</",soy.$$escapeHtml(e.url?"a":"span"),">")),t?"":i.toString()},aui.labels.closeIcon=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<span tabindex="0" class="aui-icon aui-icon-close"'),0!=e.hasTitle&&(i.append(' title="'),aui.labels.closeIconText(e,i,n),i.append('"')),i.append(">"),aui.labels.closeIconText(e,i,n),i.append("</span>"),t?"":i.toString()},aui.labels.closeIconText=function(e,t){var n=t||new soy.StringBuilder;return n.append(e.closeIconText?soy.$$escapeHtml(e.closeIconText):"("+soy.$$escapeHtml("Remove")+" "+soy.$$escapeHtml(e.text)+")"),t?"":n.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.message&&(aui.message={}),aui.message.info=function(e,t,n){var i=t||new soy.StringBuilder;return aui.message.message(soy.$$augmentData(e,{type:"info"}),i,n),t?"":i.toString()},aui.message.warning=function(e,t,n){var i=t||new soy.StringBuilder;return aui.message.message(soy.$$augmentData(e,{type:"warning"}),i,n),t?"":i.toString()},aui.message.error=function(e,t,n){var i=t||new soy.StringBuilder;return aui.message.message(soy.$$augmentData(e,{type:"error"}),i,n),t?"":i.toString()},aui.message.success=function(e,t,n){var i=t||new soy.StringBuilder;return aui.message.message(soy.$$augmentData(e,{type:"success"}),i,n),t?"":i.toString()},aui.message.hint=function(e,t,n){var i=t||new soy.StringBuilder;return aui.message.message(soy.$$augmentData(e,{type:"hint"}),i,n),t?"":i.toString()},aui.message.generic=function(e,t,n){var i=t||new soy.StringBuilder;return aui.message.message(soy.$$augmentData(e,{type:"generic"}),i,n),t?"":i.toString()},aui.message.message=function(e,t,n){var i=t||new soy.StringBuilder,r=e.tagName?e.tagName:"div",o=e.type?e.type:"generic";return i.append("<",soy.$$escapeHtml(r),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-message aui-message-',soy.$$escapeHtml(o)," ",soy.$$escapeHtml(o),e.isCloseable?" closeable":"",e.isShadowed?" shadowed":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.titleContent?'<p class="title"><strong>'+e.titleContent+"</strong></p>":"",e.content,e.isCloseable?'<span class="aui-icon icon-close" role="button" tabindex="0"></span>':"","</",soy.$$escapeHtml(r),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.page&&(aui.page={}),aui.page.document=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<!DOCTYPE html><html lang="',soy.$$escapeHtml(n.language?n.language:"en"),'">'),aui.page.documentHTMLContent(e,i,n),i.append("</html>"),t?"":i.toString()},aui.page.documentHTMLContent=function(e,t,n){var i=t||new soy.StringBuilder,r=e.pageSize?e.pageSize:e.focusedPageSize?e.focusedPageSize:"xlarge";return i.append('<head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>',soy.$$escapeHtml(e.windowTitle),"</title>",e.headContent?e.headContent:"","</head><body"),e.pageType?"generic"==e.pageType?e.extraClasses&&(i.append(' class="'),aui.renderExtraClasses(e,i,n),i.append('"')):"focused"==e.pageType?(i.append(' class="aui-page-focused aui-page-focused-',soy.$$escapeHtml(r)," aui-page-size-",soy.$$escapeHtml(r)),aui.renderExtraClasses(e,i,n),i.append('"')):"notification"==e.pageType?(i.append(' class="aui-page-notification aui-page-size-',soy.$$escapeHtml(r)),aui.renderExtraClasses(e,i,n),i.append('"')):"sidebar"==e.pageType?(i.append(' class="aui-page-sidebar',soy.$$escapeHtml(e.sidebarState?" aui-sidebar-"+e.sidebarState:"")),aui.renderExtraClasses(e,i,n),i.append('"')):(i.append(' class="aui-page-',soy.$$escapeHtml(e.pageType)),aui.renderExtraClasses(e,i,n),i.append('"')):(i.append(' class="'),aui.renderExtraClasses(e,i,n),i.append('"')),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</body>"),t?"":i.toString()},aui.page.page=function(e,t){var n=t||new soy.StringBuilder;return n.append('<div id="page"><header id="header" role="banner">',e.headerContent,'</header><!-- #header --><section id="content" role="main">',e.contentContent,'</section><!-- #content --><footer id="footer" role="contentinfo">',e.footerContent,"</footer><!-- #footer --></div><!-- #page -->"),t?"":n.toString()},aui.page.header=function(e,t,n){var i=t||new soy.StringBuilder;return i.append(e.bannerContent?'<div class="aui-banner aui-banner-error" role="banner">'+e.bannerContent+"</div>":"","<nav",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-header aui-dropdown2-trigger-group'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(' role="navigation"><div class="aui-header-inner">',e.headerBeforeContent?'<div class="aui-header-before">'+e.headerBeforeContent+"</div>":"",'<div class="aui-header-primary"><h1 id="logo" class="aui-header-logo',e.headerLogoImageUrl?" aui-header-logo-custom":e.logo?" aui-header-logo-"+soy.$$escapeHtml(e.logo):"",'"><a href="',soy.$$escapeHtml(e.headerLink?e.headerLink:"/"),'">',e.headerLogoImageUrl?'<img src="'+soy.$$escapeHtml(e.headerLogoImageUrl)+'" alt="'+soy.$$escapeHtml(e.headerLogoText)+'" />':'<span class="aui-header-logo-device">'+soy.$$escapeHtml(e.headerLogoText?e.headerLogoText:"")+"</span>",e.headerText?'<span class="aui-header-logo-text">'+soy.$$escapeHtml(e.headerText)+"</span>":"","</a></h1>",e.primaryNavContent?e.primaryNavContent:"","</div>",e.secondaryNavContent?'<div class="aui-header-secondary">'+e.secondaryNavContent+"</div>":"",e.headerAfterContent?'<div class="aui-header-after">'+e.headerAfterContent+"</div>":"","</div><!-- .aui-header-inner--></nav><!-- .aui-header -->"),t?"":i.toString()},aui.page.pagePanel=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),' class="aui-page-panel'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append('><div class="aui-page-panel-inner">',e.content,"</div><!-- .aui-page-panel-inner --></",soy.$$escapeHtml(e.tagName?e.tagName:"div"),"><!-- .aui-page-panel -->"),t?"":i.toString()},aui.page.pagePanelNav=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),' class="aui-page-panel-nav'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),"><!-- .aui-page-panel-nav -->"),t?"":i.toString()},aui.page.pagePanelContent=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"section"),' class="aui-page-panel-content'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"section"),"><!-- .aui-page-panel-content -->"),t?"":i.toString()},aui.page.pagePanelSidebar=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"aside"),' class="aui-page-panel-sidebar'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"aside"),"><!-- .aui-page-panel-sidebar -->"),t?"":i.toString()},aui.page.pagePanelItem=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"section"),' class="aui-page-panel-item'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"section"),"><!-- .aui-page-panel-item -->"),t?"":i.toString()},aui.page.pageHeader=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<header class="aui-page-header'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append('><div class="aui-page-header-inner">',e.content,"</div><!-- .aui-page-header-inner --></header><!-- .aui-page-header -->"),t?"":i.toString()},aui.page.pageHeaderImage=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div class="aui-page-header-image'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div><!-- .aui-page-header-image -->"),t?"":i.toString()},aui.page.pageHeaderMain=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div class="aui-page-header-main'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div><!-- .aui-page-header-main -->"),t?"":i.toString()},aui.page.pageHeaderActions=function(e,t,n){var i=t||new soy.StringBuilder;return i.append('<div class="aui-page-header-actions'),aui.renderExtraClasses(e,i,n),i.append('"',e.id?' id="'+soy.$$escapeHtml(e.id)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div><!-- .aui-page-header-actions -->"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if(aui.panel=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-panel'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.progressTracker&&(aui.progressTracker={}),aui.progressTracker.progressTracker=function(e,t,n){var i=t||new soy.StringBuilder;i.append("<ol",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-progress-tracker',e.isInverted?" aui-progress-tracker-inverted":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">");for(var r=new soy.StringBuilder,o=e.steps,s=o.length,a=0;s>a;a++){var l=o[a];if(l.isCurrent)for(var u=e.steps,c=u.length,d=0;c>d;d++){var h=u[d];aui.progressTracker.step(soy.$$augmentData(h,{width:Math.round(100/e.steps.length*1e4)/1e4,href:a>d?h.href:null}),r,n)}}return aui.progressTracker.content({steps:e.steps,content:r.toString()},i,n),i.append("</ol>"),t?"":i.toString()},aui.progressTracker.content=function(e,t,n){var i=t||new soy.StringBuilder;if(""!=e.content)i.append(e.content);else for(var r=e.steps,o=r.length,s=0;o>s;s++){var a=r[s];aui.progressTracker.step(soy.$$augmentData(a,{isCurrent:0==s,width:Math.round(100/e.steps.length*1e4)/1e4,href:null}),i,n)}return t?"":i.toString()},aui.progressTracker.step=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<li",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-progress-tracker-step',e.isCurrent?" aui-progress-tracker-step-current":""),aui.renderExtraClasses(e,i,n),i.append('" style="width: ',soy.$$escapeHtml(e.width),'%;"'),aui.renderExtraAttributes(e,i,n),i.append("><",soy.$$escapeHtml(e.href?"a":"span"),e.href?' href="'+soy.$$escapeHtml(e.href)+'"':"",">",soy.$$escapeHtml(e.text),"</",soy.$$escapeHtml(e.href?"a":"span"),"></li>"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if(aui.table=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<table",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.columnsContent?e.columnsContent:"",e.captionContent?"<caption>"+e.captionContent+"</caption>":"",e.theadContent?"<thead>"+e.theadContent+"</thead>":"",e.tfootContent?"<tfoot>"+e.tfootContent+"</tfoot>":"",e.contentIncludesTbody?"":"<tbody>",e.content,e.contentIncludesTbody?"":"</tbody>","</table>"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if(aui.tabs=function(e,t,n){var i=t||new soy.StringBuilder;i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-tabs ',soy.$$escapeHtml(e.isVertical?"vertical-tabs":"horizontal-tabs"),e.isDisabled?" aui-tabs-disabled":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><ul class="tabs-menu">');for(var r=e.menuItems,o=r.length,s=0;o>s;s++){var a=r[s];aui.tabMenuItem(a,i,n)}return i.append("</ul>",e.paneContent,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},aui.tabMenuItem=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<li",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="menu-item',e.isActive?" active-tab":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><a href="',soy.$$escapeHtml(e.url),'"><strong>',soy.$$escapeHtml(e.text),"</strong></a></li>"),t?"":i.toString()},aui.tabPane=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="tabs-pane',e.isActive?" active-pane":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.toolbar&&(aui.toolbar={}),aui.toolbar.toolbar=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-toolbar'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},aui.toolbar.split=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"div"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="toolbar-split toolbar-split-',soy.$$escapeHtml(e.split)),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</",soy.$$escapeHtml(e.tagName?e.tagName:"div"),">"),t?"":i.toString()},aui.toolbar.group=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<ul",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="toolbar-group'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</ul>"),t?"":i.toString()},aui.toolbar.item=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<li ",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="toolbar-item',e.isPrimary?" primary":"",e.isActive?" active":""),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</li>"),t?"":i.toString()},aui.toolbar.trigger=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<a",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="toolbar-trigger'),aui.renderExtraClasses(e,i,n),i.append('" href="',soy.$$escapeHtml(e.url?e.url:"#"),'"',e.title?' title="'+soy.$$escapeHtml(e.title)+'"':""),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</a>"),t?"":i.toString()},aui.toolbar.button=function(e,t,n){var i=t||new soy.StringBuilder;if(null==e)i.append("Either $text or both $title and $iconClass must be provided.");else{var r=new soy.StringBuilder;aui.toolbar.trigger({url:e.url,title:e.title,content:(e.iconClass?'<span class="icon '+soy.$$escapeHtml(e.iconClass)+'"></span>':"")+(e.text?'<span class="trigger-text">'+soy.$$escapeHtml(e.text)+"</span>":"")},r,n),aui.toolbar.item({isActive:e.isActive,isPrimary:e.isPrimary,id:e.id,extraClasses:e.extraClasses,extraAttributes:e.extraAttributes,content:r.toString()},i,n)}return t?"":i.toString()},aui.toolbar.link=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder("toolbar-item-link");aui.renderExtraClasses(e,r,n);var o=new soy.StringBuilder;return aui.toolbar.trigger({url:e.url,content:soy.$$escapeHtml(e.text)},o,n),aui.toolbar.item({id:e.id,extraClasses:r.toString(),extraAttributes:e.extraAttributes,content:o.toString()},i,n),t?"":i.toString()},aui.toolbar.dropdownInternal=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder(e.itemClass);aui.renderExtraClasses(e,r,n);var o=new soy.StringBuilder(e.splitButtonContent?e.splitButtonContent:""),s=new soy.StringBuilder;return aui.dropdown.trigger({extraClasses:"toolbar-trigger",accessibilityText:e.text},s,n),aui.dropdown.menu({content:e.dropdownItemsContent},s,n),aui.dropdown.parent({content:s.toString()},o,n),aui.toolbar.item({isPrimary:e.isPrimary,id:e.id,extraClasses:r.toString(),extraAttributes:e.extraAttributes,content:o.toString()},i,n),t?"":i.toString()},aui.toolbar.dropdown=function(e,t,n){var i=t||new soy.StringBuilder;return aui.toolbar.dropdownInternal({isPrimary:e.isPrimary,id:e.id,itemClass:"toolbar-dropdown",extraClasses:e.extraClasses,extraAttributes:e.extraAttributes,text:e.text,dropdownItemsContent:e.dropdownItemsContent},i,n),t?"":i.toString()},aui.toolbar.splitButton=function(e,t,n){var i=t||new soy.StringBuilder,r=new soy.StringBuilder;return aui.toolbar.trigger({url:e.url,content:soy.$$escapeHtml(e.text)},r,n),aui.toolbar.dropdownInternal({isPrimary:e.isPrimary,id:e.id,itemClass:"toolbar-splitbutton",extraClasses:e.extraClasses,extraAttributes:e.extraAttributes,dropdownItemsContent:e.dropdownItemsContent,splitButtonContent:r.toString()},i,n),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.toolbar2&&(aui.toolbar2={}),aui.toolbar2.toolbar2=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-toolbar2'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(' role="toolbar"><div class="aui-toolbar2-inner">',e.content,"</div></div>"),t?"":i.toString()},aui.toolbar2.item=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-toolbar2-',soy.$$escapeHtml(e.item)),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div>"),t?"":i.toString()},aui.toolbar2.group=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<div",e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-toolbar2-group'),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append(">",e.content,"</div>"),t?"":i.toString()},"undefined"==typeof aui)var aui={};if("undefined"==typeof aui.trigger&&(aui.trigger={}),aui.trigger.trigger=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"a"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="'),aui.renderExtraClasses(e,i,n),i.append('" aria-owns="',soy.$$escapeHtml(e.menu.id),'" aria-controls="',soy.$$escapeHtml(e.menu.id),'" aria-haspopup="true"',e.title?' title="'+soy.$$escapeHtml(e.title)+'"':"",e.container?' data-container="'+soy.$$escapeHtml(e.container)+'"':"",e.tagName&&"a"!=e.tagName||e.extraAttributes&&("[object Object]"!==Object.prototype.toString.call(e.extraAttributes)||e.extraAttributes.href||e.extraAttributes.tabindex)?"":' tabindex="0"'," data-aui-trigger"),aui.renderExtraAttributes(e,i,n),i.append(">",e.content?e.content:"",e.text?soy.$$escapeHtml(e.text):"",0!=e.showIcon?'<span class="icon '+soy.$$escapeHtml(e.iconClasses?e.iconClasses:"aui-icon-dropdown")+'">'+(e.iconText?soy.$$escapeHtml(e.iconText):"")+"</span>":"","</",soy.$$escapeHtml(e.tagName?e.tagName:"a"),">"),t?"":i.toString()},"undefined"==typeof aui)var aui={};"undefined"==typeof aui.avatar&&(aui.avatar={}),aui.avatar.avatar=function(e,t,n){var i=t||new soy.StringBuilder;return i.append("<",soy.$$escapeHtml(e.tagName?e.tagName:"span"),e.id?' id="'+soy.$$escapeHtml(e.id)+'"':"",' class="aui-avatar aui-avatar-',soy.$$escapeHtml(e.size),soy.$$escapeHtml(e.isProject?" aui-avatar-project":""),soy.$$escapeHtml(e.badgeContent?" aui-avatar-badged":"")),aui.renderExtraClasses(e,i,n),i.append('"'),aui.renderExtraAttributes(e,i,n),i.append('><span class="aui-avatar-inner"><img src="',soy.$$escapeHtml(e.avatarImageUrl),'"',e.accessibilityText?' alt="'+soy.$$escapeHtml(e.accessibilityText)+'"':"",e.title?' title="'+soy.$$escapeHtml(e.title)+'"':"",e.imageClasses?' class="'+soy.$$escapeHtml(e.imageClasses)+'"':""," /></span>",e.badgeContent?e.badgeContent:"","</",soy.$$escapeHtml(e.tagName?e.tagName:"span"),">"),t?"":i.toString()},define("aui-soy",function(){}),function(root){define("aui-stable",["jquery","aui-soy"],function(){return function(){!function(){"use strict";function e(e,i){a(e,i.id+".initialised")||(l(e,i.id+".initialised",!0),t(e,i,function(){n(e,i)}))}function t(e,t,n){var i=/^[^(]+\([^,)]+,/;return n=n||function(){},a(e,t.id+".ready-called")?n():(l(e,t.id+".ready-called",!0),t.template&&t.template(e),d(e,t.prototype),o(e,t),void(t.ready&&i.test(t.ready)?t.ready(e,n):t.ready?(t.ready(e),n()):n()))}function n(e,t){e.parentNode&&(a(e,t.id+".insert-called")||(l(e,t.id+".insert-called",!0),u(e,t.classname),t.insert&&t.insert(e),r(e,t)))}function i(e,t){a(e,t.id+".remove-called")||(l(e,t.id+".remove-called",!0),t.remove&&t.remove(e))}function r(e,t){function n(n,i,r,o){var s;t.attributes&&t.attributes[i]&&"function"==typeof t.attributes[i][n]?s=t.attributes[i][n]:t.attributes&&"function"==typeof t.attributes[i]?s=t.attributes[i]:"function"==typeof t.attributes&&(s=t.attributes),s&&s(e,{type:n,name:i,newValue:r,oldValue:o})}var i=e.attributes,r=i.length,o=new B(function(e){e.forEach(function(e){var t,r=e.attributeName,o=i[r];o&&null===e.oldValue?t="insert":o&&null!==e.oldValue?t="update":o||(t="remove"),n(t,r,o?o.value||o.nodeValue:void 0,e.oldValue)})});o.observe(e,{attributes:!0,attributeOldValue:!0});for(var s=0;r>s;s++){var a=i[s];a&&n("insert",a.nodeName,a.value||a.nodeValue)}}function o(e,t){function n(t,n){return function(i){(!n||O.call(i.target,n))&&t(e,i)}}"object"==typeof t.events&&p(t.events,function(t,i){var r=s(i);e.addEventListener(r.name,n(t,r.delegate))})}function s(e){var t=e.split(" ");return{name:t.shift(),delegate:t.join(" ")}}function a(e,t){return e.__SKATE_DATA?e.__SKATE_DATA[t]:void 0}function l(e,t,n){e.__SKATE_DATA||(e.__SKATE_DATA={}),e.__SKATE_DATA[t]=n}function u(e,t){e.classList?e.classList.add(t):e.className+=e.className?" "+t:t}function c(e){var t=e.classList;if(t)return t;var n=e.attributes;return n["class"]&&n["class"].nodeValue.split(/\s+/)||[]}function d(e,t){return p(t,function(t,n){void 0===e[n]&&(e[n]=t)}),e}function h(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function p(e,t){for(var n in e)h(e,n)&&t(e[n],n)}function f(e){function n(){var i=document.createElement(e.id);return e.prototype=n.prototype,t(i,e),i}return n.prototype=e.prototype,n}function m(e){for(var t=e;t&&t!==document;){if(t.hasAttribute(I))return t;t=t.parentNode}}function g(e,t,n){var i=t.indexOf(j.types.TAG)>-1,r=t.indexOf(j.types.ATTR)>-1,o=t.indexOf(j.types.CLASS)>-1,s=[];return n=n?":not("+n+")":"",i&&(s.push(e+n),s.push("[is="+e+"]"+n)),r&&s.push("["+e+"]"+n),o&&s.push("."+e+n),s.join(",")}function v(e,t){return h(F,e)&&F[e].type.indexOf(t)>-1}function y(e,t){if(t){for(var n=e.querySelectorAll(t),i=n.length,r=[],o=0;i>o;o++){var s=n[o];s.parentNode===e&&r.push(s)}return r}return e.childNodes||[]}function b(e){var t={caption:"table",dd:"dl",dt:"dl",li:"ul",tbody:"table",td:"tr",thead:"table",tr:"tbody"},n=e.match(/\s*<([^\s>]+)/),i=document.createDocumentFragment(),r=document.createElement(n&&t[n[1]]||"div");
return r.innerHTML=e,w(i,r.childNodes),i}function w(e,t){var n=t.length;if(t&&n)for(var i=n-1;i>=0;i--){var r=t[i],o=e.childNodes[0];o?e.insertBefore(r,o):e.appendChild(r)}}function x(e,t){var n=t.length;if(t&&n)for(var i=0;n>i;i++){var r=t[i];e.removeChild(r)}}function _(e,t){return 1!==e.nodeType?!1:e.contains?e.contains(t):N.call(e,t)}function k(t){if(1===t.nodeType&&!t.attributes[I]){for(var n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,A,!0),i=j.components(t),r=i.length,o=0;r>o;o++)e(t,i[o]);for(;n.nextNode();)for(var s=n.currentNode,a=j.components(s),l=a.length,u=0;l>u;u++)e(s,a[u])}}function C(e){for(var t=e.length,n=0;t>n;n++)k(e[n])}function S(e){for(var t=e.length,n=0;t>n;n++){var i=e[n];if(1===i.nodeType){var r=i.childNodes;S(r),j.components(i).forEach($(i))}}}function $(e){return function(t){i(e,t)}}function T(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},1))}}function A(e){var t=e.attributes;return t&&t[I]?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}function E(e,t){return{addedNodes:null,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:null,target:e,type:t||"childList"}}function j(e,t){if(t=d(t||{},j.defaults),t.id=e,h(F,t.id))throw new Error('A component of type "'+t.type+'" with the ID of "'+e+'" already exists.');return t.template&&"string"==typeof t.template&&(t.template=j.template.html(t.template)),(t.ready||t.template)&&H.sheet.insertRule(g(t.id,t.type,"."+t.classname)+"{display:none}",H.sheet.cssRules.length),F[t.id]=t,L&&q(),t.type.indexOf(j.types.TAG)>-1?f(t):void 0}var D,q=T(function(){k(document.getElementsByTagName("html")[0])}),P="data-skate-content",I="data-skate-ignore",R=/^[\s\r\n]*$/,M=window.HTMLElement.prototype,N=M.contains,O=M.matches||M.msMatchesSelector||M.webkitMatchesSelector||M.mozMatchesSelector||M.oMatchesSelector,L=!1,H=document.createElement("style"),F={},B=window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver;B||(B=function(e){this.callback=e,this.elements=[]},B.prototype={observe:function(e,t){function n(e){u.push(e),d()}function i(e){var t=e.target;if(t){var n=t.parentNode;o(n)&&(s&&_(s,t)||(a||c.push(a=E(n)),n?(a.addedNodes||(a.addedNodes=[]),a.addedNodes.push(t)):(a.removedNodes||(a.removedNodes=[]),a.removedNodes.push(t)),s=t))}}function r(t){return t===e}function o(n){return t.childList&&(t.subtree||n===e)}var s,a,l=this,u=[],c=[],d=T(function(){for(var e=u.length,t=0;e>t;t++)i(u[t]);l.callback(c),u=[],c=[],s=void 0,a=void 0}),h={},p=[],f=T(function(){var e=p.length;l.callback(p),p.splice(0,e)}),m={target:e,options:t,insertHandler:n,removeHandler:n,attributeHandler:function(e){var n=e.target;if(r(n)){var i=e.attrName,o=e.prevValue,s=e.newValue,a=E(n,"attributes");a.attributeName=i,t.attributeOldValue&&(a.oldValue=h[i]||o||null),p.push(a),t.attributeOldValue&&(h[i]=s),f()}}};return this.elements.push(m),t.childList&&(e.addEventListener("DOMNodeInserted",m.insertHandler),e.addEventListener("DOMNodeRemoved",m.removeHandler)),t.attributes&&e.addEventListener("DOMAttrModified",m.attributeHandler),this},disconnect:function(){return p(this.elements,function(e){e.target.removeEventListener("DOMNodeInserted",e.insertHandler),e.target.removeEventListener("DOMNodeRemoved",e.removeHandler),e.target.removeEventListener("DOMAttrModified",e.attributeHandler)}),this.elements=[],this}}),j.components=function(e){var t=e.attributes,n=t.length,i=[],r=t.is,o=r&&(r.value||r.nodeValue)||e.tagName.toLowerCase();v(o,j.types.TAG)&&i.push(F[o]);for(var s=0;n>s;s++){var a=t[s].nodeName;v(a,j.types.ATTR)&&i.push(F[a])}for(var l=c(e),u=l.length,d=0;u>d;d++){var h=l[d];v(h,j.types.CLASS)&&i.push(F[h])}return i},j.destroy=function(){return F={},j},j.init=function(e){return"undefined"==typeof e.length&&(e=[e]),C(e),arguments[0]},j.template={},j.template.html=function(e){var t=b(e),n=!1,i=new B(function(e){if(n)return void(n=!1);n=!0;for(var t=0;t<e.length;t++){var i=e[t],r=i.target,o=a(r,"default-content");i.addedNodes&&x(r,o),i.removedNodes&&r.innerHTML.match(R)&&(r.innerHTML="",w(r,o))}});return function(e){var n=b(e.innerHTML),r=t.cloneNode(!0),o=r.querySelectorAll("["+P+"]"),s=o.length;if(s)for(var a=0;s>a;a++){var u=o[a],c=y(n,u.getAttribute(P));l(u,"default-content",[].slice.call(u.childNodes)),c.length&&(u.innerHTML="",w(u,c)),i.observe(u,{childList:!0})}e.innerHTML="",e.appendChild(r)}},j.types={ANY:"act",ATTR:"a",CLASS:"c",NOATTR:"ct",NOCLASS:"at",NOTAG:"ac",TAG:"t"},j.unregister=function(e){return delete F[e],j},j.version="0.9.0",j.defaults={attributes:!1,classname:"__skate",events:!1,id:"",prototype:{},template:!1,type:j.types.ANY},document.getElementsByTagName("head")[0].appendChild(H),document.addEventListener("DOMContentLoaded",function(){q(),D=new B(function(e){for(var t=e.length,n=0;t>n;n++){var i=e[n],r=i.addedNodes,o=i.removedNodes;r&&r.length&&!m(r[0].parentNode)&&C(r),o&&o.length&&S(o)}}),D.observe(document,{childList:!0,subtree:!0}),L=!0}),window.skate=j,"function"==typeof define&&define.amd?define("aui/internal/skate",[],function(){return j}):"object"==typeof exports&&(module.exports=j)}(),function(e){(function(){var e,t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v={}.hasOwnProperty,y=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1},b=[].slice;null==this.Tether&&(this.Tether={modules:[]}),c=function(e){var t,n,i,r,o;if(n=getComputedStyle(e).position,"fixed"===n)return e;for(i=void 0,t=e;t=t.parentNode;){try{r=getComputedStyle(t)}catch(s){}if(null==r)return t;if(/(auto|scroll)/.test(r.overflow+r["overflow-y"]+r["overflow-x"])&&("absolute"!==n||"relative"===(o=r.position)||"absolute"===o||"fixed"===o))return t}return document.body},f=function(){var e;return e=0,function(){return e++}}(),g={},l=function(e){var t,i,o,s,a;if(o=e._tetherZeroElement,null==o&&(o=e.createElement("div"),o.setAttribute("data-tether-id",f()),r(o.style,{top:0,left:0,position:"absolute"}),e.body.appendChild(o),e._tetherZeroElement=o),t=o.getAttribute("data-tether-id"),null==g[t]){g[t]={},a=o.getBoundingClientRect();for(i in a)s=a[i],g[t][i]=s;n(function(){return g[t]=void 0})}return g[t]},h=null,s=function(e){var t,n,i,r,o,s,a;e===document?(n=document,e=document.documentElement):n=e.ownerDocument,i=n.documentElement,t={},a=e.getBoundingClientRect();for(r in a)s=a[r],t[r]=s;return o=l(n),t.top-=o.top,t.left-=o.left,null==t.width&&(t.width=document.body.scrollWidth-t.left-t.right),null==t.height&&(t.height=document.body.scrollHeight-t.top-t.bottom),t.top=t.top-i.clientTop,t.left=t.left-i.clientLeft,t.right=n.body.clientWidth-t.width-t.left,t.bottom=n.body.clientHeight-t.height-t.top,t},a=function(e){return e.offsetParent||document.documentElement},u=function(){var e,t,n,i,o;return e=document.createElement("div"),e.style.width="100%",e.style.height="200px",t=document.createElement("div"),r(t.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),t.appendChild(e),document.body.appendChild(t),i=e.offsetWidth,t.style.overflow="scroll",o=e.offsetWidth,i===o&&(o=t.clientWidth),document.body.removeChild(t),n=i-o,{width:n,height:n}},r=function(e){var t,n,i,r,o,s,a;for(null==e&&(e={}),t=[],Array.prototype.push.apply(t,arguments),a=t.slice(1),o=0,s=a.length;s>o;o++)if(i=a[o])for(n in i)v.call(i,n)&&(r=i[n],e[n]=r);return e},p=function(e,t){var n,i,r,o,s;if(null!=e.classList){for(o=t.split(" "),s=[],i=0,r=o.length;r>i;i++)n=o[i],n.trim()&&s.push(e.classList.remove(n));return s}return e.className=e.className.replace(new RegExp("(^| )"+t.split(" ").join("|")+"( |$)","gi")," ")},t=function(e,t){var n,i,r,o,s;if(null!=e.classList){for(o=t.split(" "),s=[],i=0,r=o.length;r>i;i++)n=o[i],n.trim()&&s.push(e.classList.add(n));return s}return p(e,t),e.className+=" "+t},d=function(e,t){return null!=e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},m=function(e,n,i){var r,o,s,a,l,u;for(o=0,a=i.length;a>o;o++)r=i[o],y.call(n,r)<0&&d(e,r)&&p(e,r);for(u=[],s=0,l=n.length;l>s;s++)r=n[s],u.push(d(e,r)?void 0:t(e,r));return u},i=[],n=function(e){return i.push(e)},o=function(){var e,t;for(t=[];e=i.pop();)t.push(e());return t},e=function(){function e(){}return e.prototype.on=function(e,t,n,i){var r;return null==i&&(i=!1),null==this.bindings&&(this.bindings={}),null==(r=this.bindings)[e]&&(r[e]=[]),this.bindings[e].push({handler:t,ctx:n,once:i})},e.prototype.once=function(e,t,n){return this.on(e,t,n,!0)},e.prototype.off=function(e,t){var n,i,r;if(null!=(null!=(i=this.bindings)?i[e]:void 0)){if(null==t)return delete this.bindings[e];for(n=0,r=[];n<this.bindings[e].length;)r.push(this.bindings[e][n].handler===t?this.bindings[e].splice(n,1):n++);return r}},e.prototype.trigger=function(){var e,t,n,i,r,o,s,a,l;if(n=arguments[0],e=2<=arguments.length?b.call(arguments,1):[],null!=(s=this.bindings)?s[n]:void 0){for(r=0,l=[];r<this.bindings[n].length;)a=this.bindings[n][r],i=a.handler,t=a.ctx,o=a.once,i.apply(null!=t?t:this,e),l.push(o?this.bindings[n].splice(r,1):r++);return l}},e}(),this.Tether.Utils={getScrollParent:c,getBounds:s,getOffsetParent:a,extend:r,addClass:t,removeClass:p,hasClass:d,updateClasses:m,defer:n,flush:o,uniqueId:f,Evented:e,getScrollBarSize:u}}).call(this),function(){var e,t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,S,$,T,A,E=[].slice,j=function(e,t){return function(){return e.apply(t,arguments)}};if(null==this.Tether)throw new Error("You must include the utils.js file before tether.js");i=this.Tether,A=i.Utils,m=A.getScrollParent,g=A.getSize,p=A.getOuterSize,d=A.getBounds,h=A.getOffsetParent,u=A.extend,r=A.addClass,_=A.removeClass,S=A.updateClasses,l=A.defer,c=A.flush,f=A.getScrollBarSize,$=function(e,t,n){return null==n&&(n=1),e+n>=t&&t>=e-n},C=function(){var e,t,n,i,r;for(e=document.createElement("div"),r=["transform","webkitTransform","OTransform","MozTransform","msTransform"],n=0,i=r.length;i>n;n++)if(t=r[n],void 0!==e.style[t])return t}(),k=[],x=function(){var e,t,n;for(t=0,n=k.length;n>t;t++)e=k[t],e.position(!1);return c()},v=function(){var e;return null!=(e="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?e:+new Date},function(){var e,t,n,i,r,o,s,a,l;for(t=null,n=null,i=null,r=function(){if(null!=n&&n>16)return n=Math.min(n-16,250),void(i=setTimeout(r,250));if(!(null!=t&&v()-t<10))return null!=i&&(clearTimeout(i),i=null),t=v(),x(),n=v()-t},a=["resize","scroll","touchmove"],l=[],o=0,s=a.length;s>o;o++)e=a[o],l.push(window.addEventListener(e,r));return l}(),e={center:"center",left:"right",right:"left"},t={middle:"middle",top:"bottom",bottom:"top"},n={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},a=function(n,i){var r,o;return r=n.left,o=n.top,"auto"===r&&(r=e[i.left]),"auto"===o&&(o=t[i.top]),{left:r,top:o}},s=function(e){var t,i;return{left:null!=(t=n[e.left])?t:e.left,top:null!=(i=n[e.top])?i:e.top}},o=function(){var e,t,n,i,r,o,s;for(t=1<=arguments.length?E.call(arguments,0):[],n={top:0,left:0},r=0,o=t.length;o>r;r++)s=t[r],i=s.top,e=s.left,"string"==typeof i&&(i=parseFloat(i,10)),"string"==typeof e&&(e=parseFloat(e,10)),n.top+=i,n.left+=e;return n},y=function(e,t){return"string"==typeof e.left&&-1!==e.left.indexOf("%")&&(e.left=parseFloat(e.left,10)/100*t.width),"string"==typeof e.top&&-1!==e.top.indexOf("%")&&(e.top=parseFloat(e.top,10)/100*t.height),e},b=w=function(e){var t,n,i;return i=e.split(" "),n=i[0],t=i[1],{top:n,left:t}},T=function(){function e(e){this.position=j(this.position,this);var t,n,r,o,s;for(k.push(this),this.history=[],this.setOptions(e,!1),o=i.modules,n=0,r=o.length;r>n;n++)t=o[n],null!=(s=t.initialize)&&s.call(this);this.position()}return e.modules=[],e.prototype.getClass=function(e){var t,n;return(null!=(t=this.options.classes)?t[e]:void 0)?this.options.classes[e]:(null!=(n=this.options.classes)?n[e]:void 0)!==!1?this.options.classPrefix?""+this.options.classPrefix+"-"+e:e:""},e.prototype.setOptions=function(e,t){var n,i,o,s,a,l;for(this.options=e,null==t&&(t=!0),n={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=u(n,this.options),a=this.options,this.element=a.element,this.target=a.target,this.targetModifier=a.targetModifier,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),l=["element","target"],o=0,s=l.length;s>o;o++){if(i=l[o],null==this[i])throw new Error("Tether Error: Both element and target must be defined");null!=this[i].jquery?this[i]=this[i][0]:"string"==typeof this[i]&&(this[i]=document.querySelector(this[i]))}if(r(this.element,this.getClass("element")),r(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");return this.targetAttachment=b(this.options.targetAttachment),this.attachment=b(this.options.attachment),this.offset=w(this.options.offset),this.targetOffset=w(this.options.targetOffset),null!=this.scrollParent&&this.disable(),this.scrollParent="scroll-handle"===this.targetModifier?this.target:m(this.target),this.options.enabled!==!1?this.enable(t):void 0},e.prototype.getTargetBounds=function(){var e,t,n,i,r,o,s,a,l;if(null==this.targetModifier)return d(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:(e=d(this.target),r={height:e.height,width:e.width,top:e.top,left:e.left},r.height=Math.min(r.height,e.height-(pageYOffset-e.top)),r.height=Math.min(r.height,e.height-(e.top+e.height-(pageYOffset+innerHeight))),r.height=Math.min(innerHeight,r.height),r.height-=2,r.width=Math.min(r.width,e.width-(pageXOffset-e.left)),r.width=Math.min(r.width,e.width-(e.left+e.width-(pageXOffset+innerWidth))),r.width=Math.min(innerWidth,r.width),r.width-=2,r.top<pageYOffset&&(r.top=pageYOffset),r.left<pageXOffset&&(r.left=pageXOffset),r);case"scroll-handle":return l=this.target,l===document.body?(l=document.documentElement,e={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):e=d(l),a=getComputedStyle(l),n=l.scrollWidth>l.clientWidth||"scroll"===[a.overflow,a.overflowX]||this.target!==document.body,o=0,n&&(o=15),i=e.height-parseFloat(a.borderTopWidth)-parseFloat(a.borderBottomWidth)-o,r={width:15,height:.975*i*(i/l.scrollHeight),left:e.left+e.width-parseFloat(a.borderLeftWidth)-15},t=0,408>i&&this.target===document.body&&(t=-11e-5*Math.pow(i,2)-.00727*i+22.58),this.target!==document.body&&(r.height=Math.max(r.height,24)),s=this.target.scrollTop/(l.scrollHeight-i),r.top=s*(i-r.height-t)+e.top+parseFloat(a.borderTopWidth),this.target===document.body&&(r.height=Math.max(r.height,24)),r}},e.prototype.clearCache=function(){return this._cache={}},e.prototype.cache=function(e,t){return null==this._cache&&(this._cache={}),null==this._cache[e]&&(this._cache[e]=t.call(this)),this._cache[e]},e.prototype.enable=function(e){return null==e&&(e=!0),r(this.target,this.getClass("enabled")),r(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),e?this.position():void 0},e.prototype.disable=function(){return _(this.target,this.getClass("enabled")),_(this.element,this.getClass("enabled")),this.enabled=!1,null!=this.scrollParent?this.scrollParent.removeEventListener("scroll",this.position):void 0},e.prototype.destroy=function(){var e,t,n,i,r;for(this.disable(),r=[],e=n=0,i=k.length;i>n;e=++n){if(t=k[e],t===this){k.splice(e,1);break}r.push(void 0)}return r},e.prototype.updateAttachClasses=function(e,t){var n,i,r,o,s,a,u,c,d,h=this;for(null==e&&(e=this.attachment),null==t&&(t=this.targetAttachment),o=["left","top","bottom","right","middle","center"],(null!=(d=this._addAttachClasses)?d.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),n=null!=this._addAttachClasses?this._addAttachClasses:this._addAttachClasses=[],e.top&&n.push(""+this.getClass("element-attached")+"-"+e.top),e.left&&n.push(""+this.getClass("element-attached")+"-"+e.left),t.top&&n.push(""+this.getClass("target-attached")+"-"+t.top),t.left&&n.push(""+this.getClass("target-attached")+"-"+t.left),i=[],s=0,u=o.length;u>s;s++)r=o[s],i.push(""+this.getClass("element-attached")+"-"+r);for(a=0,c=o.length;c>a;a++)r=o[a],i.push(""+this.getClass("target-attached")+"-"+r);return l(function(){return null!=h._addAttachClasses?(S(h.element,h._addAttachClasses,i),S(h.target,h._addAttachClasses,i),h._addAttachClasses=void 0):void 0})},e.prototype.position=function(e){var t,n,r,l,u,p,m,g,v,b,w,x,_,k,C,S,$,T,A,E,j,D,q,P,I,R,M,N,O,L,H,F,B,U,z,J=this;if(null==e&&(e=!0),this.enabled){for(this.clearCache(),E=a(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,E),t=this.cache("element-bounds",function(){return d(J.element)}),I=t.width,r=t.height,0===I&&0===r&&null!=this.lastSize?(L=this.lastSize,I=L.width,r=L.height):this.lastSize={width:I,height:r},q=D=this.cache("target-bounds",function(){return J.getTargetBounds()}),v=y(s(this.attachment),{width:I,height:r}),j=y(s(E),q),u=y(this.offset,{width:I,height:r}),p=y(this.targetOffset,q),v=o(v,u),j=o(j,p),l=D.left+j.left-v.left,P=D.top+j.top-v.top,H=i.modules,R=0,N=H.length;N>R;R++)if(m=H[R],C=m.position.call(this,{left:l,top:P,targetAttachment:E,targetPos:D,attachment:this.attachment,elementPos:t,offset:v,targetOffset:j,manualOffset:u,manualTargetOffset:p,scrollbarSize:T}),null!=C&&"object"==typeof C){if(C===!1)return!1;P=C.top,l=C.left}if(g={page:{top:P,left:l},viewport:{top:P-pageYOffset,bottom:pageYOffset-P-r+innerHeight,left:l-pageXOffset,right:pageXOffset-l-I+innerWidth}},document.body.scrollWidth>window.innerWidth&&(T=this.cache("scrollbar-size",f),g.viewport.bottom-=T.height),document.body.scrollHeight>window.innerHeight&&(T=this.cache("scrollbar-size",f),g.viewport.right-=T.width),(""!==(F=document.body.style.position)&&"static"!==F||""!==(B=document.body.parentElement.style.position)&&"static"!==B)&&(g.page.bottom=document.body.scrollHeight-P-r,g.page.right=document.body.scrollWidth-l-I),(null!=(U=this.options.optimizations)?U.moveElement:void 0)!==!1&&null==this.targetModifier){for(w=this.cache("target-offsetparent",function(){return h(J.target)}),k=this.cache("target-offsetparent-bounds",function(){return d(w)}),_=getComputedStyle(w),n=getComputedStyle(this.element),x=k,b={},z=["Top","Left","Bottom","Right"],M=0,O=z.length;O>M;M++)A=z[M],b[A.toLowerCase()]=parseFloat(_["border"+A+"Width"]);k.right=document.body.scrollWidth-k.left-x.width+b.right,k.bottom=document.body.scrollHeight-k.top-x.height+b.bottom,g.page.top>=k.top+b.top&&g.page.bottom>=k.bottom&&g.page.left>=k.left+b.left&&g.page.right>=k.right&&($=w.scrollTop,S=w.scrollLeft,g.offset={top:g.page.top-k.top+$-b.top,left:g.page.left-k.left+S-b.left})}return this.move(g),this.history.unshift(g),this.history.length>3&&this.history.pop(),e&&c(),!0}},e.prototype.move=function(e){var t,n,i,r,o,s,a,c,d,p,f,m,g,v,y,b,w,x=this;if(null!=this.element.parentNode){c={};for(p in e){c[p]={};for(r in e[p]){for(i=!1,b=this.history,v=0,y=b.length;y>v;v++)if(a=b[v],!$(null!=(w=a[p])?w[r]:void 0,e[p][r])){i=!0;break}i||(c[p][r]=!0)}}t={top:"",left:"",right:"",bottom:""},d=function(e,n){var i,r,o;return(null!=(o=x.options.optimizations)?o.gpu:void 0)===!1?(e.top?t.top=""+n.top+"px":t.bottom=""+n.bottom+"px",e.left?t.left=""+n.left+"px":t.right=""+n.right+"px"):(e.top?(t.top=0,r=n.top):(t.bottom=0,r=-n.bottom),e.left?(t.left=0,i=n.left):(t.right=0,i=-n.right),t[C]="translateX("+Math.round(i)+"px) translateY("+Math.round(r)+"px)","msTransform"!==C?t[C]+=" translateZ(0)":void 0)},o=!1,(c.page.top||c.page.bottom)&&(c.page.left||c.page.right)?(t.position="absolute",d(c.page,e.page)):(c.viewport.top||c.viewport.bottom)&&(c.viewport.left||c.viewport.right)?(t.position="fixed",d(c.viewport,e.viewport)):null!=c.offset&&c.offset.top&&c.offset.left?(t.position="absolute",s=this.cache("target-offsetparent",function(){return h(x.target)}),h(this.element)!==s&&l(function(){return x.element.parentNode.removeChild(x.element),s.appendChild(x.element)}),d(c.offset,e.offset),o=!0):(t.position="absolute",d({top:!0,left:!0},e.page)),o||"BODY"===this.element.parentNode.tagName||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),g={},m=!1;for(r in t)f=t[r],n=this.element.style[r],""===n||""===f||"top"!==r&&"left"!==r&&"bottom"!==r&&"right"!==r||(n=parseFloat(n),f=parseFloat(f)),n!==f&&(m=!0,g[r]=t[r]);return m?l(function(){return u(x.element.style,g)}):void 0}},e}(),i.position=x,this.Tether=u(T,i)}.call(this),function(){var e,t,n,i,r,o,s,a,l,u,c=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};u=this.Tether.Utils,s=u.getOuterSize,o=u.getBounds,a=u.getSize,i=u.extend,l=u.updateClasses,n=u.defer,t={left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle"},e=["left","top","right","bottom"],r=function(t,n){var i,r,s,a,l,u,c;if("scrollParent"===n?n=t.scrollParent:"window"===n&&(n=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),n===document&&(n=n.documentElement),null!=n.nodeType)for(r=a=o(n),l=getComputedStyle(n),n=[r.left,r.top,a.width+r.left,a.height+r.top],i=u=0,c=e.length;c>u;i=++u)s=e[i],s=s[0].toUpperCase()+s.substr(1),"Top"===s||"Left"===s?n[i]+=parseFloat(l["border"+s+"Width"]):n[i]-=parseFloat(l["border"+s+"Width"]);return n},this.Tether.modules.push({position:function(t){var s,a,u,d,h,p,f,m,g,v,y,b,w,x,_,k,C,S,$,T,A,E,j,D,q,P,I,R,M,N,O,L,H,F,B,U,z,J,W,V,G,K,Q,Y,X,Z,et,tt=this;if(P=t.top,y=t.left,A=t.targetAttachment,!this.options.constraints)return!0;for(S=function(t){var n,i,r,o;for(tt.removeClass(t),o=[],i=0,r=e.length;r>i;i++)n=e[i],o.push(tt.removeClass(""+t+"-"+n));return o},V=this.cache("element-bounds",function(){return o(tt.element)}),v=V.height,I=V.width,0===I&&0===v&&null!=this.lastSize&&(G=this.lastSize,I=G.width,v=G.height),j=this.cache("target-bounds",function(){return tt.getTargetBounds()}),E=j.height,D=j.width,T={},g={},a=[this.getClass("pinned"),this.getClass("out-of-bounds")],K=this.options.constraints,R=0,L=K.length;L>R;R++)m=K[R],m.outOfBoundsClass&&a.push(m.outOfBoundsClass),m.pinnedClass&&a.push(m.pinnedClass);for(M=0,H=a.length;H>M;M++)for(f=a[M],Q=["left","top","right","bottom"],N=0,F=Q.length;F>N;N++)$=Q[N],a.push(""+f+"-"+$);for(s=[],T=i({},A),g=i({},this.attachment),Y=this.options.constraints,O=0,B=Y.length;B>O;O++){if(m=Y[O],q=m.to,u=m.attachment,_=m.pin,null==u&&(u=""),c.call(u," ")>=0?(X=u.split(" "),p=X[0],h=X[1]):h=p=u,d=r(this,q),("target"===p||"both"===p)&&(P<d[1]&&"top"===T.top&&(P+=E,T.top="bottom"),P+v>d[3]&&"bottom"===T.top&&(P-=E,T.top="top")),"together"===p&&(P<d[1]&&"top"===T.top&&("bottom"===g.top?(P+=E,T.top="bottom",P+=v,g.top="top"):"top"===g.top&&(P+=E,T.top="bottom",P-=v,g.top="bottom")),P+v>d[3]&&"bottom"===T.top&&("top"===g.top?(P-=E,T.top="top",P-=v,g.top="bottom"):"bottom"===g.top&&(P-=E,T.top="top",P+=v,g.top="top")),"middle"===T.top&&(P+v>d[3]&&"top"===g.top?(P-=v,g.top="bottom"):P<d[1]&&"bottom"===g.top&&(P+=v,g.top="top"))),("target"===h||"both"===h)&&(y<d[0]&&"left"===T.left&&(y+=D,T.left="right"),y+I>d[2]&&"right"===T.left&&(y-=D,T.left="left")),"together"===h&&(y<d[0]&&"left"===T.left?"right"===g.left?(y+=D,T.left="right",y+=I,g.left="left"):"left"===g.left&&(y+=D,T.left="right",y-=I,g.left="right"):y+I>d[2]&&"right"===T.left?"left"===g.left?(y-=D,T.left="left",y-=I,g.left="right"):"right"===g.left&&(y-=D,T.left="left",y+=I,g.left="left"):"center"===T.left&&(y+I>d[2]&&"left"===g.left?(y-=I,g.left="right"):y<d[0]&&"right"===g.left&&(y+=I,g.left="left"))),("element"===p||"both"===p)&&(P<d[1]&&"bottom"===g.top&&(P+=v,g.top="top"),P+v>d[3]&&"top"===g.top&&(P-=v,g.top="bottom")),("element"===h||"both"===h)&&(y<d[0]&&"right"===g.left&&(y+=I,g.left="left"),y+I>d[2]&&"left"===g.left&&(y-=I,g.left="right")),"string"==typeof _?_=function(){var e,t,n,i;for(n=_.split(","),i=[],t=0,e=n.length;e>t;t++)x=n[t],i.push(x.trim());return i}():_===!0&&(_=["top","left","right","bottom"]),_||(_=[]),k=[],b=[],P<d[1]&&(c.call(_,"top")>=0?(P=d[1],k.push("top")):b.push("top")),P+v>d[3]&&(c.call(_,"bottom")>=0?(P=d[3]-v,k.push("bottom")):b.push("bottom")),y<d[0]&&(c.call(_,"left")>=0?(y=d[0],k.push("left")):b.push("left")),y+I>d[2]&&(c.call(_,"right")>=0?(y=d[2]-I,k.push("right")):b.push("right")),k.length)for(C=null!=(Z=this.options.pinnedClass)?Z:this.getClass("pinned"),s.push(C),J=0,U=k.length;U>J;J++)$=k[J],s.push(""+C+"-"+$);if(b.length)for(w=null!=(et=this.options.outOfBoundsClass)?et:this.getClass("out-of-bounds"),s.push(w),W=0,z=b.length;z>W;W++)$=b[W],s.push(""+w+"-"+$);(c.call(k,"left")>=0||c.call(k,"right")>=0)&&(g.left=T.left=!1),(c.call(k,"top")>=0||c.call(k,"bottom")>=0)&&(g.top=T.top=!1),(T.top!==A.top||T.left!==A.left||g.top!==this.attachment.top||g.left!==this.attachment.left)&&this.updateAttachClasses(g,T)}return n(function(){return l(tt.target,s,a),l(tt.element,s,a)}),{top:P,left:y}}})}.call(this),function(){var e,t,n,i;i=this.Tether.Utils,t=i.getBounds,n=i.updateClasses,e=i.defer,this.Tether.modules.push({position:function(i){var r,o,s,a,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,S,$,T,A,E=this;if(f=i.top,u=i.left,C=this.cache("element-bounds",function(){return t(E.element)}),l=C.height,m=C.width,p=this.getTargetBounds(),a=f+l,c=u+m,r=[],f<=p.bottom&&a>=p.top)for(S=["left","right"],g=0,w=S.length;w>g;g++)d=S[g],(($=p[d])===u||$===c)&&r.push(d);if(u<=p.right&&c>=p.left)for(T=["top","bottom"],v=0,x=T.length;x>v;v++)d=T[v],((A=p[d])===f||A===a)&&r.push(d);for(s=[],o=[],h=["left","top","right","bottom"],s.push(this.getClass("abutted")),y=0,_=h.length;_>y;y++)d=h[y],s.push(""+this.getClass("abutted")+"-"+d);for(r.length&&o.push(this.getClass("abutted")),b=0,k=r.length;k>b;b++)d=r[b],o.push(""+this.getClass("abutted")+"-"+d);return e(function(){return n(E.target,o,s),n(E.element,o,s)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(e){var t,n,i,r,o,s,a;return s=e.top,t=e.left,this.options.shift?(n=function(e){return"function"==typeof e?e.call(this,{top:s,left:t}):e},i=n(this.options.shift),"string"==typeof i?(i=i.split(" "),i[1]||(i[1]=i[0]),o=i[0],r=i[1],o=parseFloat(o,10),r=parseFloat(r,10)):(a=[i.top,i.left],o=a[0],r=a[1]),s+=o,t+=r,{top:s,left:t}):void 0}})}.call(this),e.Tether=this.Tether,"function"==typeof define&&define("aui/internal/tether",[],function(){return e.Tether})}(this),jQuery.os={};var jQueryOSplatform=navigator.platform.toLowerCase();return jQuery.os.windows=-1!=jQueryOSplatform.indexOf("win"),jQuery.os.mac=-1!=jQueryOSplatform.indexOf("mac"),jQuery.os.linux=-1!=jQueryOSplatform.indexOf("linux"),jQuery.fn.moveTo=function(e){var t,n={transition:!1,scrollOffset:35},i=jQuery.extend(n,e),r=this,o=r.offset().top;if((jQuery(window).scrollTop()+jQuery(window).height()-this.outerHeight()<o||jQuery(window).scrollTop()+i.scrollOffset>o)&&jQuery(window).height()>i.scrollOffset){if(t=jQuery(window).scrollTop()+i.scrollOffset>o?o-(jQuery(window).height()-this.outerHeight())+i.scrollOffset:o-i.scrollOffset,!jQuery.fn.moveTo.animating&&i.transition)return jQuery(document).trigger("moveToStarted",this),jQuery.fn.moveTo.animating=!0,jQuery("html,body").animate({scrollTop:t},1e3,function(){jQuery(document).trigger("moveToFinished",r),delete jQuery.fn.moveTo.animating}),this;var s=jQuery("html, body");return s.is(":animated")&&(s.stop(),delete jQuery.fn.moveTo.animating),jQuery(document).trigger("moveToStarted"),jQuery(window).scrollTop(t),setTimeout(function(){jQuery(document).trigger("moveToFinished",r)},100),this}return jQuery(document).trigger("moveToFinished",this),this},function(){"use strict";function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if(window.CustomEvent)try{new e}catch(t){return}e.prototype=window.Event.prototype,window.CustomEvent=e}(),window.AJS=window.AJS||{},function(){"use strict";function e(e){return function(){"undefined"!=typeof console&&console[e]&&Function.prototype.apply.call(console[e],console,arguments)}}"undefined"==typeof window.console?window.console={messages:[],log:function(e){this.messages.push(e)},show:function(){alert(this.messages.join("\n")),this.messages=[]}}:window.console.show=function(){},AJS.log=e("log"),AJS.warn=e("warn"),AJS.error=e("error")}(),window.AJS=window.AJS||{},window.AJS.deprecate={},function(e,t){"use strict";function n(e){return e+="",e?e.charAt(0).toUpperCase()+e.substring(1):""}function i(e,i){if("function"==typeof e)return e;var r=!1;return i=i||{},function(o){var s=t.__getDeprecatedLocation(o?o:1)||"";if(!r||-1===c.indexOf(s)){r=!0;var a="DEPRECATED - "+n(e)+" has been deprecated"+(i.sinceVersion?" since "+i.sinceVersion:"")+" and will be removed in "+(i.removeInVersion||"a future release")+".";i.alternativeName&&(a+=" Use "+i.alternativeName+" instead. "),i.extraInfo&&(a+=" "+i.extraInfo),t.__logger(""===s?a+" \n No stack trace of the deprecated usage is available in your current browser.":a+" \n "+s),c.push(s)}}}function r(e,t,n){var r=i(t||e.name||"this function",n);return function(){return r(),e.apply(this,arguments)}}function o(t,n,i){var o=r(t,n,i);return o.prototype=t.prototype,e.extend(o,t),o}function s(e,t,n){if(d){var r=e[t];n=n||{};var o=n.displayName||t,s=i(o,n);Object.defineProperty(e,t,{get:function(){return s(),r},set:function(e){return r=e,s(),e}})}}function a(e,t,n){if("function"==typeof e[t]){n=n||{};var i=n.displayName||t;e[t]=r(e[t],i,n)}else s(e,t,n)}function l(t,n,i){i=i||{};for(var r in t)u.call(t,r)&&(i.displayName=n+r,i.alternativeName=i.alternativeNamePrefix&&i.alternativeNamePrefix+r,a(t,r,e.extend({},i)))}var u=Object.prototype.hasOwnProperty,c=(Object.prototype.toString,[]);t.__logger=function(){return AJS.warn.apply(void 0,arguments)},t.__getDeprecatedLocation=function(e){var t=new Error,n=t.stack||t.stacktrace,i=n&&n.replace(/^Error\n/,"")||"";return i?(i=i.split("\n"),i[e+2]):i};var d=!1;try{Object.defineProperty&&(Object.defineProperty({},"blam",{get:function(){},set:function(){}}),d=!0)}catch(h){}t.fn=r,t.construct=o,t.prop=a,t.obj=l,t.propertyDeprecationSupported=d,t.getMessageLogger=i}(jQuery||Zepto,window.AJS.deprecate),function(){"use strict";if(!window.jQuery&&!window.Zepto)throw new Error("either jQuery or Zepto is required for AJS to function.");window.AJS=function(){function e(e){var t={"<":"&lt;",">":"&gt;","&":"&amp;","'":"&#39;","`":"&#96;"};return"string"==typeof t[e]?t[e]:"&quot;"}var t,n,i=[],r=0,o=/[&"'<>`]/g,s={version:"5.7.25",params:{},$:window.jQuery||window.Zepto,preventDefault:function(e){e.preventDefault()},stopEvent:function(e){return e.stopPropagation(),!1},include:function(e){if(!this.contains(i,e)){i.push(e);var t=document.createElement("script");t.src=e,this.$("body").append(t)}},toggleClassName:function(e,t){(e=this.$(e))&&e.toggleClass(t)},setVisible:function(e,t){if(e=this.$(e)){var n=this.$;n(e).each(function(){var e=n(this).hasClass("hidden");e&&t?n(this).removeClass("hidden"):e||t||n(this).addClass("hidden")})}},setCurrent:function(e,t){(e=this.$(e))&&(t?e.addClass("current"):e.removeClass("current"))},isVisible:function(e){return!this.$(e).hasClass("hidden")},isClipped:function(e){return e=AJS.$(e),e.prop("scrollWidth")>e.prop("clientWidth")},populateParameters:function(e){e||(e=this.params);var t=this;this.$(".parameters input").each(function(){var n=this.value,i=this.title||this.id;t.$(this).hasClass("list")?e[i]?e[i].push(n):e[i]=[n]:e[i]=n.match(/^(tru|fals)e$/i)?"true"===n.toLowerCase():n})},toInit:function(e){var t=this;return this.$(function(){try{e.apply(this,arguments)}catch(n){t.log("Failed to run init function: "+n+"\n"+e.toString())}}),this},indexOf:function(e,t,n){var i=e.length;n?0>n&&(n=Math.max(0,i+n)):n=0;for(var r=n;i>r;r++)if(e[r]===t)return r;
return-1},contains:function(e,t){return this.indexOf(e,t)>-1},firebug:function(){var e=this.$(document.createElement("script"));e.attr("src","https://getfirebug.com/releases/lite/1.2/firebug-lite-compressed.js"),this.$("head").append(e),function(){window.firebug?firebug.init():setTimeout(AJS.firebug,0)}()},clone:function(e){return AJS.$(e).clone().removeAttr("id")},alphanum:function(e,t){e=(e+"").toLowerCase(),t=(t+"").toLowerCase();for(var n=/(\d+|\D+)/g,i=e.match(n),r=t.match(n),o=Math.max(i.length,r.length),s=0;o>s;s++){if(s===i.length)return-1;if(s===r.length)return 1;var a=parseInt(i[s],10)+"",l=parseInt(r[s],10)+"";if(a===i[s]&&l===r[s]&&a!==l)return(a-l)/Math.abs(a-l);if((a!==i[s]||l!==r[s])&&i[s]!==r[s])return i[s]<r[s]?-1:1}return 0},onTextResize:function(e){if("function"==typeof e)if(AJS.onTextResize["on-text-resize"])AJS.onTextResize["on-text-resize"].push(function(t){e(t)});else{var t=AJS("div");t.css({width:"1em",height:"1em",position:"absolute",top:"-9999em",left:"-9999em"}),this.$("body").append(t),t.size=t.width(),setInterval(function(){if(t.size!==t.width()){t.size=t.width();for(var e=0,n=AJS.onTextResize["on-text-resize"].length;n>e;e++)AJS.onTextResize["on-text-resize"][e](t.size)}},0),AJS.onTextResize.em=t,AJS.onTextResize["on-text-resize"]=[function(t){e(t)}]}},unbindTextResize:function(e){for(var t=0,n=AJS.onTextResize["on-text-resize"].length;n>t;t++)if(AJS.onTextResize["on-text-resize"][t]===e)return AJS.onTextResize["on-text-resize"].splice(t,1)},escape:function(e){return escape(e).replace(/%u\w{4}/gi,function(e){return unescape(e)})},escapeHtml:function(t){return t.replace(o,e)},filterBySearch:function(e,t,n){if(!t)return[];var i=(this.$,n&&n.keywordsField||"keywords"),r=n&&n.ignoreForCamelCase?"i":"",o=n&&n.matchBoundary?"\\b":"",s=n&&n.splitRegex||/\s+/,a=t.split(s),l=[];a.forEach(function(e){var t=[new RegExp(o+e,"i")];if(/^([A-Z][a-z]*) {2,}$/.test(this)){var n=this.replace(/([A-Z][a-z]*)/g,"\\b$1[^,]*");t.push(new RegExp(n,r))}l.push(t)});var u=[];return e.forEach(function(e){for(var t=0;t<l.length;t++){for(var n=!1,r=0;r<l[t].length;r++)if(l[t][r].test(e[i])){n=!0;break}if(!n)return}u.push(e)}),u},drawLogo:function(e){var t=e.scaleFactor||1,n=e.fill||"#fff",i=e.stroke||"#000",r=400*t,o=40*t,s=e.strokeWidth||1,a=e.containerID||".aui-logo";AJS.$(".aui-logo").length||AJS.$("body").append('<div id="aui-logo" class="aui-logo"><div>');var l=Raphael(a,r+50*t,o+100*t),u=l.path("M 0,0 c 3.5433333,-4.7243333 7.0866667,-9.4486667 10.63,-14.173 -14.173,0 -28.346,0 -42.519,0 C -35.432667,-9.4486667 -38.976333,-4.7243333 -42.52,0 -28.346667,0 -14.173333,0 0,0 z m 277.031,28.346 c -14.17367,0 -28.34733,0 -42.521,0 C 245.14,14.173 255.77,0 266.4,-14.173 c -14.17267,0 -28.34533,0 -42.518,0 C 213.25167,0 202.62133,14.173 191.991,28.346 c -14.17333,0 -28.34667,0 -42.52,0 14.17333,-18.8976667 28.34667,-37.7953333 42.52,-56.693 -7.08667,-9.448667 -14.17333,-18.897333 -21.26,-28.346 -14.173,0 -28.346,0 -42.519,0 7.08667,9.448667 14.17333,18.897333 21.26,28.346 -14.17333,18.8976667 -28.34667,37.7953333 -42.52,56.693 -14.173333,0 -28.346667,0 -42.52,0 10.63,-14.173 21.26,-28.346 31.89,-42.519 -14.390333,0 -28.780667,0 -43.171,0 C 42.520733,1.330715e-4 31.889933,14.174867 21.26,28.347 c -42.520624,6.24e-4 -85.039187,-8.13e-4 -127.559,-0.001 11.220667,-14.961 22.441333,-29.922 33.662,-44.883 -6.496,-8.661 -12.992,-17.322 -19.488,-25.983 5.905333,0 11.810667,0 17.716,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.173333,0 28.346667,0 42.52,0 10.63,14.173333 21.26,28.346667 31.89,42.52 14.173333,0 28.3466667,0 42.52,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.1733333,0 28.3466667,0 42.52,0 10.63,14.173333 21.26,28.346667 31.89,42.52 14.390333,0 28.780667,0 43.171,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 42.51967,0 85.03933,0 127.559,0 10.63033,14.173333 21.26067,28.346667 31.891,42.52 14.17267,0 28.34533,0 42.518,0 -10.63,-14.173333 -21.26,-28.346667 -31.89,-42.52 14.17367,0 28.34733,0 42.521,0 14.17333,18.897667 28.34667,37.795333 42.52,56.693 -14.17333,18.8976667 -28.34667,37.7953333 -42.52,56.693 z");u.scale(t,-t,0,0),u.translate(120*t,o),u.attr("fill",n),u.attr("stroke",i),u.attr("stroke-width",s)},debounce:function(e,t){var n,i;return function(){var r=arguments,o=this,s=function(){i=e.apply(o,r)};return clearTimeout(n),n=setTimeout(s,t),i}},id:function(e){if(t=r++ +"",n=e?e+t:"aui-uid-"+t,document.getElementById(n)){if(n=n+"-"+(new Date).getTime(),document.getElementById(n))throw new Error("ERROR: timestamped fallback ID "+n+" exists. AJS.id stopped.");return n}return n},_addID:function(e,t){var n=AJS.$(e),i=t||!1;n.each(function(){var e=AJS.$(this);e.attr("id")||e.attr("id",AJS.id(i))})},enable:function(e,t){var n=AJS.$(e);return"undefined"==typeof t&&(t=!0),n.each(function(){this.disabled=!t})}};if("undefined"!=typeof AJS)for(var a in AJS)s[a]=AJS[a];var l=function(){var e=null;return arguments.length&&"string"==typeof arguments[0]&&(e=AJS.$(document.createElement(arguments[0])),2===arguments.length&&e.html(arguments[1])),e};for(var u in s)l[u]=s[u];return l}(),AJS.$(function(){var e=AJS.$("body");e.data("auiVersion")||e.attr("data-aui-version",AJS.version),AJS.populateParameters()}),AJS.$.ajaxSettings.traditional=!0,AJS.deprecate.prop(AJS,"firebug"),AJS.deprecate.prop(AJS,"stopEvent",{alternativeName:"AJS.preventDefault()"}),AJS.deprecate.prop(AJS,"drawLogo"),AJS.deprecate.prop(AJS,"toggleClassName")}(),AJS.format=function(){var e=/'(?!')/g,t=/^\d+$/,n=/^(\d+),number$/,i=/^(\d+)\,choice\,(.+)/,r=/^(\d+)([#<])(.+)/,o=function(e,o){var s,a="";if(s=e.match(t))a=o.length>++e?o[e]:"";else if(s=e.match(n))a=o.length>++s[1]?o[s[1]]:"";else if(s=e.match(i)){var l=o.length>++s[1]?o[s[1]]:null;if(null!==l){for(var u=s[2].split("|"),c=null,d=0;d<u.length;d++){var h=u[d].match(r),p=parseInt(h[1],10);if(p>l){if(c){a=c;break}a=h[3];break}if(l==p&&"#"==h[2]){a=h[3];break}d==u.length-1&&(a=h[3]),c=h[3]}var f=[a].concat(Array.prototype.slice.call(o,1));a=AJS.format.apply(AJS,f)}}return a},s=function(e){for(var t=!1,n=-1,i=0,r=0;r<e.length;r++){var o=e.charAt(r);if("'"==o&&(t=!t),!t)if("{"===o)0===i&&(n=r),i++;else if("}"===o&&i>0&&(i--,0===i)){var s=[];return s.push(e.substring(0,r+1)),s.push(e.substring(0,n)),s.push(e.substring(n+1,r)),s}}return null},a=function(t){for(var n=arguments,i="",r=s(t);r;)t=t.substring(r[0].length),i+=r[1].replace(e,""),i+=o(r[2],n),r=s(t);return i+=t.replace(e,"")};return a.apply(AJS,arguments)},AJS.I18n={getText:function(e){var t=Array.prototype.slice.call(arguments,1);return AJS.I18n.keys&&Object.prototype.hasOwnProperty.call(AJS.I18n.keys,e)?AJS.format.apply(null,[AJS.I18n.keys[e]].concat(t)):e}},function(e){"use strict";AJS._internal=AJS._internal||{},AJS._internal.widget=e(AJS.$)}(function(e){"use strict";return function(t,n){var i="_aui-widget-"+t;return function(t,r){var o,s;e.isPlainObject(t)?s=t:(o=t,s=r);var a,l=o&&e(o);return l&&l.data(i)?a=l.data(i):(a=new n(l,s||{}),l=a.$el,l.data(i,a)),a}}}),function(e){"use strict";AJS.Alignment=e(window.Tether),"function"==typeof window.define&&define("aui/internal/alignment",["aui/internal/tether"],function(){return AJS.Alignment})}(function(e){"use strict";function t(e,t,n){var i=l+t,r=u+n;e.className+=" "+i+" "+r}function n(e){var t=(e.getAttribute(o)||c).split(" ");return{side:t[0],snap:t[1]}}function i(e,t){return d[e+" "+t]||d[c]}function r(r,o){var l=n(r),u=i(l.side,l.snap),c=r.hasAttribute(s),d=new e({enabled:!1,element:r,target:o,attachment:u.el,targetAttachment:u.target,classPrefix:a,constraints:[{to:"window",attachment:c===!0?"none":"together"}]});t(r,l.side,l.snap),this._auiTether=d}var o="data-aui-alignment",s="data-aui-alignment-static",a="aui-alignment",l="aui-alignment-side-",u="aui-alignment-snap-",c="right middle",d={"top left":{el:"bottom left",target:"top left"},"top center":{el:"bottom center",target:"top center"},"top right":{el:"bottom right",target:"top right"},"right top":{el:"top left",target:"top right"},"right middle":{el:"middle left",target:"middle right"},"right bottom":{el:"bottom left",target:"bottom right"},"bottom left":{el:"top left",target:"bottom left"},"bottom center":{el:"top center",target:"bottom center"},"bottom right":{el:"top right",target:"bottom right"},"left top":{el:"top right",target:"top left"},"left middle":{el:"middle right",target:"middle left"},"left bottom":{el:"bottom right",target:"bottom left"}};return r.prototype={destroy:function(){return this._auiTether.destroy(),this},disable:function(){return this._auiTether.disable(),this},enable:function(){return this._auiTether.enable(),this}},r}),window.AJS=window.AJS||{},function(e){"use strict";e._internal=e._internal||{},e._internal.animation={},e._internal.animation.recomputeStyle=function(e){e=e.length?e[0]:e,window.getComputedStyle(e,null).getPropertyValue("left")}}(AJS),function(e){"use strict";AJS._internal=AJS._internal||{},AJS._internal.browser=e(AJS.$)}(function(e){"use strict";var t={},n=null;return t.supportsCalc=function(){if(null===n){var t=e('<div style="height: 10px; height: -webkit-calc(20px + 0); height: calc(20px);"></div>');n=20===t.appendTo(document.documentElement).height(),t.remove()}return n},t.supportsRequestAnimationFrame=function(){return!!window.requestAnimationFrame},t}),AJS.I18n.keys={},AJS.I18n.keys["aui.words.add"]="Add",AJS.I18n.keys["aui.words.update"]="Update",AJS.I18n.keys["aui.words.delete"]="Delete",AJS.I18n.keys["aui.words.remove"]="Remove",AJS.I18n.keys["aui.words.cancel"]="Cancel",AJS.I18n.keys["aui.words.loading"]="Loading",AJS.I18n.keys["aui.words.close"]="Close",AJS.I18n.keys["aui.enter.value"]="Enter value",AJS.I18n.keys["aui.words.more"]="More",AJS.I18n.keys["aui.words.moreitem"]="More",AJS.I18n.keys["aui.keyboard.shortcut.type.x"]="Type ''{0}''",AJS.I18n.keys["aui.keyboard.shortcut.then.x"]="then ''{0}''",AJS.I18n.keys["aui.keyboard.shortcut.or.x"]="OR ''{0}''",AJS.I18n.keys["aui.sidebar.expand.tooltip"]="Expand sidebar ( [ )",AJS.I18n.keys["aui.sidebar.collapse.tooltip"]="Collapse sidebar ( [ )",AJS.I18n.keys["aui.validation.message.maxlength"]="Must be fewer than {0} characters",AJS.I18n.keys["aui.validation.message.minlength"]="Must be greater than {0} characters",AJS.I18n.keys["aui.validation.message.matchingfield"]="{0} and {1} do not match.",AJS.I18n.keys["aui.validation.message.matchingfield-novalue"]="These fields do not match.",AJS.I18n.keys["aui.validation.message.doesnotcontain"]="Do not include the phrase {0} in this field",AJS.I18n.keys["aui.validation.message.pattern"]="This field does not match the required format",AJS.I18n.keys["aui.validation.message.required"]="This is a required field",AJS.I18n.keys["aui.validation.message.validnumber"]="Please enter a valid number",AJS.I18n.keys["aui.validation.message.min"]="Enter a value greater than {0}",AJS.I18n.keys["aui.validation.message.max"]="Enter a value less than {0}",AJS.I18n.keys["aui.validation.message.dateformat"]="Enter a valid date",AJS.I18n.keys["aui.validation.message.minchecked"]="Tick at least {0,choice,0#0 checkboxes|1#1 checkbox|1<{0,number} checkboxes}.",AJS.I18n.keys["aui.validation.message.maxchecked"]="Tick at most {0,choice,0#0 checkboxes|1#1 checkbox|1<{0,number} checkboxes}.",AJS.I18n.keys["aui.checkboxmultiselect.clear.selected"]="Clear selected items",function(e){var t;AJS.dim=function(i,r){t||(t=e(document.body)),i===!0&&n();var o=!!AJS.dim.$dim&&"false"===AJS.dim.$dim.attr("aria-hidden");return AJS.dim.$dim&&(AJS.dim.$dim.remove(),AJS.dim.$dim=null),AJS.dim.$dim=AJS("div").addClass("aui-blanket"),AJS.dim.$dim.attr("tabindex","0"),AJS.dim.$dim.appendTo(document.body),o||(AJS._internal.animation.recomputeStyle(AJS.dim.$dim),AJS.dim.cachedOverflow=t.css("overflow"),t.css("overflow","hidden")),AJS.dim.$dim.attr("aria-hidden","false"),r&&AJS.dim.$dim.css({zIndex:r}),AJS.dim.$dim},AJS.undim=function(){AJS.dim.$dim&&(AJS.dim.$dim.attr("aria-hidden","true"),t&&t.css("overflow",AJS.dim.cachedOverflow))};var n=AJS.deprecate.getMessageLogger("useShim",{extraInfo:"useShim has no alternative as it is now calculated by dim()."})}(AJS.$),function(e){"use strict";AJS.layer=e(AJS.$,AJS._internal.widget)}(function(e,t){"use strict";function n(e){e.attr("aria-hidden","true")}function i(e){e.attr("aria-hidden","false")}function r(t,n,i){var r=e.Event(s+n),o=e.Event(a+n),u=new CustomEvent(l+i,{bubbles:!0,cancelable:!0});return t.trigger(r),t.trigger(o,[t]),t[0].dispatchEvent(u),!r.isDefaultPrevented()&&!o.isDefaultPrevented()&&!u.defaultPrevented}function o(t){this.$el=e(t||'<div class="aui-layer" aria-hidden="true"></div>'),this.$el.addClass("aui-layer")}var s="_aui-internal-layer-",a="_aui-internal-layer-global-",l="aui-layer-",u=e(document);o.prototype={below:function(){return AJS.LayerManager.global.item(AJS.LayerManager.global.indexOf(this.$el)-1)},above:function(){return AJS.LayerManager.global.item(AJS.LayerManager.global.indexOf(this.$el)+1)},changeSize:function(e,t){return this.$el.css("width",e),this.$el.css("height","content"===t?"":t),this},on:function(e,t){return this.$el.on(s+e,t),this},off:function(e,t){return this.$el.off(s+e,t),this},show:function(){return this.isVisible()?(i(this.$el),this):(r(this.$el,"beforeShow","show")&&AJS.LayerManager.global.push(this.$el),this)},hide:function(){return this.isVisible()?(r(this.$el,"beforeHide","hide")&&AJS.LayerManager.global.popUntil(this.$el),this):(n(this.$el),this)},isVisible:function(){return"false"===this.$el.attr("aria-hidden")},remove:function(){this.hide(),this.$el.remove(),this.$el=null},isBlanketed:function(){return"true"===this.$el.attr("data-aui-blanketed")},isPersistent:function(){return"true"===this.$el.attr("data-aui-persistent")||"true"===this.$el.attr("data-aui-modal")},_hideLayer:function(e){(this.isPersistent()||this.isBlanketed())&&AJS.FocusManager.global.exit(this.$el),e&&r(this.$el,"beforeHide","hide"),this.$el.attr("aria-hidden","true"),this.$el.css("z-index",this.$el.data("_aui-layer-cached-z-index")||""),this.$el.data("_aui-layer-cached-z-index",""),this.$el.trigger(s+"hide"),this.$el.trigger(a+"hide",[this.$el])},_showLayer:function(e){this.$el.parent().is("body")||this.$el.appendTo(document.body),this.$el.data("_aui-layer-cached-z-index",this.$el.css("z-index")),this.$el.css("z-index",e),this.$el.attr("aria-hidden","false"),(this.isPersistent()||this.isBlanketed())&&AJS.FocusManager.global.enter(this.$el),this.$el.trigger(s+"show"),this.$el.trigger(a+"show",[this.$el])}};var c=t("layer",o);return c.on=function(e,t,n){return u.on(a+e,t,n),this},c.off=function(e,t,n){return u.off(a+e,t,n),this},c}),AJS.FocusManager=function(e){function t(){this._focusTrapStack=[],e(document).on("focusout",{focusTrapStack:this._focusTrapStack},o)}function n(e,t){t.push(e)}function i(e){e.pop()}function r(e){return e.is(".aui-dialog2")}function o(e){var t=e.data.focusTrapStack;if(e.relatedTarget&&0!==t.length){var n=t[t.length-1],i=e.target,r=e.relatedTarget,o=n.find(":aui-tabbable"),s=AJS.$(o.first()),a=AJS.$(o.last()),l=0===n.has(r).length,u=l&&r;u&&(s.is(i)?a.focus():a.is(i)&&s.focus())}}!function(){function t(t){return"visible"===e.css(t,"visibility")}function n(n,i){var r=n.nodeName.toLowerCase();if("area"===r){var o=n.parentNode,s=o.name,a=e("img[usemap=#"+s+"]").get();return n.href&&s&&"map"===o.nodeName.toLowerCase()?a&&t(a):!1}var l=/input|select|textarea|button|object/.test(r),u="a"===r,c=n.href||i;return(l?!n.disabled:u?c:i)&&t(n)}function i(t){var i=e.attr(t,"tabindex"),r=isNaN(i),o=r||i>=0;return o&&n(t,!r)}e.extend(e.expr[":"],{"aui-focusable":function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},"aui-tabbable":i})}();var s="_aui-focus-restore";return t.defaultFocusSelector=":aui-tabbable",t.prototype.enter=function(i){if(i.data(s,e(document.activeElement)),"false"!==i.attr("data-aui-focus")){var o=i.attr("data-aui-focus-selector")||t.defaultFocusSelector,a=i.is(o)?i:i.find(o);a.first().focus()}r(i)&&n(i,this._focusTrapStack)},t.prototype.exit=function(t){r(t)&&i(this._focusTrapStack);var n=document.activeElement;(t[0]===n||t.has(n).length)&&e(n).blur();var o=t.data(s);o&&o.length&&(t.removeData(s),o.focus())},t.global=new t,t}(AJS.$),function(e){"use strict";function t(e,t){for(var n=e.length;n--;)if(t(e[n]))return n;return-1}function n(e,n){return t(e,function(e){return e[0]===n[0]})}function i(e){return t(e,function(e){return AJS.layer(e).isBlanketed()})}function r(e){var t;if(e.length){var n=e[e.length-1],i=parseInt(n.css("z-index"),10);t=(isNaN(i)?0:i)+100}else t=0;return Math.max(3e3,t)}function o(e,t){var n=i(e);t!==n&&(n>-1?AJS.dim(!1,e[n].css("z-index")-20):AJS.undim())}function s(e,t,n){if(!(0>t))for(var i=e.length-1;i>=t;i--){var r=e[i],o=AJS.layer(r);(n||!o.isPersistent())&&(o._hideLayer(!0),e.splice(i,1))}}function a(e){var t=u(e);return t.length>0?t.closest(".aui-layer"):void 0}function l(e){return u(e).length>0}function u(t){return e('[aria-controls="'+t.attr("id")+'"]')}function c(){this._stack=[]}c.prototype={push:function(t){var i=t instanceof e?t:e(t);if(n(this._stack,i)>=0)throw new Error("The given element is already an active layer.");this.popLayersBeside(i);var o=AJS.layer(i),s=r(this._stack);return o._showLayer(s),o.isBlanketed()&&AJS.dim(!1,s-20),this._stack.push(i),this},popLayersBeside:function(t){var n=t instanceof e?t:e(t);if(!l(n)){var r=i(this._stack);return void s(this._stack,++r,!1)}var o=a(n);if(o){var u=this.indexOf(o);s(this._stack,++u,!1)}else s(this._stack,0,!1)},indexOf:function(t){return n(this._stack,e(t))},item:function(e){return this._stack[e]},hideAll:function(){return this._stack.reverse().forEach(function(e){var t=AJS.layer(e);t.isBlanketed()||t.isPersistent()||t.hide()}),this},getNextLowerNonPersistentOrBlanketedLayer:function(t){var i=t instanceof e?t:e(t),r=n(this._stack,i);if(0>r)return null;var o;for(r--;r>=0;){o=this._stack[r];var s=AJS.layer(o);if(!s.isPersistent()||s.isBlanketed())return o;r--}return null},getNextHigherNonPeristentAndNonBlanketedLayer:function(t){var i=t instanceof e?t:e(t),r=n(this._stack,i);if(0>r)return null;var o;for(r++;r<this._stack.length;){o=this._stack[r];var s=AJS.layer(o);if(!s.isPersistent()&&!s.isBlanketed())return o;r++}return null},popUntil:function(t){var r=t instanceof e?t:e(t),a=n(this._stack,r);if(-1===a)return null;var l=i(this._stack);return s(this._stack,a+1,AJS.layer(r).isBlanketed()),AJS.layer(r)._hideLayer(),this._stack.splice(a,1),o(this._stack,l),r},getTopLayer:function(){if(!this._stack.length)return null;var e=this._stack[this._stack.length-1];return e},popTopIfNonPersistent:function(){var e=this.getTopLayer(),t=AJS.layer(e);return!e||t.isPersistent()?null:this.popUntil(e)},popUntilTopBlanketed:function(){var e=i(this._stack);if(0>e)return null;var t=this._stack[e],r=AJS.layer(t);if(r.isPersistent()){var a=this.getNextHigherNonPeristentAndNonBlanketedLayer(t);if(a){var l=n(this._stack,a);return s(this._stack,l,!0),a}return null}return s(this._stack,e,!0),o(this._stack,e),t},popUntilTopPersistent:function(){var e=AJS.LayerManager.global.getTopLayer();if(e){var t,r=i(this._stack),a=AJS.layer(e);if(a.isPersistent()){if(a.isBlanketed())return;if(e=AJS.LayerManager.global.getNextLowerNonPersistentOrBlanketedLayer(e),a=AJS.layer(e),!e||a.isPersistent())return;t=n(this._stack,e),s(this._stack,t,!0),o(this._stack,r)}else t=n(this._stack,e),s(this._stack,t,!0),o(this._stack,r)}}},AJS.LayerManager=c}(AJS.$),function(){"use strict";AJS.keyCode={ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}(),function(e){"use strict";function t(){o.on("keydown",function(e){e.keyCode===AJS.keyCode.ESCAPE&&(AJS.LayerManager.global.popUntilTopPersistent(),e.preventDefault())})}function n(){o.on("click",".aui-blanket",function(e){AJS.LayerManager.global.popUntilTopBlanketed()&&e.preventDefault()})}function i(){o.on("click",function(t){var n=e(t.target);if(!n.closest(".aui-blanket").length){var i=n.closest("[aria-controls]"),o=n.closest(".aui-layer");if(!o.length&&!r(i))return void AJS.LayerManager.global.hideAll();if(!r(i)&&o.length){var s=AJS.LayerManager.global.getNextHigherNonPeristentAndNonBlanketedLayer(o);s&&AJS.layer(s).hide()}}})}function r(e){if(!e.length)return!1;var t=document.getElementById(e.attr("aria-controls"));return AJS.LayerManager.global.indexOf(t)>-1}var o=e(document);t(),n(),i(),AJS.LayerManager.global=new AJS.LayerManager}(AJS.$),function(e){"use strict";AJS.dialog2=e(AJS.$,AJS.layer,AJS._internal.widget)}(function(e,t,n){"use strict";function i(t){e.each(o,function(e,n){var i="data-"+e;t[0].hasAttribute(i)||t.attr(i,n)})}function r(t){this.$el=e(t?t:aui.dialog.dialog2({})),i(this.$el)}var o={"aui-focus":"false","aui-blanketed":"true"};r.prototype.on=function(e,n){return t(this.$el).on(e,n),this},r.prototype.off=function(e,n){return t(this.$el).off(e,n),this},r.prototype.show=function(){return t(this.$el).show(),this},r.prototype.hide=function(){return t(this.$el).hide(),this},r.prototype.remove=function(){return t(this.$el).remove(),this},r.prototype.isVisible=function(){return t(this.$el).isVisible()};var s=n("dialog2",r);return s.on=function(e,n){return t.on(e,".aui-dialog2",n),this},s.off=function(e,n){return t.off(e,".aui-dialog2",n),this},e(document).on("click",".aui-dialog2-header-close",function(t){t.preventDefault(),s(e(this).closest(".aui-dialog2")).hide()}),s.on("show",function(e,t){var n,i=[".aui-dialog2-content",".aui-dialog2-footer",".aui-dialog2-header"];i.some(function(e){return n=t.find(e+" :aui-tabbable"),n.length}),n&&n.first().focus()}),s.on("hide",function(e,n){var i=t(n);n.data("aui-remove-on-hide")&&i.remove()}),s}),function(){function e(e,t){t=t||"";var n=new RegExp(o(e)+"=([^|]+)"),i=t.match(n);return i&&i[1]}function t(e,t,n){var i=new RegExp("(\\s|\\|)*\\b"+o(e)+"=[^|]*[|]*");if(n=n||"",n=n.replace(i,"|"),""!==t){var r=e+"="+t;n.length+r.length<4020&&(n+="|"+r)}return n.replace(l,"|")}function n(e){return e.replace(a,"")}function i(e){var t=new RegExp("\\b"+o(e)+"=((?:[^\\\\;]+|\\\\.)*)(?:;|$)"),i=document.cookie.match(t);return i&&n(i[1])}function r(e,t,n){var i,r="",o='"'+t.replace(u,'\\"')+'"';n&&(i=new Date,i.setTime(+i+24*n*60*60*1e3),r="; expires="+i.toGMTString()),document.cookie=e+"="+o+r+";path=/"}function o(e){return e.replace(c,"\\$&")}var s="AJS.conglomerate.cookie",a=/(\\|^"|"$)/g,l=/\|\|+/g,u=/"/g,c=/[.*+?|^$()[\]{\\]/g;AJS.Cookie={save:function(e,n,o){var a=i(s);a=t(e,n,a),r(s,a,o||365)},read:function(t,n){var r=i(s),o=e(t,r);return null!=o?o:n},erase:function(e){this.save(e,"")}},AJS.deprecate.prop(AJS.Cookie,"save",{alternativeName:"AJS.cookie"})}(),AJS.bind=function(e,t,n){try{return"function"==typeof n?AJS.$(window).bind(e,t,n):AJS.$(window).bind(e,t)}catch(i){AJS.log("error while binding: "+i.message)}},AJS.unbind=function(e,t){try{return AJS.$(window).unbind(e,t)}catch(n){AJS.log("error while unbinding: "+n.message)}},AJS.trigger=function(e,t){try{return AJS.$(window).trigger(e,t)}catch(n){AJS.log("error while triggering: "+n.message)}},AJS.popup=function(e){var t={width:800,height:600,closeOnOutsideClick:!1,keypressListener:function(e){27===e.keyCode&&n.is(":visible")&&l.hide()}};"object"!=typeof e&&(e={width:arguments[0],height:arguments[1],id:arguments[2]},e=AJS.$.extend({},e,arguments[3])),e=AJS.$.extend({},t,e);var n=AJS("div").addClass("aui-popup");e.id&&n.attr("id",e.id);var i=3e3;AJS.$(".aui-dialog").each(function(){var e=AJS.$(this);i=e.css("z-index")>i?e.css("z-index"):i});var r=function(t,r){return e.width=t=t||e.width,e.height=r=r||e.height,n.css({marginTop:-Math.round(r/2)+"px",marginLeft:-Math.round(t/2)+"px",width:t,height:r,"z-index":parseInt(i,10)+2}),arguments.callee}(e.width,e.height);AJS.$("body").append(n),n.hide(),AJS.enable(n);var o=AJS.$(".aui-blanket"),s=function(e,t){var n=AJS.$(e,t);return n.length?(n.focus(),!0):!1},a=function(t){if(0===AJS.$(".dialog-page-body",t).find(":focus").length){if(e.focusSelector)return s(e.focusSelector,t);var n=":input:visible:enabled:first";s(n,AJS.$(".dialog-page-body",t))||s(n,AJS.$(".dialog-button-panel",t))||s(n,AJS.$(".dialog-page-menu",t))}},l={changeSize:function(t,n){(t&&t!=e.width||n&&n!=e.height)&&r(t,n),this.show()},show:function(){var t=function(){AJS.$(document).off("keydown",e.keypressListener).on("keydown",e.keypressListener),AJS.dim(),o=AJS.$(".aui-blanket"),0!=o.size()&&e.closeOnOutsideClick&&o.click(function(){n.is(":visible")&&l.hide()}),n.show(),AJS.popup.current=this,a(n),AJS.$(document).trigger("showLayer",["popup",this])};t.call(this),this.show=t},hide:function(){AJS.$(document).unbind("keydown",e.keypressListener),o.unbind(),this.element.hide(),0==AJS.$(".aui-dialog:visible").size()&&AJS.undim();var t=document.activeElement;this.element.has(t).length&&t.blur(),AJS.$(document).trigger("hideLayer",["popup",this]),AJS.popup.current=null,this.enable()},element:n,remove:function(){n.remove(),this.element=null},disable:function(){this.disabled||(this.popupBlanket=AJS.$("<div class='dialog-blanket'> </div>").css({height:n.height(),width:n.width()}),n.append(this.popupBlanket),this.disabled=!0)},enable:function(){this.disabled&&(this.disabled=!1,this.popupBlanket.remove(),this.popupBlanket=null)}};return l},function(){function e(e,t,n,i){e.buttonpanel||e.addButtonPanel(),this.page=e,this.onclick=n,this._onclick=function(t){return n.call(this,e.dialog,e,t)===!0},this.item=AJS("button",t).addClass("button-panel-button"),i&&this.item.addClass(i),"function"==typeof n&&this.item.click(this._onclick),e.buttonpanel.append(this.item),this.id=e.button.length,e.button[this.id]=this}function t(e,t,n,i,r){e.buttonpanel||e.addButtonPanel(),r||(r="#"),this.page=e,this.onclick=n,this._onclick=function(t){return n.call(this,e.dialog,e,t)===!0},this.item=AJS("a",t).attr("href",r).addClass("button-panel-link"),i&&this.item.addClass(i),"function"==typeof n&&this.item.click(this._onclick),e.buttonpanel.append(this.item),this.id=e.button.length,e.button[this.id]=this}function n(e,t){var n="left"==e?-1:1;return function(e){var i=this.page[t];if(this.id!=(1==n?i.length-1:0)){n*=e||1,i[this.id+n].item[0>n?"before":"after"](this.item),i.splice(this.id,1),i.splice(this.id+n,0,this);for(var r=0,o=i.length;o>r;r++)"panel"==t&&this.page.curtab==i[r].id&&(this.page.curtab=r),i[r].id=r}return this}}function i(e){return function(){this.page[e].splice(this.id,1);for(var t=0,n=this.page[e].length;n>t;t++)this.page[e][t].id=t;this.item.remove()}}e.prototype.moveUp=e.prototype.moveLeft=n("left","button"),e.prototype.moveDown=e.prototype.moveRight=n("right","button"),e.prototype.remove=i("button"),e.prototype.html=function(e){return this.item.html(e)},e.prototype.onclick=function(e){return"undefined"==typeof e?this.onclick:(this.item.unbind("click",this._onclick),this._onclick=function(t){return e.call(this,page.dialog,page,t)===!0},"function"==typeof e&&this.item.click(this._onclick),void 0)};var r=20,o=function(e,t,n,i,o){n instanceof AJS.$||(n=AJS.$(n)),this.dialog=e.dialog,this.page=e,this.id=e.panel.length,this.button=AJS("button").html(t).addClass("item-button"),o&&(this.button[0].id=o),this.item=AJS("li").append(this.button).addClass("page-menu-item"),this.body=AJS("div").append(n).addClass("dialog-panel-body").css("height",e.dialog.height+"px"),this.padding=r,i&&this.body.addClass(i);var s=e.panel.length,a=this;e.menu.append(this.item),e.body.append(this.body),e.panel[s]=this;var l=function(){var t;e.curtab+1&&(t=e.panel[e.curtab],t.body.hide(),t.item.removeClass("selected"),"function"==typeof t.onblur&&t.onblur()),e.curtab=a.id,a.body.show(),a.item.addClass("selected"),"function"==typeof a.onselect&&a.onselect(),"function"==typeof e.ontabchange&&e.ontabchange(a,t)};this.button.click?this.button.click(l):(AJS.log("atlassian-dialog:Panel:constructor - this.button.click false"),this.button.onclick=l),l(),0==s?e.menu.css("display","none"):e.menu.show()};o.prototype.select=function(){this.button.click()},o.prototype.moveUp=o.prototype.moveLeft=n("left","panel"),o.prototype.moveDown=o.prototype.moveRight=n("right","panel"),o.prototype.remove=i("panel"),o.prototype.html=function(e){return e?(this.body.html(e),this):this.body.html()},o.prototype.setPadding=function(e){return isNaN(+e)||(this.body.css("padding",+e),this.padding=+e,this.page.recalcSize()),this};var s=56,a=51,l=50,u=function(e,t){this.dialog=e,this.id=e.page.length,this.element=AJS("div").addClass("dialog-components"),this.body=AJS("div").addClass("dialog-page-body"),this.menu=AJS("ul").addClass("dialog-page-menu").css("height",e.height+"px"),this.body.append(this.menu),this.curtab,this.panel=[],this.button=[],t&&this.body.addClass(t),e.popup.element.append(this.element.append(this.menu).append(this.body)),e.page[e.page.length]=this};u.prototype.recalcSize=function(){for(var e=this.header?s:0,t=this.buttonpanel?a:0,n=this.panel.length;n--;){var i=this.dialog.height-e-t;this.panel[n].body.css("height",i),this.menu.css("height",i)}},u.prototype.addButtonPanel=function(){this.buttonpanel=AJS("div").addClass("dialog-button-panel"),this.element.append(this.buttonpanel)},u.prototype.addPanel=function(e,t,n,i){return new o(this,e,t,n,i),this.recalcSize(),this},u.prototype.addHeader=function(e,t){return this.header&&this.header.remove(),this.header=AJS("h2").text(e||"").addClass("dialog-title"),t&&this.header.addClass(t),this.element.prepend(this.header),this.recalcSize(),this},u.prototype.addButton=function(t,n,i){return new e(this,t,n,i),this.recalcSize(),this},u.prototype.addLink=function(e,n,i,r){return new t(this,e,n,i,r),this.recalcSize(),this},u.prototype.gotoPanel=function(e){this.panel[e.id||e].select()},u.prototype.getCurrentPanel=function(){return this.panel[this.curtab]},u.prototype.hide=function(){this.element.hide()},u.prototype.show=function(){this.element.show()},u.prototype.remove=function(){this.element.remove()},AJS.Dialog=function(e,t,n){var i={};+e||(i=Object(e),e=i.width,t=i.height,n=i.id),this.height=t||480,this.width=e||640,this.id=n,i=AJS.$.extend({},i,{width:this.width,height:this.height,id:this.id}),this.popup=AJS.popup(i),this.popup.element.addClass("aui-dialog"),this.page=[],this.curpage=0,new u(this)},AJS.Dialog.prototype.addHeader=function(e,t){return this.page[this.curpage].addHeader(e,t),this},AJS.Dialog.prototype.addButton=function(e,t,n){return this.page[this.curpage].addButton(e,t,n),this},AJS.Dialog.prototype.addLink=function(e,t,n,i){return this.page[this.curpage].addLink(e,t,n,i),this},AJS.Dialog.prototype.addSubmit=function(e,t){return this.page[this.curpage].addButton(e,t,"button-panel-submit-button"),this},AJS.Dialog.prototype.addCancel=function(e,t){return this.page[this.curpage].addLink(e,t,"button-panel-cancel-link"),this},AJS.Dialog.prototype.addButtonPanel=function(){return this.page[this.curpage].addButtonPanel(),this},AJS.Dialog.prototype.addPanel=function(e,t,n,i){return this.page[this.curpage].addPanel(e,t,n,i),this},AJS.Dialog.prototype.addPage=function(e){return new u(this,e),this.page[this.curpage].hide(),this.curpage=this.page.length-1,this},AJS.Dialog.prototype.nextPage=function(){return this.page[this.curpage++].hide(),this.curpage>=this.page.length&&(this.curpage=0),this.page[this.curpage].show(),this},AJS.Dialog.prototype.prevPage=function(){return this.page[this.curpage--].hide(),this.curpage<0&&(this.curpage=this.page.length-1),this.page[this.curpage].show(),this},AJS.Dialog.prototype.gotoPage=function(e){return this.page[this.curpage].hide(),this.curpage=e,this.curpage<0?this.curpage=this.page.length-1:this.curpage>=this.page.length&&(this.curpage=0),this.page[this.curpage].show(),this},AJS.Dialog.prototype.getPanel=function(e,t){var n=null==t?this.curpage:e;return null==t&&(t=e),this.page[n].panel[t]},AJS.Dialog.prototype.getPage=function(e){return this.page[e]},AJS.Dialog.prototype.getCurrentPanel=function(){return this.page[this.curpage].getCurrentPanel()
},AJS.Dialog.prototype.gotoPanel=function(e,t){if(null!=t){var n=e.id||e;this.gotoPage(n)}this.page[this.curpage].gotoPanel("undefined"==typeof t?e:t)},AJS.Dialog.prototype.show=function(){return this.popup.show(),AJS.trigger("show.dialog",{dialog:this}),this},AJS.Dialog.prototype.hide=function(){return this.popup.hide(),AJS.trigger("hide.dialog",{dialog:this}),this},AJS.Dialog.prototype.remove=function(){this.popup.hide(),this.popup.remove(),AJS.trigger("remove.dialog",{dialog:this})},AJS.Dialog.prototype.disable=function(){return this.popup.disable(),this},AJS.Dialog.prototype.enable=function(){return this.popup.enable(),this},AJS.Dialog.prototype.get=function(e){var t=[],n=this,i='#([^"][^ ]*|"[^"]*")',r=":(\\d+)",o="page|panel|button|header",s="(?:("+o+")(?:"+i+"|"+r+")?|"+i+")",a=new RegExp("(?:^|,)\\s*"+s+"(?:\\s+"+s+")?\\s*(?=,|$)","ig");(e+"").replace(a,function(e,i,r,o,s,a,l,u,c){i=i&&i.toLowerCase();var d=[];if("page"==i&&n.page[o]?(d.push(n.page[o]),i=a,i=i&&i.toLowerCase(),r=l,o=u,s=c):d=n.page,r=r&&(r+"").replace(/"/g,""),l=l&&(l+"").replace(/"/g,""),s=s&&(s+"").replace(/"/g,""),c=c&&(c+"").replace(/"/g,""),i||s)for(var h=d.length;h--;){if(s||"panel"==i&&(r||!r&&null==o))for(var p=d[h].panel.length;p--;)(d[h].panel[p].button.html()==s||d[h].panel[p].button.html()==r||"panel"==i&&!r&&null==o)&&t.push(d[h].panel[p]);if(s||"button"==i&&(r||!r&&null==o))for(var p=d[h].button.length;p--;)(d[h].button[p].item.html()==s||d[h].button[p].item.html()==r||"button"==i&&!r&&null==o)&&t.push(d[h].button[p]);d[h][i]&&d[h][i][o]&&t.push(d[h][i][o]),"header"==i&&d[h].header&&t.push(d[h].header)}else t=t.concat(d)});for(var l={length:t.length},u=t.length;u--;){l[u]=t[u];for(var c in t[u])c in l||!function(e){l[e]=function(){for(var t=this.length;t--;)"function"==typeof this[t][e]&&this[t][e].apply(this[t],arguments)}}(c)}return l},AJS.Dialog.prototype.updateHeight=function(){for(var e=0,t=AJS.$(window).height()-s-a-2*l,n=0;this.getPanel(n);n++)this.getPanel(n).body.css({height:"auto",display:"block"}).outerHeight()>e&&(e=Math.min(t,this.getPanel(n).body.outerHeight())),n!==this.page[this.curpage].curtab&&this.getPanel(n).body.css({display:"none"});for(n=0;this.getPanel(n);n++)this.getPanel(n).body.css({height:e||this.height});this.page[0].menu.height(e),this.height=e+s+a+1,this.popup.changeSize(void 0,this.height)},AJS.Dialog.prototype.isMaximised=function(){return this.popup.element.outerHeight()>=AJS.$(window).height()-2*l},AJS.Dialog.prototype.getCurPanel=function(){return this.getPanel(this.page[this.curpage].curtab)},AJS.Dialog.prototype.getCurPanelButton=function(){return this.getCurPanel().button},AJS.Dialog=AJS.deprecate.construct(AJS.Dialog,"Dialog constructor",{alternativeName:"Dialog2"}),AJS.popup=AJS.deprecate.construct(AJS.popup,"Dialog popup constructor",{alternatveName:"Dialog2"})}(),function(e){function t(e){e.preventDefault()}function n(e){return"true"!==e[0].getAttribute("aria-hidden")&&e.is(":visible")}function i(e){if(e.click)e.click();else{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}function r(t,n){return t===n||e.contains(n,t)}function o(t){t instanceof AJS.$||(t=e(t));var n=t.attr("aria-owns"),i=t.attr("aria-haspopup"),r=document.getElementById(n);if(r)return e(r);if(!n)throw new Error("Dropdown 2 trigger required attribute not set: aria-owns");if(!i)throw new Error("Dropdown 2 trigger required attribute not set: aria-haspopup");if(!r)throw new Error("Dropdown 2 trigger aria-owns attr set to nonexistent id: "+n);throw new Error("Dropdown 2 trigger unknown error. I don't know what you did, but there's smoke everywhere. Consult the documentation.")}var s=e(document),a=null,l=function(){function n(t){o||1!==t.which||(o=!0,s.bind("mouseup mouseleave",i),e(this).trigger("aui-button-invoke"))}function i(){s.unbind("mouseup mouseleave",i),setTimeout(function(){o=!1},0)}function r(){o||e(this).trigger("aui-button-invoke")}var o=!1;return"undefined"==typeof document.addEventListener?{click:r,"click selectstart":t,mousedown:function(e){function t(e){switch(e.toElement){case null:case i:case document.body:case document.documentElement:e.returnValue=!1}}var i=this,r=document.activeElement;n.call(this,e),null!==r&&(r.attachEvent("onbeforedeactivate",t),setTimeout(function(){r.detachEvent("onbeforedeactivate",t)},0))}}:{click:r,"click mousedown":t,mousedown:n}}(),u={"aui-button-invoke":function(l,u){function c(t,n){t.each(function(){var t=e(this);t.attr("role",n),t.hasClass("checked")||t.hasClass("aui-dropdown2-checked")?(t.attr("aria-checked","true"),"radio"==n&&t.closest("ul").attr("role","radiogroup")):t.attr("aria-checked","false")})}function d(){var t=j.offset(),n=j.outerWidth();E.css({left:0,top:0});var i=E.outerWidth(),r=e("body").outerWidth(!0),o=Math.max(parseInt(E.css("min-width"),10),n),s=j.data("container")||!1,a="left";D||E.css("min-width",o+"px");var l=t.left,u=t.top+j.outerHeight();if(D){var c=3;l=t.left+N.outerWidth()-c,u=t.top}if(l+i>r&&l+n>=i&&(l=t.left+n-i,D&&(l=t.left-i),a="right"),s){var d=(j.closest(s),j.offset().left+j.outerWidth()),h=d+i;o>=i&&(i=o),h>d&&(l=d-i,a="right")}E.attr({"data-dropdown2-alignment":a,"aria-hidden":"false"}).css({display:"block",left:l+"px",top:u+"px"}),E.appendTo(document.body)}function h(){$(),A("off"),setTimeout(function(){E.css("display","none").css("min-width","").insertAfter(j).attr("aria-hidden","true"),D||j.removeClass("active aui-dropdown2-active"),y().removeClass("active aui-dropdown2-active"),E.removeClass("aui-dropdown2-in-toolbar"),E.removeClass("aui-dropdown2-in-buttons"),P?E.insertBefore(P):E.appendTo(q),E.trigger("aui-dropdown2-hide")},0)}function p(){h(),D&&N.trigger("aui-dropdown2-hide-all")}function f(e){D&&e.target===N[0]&&h()}function m(e){return!e.is(".disabled, .aui-dropdown2-disabled, [aria-disabled=true]")}function g(e){return e.hasClass("aui-dropdown2-sub-trigger")}function v(t,i){if(g(t)){i=e.extend({},i,{$menu:M});var r=o(t);n(r)?r.trigger("aui-dropdown2-select-first"):t.trigger("aui-button-invoke",i)}}function y(){return E.find("a.active,a.aui-dropdown2-active")}function b(e){return H&&H[0]===e[0]?!1:(H=e,y().removeClass("active aui-dropdown2-active"),m(e)&&e.addClass("active aui-dropdown2-active"),E.trigger("aui-dropdown2-item-selected"),T(),!0)}function w(){b(E.find("a:not(.disabled):not(.aui-dropdown2-disabled)").first())}function x(e){var t=E.find("> ul > li > a, > .aui-dropdown2-section > ul > li > a").not(".disabled,.aui-dropdown2-disabled");b(C(t,e,!0))}function _(e){e.length>0&&(p(),e.trigger("aui-button-invoke"))}function k(e){_(C(M.find(".aui-dropdown2-trigger").not(".disabled, .aui-dropdown2-disabled, [aria-disabled=true], .aui-dropdown2-sub-trigger"),e,!1))}function C(e,t,n){var i=e.index(e.filter(".active,.aui-dropdown2-active"));return i+=0>i&&0>t?1:0,i+=t,n?i%=e.length:0>i&&(i=e.length),e.eq(i)}function S(){_(e(this))}function $(){a===L&&(s.unbind(L),a=null)}function T(){a!==L&&(s.unbind(a),s.bind(L),a=L)}function A(e){var t="bind",n="delegate";"on"!==e&&(t="unbind",n="undelegate"),D?N[t]("aui-dropdown2-hide aui-dropdown2-item-selected aui-dropdown2-step-out",f):(M[n](".aui-dropdown2-trigger:not(.active):not(.aui-dropdown2-active)","mousemove",S),j[t]("aui-button-invoke",h)),E[t]("aui-dropdown2-hide-all",p),E[n]("a",O),E[t]("aui-dropdown2-hide",T),E[t]("aui-dropdown2-select-first",w)}u=e.extend({selectFirst:!0},u);var E=o(this),j=e(this).addClass("active aui-dropdown2-active"),D=j.hasClass("aui-dropdown2-sub-trigger"),q=E.parent()[0],P=E.next()[0],I=e(this).attr("data-dropdown2-hide-location");if(I){var R=document.getElementById(I);if(!R)throw new Error("The specified data-dropdown2-hide-location id doesn't exist");q=e(R),P=void 0}var M=u.$menu||j.closest(".aui-dropdown2-trigger-group");if(D){var N=j.closest(".aui-dropdown2");E.addClass(N.attr("class")).addClass("aui-dropdown2-sub-menu")}var O={click:function(n){var i=e(this);m(i)&&(i.hasClass("interactive")||i.hasClass("aui-dropdown2-interactive")||p(),g(i)&&(v(i,{selectFirst:!1}),t(n)))},mousemove:function(){var t=e(this),n=b(t);n&&v(t,{selectFirst:!1})}},L={"click focusin mousedown":function(e){var t=e.target;(document!==t||"focusin"!==e.type)&&(r(t,E[0])||r(t,j[0])||p())},keydown:function(e){var r;if(e.shiftKey&&9==e.keyCode)x(-1);else switch(e.keyCode){case 13:r=y(),g(r)?v(r):i(r[0]);break;case 27:h();break;case 37:if(r=y(),g(r)){var s=o(r);if(n(s))return void E.trigger("aui-dropdown2-step-out")}D?h():k(-1);break;case 38:x(-1);break;case 39:r=y(),g(r)?v(r):k(1);break;case 40:x(1);break;case 9:x(1);break;default:return}t(e)}};j.attr("aria-controls",j.attr("aria-owns")),E.find(".disabled,.aui-dropdown2-disabled").attr("aria-disabled","true"),E.find("li.hidden > a,li.aui-dropdown2-hidden > a").addClass("disabled aui-dropdown2-disabled").attr("aria-disabled","true"),c(E.find(".aui-dropdown2-checkbox"),"checkbox"),c(E.find(".aui-dropdown2-radio"),"radio"),d(),j.hasClass("toolbar-trigger")&&E.addClass("aui-dropdown2-in-toolbar"),j.parent().hasClass("aui-buttons")&&E.addClass("aui-dropdown2-in-buttons"),j.parents().hasClass("aui-header")&&E.addClass("aui-dropdown2-in-header"),E.trigger("aui-dropdown2-show",u),u.selectFirst&&w(),A("on");var H=null},mousedown:function(t){1===t.which&&e(this).bind(c)}},c={mouseleave:function(){s.bind(d)},"mouseup mouseleave":function(){e(this).unbind(c)}},d={mouseup:function(t){var n=e(t.target).closest(".aui-dropdown2 a, .aui-dropdown2-trigger")[0];n&&setTimeout(function(){i(n)},0)},"mouseup mouseleave":function(){e(this).unbind(d)}};s.delegate(".aui-dropdown2-trigger",l),s.delegate(".aui-dropdown2-trigger:not(.active):not(.aui-dropdown2-active):not([aria-disabled=true]),.aui-dropdown2-sub-trigger:not([aria-disabled=true])",u),s.delegate(".aui-dropdown2-checkbox:not(.disabled):not(.aui-dropdown2-disabled)","click",function(){var t=e(this);t.hasClass("checked")||t.hasClass("aui-dropdown2-checked")?(t.removeClass("checked aui-dropdown2-checked").attr("aria-checked","false"),t.trigger("aui-dropdown2-item-uncheck")):(t.addClass("checked aui-dropdown2-checked").attr("aria-checked","true"),t.trigger("aui-dropdown2-item-check"))}),s.delegate(".aui-dropdown2-radio:not(.checked):not(.aui-dropdown2-checked):not(.disabled):not(.aui-dropdown2-disabled)","click",function(){var t=e(this),n=t.closest("ul").find(".checked,.aui-dropdown2-checked");n.removeClass("checked aui-dropdown2-checked").attr("aria-checked","false").trigger("aui-dropdown2-item-uncheck"),t.addClass("checked aui-dropdown2-checked").attr("aria-checked","true").trigger("aui-dropdown2-item-check")}),s.delegate(".aui-dropdown2 a.disabled,.aui-dropdown2 a.aui-dropdown2-disabled","click",function(e){t(e)})}(AJS.$),AJS.inlineHelp=function(){AJS.$(".icon-inline-help").click(function(){var e=AJS.$(this).siblings(".field-help");e.hasClass("hidden")?e.removeClass("hidden"):e.addClass("hidden")})},function(e){function t(t){var n=e(t),i=e.extend({left:0,top:0},n.offset());return{left:i.left,top:i.top,width:n.outerWidth(),height:n.outerHeight()}}function n(e,t,n,i){var r=AJS.$.isFunction(i.offsetX)?i.offsetX(e,t,n,i):i.offsetX,o=AJS.$.isFunction(i.offsetY)?i.offsetY(e,t,n,i):i.offsetY,s=AJS.$.isFunction(i.arrowOffsetX)?i.arrowOffsetX(e,t,n,i):i.arrowOffsetX,a=AJS.$.isFunction(i.arrowOffsetY)?i.arrowOffsetY(e,t,n,i):i.arrowOffsetY,l="body"!==i.container.toLowerCase(),u=AJS.$(i.container),c=l?AJS.$(i.container).parent():AJS.$(window),d=l?u.offset():{left:0,top:0},h=l?c.offset():{left:0,top:0},p=t.target,f=p.offset(),m=p[0].getBBox&&p[0].getBBox();return{screenPadding:10,arrowMargin:5,window:{top:h.top,left:h.left,scrollTop:c.scrollTop(),scrollLeft:c.scrollLeft(),width:c.width(),height:c.height()},scrollContainer:{width:u.width(),height:u.height()},trigger:{top:f.top-d.top,left:f.left-d.left,width:m?m.width:p.outerWidth(),height:m?m.height:p.outerHeight()},dialog:{width:e.width(),height:e.height(),offset:{top:o,left:r}},arrow:{height:e.find(".arrow").outerHeight(),offset:{top:a,left:s}}}}function i(e,t,i,r){var o=n(e,t,i,r),s=o.screenPadding,a=o.window,l=o.trigger,u=o.dialog,c=o.arrow,d=o.scrollContainer,h={top:l.top-a.scrollTop,left:l.left-a.scrollLeft},p=Math.floor(l.height/2),f=Math.floor(u.height/2),m=Math.floor(c.height/2),g=h.left-u.offset.left-s,v=d.width-h.left-l.width-u.offset.left-s,y=g>=u.width,b=v>=u.width,w=!b&&y?"e":"w",x=h.top+p-m,_=a.height-x-c.height;s=Math.min(s,x-o.arrowMargin),s=Math.min(s,_-o.arrowMargin);var k,C,S=h.top+p,$=Math.max(S-s,0),T=Math.max(a.height-S-s,0),A=f-u.offset.top>$,E=f+u.offset.top>T;return A?(k={top:a.scrollTop+s,left:"w"===w?l.left+l.width+u.offset.left:l.left-u.width-u.offset.left},C={top:l.top+p-(k.top+m)}):E?(k={top:a.scrollTop+a.height-u.height-s,left:"w"===w?l.left+l.width+u.offset.left:l.left-u.width-u.offset.left},C={top:l.top+p-(k.top+m)}):(k={top:l.top+p-f+u.offset.top,left:"w"===w?l.left+l.width+u.offset.left:l.left-u.width-u.offset.left},C={top:f-m+c.offset.top}),{gravity:w,popupCss:k,arrowCss:C}}function r(e,n,i,r){var o=AJS.$.isFunction(r.offsetX)?r.offsetX(e,n,i,r):r.offsetX,s=AJS.$.isFunction(r.offsetY)?r.offsetY(e,n,i,r):r.offsetY,a=AJS.$.isFunction(r.arrowOffsetX)?r.arrowOffsetX(e,n,i,r):r.arrowOffsetX,l=(AJS.$.isFunction(r.arrowOffsetY)?r.arrowOffsetY(e,n,i,r):r.arrowOffsetY,t(window)),u=t(n.target),c=t(e),d=t(e.find(".aui-inline-dialog-arrow")),h=u.left+u.width/2,p=(window.pageYOffset||document.documentElement.scrollTop)+l.height,f=10;c.top=u.top+u.height+~~s,c.left=u.left+~~o;var m=l.width-(c.left+c.width+f);d.left=h-c.left+~~a,d.top=-(d.height/2);var g=u.top>c.height,v=c.top+c.height<p,y=!v&&g||g&&"s"===r.gravity;if(y&&(c.top=u.top-c.height-d.height/2,d.top=c.height),r.isRelativeToMouse)0>m?(c.right=f,c.left="auto",d.left=i.x-(l.width-c.width)):(c.left=i.x-20,d.left=i.x-c.left);else if(0>m){c.right=f,c.left="auto";var b=l.width-c.right,w=b-c.width;d.right="auto",d.left=h-w-d.width/2}else c.width<=u.width/2&&(d.left=c.width/2,c.left=h-c.width/2);return{gravity:y?"s":"n",displayAbove:y,popupCss:{left:c.left,top:c.top,right:c.right},arrowCss:{left:d.left,top:d.top,right:d.right}}}AJS.InlineDialog=function(t,n,i,r){if(r=r||[],r.hasOwnProperty("getArrowAttributes")&&a(),r.hasOwnProperty("getArrowPath")&&(l(),r.hasOwnProperty("gravity")&&u()),r.hasOwnProperty("onTop")&&(s(),r.onTop&&void 0===r.gravity&&(r.gravity="s")),"undefined"==typeof n&&(n=String(Math.random()).replace(".",""),e("#inline-dialog-"+n+", #arrow-"+n+", #inline-dialog-shim-"+n).length))throw"GENERATED_IDENTIFIER_NOT_UNIQUE";var c=e.extend(!1,AJS.InlineDialog.opts,r);"w"===c.gravity&&(c.offsetX=void 0===r.offsetX?10:r.offsetX,c.offsetY=void 0===r.offsetY?0:r.offsetY);var d,h,p,f,m,g=function(){return window.Raphael&&r&&(r.getArrowPath||r.getArrowAttributes)},v=!1,y=!1,b=!1,w=e('<div id="inline-dialog-'+n+'" class="aui-inline-dialog"><div class="aui-inline-dialog-contents contents"></div><div id="arrow-'+n+'" class="aui-inline-dialog-arrow arrow"></div></div>'),x=e("#arrow-"+n,w),_=w.find(".contents");g()||w.find(".aui-inline-dialog-arrow").addClass("aui-css-arrow"),c.displayShadow||_.addClass("aui-inline-dialog-no-shadow"),c.autoWidth?_.addClass("aui-inline-dialog-auto-width"):_.width(c.width),_.on({mouseenter:function(){clearTimeout(h),w.unbind("mouseenter")},mouseleave:function(){S()}});var k=function(){return d||(d={popup:w,hide:function(){S(0)},id:n,show:function(){C()},persistent:c.persistent?!0:!1,reset:function(){function t(t,i){if(t.css(i.popupCss),g()){"s"===i.gravity&&(i.arrowCss.top-=e.browser.msie?10:9),t.arrowCanvas||(t.arrowCanvas=Raphael("arrow-"+n,16,16));var r=c.getArrowPath,o=e.isFunction(r)?r(i):r;t.arrowCanvas.path(o).attr(c.getArrowAttributes())}else x.removeClass("aui-bottom-arrow aui-left-arrow aui-right-arrow"),"s"!==i.gravity||x.hasClass("aui-bottom-arrow")?"n"===i.gravity||("w"===i.gravity?x.addClass("aui-left-arrow"):"e"===i.gravity&&x.addClass("aui-right-arrow")):x.addClass("aui-bottom-arrow");x.css(i.arrowCss)}var i=AJS.$(window).height(),r=Math.round(.75*i);w.children(".aui-inline-dialog-contents").css("max-height",r);var s=c.calculatePositions(w,m,f,c);if(s.hasOwnProperty("displayAbove")&&(o(),s.gravity=s.displayAbove?"s":"n"),t(w,s),w.fadeIn(c.fadeTime,function(){}),e.browser.msie&&~~e.browser.version<10){var a=e("#inline-dialog-shim-"+n);a.length||e(w).prepend(e('<iframe class = "inline-dialog-shim" id="inline-dialog-shim-'+n+'" frameBorder="0" src="javascript:false;"></iframe>')),a.css({width:_.outerWidth(),height:_.outerHeight()})}}}),d},C=function(){w.is(":visible")||(p=setTimeout(function(){b&&y&&(c.addActiveClass&&e(t).addClass("active"),v=!0,c.persistent||q(),AJS.InlineDialog.current=k(),e(document).trigger("showLayer",["inlineDialog",k()]),k().reset())},c.showDelay))},S=function(n){"undefined"==typeof n&&c.persistent||"undefined"==typeof w.get(0)._datePickerPopup&&(y=!1,v&&c.preHideCallback.call(w[0].popup)&&(n=null==n?c.hideDelay:n,clearTimeout(h),clearTimeout(p),null!=n&&(h=setTimeout(function(){P(),c.addActiveClass&&e(t).removeClass("active"),w.fadeOut(c.fadeTime,function(){c.hideCallback.call(w[0].popup)}),w.arrowCanvas&&(w.arrowCanvas.remove(),w.arrowCanvas=null),v=!1,y=!1,e(document).trigger("hideLayer",["inlineDialog",k()]),AJS.InlineDialog.current=null,c.cacheContent||(b=!1,T=!1)},n))))},$=function(t,r){var o=e(r);c.upfrontCallback.call({popup:w,hide:function(){S(0)},id:n,show:function(){C()}}),w.each(function(){"undefined"!=typeof this.popup&&this.popup.hide()}),c.closeOthers&&e(".aui-inline-dialog:not(aui-inline-dialog2)").each(function(){!this.popup.persistent&&this.popup.hide()}),m={target:o},f=t?{x:t.pageX,y:t.pageY}:{x:o.offset().left,y:o.offset().top},v||clearTimeout(p),y=!0;var s=function(){T=!1,b=!0,c.initCallback.call({popup:w,hide:function(){S(0)},id:n,show:function(){C()}}),C()};return T||(T=!0,e.isFunction(i)?i(_,r,s):e.get(i,function(e,t,i){_.html(c.responseHandler(e,t,i)),b=!0,c.initCallback.call({popup:w,hide:function(){S(0)},id:n,show:function(){C()}}),C()})),clearTimeout(h),v||C(),!1};w[0].popup=k();var T=!1,A=!1,E=function(){A||(e(c.container).append(w),A=!0)},j=e(t);c.onHover?c.useLiveEvents?j.selector?e(document).on("mouseenter",j.selector,function(e){E(),$(e,this)}).on("mouseleave",j.selector,function(){S()}):AJS.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled."):j.on({mouseenter:function(e){E(),$(e,this)},mouseleave:function(){S()}}):c.noBind||(c.useLiveEvents?j.selector?e(document).on("click",j.selector,function(e){return E(),D()?w.hide():$(e,this),!1}).on("mouseleave",j.selector,function(){S()}):AJS.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled."):j.on("click",function(e){return E(),D()?w.hide():$(e,this),!1}).on("mouseleave",function(){S()}));var D=function(){return v&&c.closeOnTriggerClick},q=function(){M(),L()},P=function(){N(),H()},I=!1,R=n+".inline-dialog-check",M=function(){I||(e("body").bind("click."+R,function(t){var i=e(t.target);0===i.closest("#inline-dialog-"+n+" .contents").length&&S(0)}),I=!0)},N=function(){I&&e("body").unbind("click."+R),I=!1},O=function(e){27===e.keyCode&&S(0)},L=function(){e(document).on("keydown",O)},H=function(){e(document).off("keydown",O)};return w.show=function(e,n){e&&e.stopPropagation(),E(),!c.noBind||t&&t.length?$(e,t):$(e,void 0===n?e.target:n)},w.hide=function(){S(0)},w.refresh=function(){v&&k().reset()},w.getOptions=function(){return c},w},AJS.InlineDialog.opts={onTop:!1,responseHandler:function(e){return e},closeOthers:!0,isRelativeToMouse:!1,addActiveClass:!0,onHover:!1,useLiveEvents:!1,noBind:!1,fadeTime:100,persistent:!1,hideDelay:1e4,showDelay:0,width:300,offsetX:0,offsetY:10,arrowOffsetX:0,arrowOffsetY:0,container:"body",cacheContent:!0,displayShadow:!0,autoWidth:!1,gravity:"n",closeOnTriggerClick:!1,preHideCallback:function(){return!0},hideCallback:function(){},initCallback:function(){},upfrontCallback:function(){},calculatePositions:function(e,t,n,o){o=o||{};var s="w"===o.gravity?i:r;return s(e,t,n,o)},getArrowPath:function(e){return"s"===e.gravity?"M0,8L8,16,16,8":"M0,8L8,0,16,8"},getArrowAttributes:function(){return{fill:"#fff",stroke:"#ccc"}}},AJS.InlineDialog=AJS.deprecate.construct(AJS.InlineDialog,"Inline dialog constructor",{alternativeName:"inline dialog 2"});var o=AJS.deprecate.getMessageLogger("displayAbove","[remove version]",{alternativeName:"gravity",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2197."}),s=AJS.deprecate.getMessageLogger("onTop","[remove version]",{alternativeName:"gravity",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2197."}),a=AJS.deprecate.getMessageLogger("getArrowAttributes","[remove version]",{extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-1362."}),l=AJS.deprecate.getMessageLogger("getArrowPath","[remove version]",{extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-1362."}),u=AJS.deprecate.getMessageLogger("getArrowPath does not support gravity","[remove version]",{extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2197."})}(AJS.$),AJS.template=function(e){"use strict";var t=/\{([^\}]+)\}/g,n=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,i=function(e,t,i,r){var o=i;return t.replace(n,function(e,t,n,i,s){t=t||i,o&&(t+":html"in o?(o=o[t+":html"],r=!0):t in o&&(o=o[t]),s&&"function"==typeof o&&(o=o()))}),(null==o||o==i)&&(o=e),o=String(o),r||(o=a.escape(o)),o},r=function(e){return this.template=this.template.replace(t,function(t,n){return i(t,n,e,!0)}),this},o=function(e){return this.template=this.template.replace(t,function(t,n){return i(t,n,e)}),this},s=function(){return this.template},a=function(e){function t(){return t.template}return t.template=String(e),t.toString=t.valueOf=s,t.fill=o,t.fillHtml=r,t},l={},u=[],c=function(t){return e("script").filter(function(){return this.getAttribute("title")===t})};return a.load=function(e){return e=String(e),l.hasOwnProperty(e)||(u.length>=1e3&&delete l[u.shift()],u.push(e),l[e]=c(e)[0].text),this(l[e])},a.escape=AJS.escapeHtml,a}(AJS.$),function(e,t){"use strict";function n(t){e.messages[t]=function(e,n){n||(n=e,e="#aui-message-bar"),n.closeable=n.closeable!==!1,n.shadowed=n.shadowed!==!1;var o=a(this.template,n,t);return s(o,n.insert,e),n.closeable&&i(o),n.fadeout&&r(o,n.delay,n.duration),o}}function i(e){t(e||"div.aui-message.closeable").each(function(){var e=t(this),n=e.find(".aui-icon.icon-close"),i=n.length>0?n.first():t('<span class="aui-icon icon-close" role="button" tabindex="0"></span>');e.addClass("closeable"),e.append(i),o(e)})}function r(e,n,i){n="undefined"!=typeof n?n:u,i="undefined"!=typeof i?i:l,t(e||"div.aui-message.fadeout").each(function(){function e(){s.stop(!0,!1).delay(n).fadeOut(i,function(){s.closeMessage()})}function r(){s.stop(!0,!1).fadeTo(c,1)}function o(){return!a&&!l}var s=t(this),a=!1,l=!1;s.focusin(function(){a=!0,r()}).focusout(function(){a=!1,o()&&e()}).hover(function(){l=!0,r()},function(){l=!1,o()&&e()}),e()})}function o(e){e.on("click",".aui-icon.icon-close",function(e){t(e.target).closest(".aui-message").closeMessage()}).on("keydown",".aui-icon.icon-close",function(e){(e.which===AJS.keyCode.ENTER||e.which===AJS.keyCode.SPACE)&&(t(e.target).closest(".aui-message").closeMessage(),e.preventDefault())})}function s(e,t,n){"prepend"===t?e.prependTo(n):e.appendTo(n)}function a(e,n,i){var r=t(AJS.template(e).fill({type:i,closeable:n.closeable?"closeable":"",shadowed:n.shadowed?"shadowed":"",fadeout:n.fadeout?"fadeout":"",title:n.title||"","body:html":n.body||""}).toString());return n.id&&(/[#\'\"\.\s]/g.test(n.id)?AJS.log("AJS.Messages error: ID rejected, must not include spaces, hashes, dots or quotes."):r.attr("id",n.id)),r}var l=500,u=5e3,c=100,d='<div class="aui-message aui-message-{type} {type} {closeable} {shadowed} {fadeout}"><p class="title"><strong>{title}</strong></p>{body}<!-- .aui-message --></div>';e.messages={setup:function(){n("generic"),n("error"),n("warning"),n("info"),n("success"),n("hint"),i(),r()},makeCloseable:i,makeFadeout:r,template:d,createMessage:n},t.fn.closeMessage=function(){var e=t(this);e.hasClass("aui-message")&&e.hasClass("closeable")&&(e.stop(!0),e.trigger("messageClose",[this]).remove(),t(document).trigger("aui-message-close",[this]))},t(function(){e.messages.setup()}),AJS.deprecate.prop(e.messages,"makeCloseable",{extraInfo:'Use the "closeable" option in the constructor instead. Docs: https://docs.atlassian.com/aui/latest/docs/messages.html'}),AJS.deprecate.prop(e.messages,"createMessage",{extraInfo:"Use the provided convenience methods instead e.g. AJS.messages.generic(). Docs: https://docs.atlassian.com/aui/latest/docs/messages.html"}),AJS.deprecate.prop(e.messages,"makeFadeout",{extraInfo:'Use the "fadeout" option in the constructor instead. Docs: https://docs.atlassian.com/aui/latest/docs/messages.html'})}(AJS,AJS.$),function(e){"use strict";function t(){var t=e(this);AJS._addID(t),t.attr("role","tab");var n=t.attr("href");e(n).attr("aria-labelledby",t.attr("id")),t.parent().hasClass("active-tab")?t.attr("aria-selected","true"):t.attr("aria-selected","false")}function n(t,n){var i=e(t),r=i.find(".tabs-menu").first(),o=r.find("li:not(.aui-tabs-responsive-trigger-item)"),s=r.find(".aui-tabs-responsive-trigger").parent(),a=s.find("a"),u=a.attr("aria-owns"),c=e(document).find("#"+u).attr("aria-checked",!1),d=c.length>0,h=p.totalTabsWidth(o,c),f=h>i.outerWidth();if(!d&&f&&(s=p.createResponsiveDropdownTrigger(r,n),c=p.createResponsiveDropdown(i,n)),a.attr("aria-owns","aui-tabs-responsive-dropdown-"+n),a.attr("id","aui-tabs-responsive-trigger-"+n),a.attr("href","aui-tabs-responsive-trigger-"+n),c.attr("id","aui-tabs-responsive-dropdown-"+n),f){var m=p.processVisibleTabs(o.toArray(),i,s),g=p.totalVisibleTabWidth(m),v=i.outerWidth()-g-s.outerWidth(!0),y=v>0;if(y){var b=c.find("li");p.processInvisibleTabs(b.toArray(),v,s)}c.on("click","a",l)}d&&!f&&(c.find("li").each(function(){p.moveTabOutOfDropdown(e(this),s)}),p.removeResponsiveDropdown(c,s))}function i(t){if(!t.hasClass("aui-tabs-responsive-trigger")){var n=e(t.attr("href").match(c)[0]);n.addClass("active-pane").attr("aria-hidden","false").siblings(".tabs-pane").removeClass("active-pane").attr("aria-hidden","true");var i=t.parents(".aui-tabs").find(".aui-tabs-responsive-trigger-item a"),r=i.attr("aria-owns"),o=e(document).find("#"+r);if(o.find("li a").attr("aria-checked",!1).removeClass("checked aui-dropdown2-checked"),o.find("li").removeClass("active-tab"),t.parent("li.menu-item").addClass("active-tab").siblings(".menu-item").removeClass("active-tab"),t.hasClass("aui-tabs-responsive-item")){var s=n.parent(".aui-tabs").find("li.menu-item:not(.aui-tabs-responsive-trigger-item)");s.removeClass("active-tab"),s.find("a").removeClass("checked").removeAttr("aria-checked")}t.hasClass("aui-tabs-responsive-item")&&n.parent(".aui-tabs").find("li.menu-item.aui-tabs-responsive-trigger-item").addClass("active-tab"),t.closest(".tabs-menu").find("a").attr("aria-selected","false"),t.attr("aria-selected","true"),t.trigger("tabSelect",{tab:t,pane:n})}}function r(e){return void 0!==e.attr("data-aui-persist")&&"false"!==e.attr("data-aui-persist")}function o(e){var t=e.attr("id"),n=e.attr("data-aui-persist");return d+(t?t:"")+(n&&"true"!==n?"-"+n:"")}function s(e){for(var t=0,n=e.length;n>t;t++){var s=e.eq(t);if(r(s)&&window.localStorage){var a=s.attr("id");if(a){var l=window.localStorage.getItem(o(s));if(l){var u=s.find("#"+l);u.length&&i(u)}}else AJS.warn("A tab group must specify an id attribute if it specifies data-aui-persist")}}}function a(e){var t=e.closest(".aui-tabs"),n=t.attr("id");if(n){var i=e.attr("id");i&&window.localStorage.setItem(o(t),i)}else AJS.warn("A tab group must specify an id attribute if it specifies data-aui-persist")}function l(t){AJS.tabs.change(e(this),t),t&&t.preventDefault()}function u(e){e.forEach(function(e,t){n(e,t)})}var c=/#.*/,d="_internal-aui-tabs-",h='.aui-tabs.horizontal-tabs[data-aui-responsive]:not([data-aui-responsive="false"])',p={totalTabsWidth:function(e,t){var n=this.totalVisibleTabWidth(e),i=0;return t.find("li").each(function(e,t){i+=parseInt(t.getAttribute("data-aui-tab-width"))}),n+i},totalVisibleTabWidth:function(t){var n=0;return t.each(function(t,i){n+=e(i).outerWidth()}),n},removeResponsiveDropdown:function(e,t){e.remove(),t.remove()},createResponsiveDropdownTrigger:function(e,t){var n='<li class="menu-item aui-tabs-responsive-trigger-item"><a class="aui-dropdown2-trigger aui-tabs-responsive-trigger aui-dropdown2-trigger-arrowless" id="aui-tabs-responsive-trigger-'+t+'" aria-haspopup="true" aria-owns="aui-tabs-responsive-dropdown-'+t+'" href="aui-tabs-responsive-dropdown-'+t+'">...</a></li>';e.append(n);var i=e.find(".aui-tabs-responsive-trigger-item");return i},createResponsiveDropdown:function(e,t){var n='<div class="aui-dropdown2 aui-style-default aui-tabs-responsive-dropdown" id="aui-tabs-responsive-dropdown-'+t+'"><ul></ul></div>';e.append(n);var i=e.find("#aui-tabs-responsive-dropdown-"+t);return i},findNewVisibleTabs:function(t,n,i){function r(e,t,n){return n>=e+t}for(var o=0,s=0;r(o,i,n)&&s<t.length;s++){var a=e(t[s]),l=a.outerWidth(!0);o+=l}return t.slice(0,s-1)},processVisibleTabs:function(t,n,i){for(var r=i.find("a").attr("aria-owns"),o=e("#"+r),s=this.findNewVisibleTabs(t,n.outerWidth(),i.parent().outerWidth(!0)),a=s.length-1,l=t.length-1;l>=a;l--){var u=e(t[l]);this.moveTabToResponsiveDropdown(u,o,i)}return e(s)},moveTabToResponsiveDropdown:function(e,t,n){var i=e.find("a");e.attr("data-aui-tab-width",e.outerWidth(!0)),i.addClass("aui-dropdown2-radio aui-tabs-responsive-item"),e.hasClass("active-tab")&&(i.addClass("aui-dropdown2-checked"),n.addClass("active-tab")),t.find("ul").prepend(e)},processInvisibleTabs:function(t,n,i){function r(e){return e>0}for(var o=0;r(n)&&o<t.length;o++){var s=e(t[o]),a=parseInt(s.attr("data-aui-tab-width"),10),l=n>a;l&&this.moveTabOutOfDropdown(s,i),n-=a}},moveTabOutOfDropdown:function(e,t){var n=e.find("a").hasClass("aui-dropdown2-checked");n&&(e.addClass("active-tab"),t.removeClass("active-tab")),e.children("a").removeClass("aui-dropdown2-radio aui-tabs-responsive-item aui-dropdown2-checked"),t.before(e)}};AJS.tabs={setup:function(){var n=e(".aui-tabs:not(.aui-tabs-disabled)"),i=e(h).toArray();u(i);var r=AJS.debounce(u,200);e(window).resize(function(){r(i)}),n.attr("role","application"),n.find(".tabs-pane").each(function(){var t=e(this);t.attr("role","tabpanel"),t.hasClass("active-pane")?t.attr("aria-hidden","false"):t.attr("aria-hidden","true")});for(var o=0,a=n.length;a>o;o++){var c=n.eq(o);if(!c.data("aui-tab-events-bound")){var d=c.children("ul.tabs-menu");d.attr("role","tablist"),d.children("li").attr("role","presentation"),d.find("> .menu-item a").each(t),d.delegate("a","click",l),c.data("aui-tab-events-bound",!0)}}s(n),e(".aui-tabs.vertical-tabs").find("a").each(function(){var t=e(this);t.attr("title")||AJS.isClipped(t)&&t.attr("title",t.text())})},change:function(e){i(e);var t=e.closest(".aui-tabs");r(t)&&window.localStorage&&a(e)}},e(AJS.tabs.setup)}(AJS.$),function(){var _after=1,_afterThrow=2,_afterFinally=3,_before=4,_around=5,_intro=6,_regexEnabled=!0,_arguments="arguments",_undef="undefined",getType=function(){for(var e=Object.prototype.toString,t={},n={1:"element",3:"textnode",9:"document",11:"fragment"},i="Arguments Array Boolean Date Document Element Error Fragment Function NodeList Null Number Object RegExp String TextNode Undefined Window".split(" "),r=i.length;r--;){var o=i[r],s=window[o];if(s)try{t[e.call(new s)]=o.toLowerCase()}catch(a){}}return function(i){return null==i&&(void 0===i?_undef:"null")||i.nodeType&&n[i.nodeType]||"number"==typeof i.length&&(i.callee&&_arguments||i.alert&&"window"||i.item&&"nodelist")||t[e.call(i)]}}(),isFunc=function(e){return"function"==getType(e)},weaveOne=function(source,method,advice){var old=source[method];if(advice.type!=_intro&&!isFunc(old)){var oldObject=old;old=function(){for(var code=arguments.length>0?_arguments+"[0]":"",i=1;i<arguments.length;i++)code+=","+_arguments+"["+i+"]";
return eval("oldObject("+code+");")}}var aspect;return advice.type==_after||advice.type==_afterThrow||advice.type==_afterFinally?aspect=function(){var e,t=null;try{e=old.apply(this,arguments)}catch(n){t=n}if(advice.type==_after){if(null!=t)throw t;e=advice.value.apply(this,[e,method])}else advice.type==_afterThrow&&null!=t?e=advice.value.apply(this,[t,method]):advice.type==_afterFinally&&(e=advice.value.apply(this,[e,t,method]));return e}:advice.type==_before?aspect=function(){return advice.value.apply(this,[arguments,method]),old.apply(this,arguments)}:advice.type==_intro?aspect=function(){return advice.value.apply(this,arguments)}:advice.type==_around&&(aspect=function(){var e={object:this,args:Array.prototype.slice.call(arguments)};return advice.value.apply(e.object,[{arguments:e.args,method:method,proceed:function(){return old.apply(e.object,e.args)}}])}),aspect.unweave=function(){source[method]=old,pointcut=source=aspect=old=null},source[method]=aspect,aspect},search=function(e,t,n){var i=[];for(var r in e){var o=null;try{o=e[r]}catch(s){}null!=o&&r.match(t.method)&&isFunc(o)&&(i[i.length]={source:e,method:r,advice:n})}return i},weave=function(e,t){var n=typeof e.target.prototype!=_undef?e.target.prototype:e.target,i=[];if(t.type!=_intro&&typeof n[e.method]==_undef){var r=search(e.target,e,t);0==r.length&&(r=search(n,e,t));for(var o in r)i[i.length]=weaveOne(r[o].source,r[o].method,r[o].advice)}else i[0]=weaveOne(n,e.method,t);return _regexEnabled?i:i[0]};jQuery.aop={after:function(e,t){return weave(e,{type:_after,value:t})},afterThrow:function(e,t){return weave(e,{type:_afterThrow,value:t})},afterFinally:function(e,t){return weave(e,{type:_afterFinally,value:t})},before:function(e,t){return weave(e,{type:_before,value:t})},around:function(e,t){return weave(e,{type:_around,value:t})},introduction:function(e,t){return weave(e,{type:_intro,value:t})},setup:function(e){_regexEnabled=e.regexMatch}}}(),AJS.dropDown=function(e,t){var n=null,i=[],r=!1,o=AJS.$(document),s={item:"li:has(a)",activeClass:"active",alignment:"right",displayHandler:function(e){return e.name},escapeHandler:function(){return this.hide("escape"),!1},hideHandler:function(){},moveHandler:function(){},useDisabled:!1};if(AJS.$.extend(s,t),s.alignment={left:"left",right:"right"}[s.alignment.toLowerCase()]||"left",e&&e.jquery)n=e;else if("string"==typeof e)n=AJS.$(e);else{if(!e||e.constructor!=Array)throw new Error("AJS.dropDown function was called with illegal parameter. Should be AJS.$ object, AJS.$ selector or array.");n=AJS("div").addClass("aui-dropdown").toggleClass("hidden",!!s.isHiddenByDefault);for(var a=0,l=e.length;l>a;a++){for(var u=AJS("ol"),c=0,d=e[a].length;d>c;c++){var h=AJS("li"),p=e[a][c];p.href?(h.append(AJS("a").html("<span>"+s.displayHandler(p)+"</span>").attr({href:p.href}).addClass(p.className)),AJS.$.data(AJS.$("a > span",h)[0],"properties",p)):h.html(p.html).addClass(p.className),p.icon&&h.prepend(AJS("img").attr("src",p.icon)),p.insideSpanIcon&&h.children("a").prepend(AJS("span").attr("class","icon")),AJS.$.data(h[0],"properties",p),u.append(h)}a==l-1&&u.addClass("last"),n.append(u)}AJS.$("body").append(n)}var f=function(){g(1)},m=function(){g(-1)},g=function(e){var t=!r,n=AJS.dropDown.current.$[0],i=AJS.dropDown.current.links,o=n.focused;if(r=!0,0!==i.length){if(n.focused="number"==typeof o?o:-1,!AJS.dropDown.current)return AJS.log("move - not current, aborting"),!0;n.focused+=e,n.focused<0?n.focused=i.length-1:n.focused>=i.length&&(n.focused=0),s.moveHandler(AJS.$(i[n.focused]),0>e?"up":"down"),t&&i.length?(AJS.$(i[n.focused]).addClass(s.activeClass),r=!1):i.length||(r=!1)}},v=function(e){if(!AJS.dropDown.current)return!0;var t=e.which,n=AJS.dropDown.current.$[0],i=AJS.dropDown.current.links;switch(AJS.dropDown.current.cleanActive(),t){case 40:f();break;case 38:m();break;case 27:return s.escapeHandler.call(AJS.dropDown.current,e);case 13:return n.focused>=0?s.selectionHandler?s.selectionHandler.call(AJS.dropDown.current,e,AJS.$(i[n.focused])):"a"!=AJS.$(i[n.focused]).attr("nodeName")?AJS.$("a",i[n.focused]).trigger("focus"):AJS.$(i[n.focused]).trigger("focus"):!0;default:return i.length&&AJS.$(i[n.focused]).addClass(s.activeClass),!0}return e.stopPropagation(),e.preventDefault(),!1},y=function(e){e&&e.which&&3==e.which||e&&e.button&&2==e.button||AJS.dropDown.current&&AJS.dropDown.current.hide("click")},b=function(e){return function(){AJS.dropDown.current&&(AJS.dropDown.current.cleanFocus(),this.originalClass=this.className,AJS.$(this).addClass(s.activeClass),AJS.dropDown.current.$[0].focused=e)}},w=function(e){return e.button||e.metaKey||e.ctrlKey||e.shiftKey?!0:void(AJS.dropDown.current&&s.selectionHandler&&s.selectionHandler.call(AJS.dropDown.current,e,AJS.$(this)))},x=function(e){var t=!1;return e.data("events")&&AJS.$.each(e.data("events"),function(e,n){AJS.$.each(n,function(e,n){return w===n?(t=!0,!1):void 0})}),t};return n.each(function(){var e=this,t=AJS.$(this),n={},r={reset:function(){n=AJS.$.extend(n,{$:t,links:AJS.$(s.item||"li:has(a)",e),cleanActive:function(){e.focused+1&&n.links.length&&AJS.$(n.links[e.focused]).removeClass(s.activeClass)},cleanFocus:function(){n.cleanActive(),e.focused=-1},moveDown:f,moveUp:m,moveFocus:v,getFocusIndex:function(){return"number"==typeof e.focused?e.focused:-1}}),n.links.each(function(e){var t=AJS.$(this);x(t)||(t.hover(b(e),n.cleanFocus),t.click(w))})},appear:function(e){e?(t.removeClass("hidden"),t.addClass("aui-dropdown-"+s.alignment)):t.addClass("hidden")},fade:function(e){e?t.fadeIn("fast"):t.fadeOut("fast")},scroll:function(e){e?t.slideDown("fast"):t.slideUp("fast")}};n.reset=r.reset,n.reset(),n.addControlProcess=function(e,t){AJS.$.aop.around({target:this,method:e},t)},n.addCallback=function(e,t){return AJS.$.aop.after({target:this,method:e},t)},n.show=function(t){s.useDisabled&&this.$.closest(".aui-dd-parent").hasClass("disabled")||(this.alignment=s.alignment,y(),AJS.dropDown.current=this,this.method=t||this.method||"appear",this.timer=setTimeout(function(){o.click(y)},0),o.keydown(v),s.firstSelected&&this.links[0]&&b(0).call(this.links[0]),AJS.$(e.offsetParent).css({zIndex:2e3}),r[this.method](!0),AJS.$(document).trigger("showLayer",["dropdown",AJS.dropDown.current]))},n.hide=function(e){return this.method=this.method||"appear",AJS.$(t.get(0).offsetParent).css({zIndex:""}),this.cleanFocus(),r[this.method](!1),o.unbind("click",y).unbind("keydown",v),AJS.$(document).trigger("hideLayer",["dropdown",AJS.dropDown.current]),AJS.dropDown.current=null,e},n.addCallback("reset",function(){s.firstSelected&&this.links[0]&&b(0).call(this.links[0])}),AJS.dropDown.iframes||(AJS.dropDown.iframes=[]),AJS.dropDown.createShims=function(){return AJS.$("iframe").each(function(){var e=this;e.shim||(e.shim=AJS.$("<div />").addClass("shim hidden").appendTo("body"),AJS.dropDown.iframes.push(e))}),arguments.callee}(),n.addCallback("show",function(){AJS.$(AJS.dropDown.iframes).each(function(){var e=AJS.$(this);if(e.is(":visible")){var t=e.offset();t.height=e.height(),t.width=e.width(),this.shim.css({left:t.left+"px",top:t.top+"px",height:t.height+"px",width:t.width+"px"}).removeClass("hidden")}})}),n.addCallback("hide",function(){AJS.$(AJS.dropDown.iframes).each(function(){this.shim.addClass("hidden")}),s.hideHandler()}),i.push(n)}),i},AJS.dropDown.getAdditionalPropertyValue=function(e,t){var n=e[0];n&&"string"==typeof n.tagName&&"li"==n.tagName.toLowerCase()||AJS.log("AJS.dropDown.getAdditionalPropertyValue : item passed in should be an LI element wrapped by jQuery");var i=AJS.$.data(n,"properties");return i?i[t]:null},AJS.dropDown.removeAllAdditionalProperties=function(){},AJS.dropDown.Standard=function(e){var t,n=[],i={selector:".aui-dd-parent",dropDown:".aui-dropdown",trigger:".aui-dd-trigger"};AJS.$.extend(i,e);var r=function(e,t,n,r){AJS.$.extend(r,{trigger:e}),t.addClass("dd-allocated"),n.addClass("hidden"),0==i.isHiddenByDefault&&r.show(),r.addCallback("show",function(){t.addClass("active")}),r.addCallback("hide",function(){t.removeClass("active")})},o=function(e,t,n,i){i!=AJS.dropDown.current&&(n.css({top:t.outerHeight()}),i.show(),e.stopImmediatePropagation()),e.preventDefault()};if(i.useLiveEvents){var s=[],a=[];AJS.$(i.trigger).live("click",function(e){var t,n,l,u,c=AJS.$(this);if((u=AJS.$.inArray(this,s))>=0){var d=a[u];t=d.parent,n=d.dropdown,l=d.ddcontrol}else{if(t=c.closest(i.selector),n=t.find(i.dropDown),0===n.length)return;if(l=AJS.dropDown(n,i)[0],!l)return;s.push(this),d={parent:t,dropdown:n,ddcontrol:l},r(c,t,n,l),a.push(d)}o(e,c,n,l)})}else t=this instanceof AJS.$?this:AJS.$(i.selector),t=t.not(".dd-allocated").filter(":has("+i.dropDown+")").filter(":has("+i.trigger+")"),t.each(function(){var e=AJS.$(this),t=AJS.$(i.dropDown,this),s=AJS.$(i.trigger,this),a=AJS.dropDown(t,i)[0];AJS.$.extend(a,{trigger:s}),r(s,e,t,a),s.click(function(e){o(e,s,t,a)}),n.push(a)});return n},AJS.dropDown.Ajax=function(e){var t,n={cache:!0};return AJS.$.extend(n,e||{}),t=AJS.dropDown.Standard.call(this,n),AJS.$(t).each(function(){var e=this;AJS.$.extend(e,{getAjaxOptions:function(t){var i=function(t){n.formatResults&&(t=n.formatResults(t)),n.cache&&e.cache.set(e.getAjaxOptions(),t),e.refreshSuccess(t)};return n.ajaxOptions?AJS.$.isFunction(n.ajaxOptions)?AJS.$.extend(n.ajaxOptions.call(e),{success:i}):AJS.$.extend(n.ajaxOptions,{success:i}):AJS.$.extend(t,{success:i})},refreshSuccess:function(e){this.$.html(e)},cache:function(){var e={};return{get:function(t){var n=t.data||"";return e[(t.url+n).replace(/[\?\&]/gi,"")]},set:function(t,n){var i=t.data||"";e[(t.url+i).replace(/[\?\&]/gi,"")]=n},reset:function(){e={}}}}(),show:function(t){return function(){n.cache&&e.cache.get(e.getAjaxOptions())?(e.refreshSuccess(e.cache.get(e.getAjaxOptions())),t.call(e)):(AJS.$(AJS.$.ajax(e.getAjaxOptions())).throbber({target:e.$,end:function(){e.reset()}}),t.call(e),e.iframeShim&&e.iframeShim.hide())}}(e.show),resetCache:function(){e.cache.reset()}}),e.addCallback("refreshSuccess",function(){e.reset()})}),t},AJS.$.fn.dropDown=function(e,t){return e=(e||"Standard").replace(/^([a-z])/,function(e){return e.toUpperCase()}),AJS.dropDown[e].call(this,t)},AJS.$.fn.dropDown=AJS.deprecate.construct(AJS.$.fn.dropDown,"Dropdown constructor",{alternativeName:"Dropdown2"}),function(e){function t(e){this.num=0,this.timer=e>0?e:!1}function n(n){if(e.isPlainObject(n.data)||e.isArray(n.data)||"string"==typeof n.data){var r=n.handler,o={timer:700};!function(t){"string"==typeof t?o.combo=[t]:e.isArray(t)?o.combo=t:e.extend(o,t),o.combo=e.map(o.combo,function(e){return e.toLowerCase()})}(n.data),n.index=new t(o.timer),n.handler=function(t){if(this===t.target||!/textarea|select|input/i.test(t.target.nodeName)){var s="keypress"!==t.type?e.hotkeys.specialKeys[t.which]:null,a=String.fromCharCode(t.which).toLowerCase(),l="",u={};t.altKey&&"alt"!==s&&(l+="alt+"),t.ctrlKey&&"ctrl"!==s&&(l+="ctrl+"),t.metaKey&&!t.ctrlKey&&"meta"!==s&&(l+="meta+"),t.shiftKey&&"shift"!==s&&(l+="shift+"),t.metaKey&&"["===a&&(a=null),s&&(u[l+s]=!0),a&&(u[l+a]=!0),/shift+/.test(l)&&(u[l.replace("shift+","")+e.hotkeys.shiftNums[s||a]]=!0);var c=n.index,d=o.combo;if(i(d[c.val()],u)){if(c.val()===d.length-1)return c.reset(),r.apply(this,arguments);c.inc()}else c.reset(),i(d[0],u)&&c.inc()}}}}function i(e,t){for(var n=e.split(" "),i=0,r=n.length;r>i;i++)if(t[n[i]])return!0;return!1}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",91:"meta",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta",219:"[",221:"]"},keypressKeys:["<",">","?"],shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(e.hotkeys.keypressKeys,function(t,n){e.hotkeys.shiftNums[n]=n}),t.prototype.val=function(){return this.num},t.prototype.inc=function(){this.timer&&(clearTimeout(this.timeout),this.timeout=setTimeout(e.proxy(t.prototype.reset,this),this.timer)),this.num++},t.prototype.reset=function(){this.timer&&clearTimeout(this.timeout),this.num=0},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:n}})}(jQuery),function(e,t){"use strict";var n=-1!==navigator.platform.indexOf("Mac"),i=/^(backspace|tab|r(ight|eturn)|s(hift|pace|croll)|c(trl|apslock)|alt|pa(use|ge(up|down))|e(sc|nd)|home|left|up|d(el|own)|insert|f\d\d?|numlock|meta)/i;e.whenIType=function(r){function o(e){!AJS.popup.current&&m&&m.fire(e)}function s(e){e.preventDefault()}function a(e){var n=e&&e.split?t.trim(e).split(" "):[e];n.forEach(function(e){u(e)})}function l(e){for(var t=e.length;t--;)if(e[t].length>1&&"space"!==e[t])return!0;return!1}function u(e){var n=e instanceof Array?e:c(e.toString()),i=l(n)?"keydown":"keypress";f.push(n),t(document).bind(i,n,o),t(document).bind(i+" keyup",n,s)}function c(e){for(var t=[],n="";e.length;){var r=e.match(/^(ctrl|meta|shift|alt)\+/i),o=e.match(i);r?(n+=r[0],e=e.substring(r[0].length)):o?(t.push(n+o[0]),e=e.substring(o[0].length),n=""):(t.push(n+e[0]),e=e.substring(1),n="")}return t}function d(e){for(var i=t(e),r=i.attr("title")||"",o=f.slice(),s=i.data("kbShortcutAppended")||"",a=!s,l=a?r:r.substring(0,r.length-s.length);o.length;)s=p(o.shift().slice(),s,a),a=!1;n&&(s=s.replace(/Meta/gi,"").replace(/Shift/gi,"")),i.attr("title",l+s),i.data("kbShortcutAppended",s)}function h(e){var n=t(e),i=n.data("kbShortcutAppended");if(i){var r=n.attr("title");n.attr("title",r.replace(i,"")),n.removeData("kbShortcutAppended")}}function p(e,t,n){return n?t+=" ("+AJS.I18n.getText("aui.keyboard.shortcut.type.x",e.shift()):(t=t.replace(/\)$/,""),t+=AJS.I18n.getText("aui.keyboard.shortcut.or.x",e.shift())),e.forEach(function(e){t+=" "+AJS.I18n.getText("aui.keyboard.shortcut.then.x",e)}),t+=")"}var f=[],m=t.Callbacks();return a(r),e.whenIType.makeShortcut({executor:m,bindKeys:a,addShortcutsToTitle:d,removeShortcutsFromTitle:h,keypressHandler:o,defaultPreventionHandler:s})},e.whenIType.makeShortcut=function(e){function n(e){return function(n,r){r=r||{};var o=r.focusedClass||"focused",s=r.hasOwnProperty("wrapAround")?r.wrapAround:!0,a=r.hasOwnProperty("escToCancel")?r.escToCancel:!0;return i.add(function(){var i=t(n),r=i.filter("."+o),l=0===r.length?void 0:{transition:!0};a&&t(document).one("keydown",function(e){e.keyCode===AJS.keyCode.ESCAPE&&r&&r.removeClass(o)}),r.length&&r.removeClass(o),r=e(r,i,s),r&&r.length>0&&(r.addClass(o),r.moveTo(l),r.is("a")?r.focus():r.find("a:first").focus())}),this}}var i=e.executor,r=e.bindKeys,o=e.addShortcutsToTitle,s=e.removeShortcutsFromTitle,a=e.keypressHandler,l=e.defaultPreventionHandler,u=[];return{moveToNextItem:n(function(e,n,i){var r;return i&&0===e.length?n.eq(0):(r=t.inArray(e.get(0),n),r<n.length-1?(r+=1,n.eq(r)):i?n.eq(0):e)}),moveToPrevItem:n(function(e,n,i){var r;return i&&0===e.length?n.filter(":last"):(r=t.inArray(e.get(0),n),r>0?(r-=1,n.eq(r)):i?n.filter(":last"):e)}),click:function(e){return u.push(e),o(e),i.add(function(){var n=t(e);n.length>0&&n.click()}),this},goTo:function(e){return i.add(function(){window.location.href=e}),this},followLink:function(e){return u.push(e),o(e),i.add(function(){var n=t(e)[0];n&&{a:!0,link:!0}[n.nodeName.toLowerCase()]&&(window.location.href=n.href)}),this},execute:function(e){var t=this;return i.add(function(){e.apply(t,arguments)}),this},evaluate:function(e){e.call(this)},moveToAndClick:function(e){return u.push(e),o(e),i.add(function(){var n=t(e);n.length>0&&(n.click(),n.moveTo())}),this},moveToAndFocus:function(e){return u.push(e),o(e),i.add(function(t){var n=AJS.$(e);n.length>0&&(n.focus(),n.moveTo&&n.moveTo(),n.is(":input")&&t.preventDefault())}),this},or:function(e){return r(e),this},unbind:function(){t(document).unbind("keydown keypress",a).unbind("keydown keypress keyup",l);for(var e=0,n=u.length;n>e;e++)s(u[e]);u=[]}}},e.whenIType.fromJSON=function(e,i){var r=[];return e&&t.each(e,function(e,o){var s,a=o.op,l=o.param;if("execute"===a||"evaluate"===a)s=[new Function(l)];else if(/^\[[^\]\[]*,[^\]\[]*\]$/.test(l)){try{s=JSON.parse(l)}catch(u){AJS.error("When using a parameter array, array must be in strict JSON format: "+l)}t.isArray(s)||AJS.error("Badly formatted shortcut parameter. String or JSON Array of parameters required: "+l)}else s=[l];t.each(o.keys,function(){var e=this;i&&n&&(e=t.map(e,function(e){return e.replace(/ctrl/i,"meta")}));var o=AJS.whenIType(e);o[a].apply(o,s),r.push(o)})}),r},t(document).bind("iframeAppended",function(e,n){t(n).load(function(){var e=t(n).contents();e.bind("keyup keydown keypress",function(e){t.browser.safari&&"keypress"===e.type||t(e.target).is(":input")||t.event.trigger(e,arguments,document,!0)})})})}(AJS,AJS.$),function(e){AJS.responsiveheader={},AJS.responsiveheader.setup=function(){function t(t,n){function i(e){var t;if(r(),!(p>f)){c.show(),t=p-g;for(var n=0;t>=0;n++)t-=h[n].itemWidth;return n-=1,a(n,e),s(n,d,e),n}l(e)}function r(){var e=0!==u.length?u.offset().left:t.width(),n=m.offset().left+m.outerWidth(!0)+y;p=e-n}function o(t){var n=e("<li>"+aui.dropdown2.trigger({menu:{id:"aui-responsive-header-dropdown-content-"+t},text:AJS.I18n.getText("aui.words.more"),extraAttributes:{href:"#"},id:"aui-responsive-header-dropdown-trigger-"+t})+"</li>");n.append(aui.dropdown2.contents({id:"aui-responsive-header-dropdown-content-"+t,extraClasses:"aui-style-default",content:aui.dropdown2.section({content:"<ul id='aui-responsive-header-dropdown-list-"+t+"'></ul>"})})),0===y?n.appendTo(v(".aui-nav")):n.insertBefore(v(".aui-nav > li > .aui-button").first().parent()),c=n,skate.init(c),g=c.outerWidth(!0)}function s(t,n,i){if(!(0>t||0>n||t===n)){var r,o,s=e("#aui-responsive-header-dropdown-trigger-"+i),a=s.parent();s.hasClass("active")&&s.trigger("aui-button-invoke");for(var l=v(".aui-nav > li > a:not(.aui-button):not(#aui-responsive-header-dropdown-trigger-"+i+")").length;t>n;)r=h[n],r&&r.itemElement&&(o=r.itemElement,0===l?o.prependTo(v(".aui-nav")):o.insertBefore(a),o.children("a").removeClass("aui-dropdown2-sub-trigger active"),n+=1,l+=1)}}function a(t,n){if(!(0>t))for(var i=e("#aui-responsive-header-dropdown-list-"+n),r=t;r<h.length;r++){h[r].itemElement.appendTo(i);var o=h[r].itemElement.children("a");o.hasClass("aui-dropdown2-trigger")&&o.addClass("aui-dropdown2-sub-trigger")}}function l(e){c.hide(),s(h.length,d,e)}var u=t.find(".aui-header-secondary .aui-nav").first();e(".aui-header").attr("data-aui-responsive","true");var c,d,h=[],p=0,f=0,m=t.find("#logo"),g=0,v=function(){var e=t.find(".aui-header-primary").first();return function(t){return e.find(t)}}(),y=0;v(".aui-button").parent().each(function(t,n){y+=e(n).outerWidth(!0)}),v(".aui-nav > li > a:not(.aui-button)").each(function(t,n){var i=e(n).parent(),r=i.outerWidth(!0);h.push({itemElement:i,itemWidth:r}),f+=r}),d=h.length,e(window).resize(function(){d=i(n)}),o(n);var b=m.find("img");0!==b.length&&(b.attr("data-aui-responsive-header-index",n),b.load(function(){d=i(n)})),d=i(n),v(".aui-nav").css("width","auto")}var n=e(".aui-header");n.length&&n.each(function(n,i){t(e(i),n)})}}(AJS.$),AJS.$(AJS.responsiveheader.setup),function(e,t){e.FancyFileInput=t(jQuery),"function"==typeof define&&define("aui/internal/fancy-file-input",[],function(){return e.FancyFileInput})}(this,function(e){"use strict";function t(n,i){var r=e(n).data("FancyFileInput");return r?r:(i=e.extend({},t.defaults,i),this.el=n,this.$el=e(n),this.$label=this.createLabel(i.buttonText),this._addLabelText(),this.$clearButton=e("<button>",{text:this.$label.attr("data-ffi-clearButtonText")||i.clearButtonText,"class":"ffi-clear",type:"button",tabindex:"-1"}),this.multipleFileTextPattern=this.$label.attr("data-ffi-multipleFileTextPattern")||i.multipleFileTextPattern,this._eventNamespace=".ffi",this.CLASSES={disabled:"is-disabled",focused:"is-focused",active:"is-active",valid:"is-valid",invalid:"is-invalid"},this[this.isDisabled()?"disable":"enable"](),void(this.isFocused=!1))}var n=/^.*[\\\/]/,i=/\{0\}/gi,r=function(){var e=3,t=document.createElement("div"),n=t.getElementsByTagName("i");do t.innerHTML="<!--[if gt IE "+ ++e+"]><i></i><![endif]-->";while(n[0]);return e>4?e:document.documentMode}();return e.fn.fancyFileInput=function(n){return this.each(function(){var i=new t(this,n);e(this).data("FancyFileInput",i)})},t.defaults={buttonText:"Browse",clearButtonText:"Clear",multipleFileTextPattern:"{0} files"},t.prototype._addLabelText=function(){var t=e('label[for="'+this.el.id+'"]');t.length&&this.$el.attr("aria-label",t.text())},t.prototype.createLabel=function(t){var n=this.$el.parent(".ffi[data-ffi-button-text]");return n.length||(n=this.$el.wrap(e("<label>",{"class":"ffi","data-ffi-button-text":t})).parent()),n},t.prototype.isDisabled=function(){return this.$el.is(":disabled")},t.prototype.formatMultipleFileText=function(e){return this.multipleFileTextPattern.replace(i,e)},t.prototype.bindEvents=function(){this.$el.on("invalid"+this._eventNamespace,e.proxy(this.checkValidity,this)).on("change"+this._eventNamespace,e.proxy(this.change,this)).on("keydown"+this._eventNamespace,e.proxy(this.keydown,this)).on("mousedown"+this._eventNamespace,e.proxy(this.mousedown,this)).on("mouseup"+this._eventNamespace,e.proxy(this.mouseup,this)).on("focus"+this._eventNamespace,e.proxy(this.focus,this)).on("blur"+this._eventNamespace,e.proxy(this.blur,this)),this.$clearButton.on("click"+this._eventNamespace,e.proxy(this.clear,this))},t.prototype.unbindEvents=function(){this.$el.off(this._eventNamespace),this.$clearButton.off(this._eventNamespace)},t.prototype.fireEvent=function(e){this.$el.trigger(e+this._eventNamespace)},t.prototype.enable=function(){this.bindEvents(),this.$el.prop("disabled",!1),this.$label.removeClass(this.CLASSES.disabled)},t.prototype.disable=function(){this.unbindEvents(),this.$el.prop("disabled",!0),this.$label.addClass(this.CLASSES.disabled)},t.prototype.clear=function(){return this.$el.wrap("<form>").closest("form").get(0).reset(),this.$el.unwrap(),this.el.value="",this.change(),!1},t.prototype.focus=function(){var e=this;this.$label.addClass(this.CLASSES.focused),r&&!this.isFocused&&(this.isFocused=!0,setTimeout(function(){e.$el.blur(),e.$el.focus()},0))},t.prototype.blur=function(){r&&this.isFocused||(this.$label.removeClass(this.CLASSES.focused),this.isFocused=!1)},t.prototype.mousedown=function(){this.$label.addClass(this.CLASSES.active)},t.prototype.mouseup=function(){this.$label.removeClass(this.CLASSES.active)},t.prototype.keydown=function(e){var t=e.which,n=8,i=9,o=46;if((t===n||t===o)&&(this.clear(),e.preventDefault()),r&&t===i){var s=this;this.isFocused=!1,this.$el.prop("disabled",!0),setTimeout(function(){s.$el.prop("disabled",!1).blur()},0)}},t.prototype.checkValidity=function(){if(this.el.required){var e=this.$el.is(":invalid");this.$label.toggleClass(this.CLASSES.invalid,e).toggleClass(this.CLASSES.valid,!e)}},t.prototype.change=function(){var e,t="";this.checkValidity(),e=this.el.multiple&&this.el.files.length>1?this.formatMultipleFileText(this.el.files.length):this.el.value,e.length?(t=e.replace(n,""),this.$clearButton.appendTo(this.$label)):this.$clearButton.detach(),this.$el.focus(),this.setFieldText(t),this.fireEvent("value-changed")},t.prototype.setFieldText=function(e){var t="data-ffi-value";e.length?(this.$label.attr(t,e),this.fireEvent("value-added")):(this.$label.removeAttr(t),this.fireEvent("value-cleared"))},t}),function(e){for(var t=0,n=["webkit","moz"],i=e.requestAnimationFrame,r=e.cancelAnimationFrame,o=n.length;--o>=0&&!i;)i=e[n[o]+"RequestAnimationFrame"],r=e[n[o]+"CancelAnimationFrame"];i&&r||(i=function(e){var n=Date.now(),i=Math.max(t+16,n);return setTimeout(function(){e(t=i)},i-n)},r=clearTimeout),e.requestAnimationFrame=i,e.cancelAnimationFrame=r}(window),window.Modernizr=function(e,t,n){function i(e){p.cssText=e}function r(e,t){return typeof e===t}var o,s,a,l="2.8.0",u={},c=t.documentElement,d="modernizr",h=t.createElement(d),p=h.style,f=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),m={},g=[],v=g.slice,y=function(e,n,i,r){var o,s,a,l,u=t.createElement("div"),h=t.body,p=h||t.createElement("body");if(parseInt(i,10))for(;i--;)a=t.createElement("div"),a.id=r?r[i]:d+(i+1),u.appendChild(a);return o=["&#173;",'<style id="s',d,'">',e,"</style>"].join(""),u.id=d,(h?u:p).innerHTML+=o,p.appendChild(u),h||(p.style.background="",p.style.overflow="hidden",l=c.style.overflow,c.style.overflow="hidden",c.appendChild(p)),s=n(u,e),h?u.parentNode.removeChild(u):(p.parentNode.removeChild(p),c.style.overflow=l),!!s},b={}.hasOwnProperty;a=r(b,"undefined")||r(b.call,"undefined")?function(e,t){return t in e&&r(e.constructor.prototype[t],"undefined")}:function(e,t){return b.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=v.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=t.prototype;var o=new r,s=t.apply(o,n.concat(v.call(arguments)));return Object(s)===s?s:o}return t.apply(e,n.concat(v.call(arguments)))};return i}),m.touch=function(){var n;return"ontouchstart"in e||e.DocumentTouch&&t instanceof DocumentTouch?n=!0:y(["@media (",f.join("touch-enabled),("),d,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(e){n=9===e.offsetTop}),n};for(var w in m)a(m,w)&&(s=w.toLowerCase(),u[s]=m[w](),g.push((u[s]?"":"no-")+s));return u.addTest=function(e,t){if("object"==typeof e)for(var i in e)a(e,i)&&u.addTest(i,e[i]);else{if(e=e.toLowerCase(),u[e]!==n)return u;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(c.className+=" "+(t?"":"no-")+e),u[e]=t}return u},i(""),h=o=null,u._version=l,u._prefixes=f,u.testStyles=y,u}(this,this.document),function(e){"use strict";AJS.navigation=e(AJS.$,window.skate,AJS._internal.widget)}(function(e,t,n){"use strict";function i(t){if(this.$el=e(t).closest(".aui-nav"),this.$el.length>1)return this.$el.map(function(e,t){return new i(t)})[0];if(this.$el.data("aui-navigation"))return this.$el.data("aui-navigation");this.$el.data("aui-navigation",this),this.$treeParent=this.$el.parent("li[aria-expanded]"),this.$subtreeToggleIcon=this.$treeParent.children(".aui-nav-subtree-toggle").children("span.aui-icon"),this.hideMoreItems(),this.$el.children("li:has(.aui-nav-selected)").addClass("aui-nav-child-selected");var n=this.$el.children(".aui-nav-selected");return n.parents(".aui-nav > [aria-expanded=false]").add(n.filter("[aria-expanded=false]")).each(function(){var t=r(e(this).children(".aui-nav"));t.expand()}),this.$el.find("> li[aria-expanded] > .aui-nav-subtree-toggle").on("click",function(){var t=r(e(this).siblings(".aui-nav"));t.toggle()}),this}i.prototype.isNested=function(){return 1===this.$treeParent.length},i.prototype.isCollapsed=function(){return"false"===this.$treeParent.attr("aria-expanded")},i.prototype.expand=function(){return this.$treeParent.attr("aria-expanded","true"),this.$subtreeToggleIcon.removeClass("aui-iconfont-collapsed").addClass("aui-iconfont-expanded"),this.hideMoreItems(),this},i.prototype.collapse=function(){return this.$treeParent.attr("aria-expanded","false"),this.$subtreeToggleIcon.removeClass("aui-iconfont-expanded").addClass("aui-iconfont-collapsed"),this},i.prototype.toggle=function(){return this.isCollapsed()?this.expand():this.collapse(),this},i.prototype.hideMoreItems=function(){if(this.$el.is(".aui-nav:not([aria-expanded=false]) [data-more]")){var t=this.$el.attr("data-more")||AJS.I18n.getText("aui.words.moreitem"),n=Math.abs(parseInt(this.$el.attr("data-more-limit")))||5,i=this.$el.children("li"),r=i.length<=n+1,o=i.filter(".aui-nav-selected").length,s=i.filter(".aui-nav-more").length;if(r||o||s)return this;e("<li>",{"class":"aui-nav-more","aria-hidden":"true"}).append(e("<a>",{href:"#","class":"aui-nav-item",text:t,click:function(t){t.preventDefault(),e(this).parent().remove()}})).insertAfter(i.eq(n-1))}return this};var r=n("navigation",i);return t("aui-nav",{insert:function(e){r(e)}}),r}),function(e){"use strict";function t(e){return e.offset().top}function n(t){this.$el=e(t),this.$el.length&&(this.$body=e("body"),this.$wrapper=this.$el.children(".aui-sidebar-wrapper"),this.submenus=new i,this.$body.addClass("aui-page-sidebar"),this._previousScrollTop=null,this._previousViewportHeight=null,this._previousViewportWidth=null,this._previousOffsetTop=null,s(this))}function i(){this.inlineDialog=AJS.InlineDialog(e(),"sidebar-submenu",this.inlineDialogShowHandler.bind(this),{noBind:!0,addActiveClass:!1,hideCallback:this.inlineDialogHideHandler.bind(this),gravity:"w",hideDelay:300,offsetY:function(e,t){var n=t.target.height()/2,i=e.height()/2;return i-n-this.submenuHeadingHeight()}.bind(this),arrowOffsetY:function(e,t){var n=t.target.height()/2,i=e.height()/2;return-i+this.submenuHeadingHeight()+n}.bind(this)}),this.$trigger=null,this.$placeholder=null,this.$placeholderSubmenu=null,this.postHideCallback=null}function r(e){e.tipsy(d).tipsy("show");var t=e.data("tipsy")&&e.data("tipsy").$tip;t&&t.css({opacity:""}).addClass("tooltip-shown")}function o(e){var t=e.data("tipsy")&&e.data("tipsy").$tip;if(t){var n=t.css("transition-duration");if(n){var i=n.indexOf("ms")>=0?parseInt(n.substring(0,n.length-2),10):1e3*parseInt(n.substring(0,n.length-1),10);setTimeout(function(){e.tipsy("hide")},i)}t.removeClass("tooltip-shown")}}function s(t){var n=e(".aui-sidebar");if(n.length){Modernizr.touch&&e("body").addClass("aui-page-sidebar-touch");var i=null;e(window).on("scroll resize",function(){null===i&&(i=requestAnimationFrame(function(){t.reflow(),i=null}))}),t.reflow(),t.isAnimated()&&t.$el.on("transitionend webkitTransitionEnd",function(){t.$el.trigger(e.Event(u+(t.isCollapsed()?"collapse-end":"expand-end")))}),t.$el.on("click",".aui-sidebar-toggle",function(e){e.preventDefault(),t.toggle()}),t.$el.on("click",".aui-sidebar-body",function(n){e(n.target).is(".aui-sidebar-body")&&(n.preventDefault(),t.toggle())}),e(".aui-page-panel").click(function(){!t.isCollapsed()&&t.isViewportNarrow()&&t.collapse()});var s=AJS.whenIType("[").execute(function(){t.toggle()});t._remove=function(){this.$el.remove(),s.unbind()},t.$el.on("touchend",function(e){t.isCollapsed()&&(t.expand(),e.preventDefault())}),t.$el.on("mouseenter focus",t.collapsedTriggersSelector,function(n){if(t.isCollapsed()){var i=e(this);t.submenus.hasSubmenu(i)?(n.preventDefault(),t.submenus.show(n,this)):i.hasClass("active")&&t.submenus.isShowing()?n.stopImmediatePropagation():(t.submenus.hide(),r(i))}}),t.$el.on("click blur mouseleave",t.collapsedTriggersSelector,function(){t.isCollapsed()&&o(e(this))}),t.$el.on("click",t.collapsedTriggersSelector,function(e){t.submenus.isShowing()&&e.stopImmediatePropagation()}),t.$el.on("mouseenter focus",t.toggleSelector,function(){var n=e(this);t.isCollapsed()?n.data("tooltip",AJS.I18n.getText("aui.sidebar.expand.tooltip")):n.data("tooltip",AJS.I18n.getText("aui.sidebar.collapse.tooltip")),r(n)}),t.$el.on("click blur mouseleave",t.toggleSelector,function(){o(e(this))}),t.$el.find(".aui-sidebar-body").on("mouseenter mouseover mouseleave",function(n){t.$el.toggleClass("aui-is-hover",("mouseover"===n.type||"mouseenter"===n.type)&&!e(n.target).parentsUntil(t.$el).filter(".aui-page-header, .aui-navgroup").length),"mouseover"!==n.type||e(n.target).closest("a").hasClass("active")||t.submenus.hide()})}}var a="undefined"!=typeof document.documentElement.style.transition||"undefined"!=typeof document.documentElement.style.webkitTransition,l=1240,u="_aui-internal-sidebar-";n.prototype.on=function(){var t=arguments[0],n=Array.prototype.slice.call(arguments,1),i=e.map(t.split(" "),function(e){return u+e}).join(" ");return this.$el.on.apply(this.$el,[i].concat(n)),this},n.prototype.setHeight=function(e,t,n){var i=Math.max(0,n-e);
return this.$wrapper.height(t-i),this},n.prototype.setPosition=function(e){return e=e||window.pageYOffset,this.$wrapper.toggleClass("aui-is-docked",e>t(this.$el)),this},n.prototype.setCollapsedState=function(t){var n={collapsed:{},expanded:{}};n.collapsed.narrow={narrow:e.noop,wide:function(e){e._expand(t,!0)}},n.collapsed.wide={narrow:e.noop,wide:e.noop},n.expanded.narrow={narrow:e.noop,wide:function(e){e.$body.removeClass("aui-sidebar-collapsed"),e.$el.removeClass("aui-sidebar-fly-out")}},n.expanded.wide={narrow:function(e){e._collapse(!0)},wide:e.noop};var i=this.isCollapsed()?"collapsed":"expanded",r=this.isViewportNarrow(this._previousViewportWidth)?"narrow":"wide",o=this.isViewportNarrow(t)?"narrow":"wide";return n[i][r][o](this),this},n.prototype._collapse=function(t){if(this.isCollapsed())return this;var n=e.Event(u+"collapse-start",{isResponsive:t});return this.$el.trigger(n),n.isDefaultPrevented()?this:(this.$body.addClass("aui-sidebar-collapsed"),this.$el.attr("aria-expanded","false"),this.$el.removeClass("aui-sidebar-fly-out"),this.isAnimated()||this.$el.trigger(e.Event(u+"collapse-end",{isResponsive:t})),this)},n.prototype.collapse=function(){return this._collapse(!1)},n.prototype._expand=function(t,n){var i=e.Event(u+"expand-start",{isResponsive:n});if(this.$el.trigger(i),i.isDefaultPrevented())return this;var r=this.isViewportNarrow(t);return this.$el.attr("aria-expanded","true"),this.$body.toggleClass("aui-sidebar-collapsed",r),this.$el.toggleClass("aui-sidebar-fly-out",r),this.isAnimated()||this.$el.trigger(e.Event(u+"expand-end",{isResponsive:n})),this},n.prototype.expand=function(){return this.isCollapsed()&&this._expand(this._previousViewportWidth,!1),this},n.prototype.isAnimated=function(){return a&&this.$el.hasClass("aui-is-animated")},n.prototype.isCollapsed=function(){return"false"===this.$el.attr("aria-expanded")},n.prototype.isViewportNarrow=function(e){return e=void 0===e?this._previousViewportWidth:e,l>e},n.prototype.reflow=function(e,n,i,r){e=void 0===e?window.pageYOffset:e,n=void 0===n?document.documentElement.clientHeight:n,r=void 0===r?document.documentElement.scrollHeight:r,i=void 0===i?window.innerWidth:i;var o=t(this.$el),s=null===this._previousViewportWidth;if(e!==this._previousScrollTop||n!==this._previousViewportHeight||o!==this._previousOffsetTop){var a=this.$body.hasClass("aui-page-sidebar-touch"),l=0>e||e+n>r;a||!s&&l||(this.setHeight(e,n,o),this.setPosition(e))}var u="false"!==this.$el.attr("data-aui-responsive");if(u)if(s){if(!this.isCollapsed()&&this.isViewportNarrow(i)){var c=this.isAnimated();c&&this.$el.removeClass("aui-is-animated"),this.collapse(),c&&(this.$el[0].offsetHeight,this.$el.addClass("aui-is-animated"))}}else i!==this._previousViewportWidth&&this.setCollapsedState(i);else{var d=!this.isCollapsed()&&this.isViewportNarrow(i);this.$el.toggleClass("aui-sidebar-fly-out",d)}return this._previousScrollTop=e,this._previousViewportHeight=n,this._previousViewportWidth=i,this._previousOffsetTop=o,this},n.prototype.toggle=function(){return this.isCollapsed()?this.submenus.isShowing()?this.submenus.hide(this.expand.bind(this)):(this.expand(),e(".aui-sidebar-section-tooltip").remove()):this.collapse(),this},n.prototype.collapsedTriggersSelector=[".aui-sidebar-group:not(.aui-sidebar-group-tier-one)",".aui-sidebar-group.aui-sidebar-group-tier-one > .aui-nav > li > a",".aui-sidebar-footer > .aui-sidebar-settings-button"].join(", "),n.prototype.toggleSelector=".aui-sidebar-footer > .aui-sidebar-toggle",i.prototype.submenu=function(e){return e.is("a")?e.next(".aui-nav"):e.children(".aui-nav, hr")},i.prototype.hasSubmenu=function(e){return 0!==this.submenu(e).length},i.prototype.submenuHeadingHeight=function(){return 34},i.prototype.isShowing=function(){return null!==this.$trigger},i.prototype.show=function(e,t){var n=this.isShowing();return this.inlineDialog.show(e,t),n&&this.inlineDialog.refresh(),this},i.prototype.hide=function(e){return void 0!==e&&(this.postHideCallback=e),this.inlineDialog.hide(),this};var c='<div class="aui-sidebar-submenu"><div class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><div class="aui-nav-heading"><strong></strong></div></div></div></div>';i.prototype.inlineDialogShowHandler=function(t,n,i){this.isShowing()&&(this.restoreSubmenu(),this.$trigger.removeClass("active")),this.$trigger=e(n).is(".aui-sidebar-group")?e(n):e(n).closest("a"),this.$trigger.addClass("active");var r=this.$trigger.is("a")?this.$trigger.text():this.$trigger.children(".aui-nav-heading").text();t.html(c);var o=t.find(".aui-navgroup-inner");o.children(".aui-nav-heading").attr("title",r).children("strong").text(r),this.moveSubmenuToInlineDialog(this.submenu(this.$trigger)),i()},i.prototype.inlineDialogHideHandler=function(){this.restoreSubmenu(),this.$trigger.removeClass("active"),this.$trigger=null,null!==this.postHideCallback&&(this.postHideCallback(),this.postHideCallback=null)},i.prototype.moveSubmenuToInlineDialog=function(t){return this.$placeholder=e("<!-- placholder -->"),this.$placeholderSubmenu=t.clone(!0),t.replaceWith(this.$placeholder),this.inlineDialog.find(".aui-navgroup-inner").append(this.$placeholderSubmenu),this},i.prototype.restoreSubmenu=function(){return this.$placeholder.replaceWith(this.$placeholderSubmenu),delete this.$placeholder,delete this.$placeholderSubmenu,this};var d={trigger:"manual",gravity:"w",className:"aui-sidebar-section-tooltip",title:function(){var t=e(this);return t.is("a")?t.attr("title")||t.find(".aui-nav-item-label").text()||t.data("tooltip"):t.children(".aui-nav").attr("title")||t.children(".aui-nav-heading").text()}};AJS.sidebar=AJS._internal.widget("sidebar",n),e(function(){AJS.sidebar(".aui-sidebar")})}(AJS.$),root.AJS=AJS}.apply(root,arguments)})}(this),function(e){define("aui-experimental",["aui-stable"],function(){return function(){!function(e){function t(e,t){return"function"==typeof e?e.call(t):e}function n(e){for(;e=e.parentNode;)if(e==document)return!0;return!1}function i(){var e=o++;return"tipsyuid"+e}function r(t,n){this.$element=e(t),this.options=n,this.enabled=!0,this.fixTitle()}var o=0;r.prototype={show:function(){function r(){l.hoverTooltip=!0}function o(){if("in"!=l.hoverState&&(l.hoverTooltip=!1,"manual"!=l.options.trigger)){var e="hover"==l.options.trigger?"mouseleave.tipsy":"blur.tipsy";l.$element.trigger(e)}}if(n(this.$element[0])){var s=this.getTitle();if(s&&this.enabled){var a=this.tip();a.find(".tipsy-inner")[this.options.html?"html":"text"](s),a[0].className="tipsy",a.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var l=this;this.options.hoverable&&a.hover(r,o),this.options.className&&a.addClass(t(this.options.className,this.$element[0]));var u,c=e.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),d=a[0].offsetWidth,h=a[0].offsetHeight,p=t(this.options.gravity,this.$element[0]);switch(p.charAt(0)){case"n":u={top:c.top+c.height+this.options.offset,left:c.left+c.width/2-d/2};break;case"s":u={top:c.top-h-this.options.offset,left:c.left+c.width/2-d/2};break;case"e":u={top:c.top+c.height/2-h/2,left:c.left-d-this.options.offset};break;case"w":u={top:c.top+c.height/2-h/2,left:c.left+c.width+this.options.offset}}if(2==p.length&&(u.left="w"==p.charAt(1)?c.left+c.width/2-15:c.left+c.width/2-d+15),a.css(u).addClass("tipsy-"+p),a.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+p.charAt(0),this.options.fade?a.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):a.css({visibility:"visible",opacity:this.options.opacity}),this.options.aria){var f=i();a.attr("id",f),this.$element.attr("aria-describedby",f)}}}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){e(this).remove()}):this.tip().remove(),this.options.aria&&this.$element.removeAttr("aria-describedby")},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("original-title"))&&e.attr("original-title",e.attr("title")||"").removeAttr("title")},getTitle:function(){var e,t=this.$element,n=this.options;this.fixTitle();var e,n=this.options;return"string"==typeof n.title?e=t.attr("title"==n.title?"original-title":n.title):"function"==typeof n.title&&(e=n.title.call(t[0])),e=(""+e).replace(/(^\s*|\s*$)/,""),e||n.fallback},tip:function(){return this.$tip||(this.$tip=e('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>').attr("role","tooltip"),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},e.fn.tipsy=function(t){function n(n){var i=e.data(n,"tipsy");return i||(i=new r(n,e.fn.tipsy.elementOptions(n,t)),e.data(n,"tipsy",i)),i}function i(){var e=n(this);e.hoverState="in",0==t.delayIn?e.show():(e.fixTitle(),setTimeout(function(){"in"==e.hoverState&&e.show()},t.delayIn))}function o(){var e=n(this);e.hoverState="out",0==t.delayOut?e.hide():setTimeout(function(){"out"!=e.hoverState||e.hoverTooltip||e.hide()},t.delayOut)}if(t===!0)return this.data("tipsy");if("string"==typeof t){var s=this.data("tipsy");return s&&s[t](),this}if(t=e.extend({},e.fn.tipsy.defaults,t),t.hoverable&&(t.delayOut=t.delayOut||20),t.live||this.each(function(){n(this)}),"manual"!=t.trigger){var a="hover"==t.trigger?"mouseenter.tipsy":"focus.tipsy",l="hover"==t.trigger?"mouseleave.tipsy":"blur.tipsy";t.live?e(this.context).on(a,this.selector,i).on(l,this.selector,o):this.bind(a,i).bind(l,o)}return this},e.fn.tipsy.defaults={aria:!1,className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,hoverable:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},e.fn.tipsy.revalidate=function(){e(".tipsy").each(function(){var t=e.data(this,"tipsy-pointee");t&&n(t)||e(this).remove()})},e.fn.tipsy.elementOptions=function(t,n){return e.metadata?e.extend({},n,e(t).metadata()):n},e.fn.tipsy.autoNS=function(){return e(this).offset().top>e(document).scrollTop()+e(window).height()/2?"s":"n"},e.fn.tipsy.autoWE=function(){return e(this).offset().left>e(document).scrollLeft()+e(window).width()/2?"e":"w"},e.fn.tipsy.autoBounds=function(t,n){return function(){var i={ns:n[0],ew:n.length>1?n[1]:!1},r=e(document).scrollTop()+t,o=e(document).scrollLeft()+t,s=e(this);return s.offset().top<r&&(i.ns="n"),s.offset().left<o&&(i.ew="w"),e(window).width()+e(document).scrollLeft()-s.offset().left<t&&(i.ew="e"),e(window).height()+e(document).scrollTop()-s.offset().top<t&&(i.ns="s"),i.ns+(i.ew?i.ew:"")}}}(jQuery),function(e){var t=e(document),n=function(n){var i={};return i.$trigger=e(n.currentTarget),i.$content=t.find("#"+i.$trigger.attr("aria-controls")),i.triggerIsParent=0!==i.$content.parent().filter(i.$trigger).length,i.$shortContent=i.triggerIsParent?i.$trigger.find(".aui-expander-short-content"):null,i.height=i.$content.css("min-height"),i.isCollapsible=i.$trigger.data("collapsible")!==!1,i.replaceText=i.$trigger.attr("data-replace-text"),i.replaceSelector=i.$trigger.data("replace-selector"),i},i=function(e){if(e.replaceText){var t=e.replaceSelector?e.$trigger.find(e.replaceSelector):e.$trigger;e.$trigger.attr("data-replace-text",t.text()),t.text(e.replaceText)}},r={"aui-expander-invoke":function(n){var i=e(n.currentTarget),r=t.find("#"+i.attr("aria-controls")),o=i.data("collapsible")!==!1;i.trigger("true"===r.attr("aria-expanded")&&o?"aui-expander-collapse":"aui-expander-expand")},"aui-expander-expand":function(e){var t=n(e);t.$content.attr("aria-expanded","true"),t.$trigger.attr("aria-expanded","true"),t.$content.outerHeight()>0&&t.$content.attr("aria-hidden","false"),i(t),t.triggerIsParent&&t.$shortContent.hide(),t.$trigger.trigger("aui-expander-expanded")},"aui-expander-collapse":function(e){var t=n(e);i(t),t.$content.attr("aria-expanded","false"),t.$trigger.attr("aria-expanded","false"),t.triggerIsParent&&t.$shortContent.show(),0===t.$content.outerHeight()&&t.$content.attr("aria-hidden","true"),t.$trigger.trigger("aui-expander-collapsed")},"click.aui-expander":function(t){var n=e(t.currentTarget);n.trigger("aui-expander-invoke",t.currentTarget)}};t.on(r,".aui-expander-trigger")}(jQuery),function(){"use strict";function e(e,t,n){AJS._internal.animation.recomputeStyle(e),e.css("width",100*n+"%"),t.attr("data-value",n)}AJS.progressBars={update:function(t,n){var i=AJS.$(t).first(),r=i.children(".aui-progress-indicator-value"),o=r.attr("data-value")||0,s="aui-progress-indicator-after-update",a="aui-progress-indicator-before-update",l="transitionend webkitTransitionEnd",u=!i.attr("data-value");if(u&&r.css("width",0),"number"==typeof n&&1>=n&&n>=0){i.trigger(a,[o,n]);var c=document.body||document.documentElement,d=c.style;"string"==typeof d.transition||"string"==typeof d.WebkitTransition?(r.one(l,function(){i.trigger(s,[o,n])}),e(r,i,n)):(e(r,i,n),i.trigger(s,[o,n]))}return i},setIndeterminate:function(e){var t=AJS.$(e).first(),n=t.children(".aui-progress-indicator-value");t.removeAttr("data-value"),AJS._internal.animation.recomputeStyle(t),n.css("width","100%")}}}(),!function(e){"use strict";e.extend({tablesorter:new function(){function t(e){"undefined"!=typeof console&&"undefined"!=typeof console.log?console.log(e):alert(e)}function n(e,n){t(e+" ("+((new Date).getTime()-n.getTime())+"ms)")}function i(t,n,i){if(!n)return"";var r=t.config,o=r.textExtraction,s="";return s="simple"===o?r.supportsTextContent?n.textContent:e(n).text():"function"==typeof o?o(n,t,i):"object"==typeof o&&o.hasOwnProperty(i)?o[i](n,t,i):r.supportsTextContent?n.textContent:e(n).text(),e.trim(s)}function r(e,n,r,o){for(var s,a=_.parsers.length,l=!1,u="",c=!0;""===u&&c;)r++,n[r]?(l=n[r].cells[o],u=i(e,l,o),e.config.debug&&t("Checking if value was empty on row "+r+", column: "+o+': "'+u+'"')):c=!1;for(;--a>=0;)if(s=_.parsers[a],s&&"text"!==s.id&&s.is&&s.is(u,e,l))return s;return _.getParserById("text")}function o(e){var n,i,o,s,a,l,u,c=e.config,d=c.$tbodies=c.$table.children("tbody:not(."+c.cssInfoBlock+")"),h="";if(0===d.length)return c.debug?t("*Empty table!* Not building a parser cache"):"";if(n=d[0].rows,n[0])for(i=[],o=n[0].cells.length,s=0;o>s;s++)a=c.$headers.filter(":not([colspan])"),a=a.add(c.$headers.filter('[colspan="1"]')).filter('[data-column="'+s+'"]:last'),l=c.headers[s],u=_.getParserById(_.getData(a,l,"sorter")),c.empties[s]=_.getData(a,l,"empty")||c.emptyTo||(c.emptyToBottom?"bottom":"top"),c.strings[s]=_.getData(a,l,"string")||c.stringTo||"max",u||(u=r(e,n,-1,s)),c.debug&&(h+="column:"+s+"; parser:"+u.id+"; string:"+c.strings[s]+"; empty: "+c.empties[s]+"\n"),i.push(u);c.debug&&t(h),c.parsers=i}function s(r){var o,s,a,l,u,c,d,h,p,f,m=r.tBodies,g=r.config,v=g.parsers,y=[];if(g.cache={},!v)return g.debug?t("*Empty table!* Not building a cache"):"";for(g.debug&&(f=new Date),g.showProcessing&&_.isProcessing(r,!0),d=0;d<m.length;d++)if(g.cache[d]={row:[],normalized:[]},!e(m[d]).hasClass(g.cssInfoBlock)){for(o=m[d]&&m[d].rows.length||0,s=m[d].rows[0]&&m[d].rows[0].cells.length||0,u=0;o>u;++u)if(h=e(m[d].rows[u]),p=[],h.hasClass(g.cssChildRow))g.cache[d].row[g.cache[d].row.length-1]=g.cache[d].row[g.cache[d].row.length-1].add(h);else{for(g.cache[d].row.push(h),c=0;s>c;++c)a=i(r,h[0].cells[c],c),l=v[c].format(a,r,h[0].cells[c],c),p.push(l),"numeric"===(v[c].type||"").toLowerCase()&&(y[c]=Math.max(Math.abs(l)||0,y[c]||0));p.push(g.cache[d].normalized.length),g.cache[d].normalized.push(p)}g.cache[d].colMax=y}g.showProcessing&&_.isProcessing(r),g.debug&&n("Building cache for "+o+" rows",f)}function a(t,i){var r,o,s,a,l,u,c,d,h,p,f,m,g=t.config,v=t.tBodies,y=[],b=g.cache;if(b[0]){for(g.debug&&(m=new Date),h=0;h<v.length;h++)if(l=e(v[h]),l.length&&!l.hasClass(g.cssInfoBlock)){for(u=_.processTbody(t,l,!0),r=b[h].row,o=b[h].normalized,s=o.length,a=s?o[0].length-1:0,c=0;s>c;c++)if(f=o[c][a],y.push(r[f]),!g.appender||!g.removeRows)for(p=r[f].length,d=0;p>d;d++)u.append(r[f][d]);_.processTbody(t,u,!1)}g.appender&&g.appender(t,y),g.debug&&n("Rebuilt table",m),i||_.applyWidget(t),e(t).trigger("sortEnd",t)}}function l(t){var n,i,r,o,s,a,l,u,c,d,h,p,f=[],m={},g=0,v=e(t).find("thead:eq(0), tfoot").children("tr");for(n=0;n<v.length;n++)for(a=v[n].cells,i=0;i<a.length;i++){for(s=a[i],l=s.parentNode.rowIndex,u=l+"-"+s.cellIndex,c=s.rowSpan||1,d=s.colSpan||1,"undefined"==typeof f[l]&&(f[l]=[]),r=0;r<f[l].length+1;r++)if("undefined"==typeof f[l][r]){h=r;break}for(m[u]=h,g=Math.max(h,g),e(s).attr({"data-column":h}),r=l;l+c>r;r++)for("undefined"==typeof f[r]&&(f[r]=[]),p=f[r],o=h;h+d>o;o++)p[o]="x"}return t.config.columns=g,m}function u(e){return/^d/i.test(e)||1===e}function c(i){var r,o,s,a,c,d,p,f=l(i),m=i.config;m.headerList=[],m.headerContent=[],m.debug&&(p=new Date),a=m.cssIcon?'<i class="'+m.cssIcon+'"></i>':"",m.$headers=e(i).find(m.selectorHeaders).each(function(t){o=e(this),r=m.headers[t],m.headerContent[t]=this.innerHTML,c=m.headerTemplate.replace(/\{content\}/g,this.innerHTML).replace(/\{icon\}/g,a),m.onRenderTemplate&&(s=m.onRenderTemplate.apply(o,[t,c]),s&&"string"==typeof s&&(c=s)),this.innerHTML='<div class="tablesorter-header-inner">'+c+"</div>",m.onRenderHeader&&m.onRenderHeader.apply(o,[t]),this.column=f[this.parentNode.rowIndex+"-"+this.cellIndex],this.order=u(_.getData(o,r,"sortInitialOrder")||m.sortInitialOrder)?[1,0,2]:[0,1,2],this.count=-1,this.lockedOrder=!1,d=_.getData(o,r,"lockedOrder")||!1,"undefined"!=typeof d&&d!==!1&&(this.order=this.lockedOrder=u(d)?[1,1,1]:[0,0,0]),o.addClass(m.cssHeader),m.headerList[t]=this,o.parent().addClass(m.cssHeaderRow),o.attr("tabindex",0)}),h(i),m.debug&&(n("Built headers:",p),t(m.$headers))}function d(e,t,n){var i=e.config;i.$table.find(i.selectorRemove).remove(),o(e),s(e),w(i.$table,t,n)}function h(t){var n,i=t.config;i.$headers.each(function(t,r){n="false"===_.getData(r,i.headers[t],"sorter"),r.sortDisabled=n,e(r)[n?"addClass":"removeClass"]("sorter-false")})}function p(t){var n,i,r,o,s=t.config,a=s.sortList,l=[s.cssAsc,s.cssDesc],u=e(t).find("tfoot tr").children().removeClass(l.join(" "));for(s.$headers.removeClass(l.join(" ")),o=a.length,i=0;o>i;i++)if(2!==a[i][1]&&(n=s.$headers.not(".sorter-false").filter('[data-column="'+a[i][0]+'"]'+(1===o?":last":"")),n.length))for(r=0;r<n.length;r++)n[r].sortDisabled||(n.eq(r).addClass(l[a[i][1]]),u.length&&u.filter('[data-column="'+a[i][0]+'"]').eq(r).addClass(l[a[i][1]]))}function f(t){if(t.config.widthFixed&&0===e(t).find("colgroup").length){var n=e("<colgroup>"),i=e(t).width();e(t.tBodies[0]).find("tr:first").children("td").each(function(){n.append(e("<col>").css("width",parseInt(e(this).width()/i*1e3,10)/10+"%"))}),e(t).prepend(n)}}function m(t,n){var i,r,o,s=t.config,a=n||s.sortList;s.sortList=[],e.each(a,function(t,n){i=[parseInt(n[0],10),parseInt(n[1],10)],o=s.headerList[i[0]],o&&(s.sortList.push(i),r=e.inArray(i[1],o.order),o.count=r>=0?r:i[1]%(s.sortReset?3:2))})}function g(e,t){return e&&e[t]?e[t].type||"":""}function v(t,n,i){var r,o,s,l,u,c=t.config,d=!i[c.sortMultiSortKey],h=e(t);if(h.trigger("sortStart",t),n.count=i[c.sortResetKey]?2:(n.count+1)%(c.sortReset?3:2),c.sortRestart&&(o=n,c.$headers.each(function(){this===o||!d&&e(this).is("."+c.cssDesc+",."+c.cssAsc)||(this.count=-1)})),o=n.column,d){if(c.sortList=[],null!==c.sortForce)for(r=c.sortForce,s=0;s<r.length;s++)r[s][0]!==o&&c.sortList.push(r[s]);if(l=n.order[n.count],2>l&&(c.sortList.push([o,l]),n.colSpan>1))for(s=1;s<n.colSpan;s++)c.sortList.push([o+s,l])}else if(c.sortAppend&&c.sortList.length>1&&_.isValueInArray(c.sortAppend[0][0],c.sortList)&&c.sortList.pop(),_.isValueInArray(o,c.sortList))for(s=0;s<c.sortList.length;s++)u=c.sortList[s],l=c.headerList[u[0]],u[0]===o&&(u[1]=l.order[l.count],2===u[1]&&(c.sortList.splice(s,1),l.count=-1));else if(l=n.order[n.count],2>l&&(c.sortList.push([o,l]),n.colSpan>1))for(s=1;s<n.colSpan;s++)c.sortList.push([o+s,l]);if(null!==c.sortAppend)for(r=c.sortAppend,s=0;s<r.length;s++)r[s][0]!==o&&c.sortList.push(r[s]);h.trigger("sortBegin",t),setTimeout(function(){p(t),y(t),a(t)},1)}function y(t){var i,r,o,s,a,l,u,c,d,h,p=0,f=t.config,m=f.sortList,v=m.length,y=t.tBodies.length;if(!f.serverSideSorting&&f.cache[0]){for(f.debug&&(i=new Date),o=0;y>o;o++)a=f.cache[o].colMax,l=f.cache[o].normalized,u=l.length,h=l&&l[0]?l[0].length-1:0,l.sort(function(n,i){for(r=0;v>r;r++){s=m[r][0],d=m[r][1],c=/n/i.test(g(f.parsers,s))?"Numeric":"Text",c+=0===d?"":"Desc",/Numeric/.test(c)&&f.strings[s]&&(p="boolean"==typeof f.string[f.strings[s]]?(0===d?1:-1)*(f.string[f.strings[s]]?-1:1):f.strings[s]?f.string[f.strings[s]]||0:0);var o=e.tablesorter["sort"+c](t,n[s],i[s],s,a[s],p);if(o)return o}return n[h]-i[h]});f.debug&&n("Sorting on "+m.toString()+" and dir "+d+" time",i)}}function b(e,t){e.trigger("updateComplete"),"function"==typeof t&&t(e[0])}function w(e,t,n){t===!1||e[0].isProcessing?b(e,n):e.trigger("sorton",[e[0].config.sortList,function(){b(e,n)}])}function x(t){var n,r,l=t.config,u=l.$table;l.$headers.find(l.selectorSort).add(l.$headers.filter(l.selectorSort)).unbind("mousedown.tablesorter mouseup.tablesorter sort.tablesorter keypress.tablesorter").bind("mousedown.tablesorter mouseup.tablesorter sort.tablesorter keypress.tablesorter",function(n,i){if(1!==(n.which||n.button)&&!/sort|keypress/.test(n.type)||"keypress"===n.type&&13!==n.which)return!1;if("mouseup"===n.type&&i!==!0&&(new Date).getTime()-r>250)return!1;if("mousedown"===n.type)return r=(new Date).getTime(),"INPUT"===n.target.tagName?"":!l.cancelSelection;l.delayInit&&!l.cache&&s(t);var o=/TH|TD/.test(this.tagName)?e(this):e(this).parents("th, td").filter(":first"),a=o[0];a.sortDisabled||v(t,a,n)}),l.cancelSelection&&l.$headers.attr("unselectable","on").bind("selectstart",!1).css({"user-select":"none",MozUserSelect:"none"}),u.unbind("sortReset update updateRows updateCell updateAll addRows sorton appendCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave ".split(" ").join(".tablesorter ")).bind("sortReset.tablesorter",function(e){e.stopPropagation(),l.sortList=[],p(t),y(t),a(t)}).bind("updateAll.tablesorter",function(e,n,i){e.stopPropagation(),_.refreshWidgets(t,!0,!0),_.restoreHeaders(t),c(t),x(t),d(t,n,i)}).bind("update.tablesorter updateRows.tablesorter",function(e,n,i){e.stopPropagation(),h(t),d(t,n,i)}).bind("updateCell.tablesorter",function(n,r,o,s){n.stopPropagation(),u.find(l.selectorRemove).remove();var a,c,d,h=u.find("tbody"),p=h.index(e(r).parents("tbody").filter(":first")),f=e(r).parents("tr").filter(":first");r=e(r)[0],h.length&&p>=0&&(c=h.eq(p).find("tr").index(f),d=r.cellIndex,a=l.cache[p].normalized[c].length-1,l.cache[p].row[t.config.cache[p].normalized[c][a]]=f,l.cache[p].normalized[c][d]=l.parsers[d].format(i(t,r,d),t,r,d),w(u,o,s))}).bind("addRows.tablesorter",function(e,r,s,a){e.stopPropagation();var c,d=r.filter("tr").length,h=[],p=r[0].cells.length,f=u.find("tbody").index(r.parents("tbody").filter(":first"));for(l.parsers||o(t),c=0;d>c;c++){for(n=0;p>n;n++)h[n]=l.parsers[n].format(i(t,r[c].cells[n],n),t,r[c].cells[n],n);h.push(l.cache[f].row.length),l.cache[f].row.push([r[c]]),l.cache[f].normalized.push(h),h=[]}w(u,s,a)}).bind("sorton.tablesorter",function(e,n,i,r){e.stopPropagation(),u.trigger("sortStart",this),m(t,n),p(t),u.trigger("sortBegin",this),y(t),a(t,r),"function"==typeof i&&i(t)}).bind("appendCache.tablesorter",function(e,n,i){e.stopPropagation(),a(t,i),"function"==typeof n&&n(t)}).bind("applyWidgetId.tablesorter",function(e,n){e.stopPropagation(),_.getWidgetById(n).format(t,l,l.widgetOptions)}).bind("applyWidgets.tablesorter",function(e,n){e.stopPropagation(),_.applyWidget(t,n)}).bind("refreshWidgets.tablesorter",function(e,n,i){e.stopPropagation(),_.refreshWidgets(t,n,i)}).bind("destroy.tablesorter",function(e,n,i){e.stopPropagation(),_.destroy(t,n,i)})}var _=this;_.version="2.10.8",_.parsers=[],_.widgets=[],_.defaults={theme:"default",widthFixed:!1,showProcessing:!1,headerTemplate:"{content}",onRenderTemplate:null,onRenderHeader:null,cancelSelection:!0,dateFormat:"mmddyyyy",sortMultiSortKey:"shiftKey",sortResetKey:"ctrlKey",usNumberFormat:!0,delayInit:!1,serverSideSorting:!1,headers:{},ignoreCase:!0,sortForce:null,sortList:[],sortAppend:null,sortInitialOrder:"asc",sortLocaleCompare:!1,sortReset:!1,sortRestart:!1,emptyTo:"bottom",stringTo:"max",textExtraction:"simple",textSorter:null,widgets:[],widgetOptions:{zebra:["even","odd"]},initWidgets:!0,initialized:null,tableClass:"tablesorter",cssAsc:"tablesorter-headerAsc",cssChildRow:"tablesorter-childRow",cssDesc:"tablesorter-headerDesc",cssHeader:"tablesorter-header",cssHeaderRow:"tablesorter-headerRow",cssIcon:"tablesorter-icon",cssInfoBlock:"tablesorter-infoOnly",cssProcessing:"tablesorter-processing",selectorHeaders:"> thead th, > thead td",selectorSort:"th, td",selectorRemove:".remove-me",debug:!1,headerList:[],empties:{},strings:{},parsers:[]},_.log=t,_.benchmark=n,_.construct=function(n){return this.each(function(){if(!this.tHead||0===this.tBodies.length||this.hasInitialized===!0)return this.config&&this.config.debug?t("stopping initialization! No thead, tbody or tablesorter has already been initialized"):"";var i,r=e(this),a=this,l="",u=e.metadata;a.hasInitialized=!1,a.isProcessing=!0,a.config={},i=e.extend(!0,a.config,_.defaults,n),e.data(a,"tablesorter",i),i.debug&&e.data(a,"startoveralltimer",new Date),i.supportsTextContent="x"===e("<span>x</span>")[0].textContent,i.supportsDataObject=parseFloat(e.fn.jquery)>=1.4,i.string={max:1,min:-1,"max+":1,"max-":-1,zero:0,none:0,"null":0,top:!0,bottom:!1},/tablesorter\-/.test(r.attr("class"))||(l=""!==i.theme?" tablesorter-"+i.theme:""),i.$table=r.addClass(i.tableClass+l),i.$tbodies=r.children("tbody:not(."+i.cssInfoBlock+")"),c(a),f(a),o(a),i.delayInit||s(a),x(a),i.supportsDataObject&&"undefined"!=typeof r.data().sortlist?i.sortList=r.data().sortlist:u&&r.metadata()&&r.metadata().sortlist&&(i.sortList=r.metadata().sortlist),_.applyWidget(a,!0),i.sortList.length>0?r.trigger("sorton",[i.sortList,{},!i.initWidgets]):i.initWidgets&&_.applyWidget(a),i.showProcessing&&r.unbind("sortBegin.tablesorter sortEnd.tablesorter").bind("sortBegin.tablesorter sortEnd.tablesorter",function(e){_.isProcessing(a,"sortBegin"===e.type)}),a.hasInitialized=!0,a.isProcessing=!1,i.debug&&_.benchmark("Overall initialization time",e.data(a,"startoveralltimer")),r.trigger("tablesorter-initialized",a),"function"==typeof i.initialized&&i.initialized(a)})},_.isProcessing=function(t,n,i){t=e(t);var r=t[0].config,o=i||t.find("."+r.cssHeader);n?(r.sortList.length>0&&(o=o.filter(function(){return this.sortDisabled?!1:_.isValueInArray(parseFloat(e(this).attr("data-column")),r.sortList)})),o.addClass(r.cssProcessing)):o.removeClass(r.cssProcessing)},_.processTbody=function(t,n,i){var r;return i?(t.isProcessing=!0,n.before('<span class="tablesorter-savemyplace"/>'),r=e.fn.detach?n.detach():n.remove()):(r=e(t).find("span.tablesorter-savemyplace"),n.insertAfter(r),r.remove(),void(t.isProcessing=!1))},_.clearTableBody=function(t){e(t)[0].config.$tbodies.empty()},_.restoreHeaders=function(t){var n=t.config;n.$table.find(n.selectorHeaders).each(function(t){e(this).find(".tablesorter-header-inner").length&&e(this).html(n.headerContent[t])})},_.destroy=function(t,n,i){if(t=e(t)[0],t.hasInitialized){_.refreshWidgets(t,!0,!0);var r=e(t),o=t.config,s=r.find("thead:first"),a=s.find("tr."+o.cssHeaderRow).removeClass(o.cssHeaderRow),l=r.find("tfoot:first > tr").children("th, td");s.find("tr").not(a).remove(),r.removeData("tablesorter").unbind("sortReset update updateAll updateRows updateCell addRows sorton appendCache applyWidgetId applyWidgets refreshWidgets destroy mouseup mouseleave keypress sortBegin sortEnd ".split(" ").join(".tablesorter ")),o.$headers.add(l).removeClass(o.cssHeader+" "+o.cssAsc+" "+o.cssDesc).removeAttr("data-column"),a.find(o.selectorSort).unbind("mousedown.tablesorter mouseup.tablesorter keypress.tablesorter"),_.restoreHeaders(t),n!==!1&&r.removeClass(o.tableClass+" tablesorter-"+o.theme),t.hasInitialized=!1,"function"==typeof i&&i(t)}},_.regex=[/(^([+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?)?$|^0x[0-9a-f]+$|\d+)/gi,/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,/^0x[0-9a-f]+$/i],_.sortText=function(e,t,n,i){if(t===n)return 0;var r,o,s,a,l,u,c,d,h=e.config,p=h.string[h.empties[i]||h.emptyTo],f=_.regex;if(""===t&&0!==p)return"boolean"==typeof p?p?-1:1:-p||-1;if(""===n&&0!==p)return"boolean"==typeof p?p?1:-1:p||1;if("function"==typeof h.textSorter)return h.textSorter(t,n,e,i);if(r=t.replace(f[0],"\\0$1\\0").replace(/\\0$/,"").replace(/^\\0/,"").split("\\0"),s=n.replace(f[0],"\\0$1\\0").replace(/\\0$/,"").replace(/^\\0/,"").split("\\0"),o=parseInt(t.match(f[2]),16)||1!==r.length&&t.match(f[1])&&Date.parse(t),a=parseInt(n.match(f[2]),16)||o&&n.match(f[1])&&Date.parse(n)||null){if(a>o)return-1;if(o>a)return 1}for(d=Math.max(r.length,s.length),c=0;d>c;c++){if(l=isNaN(r[c])?r[c]||0:parseFloat(r[c])||0,u=isNaN(s[c])?s[c]||0:parseFloat(s[c])||0,isNaN(l)!==isNaN(u))return isNaN(l)?1:-1;if(typeof l!=typeof u&&(l+="",u+=""),u>l)return-1;if(l>u)return 1}return 0},_.sortTextDesc=function(e,t,n,i){if(t===n)return 0;var r=e.config,o=r.string[r.empties[i]||r.emptyTo];return""===t&&0!==o?"boolean"==typeof o?o?-1:1:o||1:""===n&&0!==o?"boolean"==typeof o?o?1:-1:-o||-1:"function"==typeof r.textSorter?r.textSorter(n,t,e,i):_.sortText(e,n,t)},_.getTextValue=function(e,t,n){if(t){var i,r=e?e.length:0,o=t+n;for(i=0;r>i;i++)o+=e.charCodeAt(i);return n*o}return 0},_.sortNumeric=function(e,t,n,i,r,o){if(t===n)return 0;var s=e.config,a=s.string[s.empties[i]||s.emptyTo];return""===t&&0!==a?"boolean"==typeof a?a?-1:1:-a||-1:""===n&&0!==a?"boolean"==typeof a?a?1:-1:a||1:(isNaN(t)&&(t=_.getTextValue(t,r,o)),isNaN(n)&&(n=_.getTextValue(n,r,o)),t-n)},_.sortNumericDesc=function(e,t,n,i,r,o){if(t===n)return 0;var s=e.config,a=s.string[s.empties[i]||s.emptyTo];return""===t&&0!==a?"boolean"==typeof a?a?-1:1:a||1:""===n&&0!==a?"boolean"==typeof a?a?1:-1:-a||-1:(isNaN(t)&&(t=_.getTextValue(t,r,o)),isNaN(n)&&(n=_.getTextValue(n,r,o)),n-t)},_.characterEquivalents={a:"",A:"",c:"",C:"",e:"",E:"",i:"",I:"",o:"",O:"",ss:"",SS:"",u:"",U:""},_.replaceAccents=function(e){var t,n="[",i=_.characterEquivalents;if(!_.characterRegex){_.characterRegexArray={};for(t in i)"string"==typeof t&&(n+=i[t],_.characterRegexArray[t]=new RegExp("["+i[t]+"]","g"));_.characterRegex=new RegExp(n+"]")}if(_.characterRegex.test(e))for(t in i)"string"==typeof t&&(e=e.replace(_.characterRegexArray[t],t));return e},_.isValueInArray=function(e,t){var n,i=t.length;for(n=0;i>n;n++)if(t[n][0]===e)return!0;return!1},_.addParser=function(e){var t,n=_.parsers.length,i=!0;for(t=0;n>t;t++)_.parsers[t].id.toLowerCase()===e.id.toLowerCase()&&(i=!1);i&&_.parsers.push(e)},_.getParserById=function(e){var t,n=_.parsers.length;for(t=0;n>t;t++)if(_.parsers[t].id.toLowerCase()===e.toString().toLowerCase())return _.parsers[t];return!1},_.addWidget=function(e){_.widgets.push(e)},_.getWidgetById=function(e){var t,n,i=_.widgets.length;for(t=0;i>t;t++)if(n=_.widgets[t],n&&n.hasOwnProperty("id")&&n.id.toLowerCase()===e.toLowerCase())return n},_.applyWidget=function(t,i){t=e(t)[0];var r,o,s,a=t.config,l=a.widgetOptions,u=[];a.debug&&(r=new Date),a.widgets.length&&(a.widgets=e.grep(a.widgets,function(t,n){return e.inArray(t,a.widgets)===n}),e.each(a.widgets||[],function(e,t){s=_.getWidgetById(t),s&&s.id&&(s.priority||(s.priority=10),u[e]=s)}),u.sort(function(e,t){return e.priority<t.priority?-1:e.priority===t.priority?0:1}),e.each(u,function(n,r){r&&(i?(r.hasOwnProperty("options")&&(l=t.config.widgetOptions=e.extend(!0,{},r.options,l)),r.hasOwnProperty("init")&&r.init(t,r,a,l)):!i&&r.hasOwnProperty("format")&&r.format(t,a,l,!1))})),a.debug&&(o=a.widgets.length,n("Completed "+(i===!0?"initializing ":"applying ")+o+" widget"+(1!==o?"s":""),r))
},_.refreshWidgets=function(n,i,r){n=e(n)[0];var o,s=n.config,a=s.widgets,l=_.widgets,u=l.length;for(o=0;u>o;o++)l[o]&&l[o].id&&(i||e.inArray(l[o].id,a)<0)&&(s.debug&&t("Refeshing widgets: Removing "+l[o].id),l[o].hasOwnProperty("remove")&&l[o].remove(n,s,s.widgetOptions));r!==!0&&_.applyWidget(n,i)},_.getData=function(t,n,i){var r,o,s="",a=e(t);return a.length?(r=e.metadata?a.metadata():!1,o=" "+(a.attr("class")||""),"undefined"!=typeof a.data(i)||"undefined"!=typeof a.data(i.toLowerCase())?s+=a.data(i)||a.data(i.toLowerCase()):r&&"undefined"!=typeof r[i]?s+=r[i]:n&&"undefined"!=typeof n[i]?s+=n[i]:" "!==o&&o.match(" "+i+"-")&&(s=o.match(new RegExp("\\s"+i+"-([\\w-]+)"))[1]||""),e.trim(s)):""},_.formatFloat=function(t,n){if("string"!=typeof t||""===t)return t;var i,r=n&&n.config?n.config.usNumberFormat!==!1:"undefined"!=typeof n?n:!0;return t=r?t.replace(/,/g,""):t.replace(/[\s|\.]/g,"").replace(/,/g,"."),/^\s*\([.\d]+\)/.test(t)&&(t=t.replace(/^\s*\(/,"-").replace(/\)/,"")),i=parseFloat(t),isNaN(i)?e.trim(t):i},_.isDigit=function(e){return isNaN(e)?/^[\-+(]?\d+[)]?$/.test(e.toString().replace(/[,.'"\s]/g,"")):!0}}});var t=e.tablesorter;e.fn.extend({tablesorter:t.construct}),t.addParser({id:"text",is:function(){return!0},format:function(n,i){var r=i.config;return n&&(n=e.trim(r.ignoreCase?n.toLocaleLowerCase():n),n=r.sortLocaleCompare?t.replaceAccents(n):n),n},type:"text"}),t.addParser({id:"digit",is:function(e){return t.isDigit(e)},format:function(n,i){var r=t.formatFloat((n||"").replace(/[^\w,. \-()]/g,""),i);return n&&"number"==typeof r?r:n?e.trim(n&&i.config.ignoreCase?n.toLocaleLowerCase():n):n},type:"numeric"}),t.addParser({id:"currency",is:function(e){return/^\(?\d+[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]|[\u00a3$\u20ac\u00a4\u00a5\u00a2?.]\d+\)?$/.test((e||"").replace(/[,. ]/g,""))},format:function(n,i){var r=t.formatFloat((n||"").replace(/[^\w,. \-()]/g,""),i);return n&&"number"==typeof r?r:n?e.trim(n&&i.config.ignoreCase?n.toLocaleLowerCase():n):n},type:"numeric"}),t.addParser({id:"ipAddress",is:function(e){return/^\d{1,3}[\.]\d{1,3}[\.]\d{1,3}[\.]\d{1,3}$/.test(e)},format:function(e,n){var i,r=e?e.split("."):"",o="",s=r.length;for(i=0;s>i;i++)o+=("00"+r[i]).slice(-3);return e?t.formatFloat(o,n):e},type:"numeric"}),t.addParser({id:"url",is:function(e){return/^(https?|ftp|file):\/\//.test(e)},format:function(t){return t?e.trim(t.replace(/(https?|ftp|file):\/\//,"")):t},type:"text"}),t.addParser({id:"isoDate",is:function(e){return/^\d{4}[\/\-]\d{1,2}[\/\-]\d{1,2}/.test(e)},format:function(e,n){return e?t.formatFloat(""!==e?new Date(e.replace(/-/g,"/")).getTime()||"":"",n):e},type:"numeric"}),t.addParser({id:"percent",is:function(e){return/(\d\s*?%|%\s*?\d)/.test(e)&&e.length<15},format:function(e,n){return e?t.formatFloat(e.replace(/%/g,""),n):e},type:"numeric"}),t.addParser({id:"usLongDate",is:function(e){return/^[A-Z]{3,10}\.?\s+\d{1,2},?\s+(\d{4})(\s+\d{1,2}:\d{2}(:\d{2})?(\s+[AP]M)?)?$/i.test(e)||/^\d{1,2}\s+[A-Z]{3,10}\s+\d{4}/i.test(e)},format:function(e,n){return e?t.formatFloat(new Date(e.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||"",n):e},type:"numeric"}),t.addParser({id:"shortDate",is:function(e){return/(^\d{1,2}[\/\s]\d{1,2}[\/\s]\d{4})|(^\d{4}[\/\s]\d{1,2}[\/\s]\d{1,2})/.test((e||"").replace(/\s+/g," ").replace(/[\-.,]/g,"/"))},format:function(e,n,i,r){if(e){var o=n.config,s=o.headerList[r],a=s.dateFormat||t.getData(s,o.headers[r],"dateFormat")||o.dateFormat;e=e.replace(/\s+/g," ").replace(/[\-.,]/g,"/"),"mmddyyyy"===a?e=e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$1/$2"):"ddmmyyyy"===a?e=e.replace(/(\d{1,2})[\/\s](\d{1,2})[\/\s](\d{4})/,"$3/$2/$1"):"yyyymmdd"===a&&(e=e.replace(/(\d{4})[\/\s](\d{1,2})[\/\s](\d{1,2})/,"$1/$2/$3"))}return e?t.formatFloat(new Date(e).getTime()||"",n):e},type:"numeric"}),t.addParser({id:"time",is:function(e){return/^(([0-2]?\d:[0-5]\d)|([0-1]?\d:[0-5]\d\s?([AP]M)))$/i.test(e)},format:function(e,n){return e?t.formatFloat(new Date("2000/01/01 "+e.replace(/(\S)([AP]M)$/i,"$1 $2")).getTime()||"",n):e},type:"numeric"}),t.addParser({id:"metadata",is:function(){return!1},format:function(t,n,i){var r=n.config,o=r.parserMetadataName?r.parserMetadataName:"sortValue";return e(i).metadata()[o]},type:"numeric"}),t.addWidget({id:"zebra",priority:90,format:function(n,i,r){var o,s,a,l,u,c,d,h,p=new RegExp(i.cssChildRow,"i"),f=i.$tbodies;for(i.debug&&(c=new Date),d=0;d<f.length;d++)o=f.eq(d),h=o.children("tr").length,h>1&&(l=0,s=o.children("tr:visible"),s.each(function(){a=e(this),p.test(this.className)||l++,u=l%2===0,a.removeClass(r.zebra[u?1:0]).addClass(r.zebra[u?0:1])}));i.debug&&t.benchmark("Applying Zebra widget",c)},remove:function(t,n,i){var r,o,s=n.$tbodies,a=(i.zebra||["even","odd"]).join(" ");for(r=0;r<s.length;r++)o=e.tablesorter.processTbody(t,s.eq(r),!0),o.children().removeClass(a),e.tablesorter.processTbody(t,o,!1)}})}(jQuery),function(){function e(e){var n=t;e.find("th").each(function(e,t){var i=AJS.$(t);n.headers[e]={},i.hasClass("aui-table-column-unsortable")?n.headers[e].sorter=!1:(i.attr("tabindex","0"),i.wrapInner("<span class='aui-table-header-content'/>"),i.hasClass("aui-table-column-issue-key")&&(n.headers[e].sorter="issue-key"))}),e.tablesorter(n)}var t={sortMultiSortKey:"",headers:{},debug:!1};AJS.tablessortable={setup:function(){AJS.$.tablesorter.addParser({id:"issue-key",is:function(){return!1},format:function(e){var t=e.split("-"),n=t[0],i=t[1],r="..........",o="000000",s=(n+r).slice(0,r.length);return s+=(o+i).slice(-o.length)},type:"text"}),AJS.$.tablesorter.addParser({id:"textSortAttributeParser",is:function(e,t,n){return n.hasAttribute("data-sort-value")&&(!n.hasAttribute("data-sort-type")||"text"===n.getAttribute("data-sort-type"))},format:function(e,t,n){return n.getAttribute("data-sort-value")},type:"text"}),AJS.$.tablesorter.addParser({id:"numericSortAttributeParser",is:function(e,t,n){return"numeric"===n.getAttribute("data-sort-type")&&n.hasAttribute("data-sort-value")},format:function(e,t,n){return n.getAttribute("data-sort-value")},type:"numeric"}),AJS.$(".aui-table-sortable").each(function(){e(AJS.$(this))})},setTableSortable:function(t){e(t)}},AJS.$(AJS.tablessortable.setup)}(),function(e){"use strict";e.fn.tooltip=function(t){if("string"==typeof t)return this.tipsy(t),i;var n=e.extend({},e.fn.tooltip.defaults,t),i=this.tipsy(n);if(n.hideOnClick&&("hover"==n.trigger||!n.trigger&&"hover"==this.tipsy.defaults.trigger)){var r=function(){e(this).tipsy("hide")};n.live?e(this.context).on("click.tipsy",this.selector,r):this.bind("click.tipsy",r)}return i},e.fn.tooltip.defaults={opacity:1,offset:1,delayIn:500,hoverable:!0,hideOnClick:!0}}(AJS.$),define("aui/form-validation/validator-register",[],function(){"use strict";function e(e){var t=!1;return e.some(function(e){var r=-1!==n.inArray(e,i);return r&&(t=e),r}),t}function t(t,n){var i;if("string"==typeof t)i=t;else{var o=e(t);if(o)return AJS.warn('Validators cannot be registered with the argument "'+o+'", as it is a reserved argument.'),!1;i="[data-aui-validation-"+t.join("],[data-aui-validation-")+"]"}var s={validatorFunction:n,validatorTrigger:i};return r.push(s),s}var n=AJS.$,i=["displayfield","watchfield","when","novalidate","state"],r=[];return{register:t,validators:function(){return r}}}),function(e){"use strict";define("aui/form-validation/basic-validators",["./validator-register"],function(t){return e(AJS,AJS.$,t)})}(function(e,t,n){"use strict";function i(e){return"password"===e.attr("type")}function r(e,t){var n=e.match(t);if(!n)return!1;var i=e===n[0];return i}function o(t,n,i){var r,o=void 0!==e.I18n.keys;r=o?e.I18n.keys["aui.validation.message."+t]:s[t];var a=i;i||(a=[n(t)]);var l,u=n(t+"-msg");return l=u?[u].concat(a):[r].concat(a),e.format.apply(null,l)}n.register(["maxlength","minlength"],function(e){var t=o("minlength",e.args),n=o("maxlength",e.args);e.$el.val().length<e.args("minlength")?e.invalidate(t):e.$el.val().length>e.args("maxlength")?e.invalidate(n):e.validate()}),n.register(["matchingfield"],function(e){var n=e.$el.val(),r=t("#"+e.args("matchingfield")),s=r.val(),a=o("matchingfield",e.args,[n,s]),l=i(e.$el)||i(r);l&&(a=o("matchingfield-novalue",e.args)),n&&s&&s!==n?e.invalidate(a):e.validate()}),n.register(["doesnotcontain"],function(e){var t=o("doesnotcontain",e.args);-1===e.$el.val().indexOf(e.args("doesnotcontain"))?e.validate():e.invalidate(t)}),n.register(["pattern"],function(e){var t=o("pattern",e.args);r(e.$el.val(),new RegExp(e.args("pattern"),"i"))?e.validate():e.invalidate(t)}),n.register(["required"],function(e){var t=o("required",e.args);e.$el.val()?e.validate():e.invalidate(t)}),n.register(["min","max"],function(e){var t=o("validnumber",e.args),n=o("min",e.args),i=o("max",e.args),r=parseInt(e.$el.val());return isNaN(r)?void e.invalidate(t):void(e.args("min")&&r<parseInt(e.args("min"))?e.invalidate(n):e.args("max")&&r>parseInt(e.args("max"))?e.invalidate(i):e.validate())}),n.register(["dateformat"],function(e){var t=e.args("dateformat"),n=o("dateformat",e.args),i={Y:"[0-9]{4}",y:"[0-9]{2}",m:"(11|12|0{0,1}[0-9])",M:"[Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec]",D:"[Mon|Tue|Wed|Thu|Fri|Sat|Sun]",d:"([0-2]{0,1}[0-9]{1})|(30|31)"},s=t.split(""),a="";s.forEach(function(e){var t=i.hasOwnProperty(e);a+=t?i[e]:e});var l=new RegExp(a+"$","i"),u=r(e.$el.val(),l);u?e.validate():e.invalidate(n)}),n.register(["minchecked","maxchecked"],function(e){var t=e.$el.find(":checked").length,n=!e.args("minchecked")||t>=e.args("minchecked"),i=!e.args("maxchecked")||t<=e.args("maxchecked"),r=o("minchecked",e.args),s=o("maxchecked",e.args);n&&i?e.validate():n?i||e.invalidate(s):e.invalidate(r)});var s={minlength:e.I18n.getText("aui.validation.message.minlength"),maxlength:e.I18n.getText("aui.validation.message.maxlength"),matchingfield:e.I18n.getText("aui.validation.message.matchingfield"),"matchingfield-novalue":e.I18n.getText("aui.validation.message.matchingfield-novalue"),doesnotcontain:e.I18n.getText("aui.validation.message.doesnotcontain"),pattern:e.I18n.getText("aui.validation.message.pattern"),required:e.I18n.getText("aui.validation.message.required"),validnumber:e.I18n.getText("aui.validation.message.validnumber"),min:e.I18n.getText("aui.validation.message.min"),max:e.I18n.getText("aui.validation.message.max"),dateformat:e.I18n.getText("aui.validation.message.dateformat"),minchecked:e.I18n.getText("aui.validation.message.minchecked"),maxchecked:e.I18n.getText("aui.validation.message.maxchecked")}}),function(e){"use strict";define("aui/form-notification",[],function(){return e(AJS.$,window.skate)})}(function(e,t){"use strict";function n(e){i(e)||(o(e),a(e),f(e)),W.push(e)}function i(e){return e.hasClass(R)}function r(){return e('<span class="aui-icon aui-icon-small '+M+'"/>')}function o(e){e.addClass(R),s(e)}function s(e){var t=r();e.after(t)}function a(e){A(e).tipsy({gravity:T(e),title:function(){return u(e)},trigger:"manual",offset:l(e)?G:K,opacity:V,className:function(){return"aui-form-notification-tooltip "+h(e)},html:!0})}function l(e){return-1!==Q.indexOf(e.attr("type"))}function u(e){var t=p(e),n=t?e.attr(t):"";return c(n)}function c(e){if(""===e)return e;var t=d(e);return 1===t.length?t[0]:"<ul><li>"+t.join("</li><li>")+"</li></ul>"}function d(e){var t;try{t=JSON.parse(e)}catch(n){t=[e]}return t}function h(e){var t=p(e);return t===U?O:t===B?L:void 0}function p(e){var t;return J.some(function(n){return e.is("["+n+"]")?(t=n,!0):void 0}),t}function f(e){m(e)&&w(e)}function m(e){return e.is(":aui-focusable")}function g(e){return""!==u(e)}function v(e){A(e).tipsy("show"),m(e)&&$(e)}function y(e){A(e).tipsy("hide")}function b(){document.addEventListener("focus",function(t){W.forEach(function(n){var i=e(n),r=S(i);if(r&&m(i)){var o=e.contains(r[0],t.target),s=i.is(t.target);s?v(i):o||y(i)}})},!0)}function w(e){e.on("keydown",function(t){if(x(t)&&g(e)){var n=k(e);n.length&&(n.focus(),t.preventDefault())}})}function x(e){return e.keyCode===AJS.keyCode.TAB&&!e.shiftKey&&!e.altKey}function _(e){return e.keyCode===AJS.keyCode.TAB&&e.shiftKey}function k(e){return S(e).find(":aui-tabbable").first()}function C(e){return S(e).find(":aui-tabbable").last()}function S(e){var t=A(e);return t.data("tipsy")?t.data("tipsy").$tip:void 0}function $(e){var t=S(e);t.on("keydown",function(t){var n=j(C(e)),i=j(k(e));x(t)&&n&&n&&e.focus(),_(t)&&i&&i&&(e.focus(),t.preventDefault())})}function T(e){var t=e.data(I)||"side",n={side:"w",top:"se",bottom:"ne"},i=n[t];return i||(i="w",AJS.warn('Invalid notification position: "'+t+'". Valid options are "side", "bottom, "top"')),i}function A(e){return E(e)}function E(e){return e.next("."+M)}function j(t){var n=t instanceof e?t[0]:t;return n&&n===document.activeElement}function D(t){t=t instanceof e?t:e(t);var n=p(t),i=n===F;q(t,i);var r=!n;if(r)return void y(t);var o=u(t),s=j(t)||!l(t);s&&o?v(t):y(t)}function q(e,t){t?E(e).addClass("aui-icon-wait"):E(e).removeClass("aui-icon-wait")}var P="aui-form-notification",I=P+"-position",R="_aui-form-notification-initialised",M="aui-icon-notification",N=P+"-tooltip",O=N+"-error",L=N+"-info",H="data-aui-notification-",F=H+"wait",B=H+"info",U=H+"error",z=H+"success",J=[U,z,F,B],W=[],V=1,G=9,K=3,Q=["text","url","email","tel","password"];b(),document.addEventListener("mousedown",function(t){var n=void 0!==e(t.target).attr("data-aui-notification-field");if(!n){var i=e(t.target).is("a");if(!i){var r=e(t.target).closest(".aui-form-notification-tooltip").length>0;if(!r){var o=e("[data-aui-notification-field]");o.each(function(){var t=e(this);y(t)})}}}}),t("data-aui-notification-field",{insert:function(t){n(e(t))},attributes:function(){var e={};return J.forEach(function(t){e[t]=D}),e}(),type:t.types.ATTR})}),function(e){"use strict";define("aui/form-validation",["./form-validation/validator-register","./form-validation/basic-validators","./form-notification"],function(t){return e(AJS.$,window.skate,t)})}(function(e,t,n){"use strict";function i(e){return e.hasClass(z)}function r(e){i(e)||(o(e),s(e),a(e),b(e,B))}function o(e){$(e).attr("data-aui-notification-field","")}function s(e){e.addClass(z)}function a(e){l(e),u(e)}function l(e){var t,n=function(){e.trigger("aui-stop-typing")};e.on("keyup",function(){clearTimeout(t),t=setTimeout(n,1500)})}function u(e){var t=d(e,"when"),n=d(e,"watchfield"),i=n?e.add("#"+n):e;i.on(t,c(e))}function c(e){return function(){var t=d(e,"novalidate");t||h(e)}}function d(e,t){var n={when:"change"},i=e.attr("data-"+M+t);return i||(i=n[t]),i}function h(t){p(t);var n=m(t);b(t,F);var i=g(t,n);e.when.apply(e,i).done(function(){b(t,H)})}function p(e){x($(e),"none")}function f(){return n.validators()}function m(e){var t=[];return f().forEach(function(n,i){var r=n.validatorTrigger,o=e.is(r);o&&t.push(i)}),t}function g(t,n){var i=[];return n.forEach(function(n){var r=f()[n].validatorFunction,o=new e.Deferred,s=v(t,o);r(s),i.push(o)}),i}function v(e,t){return{validate:function(){t.resolve()},invalidate:function(n){b(e,L,n),t.reject()},args:y(e),$el:e}}function y(e){return function(t){return e.attr("data-"+M+t)}}function b(t,n,i){if(t.attr("data-"+O,n),n!==B){t.trigger(e.Event(J));var r=$(t),o={};o[F]="wait",o[L]="error",o[H]="success";var s=o[n];n===F?w(t):x(r,s,i)}}function w(e){setTimeout(function(){var t=T(e)===F;t&&x(e,"wait")},500)}function x(e,t,n){var i=C(e);_(e);var r="success"===t&&!i;if(!r)if("none"===t)k(e,"error");else{var o=e.attr(N+t)||"[]",s=n?S(n,o):"";e.attr(N+t,s)}}function _(e){k(e,"wait"),k(e,"success")}function k(e,t){e.removeAttr(N+t)}function C(e){return e.is("["+N+"wait]")}function S(e,t){var n=JSON.parse(t),i=n.concat([e]),r=JSON.stringify(i);return r}function $(t){var n=d(t,"displayfield"),i=void 0===n;return i?t:e("#"+n)}function T(e){return e.attr("data-"+O)}function A(e){c(e)()}function E(e,t){t.preventDefault();var n=j(e)===F;n?e.one(J,function(){e.trigger("submit")}):e.trigger("submit")}function j(e){var t=e.find("."+z),n=D(t),i=q(n);return i}function D(t){var n=e.map(t,function(t){return T(e(t))});return n}function q(e){var t=-1!==e.indexOf(L),n=-1!==e.indexOf(B),i=-1!==e.indexOf(F),r=-1!==e.indexOf(H);return t?L:n?B:i?F:r?H:void 0}function P(t){var n=R(t,B);n.each(function(t,n){W.validate(e(n))})}function I(e){var t=R(e,L).first();t.focus()}function R(e,t){var n="[data-"+O+"="+t+"]";return e.find(n)}var M="aui-validation-",N="data-aui-notification-",O="aui-validation-state",L="invalid",H="valid",F="validating",B="unvalidated",U="data-aui-validation-field",z="_aui-form-validation-initialised",J="_aui-internal-field-state-changed";e(document).on("submit",function(t){var n=t.target,i=e(n),r=j(i);if(r===B)P(i),E(i,t);else if(r===F)E(i,t);else if(r===L)t.preventDefault(),I(i);else if(r===H){var o=e.Event("aui-valid-submit");i.trigger(o);var s=o.isDefaultPrevented();s&&t.preventDefault()}});var W={register:n.register,validate:A};return t(U,{insert:function(n){var i=e(n);r(i),t.init(n)},type:t.types.ATTR}),W}),function(e){"undefined"==typeof e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var n=e([0]),i=-1,r=this.length;++i<r&&(n.context=n[0]=this[i])&&t.call(n[0],i,n)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function n(e){var t,n,i,r;if(!e||e.length<1)return e;for(t="",n=0,i=e.length;i>n;n++)r=e.charAt(n),t+=L[r]||r;return t}function i(e,t){for(var n=0,i=t.length;i>n;n+=1)if(o(e,t[n]))return n;return-1}function r(){var t=e(O);t.appendTo("body");var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function o(e,n){return e===n?!0:e===t||n===t?!1:null===e||null===n?!1:e.constructor===String?e+""==n+"":n.constructor===String?n+""==e+"":!1}function s(t,n){var i,r,o;if(null===t||t.length<1)return[];for(i=t.split(n),r=0,o=i.length;o>r;r+=1)i[r]=e.trim(i[r]);return i}function a(e){return e.outerWidth(!1)-e.width()}function l(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var r=e.data(n,i);r!==t&&n.val()!==r&&(e.removeData(n,i),n.trigger("keyup-change"))})}function u(n){n.on("mousemove",function(n){var i=N;(i===t||i.x!==n.pageX||i.y!==n.pageY)&&e(n.target).trigger("mousemove-filtered",n)})}function c(e,n,i){i=i||t;var r;return function(){var t=arguments;window.clearTimeout(r),r=window.setTimeout(function(){n.apply(i,t)},e)}}function d(e){var t,n=!1;return function(){return n===!1&&(t=e(),n=!0),t}}function h(e,t){var n=c(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){i(e.target,t.get())>=0&&n(e)})}function p(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus(),e.is(":visible")&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&(t=n.createTextRange(),t.collapse(!1),t.select()))},0)}function f(t){t=e(t)[0];var n=0,i=0;if("selectionStart"in t)n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var r=document.selection.createRange();i=document.selection.createRange().text.length,r.moveStart("character",-t.value.length),n=r.text.length-i}return{offset:n,length:i}}function m(e){e.preventDefault(),e.stopPropagation()}function g(e){e.preventDefault(),e.stopImmediatePropagation()}function v(t){if(!I){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);I=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"}),I.attr("class","select2-sizer"),e("body").append(I)}return I.text(t.val()),I.width()}function y(t,n,i){var r,o,s=[];r=t.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0===this.indexOf("select2-")&&s.push(this)})),r=n.attr("class"),r&&(r=""+r,e(r.split(" ")).each2(function(){0!==this.indexOf("select2-")&&(o=i(this),o&&s.push(o))})),t.attr("class",s.join(" "))}function b(e,t,i,r){var o=n(e.toUpperCase()).indexOf(n(t.toUpperCase())),s=t.length;return 0>o?void i.push(r(e)):(i.push(r(e.substring(0,o))),i.push("<span class='select2-match'>"),i.push(r(e.substring(o,o+s))),i.push("</span>"),void i.push(r(e.substring(o+s,e.length))))}function w(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function x(n){var i,r=null,o=n.quietMillis||100,s=n.url,a=this;return function(l){window.clearTimeout(i),i=window.setTimeout(function(){var i=n.data,o=s,u=n.transport||e.fn.select2.ajaxDefaults.transport,c={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},d=e.extend({},e.fn.select2.ajaxDefaults.params,c);i=i?i.call(a,l.term,l.page,l.context):null,o="function"==typeof o?o.call(a,l.term,l.page,l.context):o,r&&r.abort(),n.params&&(e.isFunction(n.params)?e.extend(d,n.params.call(a)):e.extend(d,n.params)),e.extend(d,{url:o,dataType:n.dataType,data:i,success:function(e){var t=n.results(e,l.page);l.callback(t)}}),r=u.call(a,d)},o)}}function _(t){var n,i,r=t,o=function(e){return""+e.text};e.isArray(r)&&(i=r,r={results:i}),e.isFunction(r)===!1&&(i=r,r=function(){return i});var s=r();return s.text&&(o=s.text,e.isFunction(o)||(n=s.text,o=function(e){return e[n]})),function(t){var n,i=t.term,s={results:[]};return""===i?void t.callback(r()):(n=function(r,s){var a,l;if(r=r[0],r.children){a={};for(l in r)r.hasOwnProperty(l)&&(a[l]=r[l]);a.children=[],e(r.children).each2(function(e,t){n(t,a.children)}),(a.children.length||t.matcher(i,o(a),r))&&s.push(a)}else t.matcher(i,o(r),r)&&s.push(r)},e(r().results).each2(function(e,t){n(t,s.results)}),void t.callback(s))}}function k(n){var i=e.isFunction(n);return function(r){var o=r.term,s={results:[]};e(i?n():n).each(function(){var e=this.text!==t,n=e?this.text:this;(""===o||r.matcher(o,n))&&s.results.push(e?this:{id:this,text:this})}),r.callback(s)}}function C(t,n){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error(n+" must be a function or a falsy value")}function S(t){return e.isFunction(t)?t():t}function $(t){var n=0;return e.each(t,function(e,t){t.children?n+=$(t.children):n++}),n}function T(e,n,i,r){var s,a,l,u,c,d=e,h=!1;if(!r.createSearchChoice||!r.tokenSeparators||r.tokenSeparators.length<1)return t;for(;;){for(a=-1,l=0,u=r.tokenSeparators.length;u>l&&(c=r.tokenSeparators[l],a=e.indexOf(c),!(a>=0));l++);if(0>a)break;if(s=e.substring(0,a),e=e.substring(a+c.length),s.length>0&&(s=r.createSearchChoice.call(this,s,n),s!==t&&null!==s&&r.id(s)!==t&&null!==r.id(s))){for(h=!1,l=0,u=n.length;u>l;l++)if(o(r.id(s),r.id(n[l]))){h=!0;break}h||i(s)}}return d!==e?e:void 0}function A(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var E,j,D,q,P,I,R,M,N={x:0,y:0},E={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case E.LEFT:case E.RIGHT:case E.UP:case E.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case E.SHIFT:case E.CTRL:case E.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},O="<div class='select2-measure-scrollbar'></div>",L={"":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"A","":"AA","":"AE","":"AE","":"AE","":"AO","":"AU","":"AV","":"AV","":"AY","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"B","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"C","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"D","":"DZ","":"DZ","":"Dz","":"Dz","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"E","":"F","":"F","":"F","":"F","":"F","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"G","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"H","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"I","":"J","":"J","":"J","":"J","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"K","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"L","":"LJ","":"Lj","":"M","":"M","":"M","":"M","":"M","":"M","":"M","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"N","":"NJ","":"Nj","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"O","":"OI","":"OO","":"OU","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"P","":"Q","":"Q","":"Q","":"Q","":"Q","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"R","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"S","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"T","":"TZ","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"U","":"V","":"V","":"V","":"V","":"V","":"V","":"V","":"VY","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"W","":"X","":"X","":"X","":"X","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Y","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"Z","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"a","":"aa","":"ae","":"ae","":"ae","":"ao","":"au","":"av","":"av","":"ay","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"b","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"c","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"d","":"dz","":"dz","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"e","":"f","":"f","":"f","":"f","":"f","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"g","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"h","":"hv","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"i","":"j","":"j","":"j","":"j","":"j","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"k","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"l","":"lj","":"m","":"m","":"m","":"m","":"m","":"m","":"m","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"n","":"nj","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"o","":"oi","":"ou","":"oo","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"p","":"q","":"q","":"q","":"q","":"q","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"r","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"s","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"t","":"tz","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"u","":"v","":"v","":"v","":"v","":"v","":"v","":"v","":"vy","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"w","":"x","":"x","":"x","":"x","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"y","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z","":"z"};R=e(document),P=function(){var e=1;return function(){return e++}}(),R.on("mousemove",function(e){N.x=e.pageX,N.y=e.pageY}),j=A(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,o,s=".select2-results";this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+P()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=d(function(){return n.element.closest("body")}),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(S(n.containerCss)),this.container.addClass(S(n.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",m),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(S(n.dropdownCssClass)),this.dropdown.data("select2",this),this.dropdown.on("click",m),this.results=i=this.container.find(s),this.search=o=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",m),u(this.results),this.dropdown.on("mousemove-filtered touchstart touchmove touchend",s,this.bind(this.highlightUnderEvent)),h(80,this.results),this.dropdown.on("scroll-debounced",s,this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&i.mousewheel(function(e,t,n,r){var o=i.scrollTop();r>0&&0>=o-r?(i.scrollTop(0),m(e)):0>r&&i.get(0).scrollHeight-i.scrollTop()+r<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),m(e))
}),l(o),o.on("keyup-change input paste",this.bind(this.updateResults)),o.on("focus",function(){o.addClass("select2-focused")}),o.on("blur",function(){o.removeClass("select2-focused")}),this.dropdown.on("mouseup",s,this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var a=n.element.prop("disabled");a===t&&(a=!1),this.enable(!a);var c=n.element.prop("readonly");c===t&&(c=!1),this.readonly(c),M=M||r(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.nextSearchTerm=t},destroy:function(){var e=this.opts.element,n=e.data("select2");this.close(),this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),n!==t&&(n.container.remove(),n.dropdown.remove(),e.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:o(e.attr("locked"),"locked")||o(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,r,a,l,u=this;if(i=n.element,"select"===i.get(0).tagName.toLowerCase()&&(this.select=r=n.element),r&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n=e.extend({},{populateResults:function(i,r,o){var s,a=this.opts.id;(s=function(i,r,l){var c,d,h,p,f,m,g,v,y,b;for(i=n.sortResults(i,r,o),c=0,d=i.length;d>c;c+=1)h=i[c],f=h.disabled===!0,p=!f&&a(h)!==t,m=h.children&&h.children.length>0,g=e("<li></li>"),g.addClass("select2-results-dept-"+l),g.addClass("select2-result"),g.addClass(p?"select2-result-selectable":"select2-result-unselectable"),f&&g.addClass("select2-disabled"),m&&g.addClass("select2-result-with-children"),g.addClass(u.opts.formatResultCssClass(h)),v=e(document.createElement("div")),v.addClass("select2-result-label"),b=n.formatResult(h,v,o,u.opts.escapeMarkup),b!==t&&v.html(b),g.append(v),m&&(y=e("<ul></ul>"),y.addClass("select2-result-sub"),s(h.children,y,l+1),g.append(y)),g.data("select2-data",h),r.append(g)})(r,i,0)}},e.fn.select2.defaults,n),"function"!=typeof n.id&&(a=n.id,n.id=function(e){return e[a]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(r?(n.query=this.bind(function(e){var n,r,o,s={results:[],more:!1},a=e.term;o=function(t,n){var i;t.is("option")?e.matcher(a,t.text(),t)&&n.push(u.optionToData(t)):t.is("optgroup")&&(i=u.optionToData(t),t.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(r=this.getPlaceholderOption(),r&&(n=n.not(r))),n.each2(function(e,t){o(t,s.results)}),e.callback(s)}),n.id=function(e){return e.id},n.formatResultCssClass=function(e){return e.css}):"query"in n||("ajax"in n?(l=n.element.data("ajax-url"),l&&l.length>0&&(n.ajax.url=l),n.query=x.call(n.element,n.ajax)):"data"in n?n.query=_(n.data):"tags"in n&&(n.query=k(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,i){var r=[];e(s(t.val(),n.separator)).each(function(){var t={id:this,text:this},i=n.tags;e.isFunction(i)&&(i=i()),e(i).each(function(){return o(this.id,t.id)?(t=this,!1):void 0}),r.push(t)}),i(r)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");return n},monitorSource:function(){var e,n,i=this.opts.element;i.on("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e=i.prop("disabled");e===t&&(e=!1),this.enable(!e);var n=i.prop("readonly");n===t&&(n=!1),this.readonly(n),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(S(this.opts.containerCssClass)),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(S(this.opts.dropdownCssClass))}),i.on("propertychange.select2",e),this.mutationCallback===t&&(this.mutationCallback=function(t){t.forEach(e)}),n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver,n!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new n(this.mutationCallback),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return this.enabledInterface===!0},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e===this.enabledInterface?!1:(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){return e===t&&(e=!1),this._readonly===e?!1:(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface(),!0)},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,r,o,s=this.dropdown,a=this.container.offset(),l=this.container.outerHeight(!1),u=this.container.outerWidth(!1),c=s.outerHeight(!1),d=e(window),h=d.width(),p=d.height(),f=d.scrollLeft()+h,m=d.scrollTop()+p,g=a.top+l,v=a.left,y=m>=g+c,b=a.top-c>=this.body().scrollTop(),w=s.outerWidth(!1),x=f>=v+w,_=s.hasClass("select2-drop-above");_?(n=!0,!b&&y&&(i=!0,n=!1)):(n=!1,!y&&b&&(i=!0,n=!0)),i&&(s.hide(),a=this.container.offset(),l=this.container.outerHeight(!1),u=this.container.outerWidth(!1),c=s.outerHeight(!1),f=d.scrollLeft()+h,m=d.scrollTop()+p,g=a.top+l,v=a.left,w=s.outerWidth(!1),x=f>=v+w,s.show()),this.opts.dropdownAutoWidth?(o=e(".select2-results",s)[0],s.addClass("select2-drop-auto-width"),s.css("width",""),w=s.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:M.width),w>u?u=w:w=u,x=f>=v+w):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body().css("position")&&(t=this.body().offset(),g-=t.top,v-=t.left),x||(v=a.left+u-w),r={left:v,width:u},n?(r.bottom=p-a.top,r.top="auto",this.container.addClass("select2-drop-above"),s.addClass("select2-drop-above")):(r.top=g,r.bottom="auto",this.container.removeClass("select2-drop-above"),s.removeClass("select2-drop-above")),r=e.extend(r,S(this.opts.dropdownCss)),s.css(r)},shouldOpen:function(){var t;return this.opened()?!1:this._enabled===!1||this._readonly===!0?!1:(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(this.opening(),!0):!1},opening:function(){var t,n=this.containerId,i="scroll."+n,r="resize."+n,o="orientationchange."+n;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),t=e("#select2-drop-mask"),0==t.length&&(t=e(document.createElement("div")),t.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body()),t.on("mousedown touchstart click",function(t){var n,i=e("#select2-drop");i.length>0&&(n=i.data("select2"),n.opts.selectOnBlur&&n.selectHighlighted({noFocus:!0}),n.close({focus:!0}),t.preventDefault(),t.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){e(this).on(r+" "+i+" "+o,function(){s.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerId,n="scroll."+t,i="resize."+t,r="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(r)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},getMaximumSelectionSize:function(){return S(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,n,i,r,o,s,a,l=this.results;if(n=this.highlight(),!(0>n)){if(0==n)return void l.scrollTop(0);t=this.findHighlightableChoices().find(".select2-result-label"),i=e(t[n]),r=i.offset().top+i.outerHeight(!0),n===t.length-1&&(a=l.find("li.select2-more-results"),a.length>0&&(r=a.offset().top+a.outerHeight(!0))),o=l.offset().top+l.outerHeight(!0),r>o&&l.scrollTop(l.scrollTop()+(r-o)),s=i.offset().top-l.offset().top,0>s&&"none"!=i.css("display")&&l.scrollTop(l.scrollTop()+s)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled, .select2-selected)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){i+=t;var r=e(n[i]);if(r.hasClass("select2-result-selectable")&&!r.hasClass("select2-disabled")&&!r.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var n,r,o=this.findHighlightableChoices();return 0===arguments.length?i(o.filter(".select2-highlighted")[0],o.get()):(t>=o.length&&(t=o.length-1),0>t&&(t=0),this.removeHighlight(),n=e(o[t]),n.addClass("select2-highlighted"),this.ensureHighlightVisible(),r=n.data("select2-data"),void(r&&this.opts.element.trigger({type:"select2-highlight",val:this.id(r),choice:r})))},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e,t=this.results,n=t.find("li.select2-more-results"),i=this.resultsPage+1,r=this,o=this.search.val(),s=this.context;0!==n.length&&(e=n.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(n.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:i,context:s,matcher:this.opts.matcher,callback:this.bind(function(e){r.opened()&&(r.opts.populateResults.call(this,t,e.results,{term:o,page:i,context:s}),r.postprocessResults(e,!1,!1),e.more===!0?(n.detach().appendTo(t).text(r.opts.formatLoadMore(i+1)),window.setTimeout(function(){r.loadMoreIfNeeded()},10)):n.remove(),r.positionDropdown(),r.resultsPage=i,r.context=e.context,this.opts.element.trigger({type:"select2-loaded",items:e}))})})))},tokenize:function(){},updateResults:function(n){function i(){u.removeClass("select2-active"),h.positionDropdown()}function r(e){c.html(e),i()}var s,a,l,u=this.search,c=this.results,d=this.opts,h=this,p=u.val(),f=e.data(this.container,"select2-last-term");if((n===!0||!f||!o(p,f))&&(e.data(this.container,"select2-last-term",p),n===!0||this.showSearchInput!==!1&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(m>=1&&(s=this.data(),e.isArray(s)&&s.length>=m&&C(d.formatSelectionTooBig,"formatSelectionTooBig")))return void r("<li class='select2-selection-limit'>"+d.formatSelectionTooBig(m)+"</li>");if(u.val().length<d.minimumInputLength)return r(C(d.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+d.formatInputTooShort(u.val(),d.minimumInputLength)+"</li>":""),void(n&&this.showSearch&&this.showSearch(!0));if(d.maximumInputLength&&u.val().length>d.maximumInputLength)return void r(C(d.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+d.formatInputTooLong(u.val(),d.maximumInputLength)+"</li>":"");d.formatSearching&&0===this.findHighlightableChoices().length&&r("<li class='select2-searching'>"+d.formatSearching()+"</li>"),u.addClass("select2-active"),this.removeHighlight(),a=this.tokenize(),a!=t&&null!=a&&u.val(a),this.resultsPage=1,d.query({element:d.element,term:u.val(),page:this.resultsPage,context:null,matcher:d.matcher,callback:this.bind(function(s){var a;if(l==this.queryCount){if(!this.opened())return void this.search.removeClass("select2-active");if(this.context=s.context===t?null:s.context,this.opts.createSearchChoice&&""!==u.val()&&(a=this.opts.createSearchChoice.call(h,u.val(),s.results),a!==t&&null!==a&&h.id(a)!==t&&null!==h.id(a)&&0===e(s.results).filter(function(){return o(h.id(this),h.id(a))}).length&&s.results.unshift(a)),0===s.results.length&&C(d.formatNoMatches,"formatNoMatches"))return void r("<li class='select2-no-results'>"+d.formatNoMatches(u.val())+"</li>");c.empty(),h.opts.populateResults.call(this,c,s.results,{term:u.val(),page:this.resultsPage,context:null}),s.more===!0&&C(d.formatLoadMore,"formatLoadMore")&&(c.append("<li class='select2-more-results'>"+h.opts.escapeMarkup(d.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){h.loadMoreIfNeeded()},10)),this.postprocessResults(s,n),i(),this.opts.element.trigger({type:"select2-loaded",items:s})}})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(e){var t=this.highlight(),n=this.results.find(".select2-highlighted"),i=n.closest(".select2-result").data("select2-data");i?(this.highlight(t),this.onSelect(i,e)):e&&e.noFocus&&this.close()},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var e=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&e||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.text()&&""===e.val())return e}},initContainerWidth:function(){function n(){var n,i,r,o,s,a;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if(n=this.opts.element.attr("style"),n!==t)for(i=n.split(";"),o=0,s=i.length;s>o;o+=1)if(a=i[o].replace(/\s/g,""),r=a.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i),null!==r&&r.length>=1)return r[1];return"resolve"===this.opts.width?(n=this.opts.element.css("width"),n.indexOf("%")>0?n:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var i=n.call(this);null!==i&&this.container.css("width",i)}}),D=A(j,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow'><b></b></span>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var n,i,r;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.search.focus(),n=this.search.get(0),n.createTextRange?(i=n.createTextRange(),i.collapse(!1),i.select()):n.setSelectionRange&&(r=this.search.val().length,n.setSelectionRange(r,r)),""===this.search.val()&&this.nextSearchTerm!=t&&(this.search.val(this.nextSearchTerm),this.search.select()),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(e){this.opened()&&(this.parent.close.apply(this,arguments),e=e||{focus:!0},this.focusser.removeAttr("disabled"),e.focus&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,n=this.container,i=this.dropdown;this.showSearch(this.opts.minimumResultsForSearch<0?!1:!0),this.selection=t=n.find(".select2-choice"),this.focusser=n.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+P()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.focusser.attr("tabindex",this.elementTabIndex),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){if(e.which===E.PAGE_UP||e.which===E.PAGE_DOWN)return void m(e);switch(e.which){case E.UP:case E.DOWN:return this.moveHighlight(e.which===E.UP?-1:1),void m(e);case E.ENTER:return this.selectHighlighted(),void m(e);case E.TAB:return void this.selectHighlighted({noFocus:!0});case E.ESC:return this.cancel(e),void m(e)}}})),this.search.on("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==E.TAB&&!E.isControl(e)&&!E.isFunctionKey(e)&&e.which!==E.ESC){if(this.opts.openOnEnter===!1&&e.which===E.ENTER)return void m(e);if(e.which==E.DOWN||e.which==E.UP||e.which==E.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void m(e)}return e.which==E.DELETE||e.which==E.BACKSPACE?(this.opts.allowClear&&this.clear(),void m(e)):void 0}})),l(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),g(e),this.close(),this.selection.focus())})),t.on("mousedown",this.bind(function(t){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(t)})),i.on("mousedown",this.bind(function(){this.search.focus()})),t.on("focus",this.bind(function(e){m(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var i=e.Event("select2-clearing");if(this.opts.element.trigger(i),i.isDefaultPrevented())return;var r=this.getPlaceholderOption();this.opts.element.val(r?r.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),t!==!1&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder())})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()?(e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val():!1},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find("option").filter(function(){return this.selected});t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=n.val(),s=null;t.query({matcher:function(e,n,i){var a=o(r,t.id(i));return a&&(s=i),a},callback:e.isFunction(i)?function(){i(s)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,r=this;if(this.findHighlightableChoices().each2(function(e,t){return o(r.id(t.data("select2-data")),r.opts.element.val())?(i=e,!1):void 0}),n!==!1&&this.highlight(t===!0&&i>=0?i:0),t===!0){var s=this.opts.minimumResultsForSearch;s>=0&&this.showSearch($(e.results)>=s)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.nextSearchTerm=this.opts.nextSearchTerm(e,this.search.val()),this.close(),t&&t.noFocus||this.focusser.focus(),o(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,r=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),r.empty(),null!==e&&(n=this.opts.formatSelection(e,r,this.opts.escapeMarkup)),n!==t&&r.append(n),i=this.opts.formatSelectionCssClass(e,r),i!==t&&r.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,i=null,r=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1]),this.select)this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return i=r.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:o});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){r.opts.element.val(e?r.id(e):""),r.updateSelection(e),r.setPlaceholder(),n&&r.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,i=!1;return 0===arguments.length?(n=this.selection.data("select2-data"),n==t&&(n=null),n):(arguments.length>1&&(i=arguments[1]),void(e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),i&&this.triggerChange({added:e,removed:n})):this.clear(i)))}}),q=A(j,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find("option").filter(function(){return this.selected}).each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var r=s(n.val(),t.separator),a=[];t.query({matcher:function(n,i,s){var l=e.grep(r,function(e){return o(e,t.id(s))}).length;return l&&a.push(s),l},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<r.length;n++)for(var s=r[n],l=0;l<a.length;l++){var u=a[l];if(o(s,t.id(u))){e.push(u),a.splice(l,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments)},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n);var i=this;this.selection.on("click",".select2-search-choice:not(.select2-locked)",function(){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+P()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.on("input paste",this.bind(function(){this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),i=n.prev(".select2-search-choice:not(.select2-locked)"),r=n.next(".select2-search-choice:not(.select2-locked)"),o=f(this.search);if(n.length&&(e.which==E.LEFT||e.which==E.RIGHT||e.which==E.BACKSPACE||e.which==E.DELETE||e.which==E.ENTER)){var s=n;return e.which==E.LEFT&&i.length?s=i:e.which==E.RIGHT?s=r.length?r:null:e.which===E.BACKSPACE?(this.unselect(n.first()),this.search.width(10),s=i.length?i:r):e.which==E.DELETE?(this.unselect(n.first()),this.search.width(10),s=r.length?r:null):e.which==E.ENTER&&(s=null),this.selectChoice(s),m(e),void(s&&s.length||this.open())}if((e.which===E.BACKSPACE&&1==this.keydowns||e.which==E.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void m(e);if(this.selectChoice(null),this.opened())switch(e.which){case E.UP:case E.DOWN:return this.moveHighlight(e.which===E.UP?-1:1),void m(e);case E.ENTER:return this.selectHighlighted(),void m(e);case E.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case E.ESC:return this.cancel(e),void m(e)}if(e.which!==E.TAB&&!E.isControl(e)&&!E.isFunctionKey(e)&&e.which!==E.BACKSPACE&&e.which!==E.ESC){if(e.which===E.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===E.PAGE_UP||e.which===E.PAGE_DOWN)&&m(e),e.which===E.ENTER&&m(e)}}})),this.search.on("keyup",this.bind(function(){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.addClass("select2-offscreen"),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.updateResults(!0),this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n=[],r=[],o=this;
e(t).each(function(){i(o.id(this),n)<0&&(n.push(o.id(this)),r.push(this))}),t=r,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(e,!1,this.opts.closeOnSelect===!0),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(n){var i,r,o=!n.locked,s=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=o?s:a,u=this.id(n),c=this.getVal();i=this.opts.formatSelection(n,l.find("div"),this.opts.escapeMarkup),i!=t&&l.find("div").replaceWith("<div>"+i+"</div>"),r=this.opts.formatSelectionCssClass(n,l.find("div")),r!=t&&l.addClass(r),o&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),m(t))})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",n),l.insertBefore(this.searchContainer),c.push(u),this.setVal(c)},unselect:function(t){var n,r,o=this.getVal();if(t=t.closest(".select2-search-choice"),0===t.length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(n=t.data("select2-data")){for(;(r=i(this.id(n),o))>=0;)o.splice(r,1),this.setVal(o),this.select&&this.postprocessResults();var s=e.Event("select2-removing");s.val=this.id(n),s.choice=n,this.opts.element.trigger(s),s.isDefaultPrevented()||(t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},postprocessResults:function(e,t,n){var r=this.getVal(),o=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),a=this;o.each2(function(e,t){var n=a.id(t.data("select2-data"));i(n,r)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&n!==!1&&a.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&C(a.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+a.opts.formatNoMatches(a.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-a(this.search)},resizeSearch:function(){var e,t,n,i,r,o=a(this.search);e=v(this.search)+10,t=this.search.offset().left,n=this.selection.width(),i=this.selection.offset().left,r=n-(t-i)-o,e>r&&(r=n-o),40>r&&(r=n-o),0>=r&&(r=e),this.search.width(Math.floor(r))},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),s(e,this.opts.separator))},setVal:function(t){var n;this.select?this.select.val(t):(n=[],e(t).each(function(){i(this,n)<0&&n.push(this)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator)))},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)o(this.opts.id(t[n]),this.opts.id(e[i]))&&(t.splice(n,1),n>0&&n--,e.splice(i,1),i--);return{added:t,removed:e}},val:function(n,i){var r,o=this;if(0===arguments.length)return this.getVal();if(r=this.data(),r.length||(r=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:r}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(r,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,o.id);o.setVal(n),o.updateSelection(t),o.clearSearch(),i&&o.triggerChange(o.buildChangeDetails(r,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,r,o=this;return 0===arguments.length?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(r=this.data(),t||(t=[]),i=e.map(t,function(e){return o.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(r,this.data())),void 0)}}),e.fn.select2=function(){var n,r,o,s,a,l=Array.prototype.slice.call(arguments,0),u=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],c=["opened","isFocused","container","dropdown"],d=["val","data"],h={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])n=0===l.length?{}:e.extend({},l[0]),n.element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?a=n.element.prop("multiple"):(a=n.multiple||!1,"tags"in n&&(n.multiple=a=!0)),r=a?new q:new D,r.init(n);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(i(l[0],u)<0)throw"Unknown method: "+l[0];if(s=t,r=e(this).data("select2"),r===t)return;if(o=l[0],"container"===o?s=r.container:"dropdown"===o?s=r.dropdown:(h[o]&&(o=h[o]),s=r[o].apply(r,l.slice(1))),i(l[0],c)>=0||i(l[0],d)&&1==l.length)return!1}}),s===t?this:s},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var r=[];return b(e.text,n.term,r,i),r.join("")},formatSelection:function(e,n,i){return e?i(e.text):t},sortResults:function(e){return e},formatResultCssClass:function(){return t},formatSelectionCssClass:function(){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return n(""+t).toUpperCase().indexOf(n(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:T,escapeMarkup:w,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null},nextSearchTerm:function(){return t}},e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:x,local:_,tags:k},util:{debounce:c,markMatch:b,escapeMarkup:w,stripDiacritics:n},"class":{"abstract":j,single:D,multi:q}}}}(jQuery),function(e){var t=e.fn.select2,n="aui-select2-container",i="aui-select2-drop aui-dropdown2 aui-style-default",r="aui-has-avatar";e.fn.auiSelect2=function(o){var s;if(e.isPlainObject(o)){var a=e.extend({},o),l=a.hasAvatar?" "+r:"";a.containerCssClass=n+l+(a.containerCssClass?" "+a.containerCssClass:""),a.dropdownCssClass=i+l+(a.dropdownCssClass?" "+a.dropdownCssClass:""),s=Array.prototype.slice.call(arguments,1),s.unshift(a)}else s=arguments.length?arguments:[{containerCssClass:n,dropdownCssClass:i}];return t.apply(this,s)}}(AJS.$),!function(e,t,n){function i(e,n){var i,r=t.createElement(e||"div");for(i in n)r[i]=n[i];return r}function r(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function o(e,t,n,i){var r=["opacity",t,~~(100*e),n,i].join("-"),o=.01+n/i*100,s=Math.max(1-(1-e)/t*(100-o),e),a=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return h[r]||(p.insertRule("@"+l+"keyframes "+r+"{0%{opacity:"+s+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+s+"}}",p.cssRules.length),h[r]=1),r}function s(e,t){var i,r,o=e.style;if(o[t]!==n)return t;for(t=t.charAt(0).toUpperCase()+t.slice(1),r=0;r<d.length;r++)if(i=d[r]+t,o[i]!==n)return i}function a(e,t){for(var n in t)e.style[s(e,n)||n]=t[n];return e}function l(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)e[r]===n&&(e[r]=i[r])}return e}function u(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}var c,d=["webkit","Moz","ms","O"],h={},p=function(){var e=i("style",{type:"text/css"});return r(t.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"},m=function g(e){return this.spin?void(this.opts=l(e||{},g.defaults,f)):new g(e)};m.defaults={},l(m.prototype,{spin:function(e){this.stop();var t,n,r=this,o=r.opts,s=r.el=a(i(0,{className:o.className}),{position:o.position,width:0,zIndex:o.zIndex}),l=o.radius+o.length+o.width;if(e&&(e.insertBefore(s,e.firstChild||null),n=u(e),t=u(s),a(s,{left:("auto"==o.left?n.x-t.x+(e.offsetWidth>>1):parseInt(o.left,10)+l)+"px",top:("auto"==o.top?n.y-t.y+(e.offsetHeight>>1):parseInt(o.top,10)+l)+"px"})),s.setAttribute("aria-role","progressbar"),r.lines(s,r.opts),!c){var d=0,h=o.fps,p=h/o.speed,f=(1-o.opacity)/(p*o.trail/100),m=p/o.lines;!function g(){d++;for(var e=o.lines;e;e--){var t=Math.max(1-(d+e*m)%p*f,o.opacity);r.opacity(s,o.lines-e,t,o)}r.timeout=r.el&&setTimeout(g,~~(1e3/h))}()}return r},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=n),this},lines:function(e,t){function n(e,n){return a(i(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*l+t.rotate)+"deg) translate("+t.radius+"px,0)",borderRadius:(t.corners*t.width>>1)+"px"})}for(var s,l=0;l<t.lines;l++)s=a(i(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:c&&o(t.opacity,t.trail,l,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&r(s,a(n("#000","0 0 4px #000"),{top:"2px"})),r(e,r(s,n(t.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}}),function(){function e(e,t){return i("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}var t=a(i("group"),{behavior:"url(#default#VML)"});!s(t,"transform")&&t.adj?(p.addRule(".spin-vml","behavior:url(#default#VML)"),m.prototype.lines=function(t,n){function i(){return a(e("group",{coordsize:u+" "+u,coordorigin:-l+" "+-l}),{width:u,height:u})}function o(t,o,s){r(d,r(a(i(),{rotation:360/n.lines*t+"deg",left:~~o}),r(a(e("roundrect",{arcsize:n.corners}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:s}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var s,l=n.length+n.width,u=2*l,c=2*-(n.width+n.length)+"px",d=a(i(),{position:"absolute",top:c,left:c});if(n.shadow)for(s=1;s<=n.lines;s++)o(s,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(s=1;s<=n.lines;s++)o(s);return r(t,d)},m.prototype.opacity=function(e,t,n,i){var r=e.firstChild;i=i.shadow&&i.lines||0,r&&t+i<r.childNodes.length&&(r=r.childNodes[t+i],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=n))}):c=s(t,"animation")}(),"function"==typeof define&&define("aui/internal/spin",[],function(){return m}),e.Spinner=m}(window,document),define("aui/button",["aui/internal/spin"],function(e){"use strict";function t(t){var n=o(t),i=document.createElement("div"),r=o(i);r.addClass("aui-button-spinner");var s={color:n.css("color"),lines:12,length:3,width:2,radius:3,trail:60,speed:1.5};r.data().spinner=new e(s).spin(i),n.append(i)}function n(e){var t=o(e),n=t.children(".aui-button-spinner").first(),i=n.data();i.spinner.stop(),delete i.spinner,n.remove()}function i(e){var t=e.getAttribute("aria-busy");return t&&"true"===t}function r(e){return"INPUT"===e.nodeName}var o=AJS.$,s=window.skate;s("aui-button",{type:s.types.CLASS,ready:function(e){e.hasAttribute("aria-busy")||e.setAttribute("aria-busy",!1)},prototype:{busy:function(){return r(this)||i(this)?(AJS.warn("It is not valid to call busy() on an input button."),this):(t(this),this.setAttribute("aria-busy",!0),this)},idle:function(){return r(this)||!i(this)?(AJS.warn("It is not valid to call idle() on an input button."),this):(n(this),this.setAttribute("aria-busy",!1),this)},isBusy:function(){return r(this)?(AJS.warn("It is not valid to call isBusy() on an input button."),!1):i(this)}}})}),function(e){"use strict";define("aui/trigger",[],function(){return e(AJS.$,window.skate)})}(function(e,t){"use strict";function n(e){return document.getElementById(e.getAttribute("aria-controls"))}function i(e,t){if(e.isEnabled()){var i=n(e);i&&i.message&&i.message(t)}}t("data-aui-trigger",{type:t.types.ATTR,insert:function(t){e(t).on({click:function(e){i(t,e),e.preventDefault()},"mouseenter mouseleave focus blur":function(e){i(t,e)}})},prototype:{disable:function(){this.setAttribute("aria-disabled","true")},enable:function(){this.setAttribute("aria-disabled","false")},isEnabled:function(){return"true"!==this.getAttribute("aria-disabled")}}})}),function(e){"use strict";define("aui/inline-dialog2",["./internal/alignment","./trigger"],function(t){return e(t,AJS.layer,window.skate)})}(function(e,t,n){"use strict";function i(e){return document.querySelector('[aria-controls="'+e.id+'"]')}function r(e,t){var n=i(e);n&&t(n)}function o(e,t){var n="hover"===e.getAttribute("data-aui-responds-to");n&&t(e)}function s(t,n){t._auiAlignment||(t._auiAlignment=new e(t,n))}function a(e,t){s(e,t),e._auiAlignment.enable()}function l(e,t){s(e,t),e._auiAlignment.disable()}function u(e,t){var n={toggle:["click"],hover:["mouseenter","mouseleave","focus","blur"]},i=e.getAttribute("data-aui-responds-to"),r=n[i];r&&r.indexOf(t.type)>-1&&d[t.type](e,t)}var c=1e3;n("aui-inline-dialog2",{type:n.types.TAG,ready:function(e){r(e,function(t){t.setAttribute("aria-expanded",e.isVisible()),t.setAttribute("aria-haspopup","true")}),o(e,function(){e.mouseInside=!1,e.addEventListener("mouseenter",function(){e.mouseInside=!0,e.message({type:"mouseenter"})}),e.addEventListener("mouseleave",function(){e.mouseInside=!1,e.message({type:"mouseleave"})})})},remove:function(e){e._auiAlignment&&e._auiAlignment.destroy()},prototype:{remove:function(){t(this).remove()},show:function(){var e=this;return t(this).show(),r(this,function(t){a(e,t),t.setAttribute("aria-expanded","true")}),this},hide:function(){var e=this;return t(this).hide(),r(this,function(t){l(e,t),t.setAttribute("aria-expanded","false")}),this},isVisible:function(){return t(this).isVisible()},message:function(e){return u(this,e),this}}});var d={click:function(e){e.isVisible()?t(e).isPersistent()||e.hide():e.show()},mouseenter:function(e){e.isVisible()||e.show(),e._clearMouseleaveTimeout&&e._clearMouseleaveTimeout()},mouseleave:function(e){if(!t(e).isPersistent()&&e.isVisible()){e._clearMouseleaveTimeout&&e._clearMouseleaveTimeout();var n=setTimeout(function(){e.mouseInside||e.hide()},c);e._clearMouseleaveTimeout=function(){clearTimeout(n),e._clearMouseleaveTimeout=null}}},focus:function(e){e.isVisible()||e.show()},blur:function(e){!t(e).isPersistent()&&e.isVisible()&&e.hide()}}}),function(e){e.fn.spin=function(t,n){var i,r;if("string"==typeof t){if(!t in e.fn.spin.presets)throw new Error("Preset '"+t+"' isn't defined");i=e.fn.spin.presets[t],r=n||{}}else{if(n)throw new Error("Invalid arguments. Accepted arguments:\n$.spin([String preset[, Object options]]),\n$.spin(Object options),\n$.spin(Boolean shouldSpin)");i=e.fn.spin.presets.small,r=e.isPlainObject(t)?t:{}}if(window.Spinner)return this.each(function(){var n=e(this),o=n.data();o.spinner&&(o.spinner.stop(),delete o.spinner),t!==!1&&(r=e.extend({color:n.css("color")},i,r),o.spinner=new Spinner(r).spin(this))});throw"Spinner class not available."},e.fn.spin.presets={small:{lines:12,length:3,width:2,radius:3,trail:60,speed:1.5},medium:{lines:12,length:5,width:3,radius:8,trail:60,speed:1.5},large:{lines:12,length:8,width:4,radius:10,trail:60,speed:1.5}},e.fn.spinStop=function(){if(window.Spinner)return this.each(function(){var t=e(this),n=t.data();n.spinner&&(n.spinner.stop(),delete n.spinner)});throw"Spinner class not available."}}(jQuery),function(e){"use strict";define("aui/flag",[],function(){return e(AJS,AJS.$,AJS.template)})}(function(e,t,n){"use strict";function i(n){if(n.hasOwnProperty("persistent")){var i;n.persistent?i=e.deprecate.getMessageLogger("persistent: true","5.8.0",{alternativeName:"close: never",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2893."}):n.persistent||(i=e.deprecate.getMessageLogger("persistent: false","5.8.0",{alternativeName:"close: manual",extraInfo:"See https://ecosystem.atlassian.net/browse/AUI-2893."})),i()}n=t.extend({},f,n);var l="never"!==n.close&&(n.close||n.persistent!==!0),c=o(n,l);return r(c),"auto"===n.close?(s(c),a(c)):"manual"===n.close?s(c):"never"===n.close||n.persistent||s(c),u(),d(c)}function r(e){var t=e[0];t.close=function(){l(e)}}function o(e,i){var r='<div class="aui-flag"><div class="aui-message aui-message-{type} {type} {closeable} shadowed"><p class="title"><strong>{title}</strong></p>{body}<!-- .aui-message --></div></div>',o=n(r).fill({"body:html":e.body||"",closeable:i?"closeable":"",title:e.title||"",type:e.type}).toString();return t(o)}function s(n){var i=t('<span class="aui-icon icon-close" role="button" tabindex="0"></span>');return i.click(function(){l(n)}),i.keypress(function(t){(t.which===e.keyCode.ENTER||t.which===e.keyCode.SPACE)&&(l(n),t.preventDefault())}),n.find(".aui-message").append(i)[0]}function a(e){e.find(".aui-message").addClass("aui-will-close"),setTimeout(function(){e[0].close()},h)}function l(e){var t=e.get(0);return t.setAttribute("aria-hidden","true"),t.dispatchEvent(new CustomEvent("aui-flag-close",{bubbles:!0})),t}function u(){var e=c(),n=e.find(".aui-flag");n.get().forEach(function(e){var n="true"===e.getAttribute("aria-hidden");n&&t(e).remove()})}function c(){return t("#"+p)}function d(n){var i=c();return i.length||(i=t('<div id="'+p+'"></div>'),t("body").prepend(i)),n.appendTo(i),e._internal.animation.recomputeStyle(n),n.attr("aria-hidden","false")[0]}var h=5e3,p="aui-flag-container",f={body:"",persistent:!1,close:"",title:"",type:"info"};return i}),function(e){"use strict";define("aui/banner",[],function(){return e(AJS,AJS.$,AJS.template)})}(function(e,t,n){"use strict";function i(e){var t=r(e);return o(),a(t),t}function r(e){var i='<div class="aui-banner aui-banner-{type}" role="banner"><p class="aui-banner-title" role="heading">{title}</p>{body}</div>',r=t(n(i).fill({type:"error",title:e.title||"","body:html":e.body||""}).toString());return r.find(".aui-banner-title:empty").remove(),r}function o(){var e=s(),n=e.find(".aui-banner");n.get().forEach(function(e){var n="true"===e.getAttribute("aria-hidden");n&&t(e).remove()})}function s(){return t("#"+l)}function a(t){var n=s();if(!n.length)throw new Error("You must implement the application header");t.prependTo(n),e._internal.animation.recomputeStyle(t),t.attr("aria-hidden","false")}var l="header";return i}),define("aui/checkbox-multiselect",[],function(){function e(e){var n=p(e.target),i=n.attr("data-value");t(this,i,n.hasClass("aui-dropdown2-checked"))}function t(e,t,n){var i=e.$select.find("option").filter(function(){var e=p(this);return e.attr("value")===t&&e.prop("selected")!=n});i.length&&(i.prop("selected",n),e.$select.trigger("change"))}function n(e){e.$dropdown.find("[data-aui-checkbox-multiselect-clear]").prop("disabled",function(){return u(e).length<1})}function i(e){return e.$dropdown.is("[aria-hidden=false]")?"":c(e).join(", ")}function r(e){return e.map(function(){var e=p(this);return{value:e.val(),label:e.text(),icon:e.data("icon"),styleClass:e.data("styleClass"),title:e.attr("title"),disabled:e.attr("disabled"),selected:e.attr("selected")}})}function o(e){return p(e).data("allLabel")||"All"}function s(e){e.$dropdown.html(f.dropdown(l(e))),n(e)}function a(e){var t=c(e),n=d(e)?o(e):t.join(", ");e.$btn.text(n)}function l(e){return r(e.getOptions())}function u(e){return r(e.getSelectedOptions())}function c(e){return p.map(u(e),function(e){return e.label})}function d(e){return 0===u(e).length}var h=window.skate,p=window.jQuery,f={dropdown:function(e){function t(){return p('<div class="aui-dropdown2-section">')}var n=t();p("<button />").attr({type:"button","data-aui-checkbox-multiselect-clear":"","class":"aui-button aui-button-link"}).text(AJS.I18n.getText("aui.checkboxmultiselect.clear.selected")).appendTo(n);var i=t(),r=p("<ul />").appendTo(i);return p.each(e,function(e,t){var n=p("<li />").attr({"class":t.styleClass||""}).appendTo(r),i=p("<a />").text(t.label).attr("data-value",t.value).addClass("aui-dropdown2-checkbox aui-dropdown2-interactive").appendTo(n);t.icon&&p("<span />").addClass("aui-icon").css("backgroundImage","url("+t.icon+')")').appendTo(i),t.selected&&i.addClass("aui-dropdown2-checked")}),p("<div />").append(n).append(i).html()},furniture:function(e,t){var n=e+"-dropdown",i=p("<select />").attr({name:e,multiple:"multiple"}).html(t),r=p("<div>").attr({id:n,"class":"aui-checkbox-multiselect-dropdown aui-dropdown2 aui-style-default"}),o=p("<button />").attr({"class":"aui-checkbox-multiselect-btn aui-button aui-dropdown2-trigger",type:"button","aria-owns":n,"aria-haspopup":!0});return p("<div />").append(i).append(o).append(r).html()}};h("aui-checkbox-multiselect",{type:h.types.TAG,template:function(e){var t=e.getAttribute("name")||AJS.id("aui-checkbox-multiselect-");e.innerHTML=f.furniture(t,e.innerHTML)},ready:function(t){t.$select=p("select",t).change(function(){a(t),n(t)}),t.$dropdown=p(".aui-checkbox-multiselect-dropdown",t).on("aui-dropdown2-item-check",e.bind(t)).on("aui-dropdown2-item-uncheck",e.bind(t)).on("click","button[data-aui-checkbox-multiselect-clear]",t.deselectAllOptions.bind(t)),t.$btn=p(".aui-checkbox-multiselect-btn",t).tooltip({title:function(){return i(t)}}),a(t),s(t)},prototype:{getOptions:function(){return this.$select.find("option")},getSelectedOptions:function(){return this.$select.find("option:selected")},selectOption:function(e){t(this,e,!0)},unselectOption:function(e){t(this,e,!1)},getValue:function(){return this.$select.val()},deselectAllOptions:function(){this.$select.val([]).trigger("change"),this.$dropdown.find(".aui-dropdown2-checked,.checked").removeClass("aui-dropdown2-checked checked")},addOption:function(e){p("<option />").attr({value:e.value,icon:e.icon,disabled:e.disabled,selected:e.selected,title:e.title}).text(e.label).appendTo(this.$select),a(this),s(this)},removeOption:function(e){this.$select.find("[value='"+e+"']").remove(),a(this),s(this)}}})}),function(e){"use strict";define("aui/polyfills/placeholder",[],function(){return e(AJS.$,window.skate)})}(function(e,t){"use strict";function n(t){var n=e(t);i(n),n.blur(function(){i(n)}),n.focus(function(){n.hasClass("aui-placeholder-shown")&&(n.val(""),n.removeClass("aui-placeholder-shown"))})}function i(t){e.trim(t.val()).length||(t.val(t.attr("placeholder")),t.addClass("aui-placeholder-shown"))}"placeholder"in document.createElement("input")||t("placeholder",{type:t.types.ATTR,insert:function(e){n(e)}})})}.apply(e,arguments)})}(this),define("js/connect/monkey-patch-messages",[],function(){return function(e){var t="ac-message-container",n=["error","generic","hint","info","success","warning"];n.forEach(function(n){var i=e[n];e[n]=function(){var n=Array.prototype.slice.call(arguments);if("function"==typeof n[0].attr&&n[0].length)try{var r=n[0];1===r.length&&r.attr("id")===t&&n.shift()}catch(o){}i.apply(e,n)}})}}),define("aui",["aui-experimental","aui-stable","js/connect/monkey-patch-messages"],function(e,t,n){return n(t.messages),t}),define("data/i18n",[],function(){return{"imageDiffer.imageDiffToolbar.button.blend.disabled.tooltip":gettext("Blend mode image diff is not available because images are not of the same dimension"),"imageDiffer.imageDiffToolbar.button.blend.tooltip":gettext("Compare the image changes by fading in the differences"),"imageDiffer.imageDiffToolbar.button.blend":gettext("Blend"),"imageDiffer.imageDiffToolbar.button.split.disabled.tooltip":gettext("Split mode image diff is not available because images are not of the same dimension"),"imageDiffer.imageDiffToolbar.button.split.tooltip":gettext("Compare the image changes by moving your mouse cursor left or right over the image"),"imageDiffer.imageDiffToolbar.button.split":gettext("Split"),"imageDiffer.imageDiffToolbar.button.two-up.tooltip":gettext("Compare images alongside each other"),"imageDiffer.imageDiffToolbar.button.twoup":gettext("Two-up")}}),define("data/environment",["jquery"],function(e){return e(document.body).hasClass("production")?"production":e(document.body).hasClass("staging")?"staging":"development"}),function(e){define("shims/string-extensions",["underscore"],function(){return function(){(function(){var e,t,n,i,r,o=[].slice;i=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},n=function(e){return/^\/(.+)\/([gimy]*)$/.exec(e)},t=function(e){var t;return"string"==typeof e?RegExp("^"+i(e)):(t=n(e),RegExp("^"+t[1],t[2]))},e=function(e){var t;return"string"==typeof e?RegExp(""+i(e)+"$"):(t=n(e),RegExp(""+t[1]+"$",t[2]))},r=function(e){var t,n,i,r,o;for(n=[],i=[],r=0,o=e.length;o>r;r++)t=e[r],(_.isRegExp(t)?n:i).push(t);return n.concat(_.sortBy(i,function(e){return-e.length}))},String.prototype.lstrip=function(){var e,n,i,s,a,l;for(i=1<=arguments.length?o.call(arguments,0):[],l=r(i),s=0,a=l.length;a>s;s++)if(n=l[s],e=t(n).exec(this))return this.substr(e[0].length);return this.toString()},String.prototype.rstrip=function(){var t,n,i,s,a,l;for(i=1<=arguments.length?o.call(arguments,0):[],l=r(i),s=0,a=l.length;a>s;s++)if(n=l[s],t=e(n).exec(this))return this.substr(0,this.length-t[0].length);return this.toString()},String.prototype.startsWith=function(){var e,n,i,r;for(n=1<=arguments.length?o.call(arguments,0):[],i=0,r=n.length;r>i;i++)if(e=n[i],t(e).test(this))return!0;return!1},String.prototype.endsWith=function(){var t,n,i,r;for(n=1<=arguments.length?o.call(arguments,0):[],i=0,r=n.length;r>i;i++)if(t=n[i],e(t).test(this))return!0;return!1}}).call(this)}.apply(e,arguments)})}(this),function(){var e,t,n,i=[].slice;e=String.prototype.format=function(){var n,r,o,s,a,l=this;return n=1<=arguments.length?i.call(arguments,0):[],0===n.length?function(){var e;return e=1<=arguments.length?i.call(arguments,0):[],l.format.apply(l,e)}:(s=0,o=a=!1,r="cannot switch from {} to {} numbering".format(),this.replace(/([{}])\1|[{](.*?)(?:!(.+?))?[}]/g,function(i,l,u,c){var d,h,p,f,m;if(l)return l;if(u.length){if(o=!0,a)throw r("implicit","explicit");h=null!=(p=t(n,u))?p:""}else{if(a=!0,o)throw r("explicit","implicit");h=null!=(f=n[s++])?f:""}return h=h.toString(),(d=e.transformers[c])?null!=(m=d.call(h))?m:"":h}))},t=function(e,t){var i;for(/^(\d+)([.]|$)/.test(t)||(t="0."+t);i=/(.+?)[.](.+)/.exec(t);)e=n(e,i[1]),t=i[2];return n(e,t)},n=function(e,t){var n;return n=e[t],"function"==typeof n?n.call(e):n},e.transformers={}}.call(this),define("shims/string-format",function(){}),function(e){define("shims/string-format-transformers",["shims/string-format","underscore"],function(){return function(){!function(e){e.esc=function(){return _.escape(this)},e.s=function(){return 1!==+this?"s":void 0}}(String.prototype.format.transformers)}.apply(e,arguments)})}(this),define("utils/initialize",["underscore"],function(e){var t=[],n=!1,i=function(){for(var e=t.length;e--;)t[e]();n=!0};return i.register=function(){if(t.push.apply(t,e.toArray(arguments)),n)for(var i=arguments.length;i--;)arguments[i]()},i}),function(e){define("jquery-plugins/jquery.pjax",["jquery"],function(){return function(){!function(e){function t(t,i,r){var o=this;return this.on("click.pjax",t,function(t){var s=e.extend({},m(i,r));s.container||(s.container=e(this).attr("data-pjax")||o),n(t,s)})}function n(t,n,i){i=m(n,i);var o=t.currentTarget;if("A"!==o.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(t.which>1||t.metaKey||t.ctrlKey||t.shiftKey||t.altKey||location.protocol!==o.protocol||location.hostname!==o.hostname||o.href.indexOf("#")>-1&&f(o)==f(location)||t.isDefaultPrevented())){var s={url:o.href,container:e(o).attr("data-pjax"),target:o},a=e.extend({},s,i),l=e.Event("pjax:click");e(o).trigger(l,[a]),l.isDefaultPrevented()||(r(a),t.preventDefault(),e(o).trigger("pjax:clicked",[a]))}}function i(t,n,i){i=m(n,i);var o=t.currentTarget;if("FORM"!==o.tagName.toUpperCase())throw"$.pjax.submit requires a form element";var s={type:o.method.toUpperCase(),url:o.action,container:e(o).attr("data-pjax"),target:o};if("GET"!==s.type&&void 0!==window.FormData)s.data=new FormData(o),s.processData=!1,s.contentType=!1;else{if(e(o).find(":file").length)return;s.data=e(o).serializeArray()}r(e.extend({},s,i)),t.preventDefault()}function r(t){function n(t,n,r){r||(r={}),r.relatedTarget=i;var o=e.Event(t,r);return a.trigger(o,n),!o.isDefaultPrevented()}t=e.extend(!0,{},e.ajaxSettings,r.defaults,t),e.isFunction(t.url)&&(t.url=t.url());var i=t.target,o=p(t.url).hash,a=t.context=g(t.container);t.data||(t.data={}),e.isArray(t.data)?t.data.push({name:"_pjax",value:a.selector}):t.data._pjax=a.selector;var l;t.beforeSend=function(e,i){if("GET"!==i.type&&(i.timeout=0),e.setRequestHeader("X-PJAX","true"),e.setRequestHeader("X-PJAX-Container",a.selector),!n("pjax:beforeSend",[e,i]))return!1;i.timeout>0&&(l=setTimeout(function(){n("pjax:timeout",[e,t])&&e.abort("timeout")},i.timeout),i.timeout=0);var r=p(i.url);o&&(r.hash=o),t.requestUrl=h(r)},t.complete=function(e,i){l&&clearTimeout(l),n("pjax:complete",[e,i,t]),n("pjax:end",[e,t])},t.error=function(e,i,r){var o=b("",e,t),a=n("pjax:error",[e,i,r,t]);"GET"==t.type&&"abort"!==i&&a&&s(o.url)},t.success=function(i,l,u){var d=r.state,h="function"==typeof e.pjax.defaults.version?e.pjax.defaults.version():e.pjax.defaults.version,f=u.getResponseHeader("X-PJAX-Version"),m=b(i,u,t),g=p(m.url);if(o&&(g.hash=o,m.url=g.href),h&&f&&h!==f)return void s(m.url);if(!m.contents)return void s(m.url);
r.state={id:t.id||c(),url:m.url,title:m.title,container:a.selector,fragment:t.fragment,timeout:t.timeout},(t.push||t.replace)&&window.history.replaceState(r.state,m.title,m.url);try{document.activeElement.blur()}catch(v){}m.title&&(document.title=m.title),n("pjax:beforeReplace",[m.contents,t],{state:r.state,previousState:d}),a.html(m.contents);var y=a.find("input[autofocus], textarea[autofocus]").last()[0];y&&document.activeElement!==y&&y.focus(),w(m.scripts);var x=t.scrollTo;if(o){var _=decodeURIComponent(o.slice(1)),k=document.getElementById(_)||document.getElementsByName(_)[0];k&&(x=e(k).offset().top)}"number"==typeof x&&e(window).scrollTop(x),n("pjax:success",[i,l,u,t])},r.state||(r.state={id:c(),url:window.location.href,title:document.title,container:a.selector,fragment:t.fragment,timeout:t.timeout},window.history.replaceState(r.state,document.title)),u(r.xhr),r.options=t;var f=r.xhr=e.ajax(t);return f.readyState>0&&(t.push&&!t.replace&&(x(r.state.id,d(a)),window.history.pushState(null,"",t.requestUrl)),n("pjax:start",[f,t]),n("pjax:send",[f,t])),r.xhr}function o(t,n){var i={url:window.location.href,push:!1,replace:!0,scrollTo:!1};return r(e.extend(i,m(t,n)))}function s(e){window.history.replaceState(null,"",r.state.url),window.location.replace(e)}function a(t){if(T===window.location.href)return void(T=null);T=null,u(r.xhr);var n,i=r.state,o=t.state;if(o&&o.container){if(i){if(i.id===o.id)return;n=i.id<o.id?"forward":"back"}var a=E[o.id]||[],l=e(a[0]||o.container),c=a[1];if(l.length){i&&_(n,i.id,d(l));var h=e.Event("pjax:popstate",{state:o,direction:n});l.trigger(h);var p={id:o.id,url:o.url,container:l,push:!1,fragment:o.fragment,timeout:o.timeout,scrollTo:!1};if(c){l.trigger("pjax:start",[null,p]),r.state=o,o.title&&(document.title=o.title);var f=e.Event("pjax:beforeReplace",{state:o,previousState:i});l.trigger(f,[c,p]),l.html(c),l.trigger("pjax:end",[null,p])}else r(p);l[0].offsetHeight}else s(location.href)}}function l(t){var n=e.isFunction(t.url)?t.url():t.url,i=t.type?t.type.toUpperCase():"GET",r=e("<form>",{method:"GET"===i?"GET":"POST",action:n,style:"display:none"});"GET"!==i&&"POST"!==i&&r.append(e("<input>",{type:"hidden",name:"_method",value:i.toLowerCase()}));var o=t.data;if("string"==typeof o)e.each(o.split("&"),function(t,n){var i=n.split("=");r.append(e("<input>",{type:"hidden",name:i[0],value:i[1]}))});else if(e.isArray(o))e.each(o,function(t,n){r.append(e("<input>",{type:"hidden",name:n.name,value:n.value}))});else if("object"==typeof o){var s;for(s in o)r.append(e("<input>",{type:"hidden",name:s,value:o[s]}))}e(document.body).append(r),r.submit()}function u(t){t&&t.readyState<4&&(t.onreadystatechange=e.noop,t.abort())}function c(){return(new Date).getTime()}function d(e){var t=e.clone();return t.find("script").each(function(){this.src||jQuery._data(this,"globalEval",!1)}),[e.selector,t.contents()]}function h(e){return e.search=e.search.replace(/([?&])(_pjax|_)=[^&]*/g,""),e.href.replace(/\?($|#)/,"$1")}function p(e){var t=document.createElement("a");return t.href=e,t}function f(e){return e.href.replace(/#.*/,"")}function m(t,n){return t&&n?n.container=t:n=e.isPlainObject(t)?t:{container:t},n.container&&(n.container=g(n.container)),n}function g(t){if(t=e(t),t.length){if(""!==t.selector&&t.context===document)return t;if(t.attr("id"))return e("#"+t.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+t.selector}function v(e,t){return e.filter(t).add(e.find(t))}function y(t){return e.parseHTML(t,document,!0)}function b(t,n,i){var r={},o=/<html/i.test(t),s=n.getResponseHeader("X-PJAX-URL");if(r.url=s?h(p(s)):i.requestUrl,o)var a=e(y(t.match(/<head[^>]*>([\s\S.]*)<\/head>/i)[0])),l=e(y(t.match(/<body[^>]*>([\s\S.]*)<\/body>/i)[0]));else var a=l=e(y(t));if(0===l.length)return r;if(r.title=v(a,"title").last().text(),i.fragment){if("body"===i.fragment)var u=l;else var u=v(l,i.fragment).first();u.length&&(r.contents="body"===i.fragment?u:u.contents(),r.title||(r.title=u.attr("title")||u.data("title")))}else o||(r.contents=l);return r.contents&&(r.contents=r.contents.not(function(){return e(this).is("title")}),r.contents.find("title").remove(),r.scripts=v(r.contents,"script[src]").remove(),r.contents=r.contents.not(r.scripts)),r.title&&(r.title=e.trim(r.title)),r}function w(t){if(t){var n=e("script[src]");t.each(function(){var t=this.src,i=n.filter(function(){return this.src===t});if(!i.length){var r=document.createElement("script"),o=e(this).attr("type");o&&(r.type=o),r.src=e(this).attr("src"),document.head.appendChild(r)}})}}function x(e,t){E[e]=t,D.push(e),k(j,0),k(D,r.defaults.maxCacheLength)}function _(e,t,n){var i,o;E[t]=n,"forward"===e?(i=D,o=j):(i=j,o=D),i.push(t),(t=o.pop())&&delete E[t],k(i,r.defaults.maxCacheLength)}function k(e,t){for(;e.length>t;)delete E[e.shift()]}function C(){return e("meta").filter(function(){var t=e(this).attr("http-equiv");return t&&"X-PJAX-VERSION"===t.toUpperCase()}).attr("content")}function S(){e.fn.pjax=t,e.pjax=r,e.pjax.enable=e.noop,e.pjax.disable=$,e.pjax.click=n,e.pjax.submit=i,e.pjax.reload=o,e.pjax.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html",scrollTo:0,maxCacheLength:20,version:C},e(window).on("popstate.pjax",a)}function $(){e.fn.pjax=function(){return this},e.pjax=l,e.pjax.enable=S,e.pjax.disable=e.noop,e.pjax.click=e.noop,e.pjax.submit=e.noop,e.pjax.reload=function(){window.location.reload()},e(window).off("popstate.pjax",a)}var T=window.location.href,A=window.history.state;A&&A.container&&(r.state=A);var E={},j=[],D=[];e.inArray("state",e.event.props)<0&&e.event.props.push("state"),e.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]\D|WebApps\/.+CFNetwork)/),e.support.pjax?S():$()}(jQuery)}.apply(e,arguments)})}(this),define("initialization",["jquery","utils/initialize","jquery-plugins/jquery.pjax"],function(e,t){e.support.pjax&&(e.pjax.defaults.timeout=2e3),e(document).on("pjax:end",t),t()}),define("utils/on-load",["jquery","underscore"],function(e,t){var n=[];return"complete"!==document.readyState&&e(window).on("load",function(){n.forEach(function(e){t.defer(e)}),n=[]}),function(e){"complete"===document.readyState?t.defer(e):n.push(e)}}),define("on-ready",[],function(){return function(e){return{onReady:e}}}),define("i18n/header-language-form",["jquery","on-ready"],function(e,t){return t(function(t){t.on("click","a",function(n){n.preventDefault(),t.find("input[name=language]").val(e(n.target).attr("data-value")),t.submit()})})}),define("data/debug",["jquery"],function(e){var t="true"===e("#bb-debug").attr("content");return t}),define("utils/gaq-push",["underscore","data/debug"],function(e,t){var n=!1,i=function(){if(n)t?console.log(["_gaq.push(",e.map(arguments,function(e){return'  ["'+e.join('", "')+'"]'}).join(",\n"),");"].join("\n")):(window._gaq||(window._gaq=[]),_gaq.push.apply(_gaq,e.toArray(arguments)));else{n=!0;var r="//www.google-analytics.com/plugins/ga/inpage_linkid.js";i(["_require","inpage_linkid",r],["_setAccount","UA-2456069-3"],["atl._setAccount","UA-6032469-33"]),i.apply(null,arguments)}};return i}),define("data/current-user",["jquery"],function(e){var t=e(document.body).data("currentUser")||{};return t}),define("utils/api-helper",["underscore"],function(e){var t=Array.prototype.concat,n={concat:function(){return e.extend(t.apply(this,e.toArray(arguments)),n)},toString:function(){var n="",i=e.toArray(arguments);if("[object Object]"===Object.prototype.toString.call(e.last(i))){var r=i.pop();e.each(e.keys(r).sort(),function(e,t){n+="{sep}{key}={val}".format({sep:t?"&":"?",key:encodeURIComponent(e),val:encodeURIComponent(r[e])})})}return"/{}/{}".format(e.map(t.apply(this,i),encodeURIComponent).join("/"),n)}},i=e.extend(["!api","1.0"],n);return i}),define("utils/preferences",["jquery","data/current-user","utils/api-helper"],function(e,t,n){function i(e){return{url:n.concat("user","preferences",t.username,e),dataType:"json"}}return{get:function(t){return e.ajax(_.extend(i(t),{type:"GET"}))},set:function(t,n){return e.ajax(_.extend(i(t),{type:"PUT",data:{value:n}}))},"delete":function(t){return e.ajax(_.extend(i(t),{type:"DELETE"}))}}}),define("i18n/call-for-translators",["jquery","on-ready","utils/gaq-push","utils/preferences"],function(e,t,n,i){return t(function(e){e.slideDown(),n(["atl._trackEvent","i18n","Show call for translators banner"]),e.on("messageClose",function(){i.set("dismiss-call-for-translators","True")}),e.on("click",".view-language-link",function(){n(["atl._trackEvent","i18n","View language preference","banner"])})})}),define("i18n/index",["i18n/header-language-form","i18n/call-for-translators"],function(){}),function(e){define("jquery-plugins/jquery.localize",["jquery"],function(){return function(){(function(){var e,t,n,i,r,o,s,a;s="0.8.0",o=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(?:[.](\d+))?)?(?:([-+]\d\d):(\d\d)|Z)$/,n=function(e,t,n){return null==t&&(t=0),null==n&&(n=0),e.setHours(a.H(e)-t,a.M(e)+(+t>0?-n:+n)),e},t=function(t){return i[t]||e[t]},r=function(e,t){return null==t&&(t=2),(e+1e3+"").substr(4-t)},a={yy:function(e){return r(a.yyyy(e)%100)},yyyy:function(e){return e.getFullYear()},m:function(e){return e.getMonth()+1},mm:function(e){return r(a.m(e))},mmm:function(e){return t("abbrMonths")[a.m(e)-1]},mmmm:function(e){return t("fullMonths")[a.m(e)-1]},d:function(e){return e.getDate()},dd:function(e){return r(a.d(e))},ddd:function(e){return t("abbrDays")[e.getDay()]},dddd:function(e){return t("fullDays")[e.getDay()]},o:function(e){return t("ordinals")(a.d(e))},h:function(e){return a.H(e)%12||12},hh:function(e){return r(a.h(e))},H:function(e){return e.getHours()},HH:function(e){return r(a.H(e))},M:function(e){return e.getMinutes()},MM:function(e){return r(a.M(e))},s:function(e){return e.getSeconds()},ss:function(e){return r(a.s(e))},S:function(e){return""+a.s(e)+"."+r(e%1e3,3)},SS:function(e){return""+a.ss(e)+"."+r(e%1e3,3)},a:function(e){return t("periods")[+(a.H(e)>11)]},Z:function(e){var t,n;return t=Math.abs(n=-e.getTimezoneOffset()),""+(0>n?"-":"+")+r(t/60>>0)+":"+r(t%60)}},e=function(t,n){var i,r,o,s,l,u,c;if(t instanceof Date||(n=t,t=new Date),n||(n=e.format),"function"==typeof n)return n(t);for(s=null,r=o="",c=(""+n.replace(/~/g,"~T").replace(/%%/g,"~P")+"%").split(""),l=0,u=c.length;u>l;l++)i=c[l],r&&(i===s||"%"===r?r+=i:(r=r.substr(1),o+=a.hasOwnProperty(r)?e.escaped?jQuery("<b>").text(a[r](t)).html():a[r](t):r)),/%/.test(r)||(r=/%/.test(n)?"%"===i?"%":(o+=i,""):"%"+i),s=i;return o.replace(/~P/g,"%").replace(/~T/g,"~")},e.abbrDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],e.abbrMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.fullDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],e.fullMonths=["January","February","March","April","May","June","July","August","September","October","November","December"],e.format="d mmmm yyyy",e.periods=["AM","PM"],e.ordinals=function(e){return e+["th","st","nd","rd"][e>10&&14>e||(e%=10)>3?0:e]},e.version=s,jQuery.localize=e,i={},jQuery.fn.localize=function(t){var r;return"object"==typeof t&&(jQuery.extend(i,t),t=i.format),t||(t=e.format),r=i.escaped?"html":"text",this.each(function(){var i,s,a;return i=jQuery(this),"time"===this.nodeName.toLowerCase()&&(a=o.exec(i.attr("datetime")||e("yyyy-mm-ddTHH:MM:ssZ"))),a?(s=n(new Date(Date.UTC(+a[1],a[2]-1,+a[3],+a[4],+a[5],+a[6]||0,+(""+(a[7]||0)+"00").substr(0,3))),a[8],a[9]),i.attr("datetime",e(s,"yyyy-mm-ddTHH:MM"+(a[7]?":SS":a[6]?":ss":"")+"Z")),i[r]("function"==typeof t?t.call(i,s):e(s,t))):void 0}),i={},this}}).call(this)}.apply(e,arguments)})}(this),define("utils/localize",["jquery","jquery-plugins/jquery.localize"],function(e){var t=5,n=Math.abs,i=Math.floor,r=Math.round;return e.localize.format=function(o,s){var a,l,u,c,d,h,p,f,m,g,v;if(null==s&&(s=new Date),l=(o-s)/1e3,l>-10&&300>l)return"just now";if(c=0>l,l=n(l),h=c?"ago":"from now",o.setHours(s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),a=n(r((o-s)/864e5)),a>t)return e.localize(o,"yyyy-mm-dd");if(a>1)return""+a+" days "+h;if(l>=86400)return c?"yesterday":"tomorrow";for(g=[["an hour",3600],["a minute",60],["a second",1]],f=0,m=g.length;m>f&&(v=g[f],p=v[0],d=v[1],!(l>=d));f++);return u=i(l/d),1===u?""+p+" "+h:""+u+" "+p.split(" ")[1]+"s "+h},function(t){t=t&&t.length?t:e("time"),t.each(function(){var t=e(this),n=t.data();n.format?t.localize({format:n.format,periods:n.associatedPressPeriods?["a.m.","p.m."]:void 0}):n.relative!==!1&&t.localize();var i=new Date(t.attr("datetime"));t.attr({title:e.localize(i,"d mmmm yyyy HH:MM")})})}}),define("localization",["jquery","utils/localize"],function(e,t){window.setInterval(t,6e4),e(function(){t()}),e(document).on("pjax:end",function(){t()})}),define("data/current-repo",["jquery"],function(e){var t=e(document.body).data("currentRepo")||{owner:{username:""},slug:""};return t.toString=function(){return t.cname?t.slug:"{owner.username}/{slug}".format(t)},t}),define("data/ga-commands",["jquery"],function(e){var t=e(document.body).data("gaCommands")||[];return t}),define("data/opt-commands",["jquery"],function(e){var t=e(document.body).data("optCommands")||[];return t}),define("data/sio-commands",["jquery"],function(e){return e(document.body).data("sioCommands")||[]}),define("utils/opt-push",["underscore","data/debug"],function(e,t){return function(n){n=e.isArray(n)?n:["trackEvent",n],t?console.log('window.optimizely.push(["'+n.join('", "')+'"])'):(window.optimizely=window.optimizely||[],window.optimizely.push(n))}}),define("utils/load-ace",["jquery","on-ready","data/debug"],function(e,t,n){return function(){var t;return n||t||(t=e.Deferred(),e.getScript("https://ace-cdn.atlassian.com/stp/current/analytics/js/atl-analytics.min.js").done(function(){ace.analytics.Initializer.initWithPageAnalytics("kFTUHPhH9Q"),ace.analytics.Initializer.ready(function(){t.resolve()})})),t.promise()}}),define("utils/sio-push",["underscore","data/debug","utils/load-ace"],function(e,t,n){return function(i){t?console.log('segment (["'+i.join('", "')+'"])'):n().then(function(){e.each(i,function(e){window.analytics[e[0]].apply(null,e[1])})})}}),define("tracking",["jquery","underscore","data/current-repo","data/ga-commands","data/opt-commands","data/sio-commands","utils/gaq-push","utils/opt-push","utils/sio-push"],function(e,t,n,i,r,o,s,a,l){s(["_trackPageview"]),s(["atl._trackPageview"]),n.analyticsKey&&s(["repo._setAccount",n.analyticsKey],["repo._trackPageview"]),t.each(i,function(e){switch(e.type){case"trackPageview":s(["atl._trackPageview",e.pageName]);break;case"trackEvent":s(["atl._trackEvent",e.eventCategory,e.eventName]);break;case"setCustomVar":s(["atl._setCustomVar",e.customVarSlot,e.customVarName,e.customVarValue,e.customVarScope])}}),t.each(r,function(e){a(e)}),o&&o.length>0&&l(o),e(".support-ga").on("click submit",function(){var t=e(this).data("support-gaq-page");s(["_trackPageview","/support/"+t],["atl._trackPageview","/support/"+t])}),e("#plan-details .aui-button-primary").on("click",function(){s(["atl._trackEvent","Account","Over Plan Upgrade"])})}),function(e){define("store",[],function(){return function(){var t=function(){function e(){try{return a in o&&o[a]}catch(e){return!1}}function t(){try{return l in o&&o[l]&&o[l][o.location.hostname]}catch(e){return!1}}function n(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(i),s.body.appendChild(i),i.addBehavior("#default#userData"),i.load(a);var n=e.apply(r,t);return s.body.removeChild(i),n}}var i,r={},o=window,s=o.document,a="localStorage",l="globalStorage",u="__storejs__";if(r.disabled=!1,r.set=function(){},r.get=function(){},r.remove=function(){},r.clear=function(){},r.transact=function(e,t){var n=r.get(e);"undefined"==typeof n&&(n={}),t(n),r.set(e,n)},r.serialize=function(e){return JSON.stringify(e)},r.deserialize=function(e){return"string"!=typeof e?void 0:JSON.parse(e)},e())i=o[a],r.set=function(e,t){i.setItem(e,r.serialize(t))},r.get=function(e){return r.deserialize(i.getItem(e))},r.remove=function(e){i.removeItem(e)},r.clear=function(){i.clear()};else if(t())i=o[l][o.location.hostname],r.set=function(e,t){i[e]=r.serialize(t)},r.get=function(e){return r.deserialize(i[e]&&i[e].value)},r.remove=function(e){delete i[e]},r.clear=function(){for(var e in i)delete i[e]};else if(s.documentElement.addBehavior){var i=s.createElement("div");r.set=n(function(e,t,n){e.setAttribute(t,r.serialize(n)),e.save(a)}),r.get=n(function(e,t){return r.deserialize(e.getAttribute(t))}),r.remove=n(function(e,t){e.removeAttribute(t),e.save(a)}),r.clear=n(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(a);for(var n,i=0;n=t[i];i++)e.removeAttribute(n.name);e.save(a)})}try{r.set(u,u),r.get(u)!=u&&(r.disabled=!0),r.remove(u)}catch(c){r.disabled=!0}return r}();return"undefined"!=typeof module&&(module.exports=t),e.store=t}.apply(e,arguments)})}(this),function(e,t){"function"==typeof define&&define.amd?define("data/client",t):t({initialize:!0})}(this,function(e){var t={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,i=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,n){if(-1!=n.indexOf(e[t].subString))return e[t].identity}else if(i)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Trident",identity:"Explorer",versionSearch:"rv:"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};t.init();var n={os:t.OS,browser:t.browser};return e.initialize&&(document.body.className+=" "+n.os.toLowerCase()+" "+n.browser.toLowerCase()),n}),define("data/when-i-type",[],function(){return{sections:[],keyDataMap:{}}}),define("js/components/aui-dialog",["jquery","aui"],function(e,t){return function(n){var i,r=new t.Dialog(n);return n.id&&(i=e("#{}".format(n.id)),i.addClass("bb-dialog").css({"margin-left":0,"margin-top":0})),r}}),define("utils/keyboard-shortcuts-dialog",["aui","jquery","data/when-i-type","js/components/aui-dialog"],function(e,t,n,i){function r(){o&&o.hide().remove(),o=null}var o;return function(){if(o){var e=o.popup.element.is(":visible");if(r(),e)return}o=new i({width:800,height:"auto",id:"bb-keyboard-shortcuts-dialog"}),o.addPanel("main").addHeader("Keyboard shortcuts").addCancel("Close",function(){r()});var s=t('<section id="keyboard-shortcuts" class="aui-group"></div>'),a=t('<div class="aui-item"></div>').appendTo(s),l=t('<div class="aui-item"></div>').appendTo(s),u=1;_.each(n.sections,function(e){var i,r="";_.each(n.keyDataMap[e],function(e){(!e.guard||t(e.guard).is(":visible"))&&(r+="<dt>"+e.desc+"</dt>",r+="<dd>",r+=_.map(e.keys,function(e){return"<kbd>"+e.join("</kbd> then <kbd>")+"</kbd>"}).join(" or "),r+="</dd>")}),r&&(u++,i=t('<div class="keyboard-shortcut-context"></div>'),i.append('<h3 class="context-title">'+e+"</h3>"),t("<dl></dl>").append(r).appendTo(i),(u%2?l:a).append(i))}),o.getCurrentPanel().html(s),o.show()}}),define("utils/when-i-type",["aui","jquery","underscore","data/client","data/when-i-type","utils/keyboard-shortcuts-dialog"],function(e,t,n,i,r,o){var s=function(n,i,a,l,u){function c(e){for(var t=e.length;t--;)if(e[t].length>1&&"space"!==e[t])return!0;return!1}var d,h,p,f=function(e,t,n){return n=t.length>1?interpolate(gettext("( type %(key1)s then %(key2)s )"),{key1:t[0],key2:t[1]},!0):interpolate(gettext("( type %(key1)s )"),{key1:t[0]},!0)},m=function(e){var i=t(e),r=i.attr("title")||"",o=n.slice(0);i.data("kbShortcutAppended")?(r=r.replace(/\)$/," OR "),r+=f(i,o,r).replace("(","")):(r=r?" ":"",r+=f(i,o,r)),i.attr({title:r}),i.data("kbShortcutAppended",!0)},g=function(e){var n=c(e)?"keydown":"keypress";t(document).on(n,u,e,function(e){d&&(l||!s.disabled&&!t("#keyboard-shortcut-container").is(":visible"))&&(!h||t(h).is(":visible"))&&(d(e),(u||13!==e.keyCode)&&e.preventDefault())})};return a||(a="Application"),Object.hasOwnProperty.call(r.keyDataMap,a)||(r.sections.push(a),r.keyDataMap[a]=[]),p={keys:[n],desc:i},r.keyDataMap[a].push(p),g(n),{or:function(e){return p.keys.push(e),g(e),this},moveToNextItem:function(n,i,r){d=function(){var o,s,a;if(t(".aui-dialog:visible").length&&-1===n.indexOf(".aui-dialog:visible")&&(n=".aui-dialog:visible "+n),s=t(n),a=t(n).filter(".focused"),d.blurHandler||t(document).one("keydown",function(t){t.keyCode===e.keyCode.ESCAPE&&a&&(a.removeClass("focused"),a.find("a:first").blur())}),0===a.length?a=t(n).eq(0):(a.removeClass("focused"),o=t.inArray(a.get(0),s),o<s.length-1?(o+=1,a=s.eq(o)):i&&i()?r():(a.removeClass("focused"),a=t(n).eq(0))),a&&a.length>0){a.addClass("focused"),a.moveTo();var l=a.find("a.execute");l.length||(l=a.find("a:first")),l.focus()}}},moveToPrevItem:function(n,i,r){d=function(){var o,s,a;t(".aui-dialog:visible").length&&-1===n.indexOf(".aui-dialog:visible")&&(n=".aui-dialog:visible "+n),s=t(n),a=t(n).filter(".focused"),d.blurHandler||t(document).one("keydown",function(t){t.keyCode===e.keyCode.ESCAPE&&a&&(a.removeClass("focused"),a.find("a:first").blur())}),0===a.length?a=t(n).last():(a.removeClass("focused"),o=t.inArray(a.get(0),s),o>0?(o-=1,a=s.eq(o)):i&&i()?r():(a.removeClass("focused"),a=t(n).last())),a&&a.length>0&&(a.addClass("focused"),a.moveTo(),a.find("a:first").focus())}},click:function(e){m(e),d=function(){t(e).trigger("click")}},goTo:function(e){d=function(){window.location.href=e}},followLink:function(e){m(e),d=function(){var n=t(e)[0];n&&"a"===n.nodeName.toLowerCase()&&(window.location.href=n.href)}},execute:function(e){d=e},moveToAndClick:function(e){m(e),d=function(){t(e).click().moveTo()}},moveToAndFocus:function(e){m(e),d=function(){t(e).focus().moveTo()}},focus:function(e){m(e),d=function(){t(e).focus()}},submitComment:function(){d=function(e){var n,i,r=t(e.currentTarget);1===r.length&&(n=r.closest("form"),1===n.length&&(i=n.find("button[type=submit]"),1===i.length&&i.click()))}},kbShortcutsDialog:function(){d=o},dismiss:function(){d=function(){t("#keyboard-shortcut-container").remove()}},guard:function(e){h=e,p.guard=e}}};return s.fromJSON=function(e){n.each(e,function(e){var t=e.section;n.each(e.shortcuts,function(e){var n=e.op,i=e.params||[],r=e.guard,o=s(e.keys,e.description,t,e.always,e.delegate);o[n].apply(null,i),r&&o.guard(r),e.aliasKeys&&o.or(e.aliasKeys)})})},t(document).on("keydown",function(e){27===e.keyCode&&/^(input|select|textarea)$/i.test(e.target.nodeName)&&e.target.blur()}),t(document).on("iframeAppended",function(e,n){t(n).load(function(){t(n).contents().bind("keyup keydown keypress",function(e){("Safari"!==i.browser||"keypress"!==e.type)&&(/^(input|select|textarea)$/i.test(e.target.nodeName)||t(document).trigger(e))})})}),s}),define("keyboard-shortcuts",["jquery","aui","store","underscore","data/current-user","utils/initialize","utils/when-i-type","jquery-plugins/jquery.pjax"],function(e,t,n,i,r,o,s){if(r.isKbdShortcutsEnabled){var a=function(t){var i=e(".iterable-item.focused  a.execute:visible").first();if(i.length){t.preventDefault();var r=i.attr("href");if(!i.data("add-to-stack")){var o=n.get("lastFocusedIdArray")||[];o.push({id:r}),n.set("lastFocusedIdArray",o),n.set("leaveFocusedUniqueId",!0)}i.hasClass("click")||e.support.pjax&&i.data("bb-pjax-enabled")?i.click():window.location.href=r}},l=function(){return e("a.next-page, a.prev-page").length},u=function(){var t=e("a.next-page");t.attr("href")&&(n.set("focusFirst",!0),s.disabled=!0,e.support.pjax&&t.data("bb-pjax-enabled")?t.click():window.location=t.attr("href"))},c=function(){var t=e("a.prev-page");t.attr("href")&&(n.set("focusLast",!0),s.disabled=!0,e.support.pjax&&t.data("bb-pjax-enabled")?t.click():window.location=t.attr("href"))},d=[{section:gettext("Global navigation"),shortcuts:[{keys:["g","d"],description:gettext("Go to dashboard"),op:"followLink",params:["#logo a"]},{keys:["g","a"],description:gettext("Go to account settings"),op:"followLink",params:["#account-link"],guard:"#user-dropdown-trigger"},{keys:["g","i"],description:gettext("Go to inbox"),op:"followLink",params:["#inbox-link"],guard:"#user-dropdown-trigger"},{keys:["/"],description:gettext("Focus the site search"),op:"focus",params:["#search-query"]}]},{section:gettext("Global actions"),shortcuts:[{keys:["c","r"],description:gettext("Create a repository"),op:"followLink",params:["#create-repo-link"],guard:"#repositories-dropdown-trigger"},{keys:["i","r"],description:gettext("Import a repository"),op:"followLink",params:["#import-repo-link"],guard:"#repositories-dropdown-trigger"}]},{section:gettext("Repository navigation"),shortcuts:[{keys:["r","o"],description:gettext("Repository overview"),guard:"#repo-overview-link",op:"followLink",params:["#repo-overview-link"]},{keys:["r","s"],description:gettext("Repository source"),guard:"#repo-source-link",op:"followLink",params:["#repo-source-link"]},{keys:["r","c"],description:gettext("Repository commits"),guard:"#repo-commits-link",op:"followLink",params:["#repo-commits-link"]},{keys:["r","b"],description:gettext("Repository branches"),guard:"#repo-branches-link",op:"followLink",params:["#repo-branches-link"]},{keys:["r","p"],description:gettext("Repository pull requests"),guard:"#repo-pullrequests-link",op:"followLink",params:["#repo-pullrequests-link"]},{keys:["r","q"],description:gettext("Repository patch series"),guard:"#repo-patch-series-link",op:"followLink",param:["#repo-patch-series-link"]},{keys:["r","w"],description:gettext("Repository wiki"),guard:"#repo-wiki-link",op:"followLink",params:["#repo-wiki-link"]},{keys:["r","i"],description:gettext("Repository issues"),guard:"#repo-issues-link",op:"followLink",params:["#repo-issues-link"]},{keys:["r","d"],description:gettext("Repository downloads"),guard:"#repo-downloads-link",op:"followLink",params:["#repo-downloads-link"]},{keys:["r","a"],description:gettext("Repository administration"),guard:"#repo-admin-link",op:"followLink",params:["#repo-admin-link"]}]},{section:gettext("Repository actions"),shortcuts:[{keys:["x","f"],description:gettext("Fork repository"),guard:"#repo-fork-link, .repository-actions.forks-enabled",op:"followLink",params:["#repo-fork-link"]},{keys:["x","b"],description:gettext("Create branch"),guard:"#repo-create-branch-link, .repository-actions.can-create",op:"click",params:["#repo-create-branch-link"]},{keys:["x","c"],description:gettext("Compare repository"),guard:"#repo-compare-link, .repository-actions",op:"followLink",params:["#repo-compare-link"]},{keys:["x","p"],description:gettext("Create pull request"),guard:"#repo-create-pull-request-link, .repository-actions.can-create",op:"followLink",params:["#repo-create-pull-request-link"]},{keys:["x","i"],description:gettext("Create issue"),guard:"#repo-issues-link",op:"followLink",params:["#repo-create-issue"]},{keys:["x","u"],description:gettext("Invite user to repository"),guard:"#repo-invite-link",op:"click",params:["#repo-invite-link"]},{keys:["x","w"],description:gettext("Follow repository"),guard:"#repo-follow",op:"click",params:["#repo-follow"]}]},{section:gettext("List navigation"),shortcuts:[{keys:["j"],description:gettext("Select next item"),guard:".iterable-item:visible",op:"moveToNextItem",params:[".iterable-item:visible",l,u]},{keys:["k"],description:gettext("Select previous item"),guard:".iterable-item:visible",op:"moveToPrevItem",params:[".iterable-item:visible",l,c]},{keys:["return"],aliasKeys:["o"],description:gettext("View selected item"),guard:".iterable-item:visible",op:"execute",params:[a]}]},{section:gettext("Application"),shortcuts:[{keys:["?"],description:gettext("Display this help"),op:"kbShortcutsDialog",always:!0},{keys:["esc"],description:gettext("Dismiss dialog or remove focus"),op:"dismiss",always:!0},{keys:["u"],description:gettext("Back up"),op:"execute",params:[function(){n.set("leaveFocusedUniqueId",!0),window.history.back()}]},{keys:["["],description:gettext("Collapse/expand sidebar"),op:"execute",params:[e.noop],guard:".aui-sidebar"}]},{section:gettext("Commits / pull requests"),shortcuts:[{keys:["ctrl+return"],delegate:"textarea#id_new_comment",description:gettext("Submit your comment."),op:"submitComment",always:!0},{keys:["t","c"],description:gettext("Toggle display of inline comments"),guard:"#changeset-diff",op:"execute",params:[function(){var t=e("#changeset-diff");t.find(".comment-thread-container").addClass("existing-comment"),t.toggleClass("hide-comments")}]},{keys:["p","d"],description:gettext("Switch to the pull request diff tab"),guard:"#pr-menu-diff",op:"execute",params:[function(){e(window).scrollTo("#pr-menu-diff",500,{axis:"y",offset:-50}),e("#pr-menu-diff").click()}]},{keys:["p","c"],description:gettext("Switch to the pull request commits tab"),guard:"#pr-menu-commits",op:"execute",params:[function(){e(window).scrollTo("#pr-menu-commits",500,{axis:"y",offset:-50}),e("#pr-menu-commits").click()}]},{keys:["p","a"],description:gettext("Switch to the pull request activity tab"),guard:"#pr-menu-activity",op:"execute",params:[function(){e(window).scrollTo("#pr-menu-activity",500,{axis:"y",offset:-50}),e("#pr-menu-activity").click()}]}]}];s.fromJSON(d);var h=function(){var i=null;if(n.get("focusLast"))i=e(".iterable-item:visible").last(),n.remove("focusLast"),s.disabled=!1;else if(n.get("focusFirst"))i=e(".iterable-item:visible").first(),n.remove("focusFirst"),s.disabled=!1;else{var r=n.get("lastFocusedIdArray");if(r)for(;r.length;){var o=r.pop();if(i=e('.iterable a[href="'+o.id+'"]:visible').closest(".iterable-item"),i.length){n.set("lastFocusedIdArray",r),n.remove("leaveFocusedUniqueId"),s.disabled=!1;break}}}if(i&&i.length){i.addClass("focused");var a=i.find("a.execute");a.length||(a=i.find("a:first")),a.focus(),e(document).one("keydown",function(e){e.keyCode===t.keyCode.ESCAPE&&(i.removeClass("focused"),i.find("a:focus").blur())})}};o.register(h),e(document).on("bb:compare",h);var p=window.onbeforeunload;window.onbeforeunload=function(e){return n.get("leaveFocusedUniqueId")||n.remove("lastFocusedIdArray"),n.remove("leaveFocusedUniqueId"),"function"==typeof p?p(e):void 0}}}),define("utils/ready",["jquery"],function(e){return function(t,n){var i=function(){if(n){var i=e(t);i.length&&n(i)}else t()};e(document).on("pjax:end",i),e(i)}}),define("select2",["aui","jquery","utils/ready"],function(e,t,n){t.fn.select2.defaults.minimumResultsForSearch=8,n(function(){t("select.aui-select2").each(function(){var e,n=t(this);e=n.find("option").first(),e.val()||"---------"!==e.text()||e.text("")}).auiSelect2()})}),function(e){define("bitbucket",["jquery"],function(){return function(){return function(){var e,t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,S,T,A,E,j,D,q,P=[].slice,I={}.hasOwnProperty,R=function(e,t){function n(){this.constructor=e
}for(var i in t)I.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};i={},n=function(e,t){return function(){var n;return n=1<=arguments.length?P.call(arguments,0):[],t.apply(e,n)}},y=function(e,t){return null==e&&(e={}),"function"==typeof e&&(e={success:e}),void 0!==t&&(e.data=t),e},s=function(e,t){var n;return e=y(e),(n=e.success)&&(e.success=function(e,i,r){return n(t(e),i,r)}),e},S=function(e,t,n){var i,r,o,s,a;if(r=/^(.+?)[.](.+)$/.exec(t))S(e[r[1]],r[2],n);else if(r=/^\[(.+)\]$/.exec(t))for(t=r[1],s=0,a=e.length;a>s;s++)o=e[s],n(o,t);else if(r=/^\{(.+)\}$/.exec(t)){t=r[1];for(i in e)I.call(e,i)&&(o=e[i],n(o,t))}else n(e,t);return e},w=function(e,t){var n,i;e=y(e);for(i in t)I.call(t,i)&&(n=t[i])(i,e);return e},b=function(e){return function(t,n){return s(n,function(n){return S(n,t,e)})}},o={utc_created_on:"date_created",utc_last_updated:"date_updated",utc_sent_on:"date_created",utc_updated_on:"date_updated"},e=b(function(e,t){var n,i,r,s,a,l,u,c;for(u=t.split(","),a=0,l=u.length;l>a;a++)i=u[a],c=i.split(":"),s=c[0],r=c[1],(n=e[s])&&(r||(r=o[s]||"date"),delete e[s],delete e[s.replace(/^utc_?/,"")],e[r]=new Date(n.replace(" ","T")));return e}),v=b(function(e){return-1===e.size?delete e.size:void 0}),t=function(e,t){var n,i;return e===t?0:(n=e.toLowerCase(),i=t.toLowerCase(),(n===i?t>e:i>n)?-1:1)},c=b(function(e,n){var i,r,o,s,a;return a=n.split(":"),o=a[0],r=a[1],o in e&&(s=e[o].replace(/^\s+|\s+$/g,""),i=s?s.split(/\s*[\n\r]\s*/).sort(t):[],delete e[o],e[r||o]=i),e}),m=b(function(e,t){var n,i,r,o;return o=t.split(":"),i=o[0],n=o[1],i in e&&(r=e[i],delete e[i],e[n]=r),e}),T=b(function(e,t){var n,i,r,o,s,a;for(s=t.split(":"),t=s[0],i=s[1],a=i.split(","),r=0,o=a.length;o>r;r++)n=a[r],e[n]=e[t][n];return delete e[t],e}),g=function(e,t){return s(t,function(t){return t[e]})},u=function(e){return function(){var t,n,r,o,s;return r=arguments[0],o=3<=arguments.length?P.call(arguments,1,s=arguments.length-1):(s=1,[]),n=arguments[s++],t=o[0],n=y(n,t),n.type=e,n.url=r,"GET"!==e||i.proxy_url||(n.dataType="jsonp"),$.ajax(n)}},d=u("POST"),l=u("GET"),p=u("PUT"),a=u("DELETE"),A=function(){var e,t;return e=1<=arguments.length?P.call(arguments,0):[],t=i.proxy_url,(t||"https://bitbucket.org/!api/1.0/")+e.join("/")},f=function(e){var t,n,i,r,o,s,a,l,u;if(null==e&&(e={}),i=function(){var t;t=[];for(n in e)I.call(e,n)&&t.push(n);return t}().sort(),0===i.length)return"";for(t=[],s=0,l=i.length;l>s;s++)for(n=i[s],o=e[n],o instanceof Array||(o=[o]),a=0,u=o.length;u>a;a++)r=o[a],t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return"?"+t.join("&")},i.error=function(e){function t(e){return this instanceof t?(this.name="bitbucket.error",void(this.message=e)):new t(e)}return R(t,e),t}(Error),_=function(t,n,i){var r,o;return null==i&&(i="%"),"string"==typeof n&&(i=n,n={}),r=["component","kind","milestone","version"],o={},o[i.replace(/%/,"utc_created_on,utc_last_updated")]=e,o[i.replace(/%/,"metadata:"+r.join())]=T,w(y(t,n),o)},k=function(t,n,i){var r;return null==i&&(i="%"),"string"==typeof n&&(i=n,n={}),r={},r[i.replace(/%/,"utc_created_on,utc_updated_on")]=e,r[i.replace(/%/,"author_info:author")]=m,w(y(t,n),r)},C=function(t,n,i){var r;return null==i&&(i="%"),"string"==typeof n&&(i=n,n={}),null!=(null!=n?n.mailing_lists:void 0)&&(n.email_mailinglist=n.mailing_lists.join("\n"),delete n.mailing_lists),r={},r[i.replace(/%/,"utc_created_on,utc_last_updated")]=e,r[i.replace(/%/,"email_mailinglist:mailing_lists")]=c,w(y(t,n),r)},x=function(t,n){var i;return null==n&&(n="%"),i={},i[n.replace(/%/,"utctimestamp")]=e,i[n.replace(/%/,"size")]=v,w(y(t),i)},i.flags={access:{direct:1,via_groups:2},output:{include_groups:4}},h=function(){var e,t,n,r,o,s,a,l,u,c;for(a=["read","write","admin"],l={},o=u=0,c=a.length;c>u;o=++u)r=a[o],l[r]=o;return s=function(){var e;return e=1<=arguments.length?P.call(arguments,0):[],a[Math.max.apply(Math,function(){var t,n,i;for(i=[],t=0,n=e.length;n>t;t++)r=e[t],i.push(l[r]||0);return i}())]},e=i.flags.access.direct,t=i.flags.access.via_groups,n=i.flags.output.include_groups,function(i){return{direct:e,expand:t,flags:i,groups:n,max:s,privileges:{}}}}(),i.repositories=function(){var e,t,n,i;return n=2<=arguments.length?P.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],l(A("repositories")+f(t),C(e,"repositories.[%]"))},i.repository=function(){function t(e,n){var i;return null==n&&(i=e.split("/"),e=i[0],n=i[1]),this instanceof t?(this.username=e,void(this.slug=n)):new t(e,n)}return t.create=function(e,n){var r,o;if(o=e.username,r=e.slug,!o||!r)throw i.error('"username" and "slug" are required attributes');if(/^[.]{1,2}$/.test(r))throw i.error('"'+r+'" is an invalid slug');if(/[^a-z0-9.-]/.test(r))throw i.error('"'+r+'" does not match /^[a-z0-9.-]+$/');return delete e.username,delete e.slug,e.name=r,d(A("repositories"),C(n,e)),t(o,r)},t.prototype.toString=function(){return this.username+"/"+this.slug},t.prototype.url=function(){var e;return e=1<=arguments.length?P.call(arguments,0):[],A.apply(null,["repositories",this.username,this.slug].concat(P.call(e)))},t.prototype.details=function(e){return l(this.url(),C(e))},t.prototype.update=function(e,t){return p(this.url(),C(t,e))},t.prototype.destroy=function(e){return a(this.url(),e)},t.prototype.branches=function(t){return l(this.url("branches"),w(t,{"{utctimestamp}":e,"{size}":v}))},t.prototype.changeset=function(e,t){return l(this.url("changesets",e),x(t))},t.prototype.changesets=function(){var e,t,n,i;return n=2<=arguments.length?P.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],l(this.url("changesets")+f(t),x(e,"changesets.[%]"))},t.prototype.diffstat=function(e,t){return l(this.url("changesets",e,"diffstat"),t)},t.prototype.directory=function(){var t,n,i,r;return i=arguments[0],n=3<=arguments.length?P.call(arguments,1,r=arguments.length-1):(r=1,[]),t=arguments[r++],l(this.url("src",i,n),w(t,{"files.[utctimestamp]":e}))},t.prototype.file=function(e,t,n){return l(this.url("src",e,t),g("data",n))},t.prototype.followers=function(e){return l(this.url("followers"),g("followers",e))},t.prototype.create_issue=function(e,t){return d(this.url("issues"),_(t,e))},t.prototype.update_issue=function(e,t,n){return p(this.url("issues",e),_(n,t))},t.prototype.delete_issue=function(e,t){return a(this.url("issues",e),t)},t.prototype.issue=function(e,t){return l(this.url("issues",e),_(t))},t.prototype.create_issue_comment=function(e,t,n){return d(this.url("issues",e,"comments"),k(n,t))},t.prototype.update_issue_comment=function(e,t,n,i){return p(this.url("issues",e,"comments",t),k(i,n))},t.prototype.delete_issue_comment=function(e,t,n){return a(this.url("issues",e,"comments",t),n)},t.prototype.issue_comment=function(e,t,n){return l(this.url("issues",e,"comments",t),k(n))},t.prototype.issue_comments=function(e,t){return l(this.url("issues",e,"comments"),k(t,"[%]"))},t.prototype.issue_followers=function(e,t){return l(this.url("issues",e,"followers"),g("followers",t))},t.prototype.issues=function(){var e,t,n,i;return n=2<=arguments.length?P.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],l(this.url("issues")+f(t),_(e,"issues.[%]"))},t.prototype.create_linkifier=function(e,t){return d(this.url("links"),e,t)},t.prototype.update_linkifier=function(e,t,n){return p(this.url("links",e),t,n)},t.prototype.delete_linkifier=function(e,t){return a(this.url("links",e),t)},t.prototype.linkifier=function(e,t){return l(this.url("links",e),t)},t.prototype.linkifiers=function(){},t.prototype.deploy_key=function(e,t,n){return l(this.url("deploy-keys",e),t,n)},t.prototype.deploy_keys=function(e,t){return l(this.url("deploy-keys"),e,t)},t.prototype.create_deploy_key=function(e,t){return d(this.url("deploy-keys"),e,t)},t.prototype.update_deploy_key=function(e,t,n){return p(this.url("deploy-keys",e),t,n)},t.prototype.delete_deploy_key=function(e,t){return a(this.url("deploy-keys",e),t)},t.prototype.privileges=function(e,t){var i,r,o,s,a,u;return null==t&&(t=e,e=3),t=y(t),a=t.success||function(){},o=t.error||function(){},r=h(e),i=2,u=function(){return--i>0},s=!1,t.error=function(e,t,n){return s?void 0:(o(e,t,n),s=!0)},t.success=n(r,function(e,t,n){var i,r,o,s,l,c;if(this.flags&this.direct)for(s=0,l=e.length;l>s;s++)c=e[s],i=c.privilege,r=c.user,o=r.username,this.privileges[o]=this.max(this.privileges[o],i);return u()?void 0:a(this.privileges,t,n)}),l(A("privileges",this),t),t.success=n(r,function(e,t,n){var i,r,o,s,l,c,d,h,p;if(this.flags&(this.groups|this.expand))for(s=0,c=e.length;c>s;s++)if(h=e[s],r=h.privilege,i=h.group,this.flags&this.groups&&(this.privileges[i.owner.username+"/"+i.slug]=r),this.flags&this.expand)for(p=i.members,l=0,d=p.length;d>l;l++)o=p[l].username,this.privileges[o]=this.max(this.privileges[o],r);return u()?void 0:a(this.privileges,t,n)}),l(A("group-privileges",this),t)},t.prototype.tags=function(t){return l(this.url("tags"),w(t,{"{utctimestamp}":e,"{size}":v}))},t.prototype.wiki_page=function(){var e,t,n,i;return n=2<=arguments.length?P.call(arguments,0,i=arguments.length-1):(i=0,[]),e=arguments[i++],t=n[0],l(this.url("wiki",t),e)},t}(),q=["component","milestone","version"],E=function(){var e,t,n;return t=r,e=r+"s",n=i.repository.prototype,n["create_"+t]=function(t,n){return d(this.url("issues",e),{name:t},n)},n["update_"+t]=function(t,n,i){return p(this.url("issues",e,t),{name:n},i)},n["delete_"+t]=function(t,n){return a(this.url("issues",e,t),n)},n[t]=function(t,n){return l(this.url("issues",e,t),n)},n[e]=function(t){return l(this.url("issues",e),t)}};for(j=0,D=q.length;D>j;j++)r=q[j],E();i.send_invitation=function(t,n,i,r){var o,s,a,l;return l=i.toString().split("/"),a=l[0],s=l[1],o=A("invitations",a,s,t),d(o,{permission:n},e("utc_sent_on",C(r,"repository.%")))},i.send_general_invitation=function(e,t){return d(A("invitations",e),t)},i.users=function(e,t){var n;return 0===(null!=(n=e.user)?n.length:void 0)?(t=y(t),"function"==typeof t.complete&&t.complete(),void t.success([])):l(A("users")+f(e),s(t,function(e){var t,n,i,r;for(n={},i=0,r=e.length;r>i;i++)t=e[i],n[t.username]=t;return n}))},i.user=function(){function t(e){return this instanceof t?void(this.username=e):new t(e)}return t.create=function(e,n){var r;if(r=e.username,!r)throw i.error('"username" is a required attribute');return d(A("newuser"),e,n),t(r)},t.prototype.url=function(){var e;return e=1<=arguments.length?P.call(arguments,0):[],A.apply(null,["users",this.username].concat(P.call(e)))},t.prototype.details=function(e){return l(this.url(),g("user",e))},t.prototype.events=function(){var t,n,i,r;return i=2<=arguments.length?P.call(arguments,0,r=arguments.length-1):(r=0,[]),t=arguments[r++],n=i[0],l(this.url("events")+f(n),w(t,{"events.[utc_created_on:date]":e}))},t.prototype.followers=function(e){return l(this.url("followers"),g("followers",e))},t.prototype.delete_invitation=function(e,t){return a(this.url("invitations",e),t)},t.prototype.invitation=function(t,n){return l(this.url("invitations",t),w(n,{utc_sent_on:e}))},t.prototype.invitations=function(t){return l(this.url("invitations"),w(t,{"[utc_sent_on]":e}))},t.prototype.invite=function(e,t,n){return p(this.url("invitations",e,t),n)},t.prototype.uninvite=function(e,t,n){return a(this.url("invitations",e,t),n)},t.prototype.plan=function(e){return l(this.url("plan"),e)},t.prototype.privileges=function(e,t){var i,r,o,s,a,u;return null==t&&(t=e,e=3),t=y(t),a=t.success||function(){},o=t.error||function(){},r=h(e),i=2,u=function(){return--i>0},s=!1,t.error=function(e,t,n){return s?void 0:(o(e,t,n),s=!0)},t.success=n(r,function(e,t,n){var i,r,o,s,l,c,d;if(this.flags&this.direct)for(l=0,c=e.length;c>l;l++)d=e[l],i=d.privilege,r=d.repo,o=d.user,r=(s=this.privileges)[r]||(s[r]={}),r[o.username]=this.max(r[o.username],i);return u()?void 0:a(this.privileges,t,n)}),l(A("privileges",this.username),t),t.success=n(r,function(e,t,n){var i,r,o,s,l,c,d,h,p,f,m;if(this.flags&(this.groups|this.expand))for(c=0,h=e.length;h>c;c++)if(f=e[c],r=f.privilege,o=f.repo,i=f.group,o=(l=this.privileges)[o]||(l[o]={}),this.flags&this.groups&&(o[i.owner.username+"/"+i.slug]=r),this.flags&this.expand)for(m=i.members,d=0,p=m.length;p>d;d++)s=m[d].username,o[s]=this.max(o[s],r);return u()?void 0:a(this.privileges,t,n)}),l(A("group-privileges",this.username),t)},t.prototype.repositories=function(e){return l(this.url(),g("repositories",C(e,"[%]")))},t.prototype.add_email_address=function(e,t){return d(this.url("emails",e),t)},t.prototype.set_primary_email_address=function(e,t){return p(this.url("emails",e),{primary:!0},t)},t.prototype.remove_email_address=function(e,t){return a(this.url("emails",e),t)},t.prototype.email_address=function(e,t){return l(this.url("emails",e),t)},t.prototype.email_addresses=function(e){return l(this.url("emails"),e)},t.prototype.remove_ad=function(e,t){return a(this.url("ad",e),t)},t.prototype.feature_viewed=function(e,t){return a(this.url("feature",e),t)},t.prototype.add_ssh_key=function(e,t){return d(this.url("ssh-keys"),e,m("pk:id",t))},t.prototype.update_ssh_key=function(e,t,n){return p(this.url("ssh-keys",e),t,m("pk:id",n))},t.prototype.remove_ssh_key=function(e,t){return a(this.url("ssh-keys",e),t)},t.prototype.ssh_key=function(e,t){return l(this.url("ssh-keys",e),m("pk:id",t))},t.prototype.ssh_keys=function(e){return l(this.url("ssh-keys"),m("[pk:id]",e))},t.prototype.create_consumer=function(e,t){return d(this.url("consumers"),e,t)},t.prototype.update_consumer=function(e,t,n){return p(this.url("consumers",e),t,n)},t.prototype.delete_consumer=function(e,t){return a(this.url("consumers",e),t)},t.prototype.consumer=function(e,t){return l(this.url("consumers",e),t)},t.prototype.consumers=function(e){return l(this.url("consumers"),e)},t.prototype.add_member=function(e,t,n){return d(this.url("privileges",e),{privilege:t},n)},t.prototype.update_member=function(e,t,n){return p(this.url("privileges",e),{privilege:t},n)},t.prototype.remove_member=function(e,t){return a(this.url("privileges",e),t)},t.prototype.members=function(e){return l(this.url("privileges"),e)},t}(),i.groups=function(e,t){return l(A("groups")+f(e),t)},i.group=function(){function e(t,n){return this instanceof e?(this.username=t,void(this.slug=n)):new e(t,n)}return e.prototype.url=function(){var e;return e=1<=arguments.length?P.call(arguments,0):[],A.apply(null,["groups",this.username,this.slug].concat(P.call(e)))},e.prototype.details=function(e){return l(this.url(),e)},e}(),i.utils={alphabetical:t},window.bitbucket=i}.call(this),e.bitbucket=bitbucket}.apply(e,arguments)})}(this),function(e){define("jquery-plugins/jquery.cookie",["jquery"],function(){return function(){!function(e,t,n){function i(e){return e}function r(e){return decodeURIComponent(e.replace(o," "))}var o=/\+/g;e.cookie=function(o,s,a){if(s!==n&&!/Object/.test(Object.prototype.toString.call(s))){if(a=e.extend({},e.cookie.defaults,a),null===s&&(a.expires=-1),"number"==typeof a.expires){var l=a.expires,u=a.expires=new Date;u.setDate(u.getDate()+l)}return s=String(s),t.cookie=[encodeURIComponent(o),"=",a.raw?s:encodeURIComponent(s),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}a=s||e.cookie.defaults||{};for(var c,d=a.raw?i:r,h=t.cookie.split("; "),p=0;c=h[p]&&h[p].split("=");p++)if(d(c.shift())===o)return d(c.join("="));return null},e.cookie.defaults={},e.removeCookie=function(t,n){return null!==e.cookie(t,n)?(e.cookie(t,null,n),!0):!1}}(jQuery,document)}.apply(e,arguments)})}(this),define("components/banner",["bitbucket","jquery","on-ready","data/current-user","utils/gaq-push","jquery-plugins/jquery.cookie"],function(e,t,n,i,r){return n(function(n){var o,s;n.hasClass("ad")?(o=function(e){var n=t(e.target).parent(".bb-banner").attr("data-analytics");r(["atl._trackEvent","Advertisement",n+" - view"])},s=function(){var t=n.attr("data-analytics"),o=n.attr("data-ad");e.user(i.username).remove_ad(o,{}),n.addClass("hidden"),r(["atl._trackEvent","Advertisement",t+"- hide"])}):n.hasClass("feature")?(o=function(){r(["atl._trackEvent","Advertisement","new-feature-banner - view"])},s=function(){var t=n.attr("data-featureid");e.user(i.username).feature_viewed(t,{}),n.addClass("hidden"),r(["atl._trackEvent","Feature","new-feature-banner- hide"])},n.find(".tweet").on("click",function(){r(["atl._trackEvent","Advertisement","new-feature-banner - tweet"])})):n.is("#signup-banner")&&(o=function(){r(["atl._trackEvent","Signup","Signup Banner","Clicked"])},s=function(){t.cookie("bb.hide-signup-banner",!0),n.remove(),r(["atl._trackEvent","Signup","Signup Banner","Dismissed"])}),n.find(".signup-button").on("click",o),n.find(".close").on("click",s)})}),define("registration/create-team-link",["jquery","on-ready","utils/gaq-push"],function(e,t,n){return t(function(){e("#create-team-link").on("click",function(){n(["atl._trackEvent","Share","Create Team Menu Link"])})})}),define("data/header-info",["jquery","data/current-user"],function(e,t){return t.isAuthenticated?e.ajax({cache:!1,type:"GET",url:"/account/xhr/header_information/",dataType:"json"}):new e.Deferred}),define("data/base-url",["jquery"],function(e){var t=e(document.body).attr("data-base-url");return t}),define("data/switches",[],function(){function e(e){return e.replace(/-\w/g,function(e){return e[1].toUpperCase()})}for(var t,n=document.body.attributes,i=/^data-switch-(.*)/,r={},o=0;o<n.length;o++)t=i.exec(n[o].name),t&&(r[e(t[1])]=!0);return r}),define("header/account-warning",["jquery","on-ready","data/header-info","data/base-url","data/switches"],function(e,t,n,i,r){return t(function(t){n.done(function(n){var o=e("#plan-upgrade").length;if(n.global_too_many_users.length&&!o){var s,a=n.global_too_many_users[0],l=gettext('It\'s time for <strong>%(username)s</strong> to upgrade to the next user level &mdash; committers currently have read-only access. <a href="%(upgrade_url)s">Upgrade or manage users</a>.');s=r.inAppPayments?"{}/account/user/{!esc}/plans-and-billing/":"{}/account/user/{!esc}/plan-upgrade/",t.addClass("has-message"),t.find(".message").html(interpolate(l,{username:a,upgrade_url:s.format(i,a)},!0))}}).always(function(){t.hasClass("has-message")&&t.slideDown(200,function(){var e=AJS.sidebar(".aui-sidebar");e.$el.length&&e.reflow()})})})}),define("header/feedback",["jquery","on-ready"],function(e,t){return t(function(t){e.ajax({url:"https://bitbucket.atlassian.net/s/d41d8cd98f00b204e9800998ecf8427e/en_US-w19h2v-1988229788/6253/229/1.4.7/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=4ced2b8c",type:"get",cache:!0,dataType:"script"}),window.ATL_JQ_PAGE_PROPS={triggerFunction:function(e){t.click(function(t){t.preventDefault(),e()})}}})}),define("utils/delay",[],function(){return function(e,t){return"function"==typeof e&&(t=e,e=0),window.setTimeout(t,e)}}),define("utils/invite-helper",["bitbucket","jquery"],function(e,t){return{repo:{send:e.send_invitation},general:{send:e.send_general_invitation},getErrorMessages:function(e,n){var i,r="There was a problem processing your request.";return i=e?"{!esc} has already been invited.".format(e):"That person has already been invited",t.extend({400:"Please enter a valid email address.",409:i,500:r,other:r},n||{})}}}),define("components/invite-dialog",["aui","jquery","js/components/aui-dialog","utils/delay","utils/invite-helper"],function(e,t,n,i,r){return function(o,s,a,l){l=l||{};var u,c=o.find('input[type="email"]'),d=new n({width:600,height:"auto",id:s,closeOnOutsideClick:!0}),h=o.find(".error");return d.addHeader(gettext("Send an invitation")),d.addPanel(gettext("Invite"),o,"panel-body"),o.show(),d.addButton(gettext("Send"),function(){o.submit()},"aui-button aui-style"),d.addCancel(gettext("Cancel"),function(e){e.hide()}),u=d.getCurrentPanel().page.button[0].item,c.on("keyup input propertychange",function(){var e=t.trim(c.val());e?u.prop("disabled",!1).attr("aria-disabled",!1):u.prop("disabled",!0).attr("aria-disabled",!0)}),o.submit(function(n){n.preventDefault();var s=t.trim(c.val());if(s&&!u.attr("disabled")){var p=r.getErrorMessages(s,l.messages);u.prop("disabled",!0).attr("aria-disabled",!0);var f=i(200,function(){u.addClass("disabled loading")});h.addClass("hidden");var m={complete:function(){clearTimeout(f),u.prop("disabled",!1).removeClass("disabled loading").attr("aria-disabled",!1)},success:function(t,n,i){if(200===i.status){d.hide();var r=gettext("Invitation sent to %(email)s");e.messages.success({body:interpolate(r,{email:s},!0),fadeout:!0})}},error:function(e,t){var n;n="timeout"!==t?p[e.status]||p.other:gettext("There was a problem connecting to the server."),h.removeClass("hidden").find(".message").text(n)}};a(s,o,m)}}),e.bind("show.dialog",function(e,t){t.dialog.id==s&&(o.find(".error").addClass("hidden"),c.val(""),u.prop("disabled",!0).attr("aria-disabled",!0))}),{show:function(){d.show()},hide:function(){d.hide()}}}}),function(e){define("mustache",[],function(){return function(){var t="undefined"!=typeof module&&module.exports||{};return function(e){function t(e){return!y.test(e)}function n(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}function i(e){return String(e).replace(/&(?!\w+;)|[<>"']/g,function(e){return C[e]})}function r(e){this.string=e,this.tail=e,this.pos=0}function o(e,t){this.view=e,this.parent=t,this.clearCache()}function s(){this.clearCache()}function a(e,t){"string"==typeof e&&(e=d(e));for(var n,i,r,o=['""'],s=0,l=e.length;l>s;++s)switch(n=e[s],n.type){case"#":case"^":i="#"===n.type?"_section":"_inverted",o.push("r."+i+"("+k(n.value)+", c, function (c, r) {\n  "+a(n.tokens,!0)+"\n})");break;case"{":case"&":case"name":r="name"===n.type?"true":"false",o.push("r._name("+k(n.value)+", c, "+r+")");break;case">":o.push("r._partial("+k(n.value)+", c)");break;case"text":o.push(k(n.value))}return o="return "+o.join(" + ")+";",t?o:new Function("c, r",o)}function l(e){if(2===e.length)return[new RegExp(n(e[0])+"\\s*"),new RegExp("\\s*"+n(e[1]))];throw new Error("Invalid tags: "+e.join(" "))}function u(e){for(var t,n,i=[],r=i,o=[],s=0;s<e.length;++s)switch(t=e[s],t.type){case"#":case"^":t.tokens=[],o.push(t),r.push(t),r=t.tokens;break;case"/":if(0===o.length)throw new Error("Unopened section: "+t.value);if(n=o.pop(),n.value!==t.value)throw new Error("Unclosed section: "+n.value);r=o.length>0?o[o.length-1].tokens:i;break;default:r.push(t)}if(n=o.pop())throw new Error("Unclosed section: "+n.value);return i}function c(e){for(var t,n=0;n<e.length;++n)token=e[n],t&&"text"===t.type&&"text"===token.type?(t.value+=token.value,e.splice(n--,1)):t=token}function d(n,i){function o(){if(m&&!y)for(;f.length;)p.splice(f.pop(),1);else f=[];m=!1,y=!1}i=l(i||e.tags);for(var s,a,d,h=new r(n),p=[],f=[],m=!1,y=!1;!h.eos();){if(a=h.scanUntil(i[0]))for(var _=0,k=a.length;k>_;++_)d=a[_],t(d)?f.push(p.length):y=!0,p.push({type:"text",value:d}),"\n"===d&&o();if(!h.scan(i[0]))break;if(m=!0,s=h.scan(x)||"name",h.scan(g),"="===s?(a=h.scanUntil(b),h.scan(b),h.scanUntil(i[1])):"{"===s?(a=h.scanUntil(w),h.scan(w),h.scanUntil(i[1])):a=h.scanUntil(i[1]),!h.scan(i[1]))throw new Error("Unclosed tag at "+h.pos);p.push({type:s,value:a}),("name"===s||"{"===s||"&"===s)&&(y=!0),"="===s&&(i=l(a.split(v)))}return c(p),u(p)}function h(){S.clearCache()}function p(e,t){return S.compile(e,t)}function f(e,t,n){return S.compilePartial(e,t,n)}function m(e,t,n){if(n)for(var i in n)f(i,n[i]);return S.render(e,t)}e.name="mustache.js",e.version="0.5.1-dev",e.tags=["{{","}}"],e.parse=d,e.clearCache=h,e.compile=p,e.compilePartial=f,e.render=m,e.Scanner=r,e.Context=o,e.Renderer=s,e.to_html=function(e,t,n,i){var r=m(e,t,n);return"function"!=typeof i?r:void i(r)};var g=/\s*/,v=/\s+/,y=/\S/,b=/\s*=/,w=/\s*\}/,x=/#|\^|\/|>|\{|&|=|!/,_=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},k="undefined"!=typeof JSON&&JSON.stringify||function(e){return'"'+String(e).replace(/(^|[^\\])"/g,'\\"')+'"'},C={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};e.isWhitespace=t,e.isArray=_,e.quote=k,e.escapeRe=n,e.escapeHtml=i,r.prototype.eos=function(){return""===this.tail},r.prototype.scan=function(e){var t=this.tail.match(e);return t&&0===t.index?(this.tail=this.tail.substring(t[0].length),this.pos+=t[0].length,t[0]):null},r.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.pos+=this.tail.length,this.tail="";break;case 0:t=null;break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n),this.pos+=n}return t},o.make=function(e){return e instanceof o?e:new o(e)},o.prototype.clearCache=function(){this._cache={}},o.prototype.push=function(e){return new o(e,this)},o.prototype.lookup=function(e){var t=this._cache[e];if(!t){if("."===e)t=this.view;else for(var n=this;n;){if(e.indexOf(".")>0){var i=e.split("."),r=0;for(t=n.view;t&&r<i.length;)t=t[i[r++]]}else t=n.view[e];if(null!=t)break;n=n.parent}this._cache[e]=t}return"function"==typeof t&&(t=t.call(this.view)),t},s.prototype.clearCache=function(){this._cache={},this._partialCache={}},s.prototype.compile=function(e){var t=a(e),n=this;return function(e){return t(o.make(e),n)}},s.prototype.compilePartial=function(e,t,n){return this._partialCache[e]=this.compile(t,n),this._partialCache[e]},s.prototype.render=function(e,t){var n=this._cache[e];return n||(n=this.compile(e),this._cache[e]=n),n(t)},s.prototype._section=function(e,t,n){function i(e){return u.render(e,t)}var r=t.lookup(e);switch(typeof r){case"object":if(_(r)){for(var o="",s=0,a=r.length;a>s;++s)o+=n(t.push(r[s]),this);return o}return n(t.push(r),this);case"function":var l=n(t,this),u=this;return r.call(t.view,l,i)||"";default:if(r)return n(t,this)}return""},s.prototype._inverted=function(e,t,n){var i=t.lookup(e);return null==i||i===!1||_(i)&&0===i.length?n(t,this):""},s.prototype._partial=function(e,t){var n=this._partialCache[e];return n?n(t,this):""},s.prototype._name=function(e,t,n){var r=t.lookup(e);"function"==typeof r&&(r=r.call(t.view));var o=null==r?"":String(r);return n?i(o):o};var S=new s}(t),e.Mustache=t}.apply(e,arguments)})}(this),define("utils/mustache",["jquery","mustache"],function(e,t){t.tags=["[[","]]"];var n={};return{toHtml:function(i,r){var o=n[i];return o||(o=t.compile(e("#"+i).html()),n[i]=o),o(r).trim()},clear:function(e){delete n[e]}}}),define("header/general-invite",["jquery","on-ready","components/invite-dialog","utils/gaq-push","utils/invite-helper","utils/mustache"],function(e,t,n,i,r,o){return t(function(t){var s,a,l=function(e,t,n){r.general.send(e,{complete:n.complete,success:function(e,t,r){i(["atl._trackEvent","Share","General invite user",s]),n.success(e,t,r)},error:n.error})};t.on("click",function(t){t.preventDefault(),s="nav-link",a||(a=n(e(o.toHtml("general-invite-template")),"invitation-dialog",l)),a.show()})})}),define("header/inbox-count",["jquery","on-ready","data/header-info"],function(e,t,n){return t(function(e){n.done(function(t){e.text("("+t.unread_notifications+")")})})}),define("utils/recent-history",["jquery","store","data/current-user","jquery-plugins/jquery.cookie"],function(e,t,n){return function(i){function r(i){if(n.isAuthenticated&&i){var r=e.cookie(s),o=r?r.split(","):[],l=o.indexOf(""+i);0!==l&&(~l&&o.splice(l,1),o=[i].concat(o.slice(0,u)),e.cookie(s,o.join(","),{path:"/",expires:1e6}),t.remove(a))}}function o(){var n=new e.Deferred,i=t.get(a),r=Date.now();return i&&r-i.time<d?(n.resolve(i),n):(e.ajax({cache:!1,type:"get",url:l,data:c,dataType:"json"}).done(function(e){e.time=r,t.set(a,e),n.resolve(e)}),n)}var s=i.key||i.cookieName,a=i.key||i.storageName,l=i.url,u=i.limit||5,c=i.query||{max:u},d=i.cacheTimeout||3e5;return{get:o,set:r}}}),define("repo/history",["data/current-user","utils/api-helper","utils/recent-history"],function(e,t,n){return n({cookieName:"recently-viewed-repos_"+e.username,storageName:"repo-history:"+e.username,url:t.toString("user","repositories","overview"),limit:5,maxAge:3e5})}),define("header/recent-repos",["jquery","on-ready","repo/history","utils/mustache"],function(e,t,n,i){return t(function(t){n.get().done(function(n){n.hasViewed=!!n.viewed.length,n.hasUpdated=!!n.updated.length,(n.hasUpdated||n.hasViewed)&&e("#repositories-dropdown-trigger").one("mouseover",function(){t.replaceWith(i.toHtml("repo-dropdown-template",n))})})})}),define("header/teams-dropdown",["jquery","on-ready","data/header-info","utils/mustache"],function(e,t,n,i){return t(function(t){n.done(function(n){var r=e("#"+t.attr("aria-owns"));t.one("mouseover",function(){n.teams.length&&r.html(i.toHtml("team-dropdown-template",{teams:n.teams})).removeClass("hidden")})})})}),define("utils/event-tracking-helper",["utils/gaq-push"],function(e){return function(t){return function(n,i){var r=["atl._trackEvent",t,n];i&&r.push(i),e(r)}}}),define("header/tracking",["jquery","on-ready","data/current-user","utils/event-tracking-helper","utils/gaq-push"],function(e,t,n,i,r){return t(function(){var t=i("Page Header");return e("#sign-up-link").on("click",function(){r(["atl._trackEvent","Signup","Header"])}),n.isAuthenticated?(e("#header").on("click",".app-switcher-trigger",function(n){e(n.target).hasClass("active")&&t("App Switcher - Displayed")}),e("#app-switcher").on("click",".nav-link a",function(){t("App Switcher - App Link Clicked")}),e("#ondemand-trial").on("click",function(){t("App Switcher - Free Trial Clicked")}),e("#ondemand-learn-more").on("click",function(){t("App Switcher - Learn More Clicked")}),e("#logo").on("click",function(){t("Bitbucket Logo Clicked")}),e("#teams-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Teams Dropdown - Displayed")}),e("#create-team-blank-slate").on("click",function(){t("Teams Dropdown - Create Clicked","No teams")}),e("#create-team-link").on("click",function(){t("Teams Dropdown - Create Clicked","Has teams")}),e("#teams-dropdown").on("click"," a.team-link",function(){t("Teams Dropdown - Team Clicked")}),e("#repositories-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Repo Dropdown - Displayed")}),e("#create-repo-link").on("click",function(){t("Repo Dropdown - Create Clicked")}),e("#import-repo-link").on("click",function(){t("Repo Dropdown - Import Clicked")}),e("#repo-dropdown").on("click","a.repo-link",function(n){t("Repo Dropdown - Repo Clicked",e(n.target).hasClass("recently-viewed")?"Recently Viewed":"Recently Updated")}),e("#header-snippets-link").on("click",function(){t("Snippets Clicked")}),e("#snippet-create-cta").on("click",function(){t("Create Snippet CTA Clicked")}),e("#help-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Help Dropdown - Displayed")}),e("#header-help-dropdown").on("click","a",function(n){t("Help Dropdown - Link Clicked",e(n.target).text().trim())}),e("#user-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Account Dropdown - Displayed")}),e("#user-dropdown").on("click","a",function(n){var i=e(n.target).closest("a").text().replace(/\(.*\)/,"").trim();t("Account Dropdown - Link Clicked",i)}),e("#dashboard-dropdown-trigger").on("click",function(n){e(n.target).hasClass("active")&&t("Dashboard Dropdown - Displayed")}),e("#dashboard-overview-link").on("click",function(){t("Dashboard Dropdown - Repositories Clicked")}),e("#dashboard-prs-link").on("click",function(){t("Dashboard Dropdown - Pull Requests Clicked")}),e("#dashboard-issues-link").on("click",function(){t("Dashboard Dropdown - Issues Clicked")}),void e("#repo-create-cta").on("click",function(){t("Create Repo CTA Clicked")})):(new e.Deferred).reject(new Error("User not authenticated"))})}),define("header/index",["header/account-warning","header/feedback","header/general-invite","header/inbox-count","header/recent-repos","header/teams-dropdown","header/tracking"],function(){}),define("components/follow",["aui","jquery","utils/gaq-push","utils/mustache"],function(e,t,n,i){var r=function(e,n){var r=e.find(".text"),o=e.attr("href"),s=e.data("follow-text")||gettext("Follow"),a=e.data("unfollow-text")||gettext("Following"),l=e.data("template");
if(r.length||(r=e),l){var u=t(i.toHtml(l,{isFollowing:n,url:o}));return e.replaceWith(u),u}return n?(e.addClass("following"),r.text(a)):(e.removeClass("following"),r.text(s)),e};t(document).on("toggle-follow","a.follow, button.follow",function(e,n){var i=t(e.target).closest("a.follow,button.follow");i=r(i,n.isNowFollowing),i.trigger("follow:"+n.type,n.isNowFollowing)}),t(document).on("click","a.follow,button.follow",function(e){e.preventDefault();var i=t(e.target).closest("a.follow,button.follow"),o=i.attr("href")||i.data("url"),s=i.data("restful"),a=i.hasClass("following"),l="POST";i.attr("aria-disabled",!0),i=r(i,!a),s&&(l=a?"DELETE":i.data("follow-method")||"POST"),t.ajax({url:o,type:l,dataType:"json",success:function(e){var t=void 0===e.following?e.is_watching:e.following,r=e.type;if(void 0===t)return window.location.pathname=o;var s={repo:["atl._trackEvent","Share","Follow Repo"],user:["atl._trackEvent","Share","Follow User"],pullrequest:["atl._trackEvent","Notifications","Watch Pull Request"],issue:["atl._trackEvent","Notifications","Watch Issue"],commit:["atl._trackEvent","Notifications","Watch Commit"],snippet:["atl._trackEvent","Notifications","Watch Snippet"]};i.trigger("follow:"+r,t),t&&n(["atl._trackPageview","/"+r+"/follow"],s[r])},error:function(){r(i)},complete:function(){i.removeAttr("aria-disabled")}})})}),define("components/follow-list",["jquery","on-ready","components/follow"],function(e,t){return t(function(){var t=e(".pullrequest-list, .issues-list, .repo-list, .snippet-list");t.on("click","a.follow",function(t){var n,i=e(t.target),r=i.closest(".iterable-item").find(".title, .text").text(),o=/#(\d+):/.exec(r),s=o?o[1]:null,a=!i.hasClass("following"),l=i.data("type"),u=s?l+" #"+s:"this "+l;n=gettext(a?"You are now watching %(item)s.":"You are no longer watching %(item)s."),AJS.messages.info({body:interpolate(n,{item:u},!0),fadeout:!0})})})}),define("components/footer",["aui","jquery","on-ready"],function(e,t,n){return n(function(n){e.InlineDialog(t("#meta-info"),"metaInfo",function(e,n,i){return e.css({padding:"20px",width:"150px"}).html(t("#meta-info-content").html()),i(),!1},{gravity:"s"}),n.find("a").tooltip({aria:!0,gravity:"s",delayIn:200})})}),function(e,t){if("function"==typeof define&&define.amd)define("backbone.wreqr",["backbone","underscore"],function(e,n){return t(e,n)});else if("undefined"!=typeof exports){var n=require("backbone"),i=require("underscore");module.exports=t(n,i)}else t(e.Backbone,e._)}(this,function(e,t){"use strict";var n=e.Wreqr,i=e.Wreqr={};return e.Wreqr.VERSION="1.3.1",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),i.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),i.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,n,i){var r=this.storage.getCommands(e);t.each(r.instances,function(e){n.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,i=e.storageType||this.storageType;n=t.isFunction(i)?new i:i,this.storage=n}})}(i),i.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.hasHandler(e)?this.getHandler(e).apply(this,t):void 0}})}(i),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),i.Channel=function(){var n=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,i){if(n){i=i||this;var r="vent"===e?"on":"setHandler";t.each(n,function(n,o){this[e][r](o,t.bind(n,i))},this)}}}),n}(i),i.radio=function(e){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(i[e],function(t){this[e][t]=r(this,e,t)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,t,n){return function(i){var r=e._getChannel(i)[t],o=Array.prototype.slice.call(arguments,1);return r[n].apply(r,o)}};return new n}(i),e.Wreqr}),define("js/global/events",["backbone.wreqr"],function(e){return e.radio.channel("global")}),define("utils/analytics-event",["jquery","data/current-user","data/debug","data/environment"],function(e,t,n){return function(t,i){var r={name:t};return i&&(r.properties=i),n&&console.log("Name:",t,"Properties:",i),e.ajax({url:"/xhr/analytics/events",type:"POST",contentType:"application/json",data:JSON.stringify({events:[r]})})}}),function(e,t){"object"==typeof exports?module.exports=t():"function"==typeof define&&define.amd?define("spin",t):e.Spinner=t()}(this,function(){"use strict";function e(e,t){var n,i=document.createElement(e||"div");for(n in t)i[n]=t[n];return i}function t(e){for(var t=1,n=arguments.length;n>t;t++)e.appendChild(arguments[t]);return e}function n(e,t,n,i){var r=["opacity",t,~~(100*e),n,i].join("-"),o=.01+n/i*100,s=Math.max(1-(1-e)/t*(100-o),e),a=c.substring(0,c.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return h[r]||(p.insertRule("@"+l+"keyframes "+r+"{0%{opacity:"+s+"}"+o+"%{opacity:"+e+"}"+(o+.01)+"%{opacity:1}"+(o+t)%100+"%{opacity:"+e+"}100%{opacity:"+s+"}}",p.cssRules.length),h[r]=1),r}function i(e,t){var n,i,r=e.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),i=0;i<d.length;i++)if(n=d[i]+t,void 0!==r[n])return n;return void 0!==r[t]?t:void 0}function r(e,t){for(var n in t)e.style[i(e,n)||n]=t[n];return e}function o(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)void 0===e[i]&&(e[i]=n[i])}return e}function s(e){for(var t={x:e.offsetLeft,y:e.offsetTop};e=e.offsetParent;)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function a(e,t){return"string"==typeof e?e:e[t%e.length]}function l(e){return"undefined"==typeof this?new l(e):void(this.opts=o(e||{},l.defaults,f))}function u(){function n(t,n){return e("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',n)}p.addRule(".spin-vml","behavior:url(#default#VML)"),l.prototype.lines=function(e,i){function o(){return r(n("group",{coordsize:c+" "+c,coordorigin:-u+" "+-u}),{width:c,height:c})}function s(e,s,l){t(h,t(r(o(),{rotation:360/i.lines*e+"deg",left:~~s}),t(r(n("roundrect",{arcsize:i.corners}),{width:u,height:i.width,left:i.radius,top:-i.width>>1,filter:l}),n("fill",{color:a(i.color,e),opacity:i.opacity}),n("stroke",{opacity:0}))))}var l,u=i.length+i.width,c=2*u,d=2*-(i.width+i.length)+"px",h=r(o(),{position:"absolute",top:d,left:d});if(i.shadow)for(l=1;l<=i.lines;l++)s(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=i.lines;l++)s(l);return t(e,h)},l.prototype.opacity=function(e,t,n,i){var r=e.firstChild;i=i.shadow&&i.lines||0,r&&t+i<r.childNodes.length&&(r=r.childNodes[t+i],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=n))}}var c,d=["webkit","Moz","ms","O"],h={},p=function(){var n=e("style",{type:"text/css"});return t(document.getElementsByTagName("head")[0],n),n.sheet||n.styleSheet}(),f={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};l.defaults={},o(l.prototype,{spin:function(t){this.stop();var n,i,o=this,a=o.opts,l=o.el=r(e(0,{className:a.className}),{position:a.position,width:0,zIndex:a.zIndex}),u=a.radius+a.length+a.width;if(t&&(t.insertBefore(l,t.firstChild||null),i=s(t),n=s(l),r(l,{left:("auto"==a.left?i.x-n.x+(t.offsetWidth>>1):parseInt(a.left,10)+u)+"px",top:("auto"==a.top?i.y-n.y+(t.offsetHeight>>1):parseInt(a.top,10)+u)+"px"})),l.setAttribute("role","progressbar"),o.lines(l,o.opts),!c){var d,h=0,p=(a.lines-1)*(1-a.direction)/2,f=a.fps,m=f/a.speed,g=(1-a.opacity)/(m*a.trail/100),v=m/a.lines;!function y(){h++;for(var e=0;e<a.lines;e++)d=Math.max(1-(h+(a.lines-e)*v)%m*g,a.opacity),o.opacity(l,e*a.direction+p,d,a);o.timeout=o.el&&setTimeout(y,~~(1e3/f))}()}return o},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=void 0),this},lines:function(i,o){function s(t,n){return r(e(),{position:"absolute",width:o.length+o.width+"px",height:o.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/o.lines*u+o.rotate)+"deg) translate("+o.radius+"px,0)",borderRadius:(o.corners*o.width>>1)+"px"})}for(var l,u=0,d=(o.lines-1)*(1-o.direction)/2;u<o.lines;u++)l=r(e(),{position:"absolute",top:1+~(o.width/2)+"px",transform:o.hwaccel?"translate3d(0,0,0)":"",opacity:o.opacity,animation:c&&n(o.opacity,o.trail,d+u*o.direction,o.lines)+" "+1/o.speed+"s linear infinite"}),o.shadow&&t(l,r(s("#000","0 0 4px #000"),{top:"2px"})),t(i,t(l,s(a(o.color,u),"0 0 1px rgba(0,0,0,.1)")));return i},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var m=r(e("group"),{behavior:"url(#default#VML)"});return!i(m,"transform")&&m.adj?u():c=i(m,"animation"),l}),function(e){if("object"==typeof exports)e(require("jquery"),require("spin"));else if("function"==typeof define&&define.amd)define("jquery-plugins/jquery.spin",["jquery","spin"],e);else{if(!window.Spinner)throw new Error("Spin.js not present");e(window.jQuery,window.Spinner)}}(function(e,t){e.fn.spin=function(n,i){return this.each(function(){var r=e(this),o=r.data();o.spinner&&(o.spinner.stop(),delete o.spinner),n!==!1&&(n=e.extend({color:i||r.css("color")},e.fn.spin.presets[n]||n),o.spinner=new t(n).spin(this))})},e.fn.spin.presets={tiny:{lines:8,length:2,width:2,radius:3},small:{lines:8,length:4,width:3,radius:5},large:{lines:10,length:8,width:4,radius:8}}}),function(e,t){"function"==typeof define&&define.amd?define("utils/disable",["jquery"],t):t(e.jQuery)}(this,function(e){e.fn.disable=function(t,n){var i=e(this);return t=void 0===t?i.prop("disabled"):!!t,n=n||{},t?i.addClass("disabled").attr("disabled",!0).attr("aria-disabled",!0):i.removeClass("disabled").removeAttr("disabled aria-disabled"),n.text&&i.text(n.text),this}}),function(e,t){"function"==typeof define&&define.amd?define("utils/loading",["jquery","jquery-plugins/jquery.spin","./disable"],t):t(e.jQuery)}(this,function(e){e.fn.loading=function(t,n){var i=e(this),r=e.extend({loadTime:400,spin:!1,disable:!0,restore:!0},n),o=setTimeout(function(){r.spin?i.spin(r.spin):i.addClass(r.mask?"has-mask":"loading"),r.disable&&i.disable()},r.loadTime);return t=t||e.Deferred(),t.fail(function(){i.disable(!1)}),t.done(function(){r.disable&&r.restore&&i.disable(!1)}),t.always(function(){clearTimeout(o),r.spin?i.spin(!1):i.removeClass(r.mask?"has-mask":"loading")})}}),define("components/hipchat-integration-dialog",["aui","jquery","on-ready","js/global/events","utils/analytics-event","utils/loading","utils/preferences"],function(e,t,n,i,r,o,s){return n(function(n){var o=e.dialog2(n),a=n.attr("data-descriptor-url"),l=n.attr("data-connections-url"),u=n.attr("data-create-repo-url"),c=n.attr("data-admin-url"),d=n.data("repository"),h=n.data("show-success-message");o.on("show",function(){r("bitbucket.hipchat.integration.installation.dialog.presented")}),t("#dialog-install-button").on("click",function(n){{var s=new t.Deferred;t.ajax({url:l,type:"POST",data:{url:a},dataType:"json"}).done(function(){var t=r("bitbucket.hipchat.integration.installed");if(i.vent.trigger("hipchatIntegration:installed"),h){var n=gettext("Manage integrations"),a=gettext("Create your first repository");message=d?gettext('<a href="{}">{}</a>').format(c,n):gettext('<a href="{}">{}</a> &middot; <a href="{}">{}</a>').format(u,a,c,n),e.messages.success({title:gettext("HipChat integration complete"),body:message,fadeout:!0}),o.hide(),s.resolve()}else t.done(function(){window.location.reload()})}).fail(function(t){var n=JSON.parse(t.responseText).error.message;r("bitbucket.hipchat.integration.installation.error",{errorMessage:n}),e.messages.error({title:gettext("There was a problem installing the integration"),body:n}),s.resolve()})}t(n.target).loading(s)}),t("#dialog-cancel-button").on("click",function(){r("bitbucket.hipchat.integration.installation.dialog.dismissed"),o.hide()}),s.get("show-hipchat-dialog").done(function(e){e&&(o.show(),s["delete"]("show-hipchat-dialog"))})})}),define("components/hipchat-integration-message",["aui","on-ready","utils/analytics-event","utils/preferences"],function(e,t,n,i){return t(function(t){var r=t.attr("data-admin-url"),o=gettext("Manage integrations");e.messages.success({title:gettext("HipChat integration complete"),body:gettext('<a href="{}">{}</a>').format(r,o),fadeout:!0}),n("bitbucket.hipchat.integration.confirmation.message.presented"),i["delete"]("show-hipchat-dialog")})}),define("components/hipchat-integration-trigger",["aui","jquery","on-ready","utils/analytics-event"],function(e,t,n,i){return n(function(t){var n=e.dialog2("#hipchat-integration-dialog");t.on("click",function(){i("bitbucket.hipchat.integration.installation.dialog.trigger.clicked"),n.show()})})}),function(e){var t,n,i="0.4.2",r="hasOwnProperty",o=/[\.\/]/,s=/\s*,\s*/,a="*",l=function(e,t){return e-t},u={n:{}},c=function(){for(var e=0,t=this.length;t>e;e++)if("undefined"!=typeof this[e])return this[e]},d=function(){for(var e=this.length;--e;)if("undefined"!=typeof this[e])return this[e]},h=function(e,i){e=String(e);var r,o=n,s=Array.prototype.slice.call(arguments,2),a=h.listeners(e),u=0,p=[],f={},m=[],g=t;m.firstDefined=c,m.lastDefined=d,t=e,n=0;for(var v=0,y=a.length;y>v;v++)"zIndex"in a[v]&&(p.push(a[v].zIndex),a[v].zIndex<0&&(f[a[v].zIndex]=a[v]));for(p.sort(l);p[u]<0;)if(r=f[p[u++]],m.push(r.apply(i,s)),n)return n=o,m;for(v=0;y>v;v++)if(r=a[v],"zIndex"in r)if(r.zIndex==p[u]){if(m.push(r.apply(i,s)),n)break;do if(u++,r=f[p[u]],r&&m.push(r.apply(i,s)),n)break;while(r)}else f[r.zIndex]=r;else if(m.push(r.apply(i,s)),n)break;return n=o,t=g,m};h._events=u,h.listeners=function(e){var t,n,i,r,s,l,c,d,h=e.split(o),p=u,f=[p],m=[];for(r=0,s=h.length;s>r;r++){for(d=[],l=0,c=f.length;c>l;l++)for(p=f[l].n,n=[p[h[r]],p[a]],i=2;i--;)t=n[i],t&&(d.push(t),m=m.concat(t.f||[]));f=d}return m},h.on=function(e,t){if(e=String(e),"function"!=typeof t)return function(){};for(var n=e.split(s),i=0,r=n.length;r>i;i++)!function(e){for(var n,i=e.split(o),r=u,s=0,a=i.length;a>s;s++)r=r.n,r=r.hasOwnProperty(i[s])&&r[i[s]]||(r[i[s]]={n:{}});for(r.f=r.f||[],s=0,a=r.f.length;a>s;s++)if(r.f[s]==t){n=!0;break}!n&&r.f.push(t)}(n[i]);return function(e){+e==+e&&(t.zIndex=+e)}},h.f=function(e){var t=[].slice.call(arguments,1);return function(){h.apply(null,[e,null].concat(t).concat([].slice.call(arguments,0)))}},h.stop=function(){n=1},h.nt=function(e){return e?new RegExp("(?:\\.|\\/|^)"+e+"(?:\\.|\\/|$)").test(t):t},h.nts=function(){return t.split(o)},h.off=h.unbind=function(e,t){if(!e)return void(h._events=u={n:{}});var n=e.split(s);if(n.length>1)for(var i=0,l=n.length;l>i;i++)h.off(n[i],t);else{n=e.split(o);var c,d,p,i,l,f,m,g=[u];for(i=0,l=n.length;l>i;i++)for(f=0;f<g.length;f+=p.length-2){if(p=[f,1],c=g[f].n,n[i]!=a)c[n[i]]&&p.push(c[n[i]]);else for(d in c)c[r](d)&&p.push(c[d]);g.splice.apply(g,p)}for(i=0,l=g.length;l>i;i++)for(c=g[i];c.n;){if(t){if(c.f){for(f=0,m=c.f.length;m>f;f++)if(c.f[f]==t){c.f.splice(f,1);break}!c.f.length&&delete c.f}for(d in c.n)if(c.n[r](d)&&c.n[d].f){var v=c.n[d].f;for(f=0,m=v.length;m>f;f++)if(v[f]==t){v.splice(f,1);break}!v.length&&delete c.n[d].f}}else{delete c.f;for(d in c.n)c.n[r](d)&&c.n[d].f&&delete c.n[d].f}c=c.n}}},h.once=function(e,t){var n=function(){return h.unbind(e,n),t.apply(this,arguments)};return h.on(e,n)},h.version=i,h.toString=function(){return"You are running Eve "+i},"undefined"!=typeof module&&module.exports?module.exports=h:"function"==typeof define&&define.amd?define("eve",[],function(){return h}):e.eve=h}(this),define("eevee",["backbone","eve","underscore"],function(e,t,n){"use strict";var i={trigger:function(){return t.apply(this,arguments)},on:function(e,n){return t.on(e,n)},off:function(e,n){return t.off(e,n)},once:function(e,n){return t.once(e,n)},listeners:function(e){return t.listeners(e)},name:function(e){return t.nt(e)},chain:function(){return this.chainWith(this)},chainWith:function(e){var t=[],n={on:function(){var n=arguments;return e.on.apply(e,n),t.push(function(){e.off.apply(e,n)}),this},destroy:function(){for(var e=0;e<t.length;e++)t[e]();t=[]}};return n},stop:function(){return t.stop()},createEventMixin:function(t,r){return r=r||{},n.extend({},e.Events,{trigger:function(n){var o=e.Events.trigger.apply(this,arguments);return r.localOnly||i.trigger.apply(i,[t+"/"+n,this].concat(Array.prototype.slice.call(arguments,1))),o},retriggerFrom:function(e){function t(e,t){return e.on(t,this.trigger.bind(this,t))}var n=Array.prototype.slice.call(arguments,1);return n.reduce(t.bind(this),i.chainWith(e))}})},createLocalEventMixin:function(){return this.createEventMixin(null,{localOnly:!0})},addEventMixin:function(e,t,i){n.extend(e,this.createEventMixin(t,i))},addLocalEventMixin:function(e){n.extend(e,this.createLocalEventMixin())}};return i}),function(e){define("fd-slider",[],function(){return function(){var t=function(){function e(e){function t(e){e=!!e,e!=Vt&&(Vt=e,O(R()))}function n(e){if(!ot||e){try{Y(tt,-1),m(tt,"focus",p),m(tt,"blur",w),u?m(tt,"keypress",k):(m(tt,"keydown",k),m(tt,"keypress",_)),m(X,"mouseover",C),m(X,"mouseout",S),m(X,"mousedown",$),m(X,"touchstart",$),i&&(window.addEventListener&&!window.devicePixelRatio?window.removeEventListener("DOMMouseScroll",x,!1):(m(document,"mousewheel",x),m(window,"mousewheel",x)))}catch(t){}b(Z,"fd-slider-focused"),b(Z,"fd-slider-active"),y(Z,"fd-slider-disabled"),X.setAttribute("aria-disabled",!0),rt.disabled=ot=!0,clearTimeout(jt),e||h("disable")}}function l(e){(ot||e)&&(Y(tt,0),f(tt,"focus",p),f(tt,"blur",w),u?f(tt,"keypress",k):(f(tt,"keydown",k),f(tt,"keypress",_)),f(X,"touchstart",$),f(X,"mousedown",$),f(X,"mouseover",C),f(X,"mouseout",S),b(Z,"fd-slider-disabled"),X.setAttribute("aria-disabled",!1),rt.disabled=ot=Gt=!1,e||h("enable"))}function c(){clearTimeout(jt),et=it=tt=X=Z=jt=null,h("destroy"),wt=null}function d(){D();try{var e=X.offsetWidth,t=X.offsetHeight,n=tt.offsetWidth,i=tt.offsetHeight,r=(it.offsetHeight,it.offsetWidth,bt?t-i:e-n);Wt=r/mt,Bt=Math.max(gt?B(F(ut)):Math.abs((ut-at)/ht)*Wt,0),Ft=Math.min(gt?B(F(ct)):Math.abs((ct-at)/ht)*Wt,Math.floor(bt?t-i:e-n)),Pt=e,qt=t,O(St?R():"select"==st?rt.selectedIndex:parseFloat(rt.value),!1)}catch(o){}h("redraw")}function h(e){if(_t){if(e.match(/^(blur|focus|change)$/i)){var t;if("undefined"!=typeof document.createEvent)t=document.createEvent("HTMLEvents"),t.initEvent(e,!0,!0),rt.dispatchEvent(t);else if("undefined"!=typeof document.createEventObject)try{t=document.createEventObject(),rt.fireEvent("on"+e.toLowerCase(),t)}catch(n){}}}else if(wt.hasOwnProperty(e))for(var i,r={userSet:Vt,disabled:ot,elem:rt,value:"select"==st?rt.options[rt.selectedIndex].value:rt.value},o=0;i=wt[e][o];o++)i.call(rt,r)}function p(){return y(Z,"fd-slider-focused"),s.onfocus&&(Vt=!0,O(R())),i&&(f(window,"DOMMouseScroll",x),f(document,"mousewheel",x),u||f(window,"mousewheel",x)),h("focus"),!0}function w(){b(Z,"fd-slider-focused"),i&&(m(document,"mousewheel",x),m(window,"DOMMouseScroll",x),u||m(window,"mousewheel",x)),Dt=!0,h("blur")}function x(e){if(Dt){e=e||window.event;var t,n=0;e.wheelDelta?(n=e.wheelDelta/120,u&&window.opera.version()<9.2&&(n=-n)):e.detail&&(n=-e.detail/3),bt&&(n=-n),n&&(t=R(),t+=0>n?-ht:ht,Vt=!0,O(M(t))),v(e)}}function _(e){return e=e||window.event,e.keyCode>=33&&e.keyCode<=40||!Dt||45==e.keyCode||46==e.keyCode?g(e):!0}function k(e){if(!Dt)return!0;e=e||window.event;var t,n=null!==e.keyCode?e.keyCode:e.charCode;return 33>n||n>40&&45!=n&&46!=n?!0:(t=R(),37==n||40==n||46==n||34==n?t-=e.ctrlKey||34==n?+pt:+ht:39==n||38==n||45==n||33==n?t+=e.ctrlKey||33==n?+pt:+ht:35==n?t=ct:36==n&&(t=ut),Vt=!0,O(M(t)),h("update"),void v(e))}function C(){y(Z,"fd-slider-hover")}function S(){b(Z,"fd-slider-hover")}function $(e){e=e||window.event,v(e);var t;if(e.target?t=e.target:e.srcElement&&(t=e.srcElement),t&&3==t.nodeType&&(t=t.parentNode),e.touches){if(e.targetTouches&&1!=e.targetTouches.length)return!1;e=e.touches[0],Gt=!0}if(clearTimeout(jt),jt=null,Dt=!1,Vt=!0,-1!=t.className.search("fd-slider-handle"))Jt=bt?e.clientY:e.clientX,Ut=parseInt(bt?tt.offsetTop:tt.offsetLeft)||0,E(e),Gt?(f(document,"touchmove",E),f(document,"touchend",A),m(X,"mousedown",$)):(f(document,"mousemove",E),f(document,"mouseup",A)),y(Z,"fd-slider-active"),y(document.body,"fd-slider-drag-"+(bt?"vertical":"horizontal")),h("dragstart");else{D();var n=0;e.pageX||e.pageY?n=bt?e.pageY:e.pageX:(e.clientX||e.clientY)&&(n=bt?e.clientY+document.body.scrollTop+document.documentElement.scrollTop:e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft),n-=bt?Ht+Math.round(tt.offsetHeight/2):Lt+Math.round(tt.offsetWidth/2),n=L(n),"tween"==yt?(y(Z,"fd-slider-active"),P(n)):"timed"==yt?(y(Z,"fd-slider-active"),f(document,Gt?"touchend":"mouseup",T),zt=n,q()):N(n)}return!1}function T(e){return e=e||window.event,v(e),m(document,Gt?"touchend":"mouseup",T),b(Z,"fd-slider-active"),clearTimeout(jt),jt=null,Dt=!0,!1}function A(e){return e=e||window.event,v(e),Gt?(m(document,"touchmove",E),m(document,"touchend",A)):(m(document,"mousemove",E),m(document,"mouseup",A)),Dt=!0,b(document.body,"fd-slider-drag-"+(bt?"vertical":"horizontal")),b(Z,"fd-slider-active"),h("dragend"),!1}function E(e){if(e=e||window.event,v(e),e.touches){if(e.targetTouches&&1!=e.targetTouches.length)return!1;e=e.touches[0]}return N(L(Ut+(bt?e.clientY-Jt:e.clientX-Jt))),!1}function j(e){var t=R();Vt=!0,t+=e*ht,O(M(t))}function D(){var e=0,t=0,n=X;try{do e+=n.offsetLeft,t+=n.offsetTop;while(n=n.offsetParent)}catch(i){}Lt=e,Ht=t}function q(){var e=parseInt(bt?tt.offsetTop:tt.offsetLeft,10);e=Math.round(e>zt?Math.max(zt,Math.floor(e-Wt)):Math.min(zt,Math.ceil(e+Wt))),N(L(e)),e!=zt?jt=setTimeout(q,mt>20?50:100):(Dt=!0,b(Z,"fd-slider-active"),h("finalise"))}function P(e){Dt=!1,It=parseInt(e,10),Rt=parseInt(bt?tt.offsetTop:tt.offsetLeft,10),Mt=It-Rt,Nt=20,Ot=0,jt||(jt=setTimeout(Kt,20))}function I(e){return isNaN(e)||""===e||"undefined"==typeof e?(Vt=!1,kt):e<Math.min(ut,ct)?(Vt=!1,Math.min(ut,ct)):e>Math.max(ut,ct)?(Vt=!1,Math.max(ut,ct)):(Vt=!0,e)}function R(){return M("input"==st?parseFloat(rt.value):rt.selectedIndex)}function M(e){return isNaN(e)||""===e||"undefined"==typeof e?kt:Math.min(Math.max(e,Math.min(ut,ct)),Math.max(ut,ct))}function N(e){var t=M(gt?H(U(e)):bt?lt-Math.round(e/Wt)*ht:at+Math.round(e/Wt)*ht);tt.style[bt?"top":"left"]=(e||0)+"px",W(),z("select"==st||1==ht?Math.round(t):t)}function O(e,t){var n,i=!1;"undefined"!=typeof e&&!isNaN(e)&&""!==e||"input"!=st||St?n=I(e):(n=kt,i=!0,Vt=!1),tt.style[bt?"top":"left"]=(gt?B(F(n)):Math.round(bt?(lt-n)/ht*Wt:(n-at)/ht*Wt))+"px",W(),typeof t!==!1&&z(i?"":n)}function L(e){if(gt)return Math.max(Math.min(Ft,e),Bt);var t=e%Wt;return t&&t>=Wt/2?e+=Wt-t:e-=t,e<Math.min(Math.abs(Bt),Math.abs(Ft))?e=Math.min(Math.abs(Bt),Math.abs(Ft)):e>Math.max(Math.abs(Bt),Math.abs(Ft))&&(e=Math.max(Math.abs(Bt),Math.abs(Ft))),Math.min(Math.max(e,0),Ft)}function H(e){var t,n=0,i=at;for(var r in gt)gt.hasOwnProperty(r)&&(e>=n&&+r>=e&&(t=i+(e-n)*(+gt[r]-i)/(+r-n)),n=+r,i=+gt[r]);return t}function F(e){var t=0,n=at,i=0;for(var r in gt)gt.hasOwnProperty(r)&&(e>=n&&e<=+gt[r]&&(i=t+(e-n)*(+r-t)/(+gt[r]-n)),t=+r,n=+gt[r]);return i}function B(e){return(X[bt?"offsetHeight":"offsetWidth"]-tt[bt?"offsetHeight":"offsetWidth"])/100*e}function U(e){return e/((X[bt?"offsetHeight":"offsetWidth"]-X[tt?"offsetHeight":"offsetWidth"])/100)}function z(e){if(h("update"),Vt?b(Z,"fd-slider-no-value"):y(Z,"fd-slider-no-value"),"select"==st)try{if(e=parseInt(e,10),rt.selectedIndex===e)return void G();rt.options[e].selected=!0}catch(t){}else{if(""===e||Et||(e=(at+Math.round((e-at)/ht)*ht).toFixed(ft)),rt.value===e)return void G();rt.value=e}G(),h("change")}function J(e,t){ut>ct?(e=Math.min(at,Math.max(e,t)),t=Math.max(lt,Math.min(e,t)),ut=Math.max(e,t),ct=Math.min(e,t)):(e=Math.max(at,Math.min(e,t)),t=Math.min(lt,Math.max(e,t)),ut=Math.min(e,t),ct=Math.max(e,t)),kt<Math.min(ut,ct)?kt=Math.min(ut,ct):kt>Math.max(ut,ct)&&(kt=Math.max(ut,ct)),tt.setAttribute("aria-valuemin",ut),tt.setAttribute("aria-valuemax",ct),I("input"==st?parseFloat(rt.value):rt.selectedIndex),d()}function W(){a||(bt?nt.style.height=Math.max(1,it.offsetHeight-tt.offsetTop)+"px":nt.style.width=Math.max(1,tt.offsetLeft)+"px")}function V(){for(var e,t=!1,n=document.getElementsByTagName("label"),i=0;e=n[i];i++)if(e.htmlFor&&e.htmlFor==rt.id||e.getAttribute("for")==rt.id){t=e;break}return t&&!t.id&&(t.id=rt.id+"_label"),t}function G(){var e="select"==st?rt.options[rt.selectedIndex].value:rt.value,t=Tt?Tt(e):"select"==st&&rt.options[rt.selectedIndex].text?rt.options[rt.selectedIndex].text:e;tt.setAttribute("aria-valuenow",e),tt.setAttribute("aria-valuetext",t)}function K(){Vt=!0,Et=At,O("input"==st?parseFloat(rt.value):rt.selectedIndex),G(),Et=!1}function Q(){"input"==st?rt.value=rt.defaultValue:rt.selectedIndex=Ct,I("select"==st?rt.options[rt.selectedIndex].value:rt.value),d(),G()}function t(e){Vt=!!e}function Y(e,t){e.setAttribute("tabIndex",t),e.tabIndex=t}var X,Z,et,tt,nt,it,rt=e.inp,ot=!1,st=rt.tagName.toLowerCase(),at=+e.min,lt=+e.max,ut=+e.min,ct=+e.max,dt=Math.abs(lt-at),ht="select"==st?1:+e.step,pt=e.maxStep?+e.maxStep:2*ht,ft=e.precision||0,mt=Math.ceil(dt/ht),gt=e.scale||!1,vt=!!e.hideInput,yt=e.animation||"",bt=!!e.vertical,wt=e.callbacks||{},xt=e.classNames||"",_t=!!e.html5Shim,kt=at>lt?at:at+(lt-at)/2,Ct="select"==st?rt.selectedIndex:rt.defaultValue||kt,St=_t||!!e.forceValue,$t=_t&&bt&&"inpHeight"in e?e.inpHeight:!1,Tt=!_t&&e.ariaFormat?e.ariaFormat:!1,At=!_t&&"select"!=st&&"userSnap"in e?!!e.userSnap:!1,Et=!1,jt=null,Dt=!0,qt=("select"==st?rt.selectedIndex:rt.value,0),Pt=0,It=0,Rt=0,Mt=0,Nt=0,Ot=0,Lt=0,Ht=0,Ft=0,Bt=0,Ut=0,zt=0,Jt=0,Wt=0,Vt=!1,Gt=!1;"input"==st&&St&&!rt.defaultValue&&(rt.defaultValue=R()),at>lt&&(ht=-Math.abs(ht),pt=-Math.abs(pt)),gt&&(gt[100]=lt);var Kt=function(){Ot++;var e=Mt,t=20,n=Ot,i=Rt,r=Math.ceil(n==t?i+e:e*(-Math.pow(2,-10*n/t)+1)+i);N(n==t?It:r),n!=t?(h("move"),jt=setTimeout(Kt,20)):(clearTimeout(jt),jt=null,Dt=!0,b(Z,"fd-slider-focused"),b(Z,"fd-slider-active"),h("finalise"))};return function(){_t||vt?y(rt,"fd-form-element-hidden"):f(rt,"change",K),_t&&(rt.stepUp=function(e){j(e||1)},rt.stepDown=function(e){j(e||-1)}),X=document.createElement("span"),X.className="fd-slider"+(bt?"-vertical ":" ")+xt,X.id="fd-slider-"+rt.id,bt&&$t&&(X.style.height=$t+"px"),Z=document.createElement("span"),Z.className="fd-slider-wrapper"+(_t?"":" fd-slider-no-value"),et=document.createElement("span"),et.className="fd-slider-inner",it=document.createElement("span"),it.className="fd-slider-bar",r?tt=document.createElement("span"):(tt=document.createElement("a"),tt.setAttribute("href","#"),f(tt,"click",g)),Y(tt,0),tt.className="fd-slider-handle",tt.appendChild(document.createTextNode(String.fromCharCode(160))),Z.appendChild(et),a||(nt=document.createElement("span"),nt.className="fd-slider-range",Z.appendChild(nt)),Z.appendChild(it),Z.appendChild(tt),X.appendChild(Z),rt.parentNode.insertBefore(X,rt),u&&(tt.unselectable="on",it.unselectable="on",et.unselectable="on",X.unselectable="on",Z.unselectable="on",a||(nt.unselectable="on")),X.setAttribute("role","application"),tt.setAttribute("role","slider"),tt.setAttribute("aria-valuemin","select"==st?rt.options[0].value:at),tt.setAttribute("aria-valuemax","select"==st?rt.options[rt.options.length-1].value:lt);var e=V();e&&(tt.setAttribute("aria-labelledby",e.id),tt.id="fd-slider-handle-"+rt.id,e.setAttribute("for",tt.id)),document.getElementById(o)&&tt.setAttribute("aria-describedby",o),1==rt.getAttribute("disabled")||"disabled"==rt.getAttribute("disabled")?n(!0):l(!0),s.onvalue&&(Vt=!0,I("input"==st?parseFloat(rt.value):rt.selectedIndex)),rt.form&&f(rt.form,"reset",Q),G(),h("create"),d()}(),{onResize:function(){(X.offsetHeight!=qt||X.offsetWidth!=Pt)&&d()},destroy:function(){c()},reset:function(){O("input"==st?parseFloat(rt.value):rt.selectedIndex)},stepUp:function(e){j(Math.abs(e)||1)},stepDown:function(e){j(-Math.abs(e)||-1)},increment:function(e){j(e)},disable:function(){n()},enable:function(){l()},setRange:function(e,t){J(e,t)},getValueSet:function(){return!!Vt},setValueSet:function(e){t(e)},checkValue:function(){s.onvalue&&(Vt=!0,I("input"==st?parseFloat(rt.value):rt.selectedIndex)),G(),d()}}}var t={},n=0,i=!0,r=!0,o="fd-slider-describedby",s={onfocus:!0,onvalue:!0},a=!1,l="jump",u="[object Opera]"===Object.prototype.toString.call(window.opera),c=/^([\-]{0,1}[0-9]+(\.[0-9]+){0,1})$/,d=/^([0-9]+(\.[0-9]+){0,1})$/,h=function(e){if("string"!=typeof e||""===e)return{};try{if("object"==typeof JSON&&"function"==typeof JSON.parse)return JSON.parse(e);if(/mousewheelenabled|fullaria|describedby|norangebar|html5animation|varsetrules/.test(e.toLowerCase())){var t=Function(["var document,top,self,window,parent,Number,Date,Object,Function,","Array,String,Math,RegExp,Image,ActiveXObject;","return (",e.replace(/<\!--.+-->/gim,"").replace(/\bfunction\b/g,"function-"),");"].join(""));return t()}}catch(n){}return{err:"Could not parse the JSON object"}},p=function(e){if("object"==typeof e)for(var t in e)switch(value=e[t],t.toLowerCase()){case"mousewheelenabled":i=!!value;break;case"fullaria":r=!!value;break;case"describedby":o=String(value);break;case"norangebar":a=!!value;break;case"html5animation":l=-1!=String(value).search(/^(jump|tween|timed)$/i)?String(value).toLowerCase():"jump";break;case"varsetrules":"onfocus"in value&&(s.onfocus=!!value.onfocus),"onvalue"in value&&(s.onvalue=!!value.onvalue)
}},f=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!0):e.attachEvent&&e.attachEvent("on"+t,n)},m=function(e,t,n){try{e.removeEventListener?e.removeEventListener(t,n,!0):e.detachEvent&&e.detachEvent("on"+t,n)}catch(i){}},g=function(e){return e=e||window.event,e.stopPropagation&&(e.stopPropagation(),e.preventDefault()),!1},v=function(e){return e=e||window.event,e.preventDefault?void e.preventDefault():void(e.returnValue=!1)},y=function(e,t){new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)||(e.className+=(e.className?" ":"")+t)},b=function(e,t){e.className=t?e.className.replace(new RegExp("(^|\\s)"+t+"(\\s|$)")," ").replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},w=function(){var e={};for(var n in t)e[n]=t[n].getValueSet();return e},x=function(e,n){t[e].setValueSet(!!n)},_=function(e){return!!(e in t&&t.hasOwnProperty(e))},k=function(n){if(!n||!n.inp||!n.inp.tagName||-1==n.inp.tagName.search(/^input|select/i))return!1;if(n.html5Shim=!1,"select"==n.inp.tagName.toLowerCase()){if(n.inp.options.length<2)return!1;n.min=0,n.max=n.inp.options.length-1,n.step=1,n.precision=0,n.scale=!1,n.forceValue=!0}else{if(-1==String(n.inp.type).search(/^(text|range)$/i))return!1;n.min=n.min&&-1!=String(n.min).search(c)?+n.min:0,n.max=n.max&&-1!=String(n.max).search(c)?+n.max:100,n.step=n.step&&-1!=String(n.step).search(d)?n.step:1,n.precision=n.precision&&-1!=String(n.precision).search(/^[0-9]+$/)?n.precision:-1!=String(n.step).search(/\.([0-9]+)$/)?String(n.step).match(/\.([0-9]+)$/)[1].length:0,n.scale=n.scale||!1,n.forceValue="forceValue"in n?!!n.forceValue:!1,n.userSnap="userSnap"in n?!!n.userSnap:!1}return n.ariaFormat="ariaFormat"in n&&"function"==typeof n.ariaFormat?n.ariaFormat:!1,n.maxStep=n.maxStep&&-1!=String(n.maxStep).search(d)?+n.maxStep:2*+n.step,n.classNames=n.classNames||"",n.callbacks=n.callbacks||!1,$(n.inp.id),t[n.inp.id]=new e(n),!0},C=function(e,t){return e.getAttribute(t)||""},S=function(){for(var i,r,o=document.getElementsByTagName("input"),s=0;r=o[s];s++)if("input"==r.tagName.toLowerCase()&&"text"==r.type.toLowerCase()&&(C(r,"min")&&-1!=C(r,"min").search(c)||C(r,"max")&&-1!=C(r,"max").search(c)||C(r,"step")&&-1!=C(r,"step").search(/^(any|([0-9]+(\.[0-9]+){0,1}))$/i))){if(r.id&&document.getElementById("fd-slider-"+r.id))continue;r.id&&!document.getElementById("fd-slider-"+r.id)&&$(r.id),r.id||(r.id="fd-slider-form-elem-"+n++),i={inp:r,callbacks:[],animation:l,vertical:C(r,"data-fd-slider-vertical")?!0:r.offsetHeight>r.offsetWidth,classNames:C(r,"data-fd-slider-vertical"),html5Shim:!0},i.vertical&&!C(r,"data-fd-slider-vertical")&&(i.inpHeight=r.offsetHeight),i.min=C(r,"min")||0,i.max=C(r,"max")||100,i.step=-1!=C(r,"step").search(/^any$/i)?i.max-i.min:-1!=C(r,"step").search(d)?r.getAttribute("step"):1,i.precision=-1!=String(i.step).search(/\.([0-9]+)$/)?String(i.step).match(/\.([0-9]+)$/)[1].length:0,i.maxStep=2*i.step,$(i.inp.id),t[i.inp.id]=new e(i)}return!0},$=function(e){return e in t&&t.hasOwnProperty(e)?(t[e].destroy(),delete t[e],!0):!1},T=function(){for(var e in t)t.hasOwnProperty(e)&&t[e].destroy();t=[]},A=function(){T(),t=null},E=function(){for(var e in t)t.hasOwnProperty(e)&&t[e].onResize()},j=function(){D(),S()},D=function(){m(window,"load",S)};return f(window,"load",S),f(window,"load",function(){setTimeout(function(){var e;for(e in t)t[e].checkValue()},0)}),f(window,"resize",E),f(window,"unload",A),function(){var e=document.getElementsByTagName("script"),t=String(e[e.length-1].innerHTML).replace(/[\n\r\s\t]+/g," ").replace(/^\s+/,"").replace(/\s+$/,""),n=h(t);"object"!=typeof n||"err"in n||p(n)}(),{rescanDocument:S,createSlider:function(e){return k(e)},onDomReady:function(){j()},destroyAll:function(){T()},destroySlider:function(e){return $(e)},redrawAll:function(){E()},addEvent:f,removeEvent:m,stopEvent:g,increment:function(e,n){return _(e)?void t[e].increment(n):!1},stepUp:function(e,n){return _(e)?void t[e].stepUp(Math.abs(n)||1):!1},stepDown:function(e,n){return _(e)?void t[e].stepDown(-Math.abs(n)||-1):!1},setRange:function(e,n,i){return _(e)?void t[e].setRange(n,i):!1},updateSlider:function(e){return _(e)?(t[e].onResize(),void t[e].reset()):!1},disable:function(e){return _(e)?void t[e].disable():!1},enable:function(e){return _(e)?void t[e].enable():!1},getValueSet:function(){return w()},setValueSet:function(e,t){return _(id)?void x(e,t):!1},setGlobalVariables:function(e){p(e)},removeOnload:function(){D()}}}();return e.fdSlider=t}.apply(e,arguments)})}(this),function(e){define("imagesloaded",["jquery"],function(){return function(){!function(e,t){"use strict";var n="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";e.fn.imagesLoaded=function(i){function r(){var t=e(h),n=e(p);l&&(p.length?l.reject(c,t,n):l.resolve(c)),e.isFunction(i)&&i.call(a,c,t,n)}function o(e){s(e.target,"error"===e.type)}function s(t,i){t.src!==n&&-1===e.inArray(t,d)&&(d.push(t),i?p.push(t):h.push(t),e.data(t,"imagesLoaded",{isBroken:i,src:t.src}),u&&l.notifyWith(e(t),[i,c,e(h),e(p)]),c.length===d.length&&(setTimeout(r),c.unbind(".imagesLoaded",o)))}var a=this,l=e.isFunction(e.Deferred)?e.Deferred():0,u=e.isFunction(l.notify),c=a.find("img").add(a.filter("img")),d=[],h=[],p=[];return e.isPlainObject(i)&&e.each(i,function(e,t){"callback"===e?i=t:l&&l[e](t)}),c.length?c.bind("load.imagesLoaded error.imagesLoaded",o).each(function(i,r){var o=r.src,a=e.data(r,"imagesLoaded");return a&&a.src===o?void s(r,a.isBroken):r.complete&&r.naturalWidth!==t?void s(r,0===r.naturalWidth||0===r.naturalHeight):void((r.readyState||r.complete)&&(r.src=n,r.src=o))}):r(),l?l.promise(a):a}}(jQuery)}.apply(e,arguments)})}(this),define("image-differ",["eevee","fd-slider","imagesloaded","jquery"],function(e,t,n,i){function r(e){this._$container=e}function o(e,t){e.onchange=t,e.oninput=t}function s(e){e.onchange=null,e.oninput=null}function a(e){if(e.data("natural-size"))return i.Deferred().resolve(e.data("natural-size"));if(e[0].naturalWidth){var t={width:e[0].naturalWidth,height:e[0].naturalHeight};return e.data("natural-size",t),i.Deferred().resolve(t)}var n=new Image,r=i.Deferred(),o=!1,s=function(){if(!o){var t={width:n.width,height:n.height};e.data("natural-size",t),r.resolve(t),o=!0}};return n.onload=s,n.src=e[0].src,n.complete&&s(),r}function l(e,t){var n=e.data("margin_border_padding");return null==n&&(n=e.outerWidth(!0)-e.width(),e.data("margin_border_padding",n)),t-n}return r.modes={TWO_UP:"two-up",BLEND:"blend",SPLIT:"split"},Object.freeze&&Object.freeze(r.modes),r.prototype.init=function(){var e,t,n=this,o=this._$imgs=this._$container.find("img");this._$sinceImg=o.eq(0),this._$untilImg=o.eq(1),this._$untilRevision=this._$untilImg.parent(),this._$sinceRevision=this._$sinceImg.parent(),this._$revisions=this._$untilRevision.add(this._$sinceRevision),this._$untilRevisionLabel=n._$untilRevision.find("h5"),this._$sinceRevisionLabel=n._$sinceRevision.find("h5"),n.setMode(r.modes.TWO_UP);var s=i.Deferred();return o.imagesLoaded().always(function(){var r=a(n._$sinceImg).done(function(t){e=t}),o=a(n._$untilImg).done(function(e){t=e});i.when(r,o).done(function(){var n=e.width===t.width&&e.height===t.height,i=n&&e.width>0;s.resolve(i)}).fail(function(){s.reject()})}),s},r.prototype.destroy=function(){this._cleanOldMode(this._mode),this._mode=null},r.prototype.setMode=function(e){this._mode!==e&&(this._onDiffModeChanged(e,this._mode),this._mode=e)},r.prototype._cleanOldMode=function(e){switch(e){case r.modes.TWO_UP:this._cleanTwoUpDiff();break;case r.modes.BLEND:this._cleanBlendDiff();break;case r.modes.SPLIT:this._cleanSplitDiff()}},r.prototype._onDiffModeChanged=function(t,n){switch(this._$container.removeClass("two-up blend split").addClass(t),this._cleanOldMode(n),t){case r.modes.TWO_UP:this._setupTwoUpDiff();break;case r.modes.BLEND:this._setupBlendDiff();break;case r.modes.SPLIT:this._setupSplitDiff()}e.trigger("imageDiffer.modeChanged",null,t,n)},r.prototype._cleanTwoUpDiff=i.noop,r.prototype._setupTwoUpDiff=i.noop,r.prototype._cleanBlendDiff=function(){var e=this._$container.children(".opacity-slider-container"),t=e.find("input");e.remove(),this._$untilImg.css("opacity",""),s(t[0])},r.prototype._setupBlendDiff=function(){var e=this,n=i('<input type="range" min="0" max="1" step="0.01" value="1" />');this._$container.children(".image-diff-toolbar").after(i('<div class="opacity-slider-container" />').append(n)),t.onDomReady(),o(n[0],function(){e._$untilImg.css("opacity",parseFloat(i(this).val()))})},r.prototype._cleanSplitDiff=function(){this._$imgs.css("width","").css("height",""),this._$revisions.css("width",""),this._$untilRevision.css("margin-left",""),this._$untilRevisionLabel.add(this._$sinceRevisionLabel).css("margin-left","").css("margin-right",""),this._$untilImg.unwrap(),this._$untilRevisionImageContainer.remove(),delete this._$untilRevisionImageContainer,this._$revisions.unwrap(),this._$splitContainer.remove(),delete this._$splitContainer,this._onResize&&(e.off("window.resize.debounced",this._onResize),delete this._onResize)},r.prototype._setSplitDiffElementProperties=function(e,t,n){var i=l(this._$container,this._$container.parent().width()),r=l(t,i),o=l(this._$sinceRevision,r),s=l(this._$sinceImg,o),a=Math.min(n.width,s);this._$imgs.width(a),this._$imgs.height(Math.floor(a/n.width*n.height)),e.height(this._$imgs.outerHeight(!0));var u=a+(o-s);this._$revisions.width(u),this._$untilRevision.css("margin-left",-u)},r.prototype._setupSplitDiff=function(){var t=this;return a(this._$imgs).done(function(n){t._$untilImg.wrap('<div class="image-container" />'),t._$revisions.wrapAll('<div class="split-container" />'),t._$untilRevisionImageContainer=t._$untilImg.parent(),t._$splitContainer=t._$container.find(".split-container");var i;t._onResize=function(){t._setSplitDiffElementProperties(t._$untilRevisionImageContainer,t._$splitContainer,n),i=t._$sinceImg.outerWidth(!0)},t._onResize(),e.on("window.resize.debounced",t._onResize),n.width<50?(t._$untilRevisionLabel.css("margin-left","-50px"),t._$sinceRevisionLabel.css("margin-right","-50px")):n.width<100&&(t._$untilRevisionLabel.css("margin-left",-n.width),t._$sinceRevisionLabel.css("margin-right",-n.width));var r;t._$splitContainer.on("mouseenter",function(){r=t._$untilRevision.offset(),t._$revisions.on("mousemove",o)}),t._$splitContainer.on("mouseleave",function(){t._$revisions.off("mousemove",o)});var o=function(e){t._$untilRevisionImageContainer.css("width",Math.min(e.pageX-r.left,i))}})},r}),define("image-diff-toolbar",["aui","eevee","jquery"],function(e,t,n){"use strict";function i(e){this._$toolbar=n(e),this._$toggle=this._$toolbar.find(".image-diff-toggle")}return t.addLocalEventMixin(i.prototype),i.prototype.init=function(t){function i(e){r.trigger("modeChanged",e,r._mode),r._mode=e}var r=this,o=this._$toggle.find(".image-diff-two-up"),s=this._$toggle.find(".image-diff-blend"),a=this._$toggle.find(".image-diff-split");a.attr("aria-disabled",!t).prop("disabled",!t),t&&a.attr("title",e.I18n.getText("imageDiffer.imageDiffToolbar.button.split.tooltip")),s.attr("aria-disabled",!t).prop("disabled",!t),t&&s.attr("title",e.I18n.getText("imageDiffer.imageDiffToolbar.button.blend.tooltip"));var l=this._$toggle.find(".aui-button"),u=function(e){return function(t){var r=n(this);"true"!==r.attr("aria-disabled")&&"true"!==r.attr("aria-pressed")&&(l.attr("aria-pressed","false"),r.attr("aria-pressed","true"),i(e)),t.preventDefault()}};o.click(u("two-up")),s.click(u("blend")),a.click(u("split")),o.add(s).add(a).tooltip({gravity:"s"}),i("two-up")},i.prototype.getMode=function(){return this._mode},i.prototype.destroy=function(){this._$toolbar&&(this._$toolbar.remove(),this._$toolbar=null),this._$toggle=null},i}),define("components/image-diff",["on-ready","image-differ","image-diff-toolbar"],function(e,t,n){return e(function(e){var i=e.find(".image-diff-toolbar"),r=new t(e),o=new n(e,i);r.init().done(function(e){o.init(e)}),o.on("modeChanged",function(e){r.setMode(e)})})}),define("components/typeahead/cursores",[],function(){function e(e,t,n){this.leftRegex=new RegExp((e||/(?:^|\s)(\S+)/).source+"$"),this.rightRegex=new RegExp("^"+(t||/(\S*)/).source),this.maxLength=n>0?n:128}return e.VERSION="0.2",e.startsWith=function(t){return new e(new RegExp(["(?:^|\\s)(",t,"[^",t,"\\s]*)"].join("")))},e.prototype.token=function(e,t){var n;"string"==typeof e?n=e:(n=e.value,t=e.selectionStart);var i=n.slice(0,t),r=n.slice(t),o=i.slice(-this.maxLength),s=r.slice(0,this.maxLength),a=o.match(this.leftRegex),l=a?a[1]:"",u=(a=s.match(this.rightRegex))?a[1]:"";return{value:l?l+u:"",prefix:l,suffix:l?u:"",toString:function(){return this.value}}},e.prototype.replace=function(e,t,n){var i;"string"==typeof e?i=e:(i=e.value,n=t,t=e.selectionStart);var r=this.token(i,t);if(i&&!r.value)return"string"==typeof e?i:!1;var o=i.slice(0,t),s=i.slice(t),a=[o.slice(0,o.length-r.prefix.length),n,s.slice(r.suffix.length)].join("");if("string"==typeof e)return a;var l=n.length-r.prefix.length;return e.value=a,e.setSelectionRange(t+l,t+l),!0},e}),define("components/typeahead/typeahead-view",["backbone","utils/mustache"],function(e,t){return e.View.extend({tagName:"a",className:"interactive",extraClassNames:"",initialize:function(e){this.query=e.query||"",e.templateName&&(this.template=_.partial(t.toHtml,e.templateName))},render:function(){return this.$el.children().length?this:(this.$el.html(this.template(this.model.toHighlightedJSON(this.query))),this.$el.addClass(_.result(this,"extraClassNames")),this)},setQuery:function(e){var t=this.model.toHighlightedJSON(e);return _.each(_.result(this.model,"highlightAttrs"),function(e){var n=e.replace("_","-");this.$(".{}".format(n)).html(t[e])},this),this.query=e,this.render()}})}),define("components/typeahead/typeahead-suggestions",["jquery","backbone","underscore","components/typeahead/typeahead-view"],function(e,t,n,i){return t.View.extend({tagName:"div",className:"bb-typeahead-suggestions aui-dropdown2 aui-style-default",extraClassNames:function(){return this.extraClasses},viewClass:function(){return this.suggestionView},callToActionHtml:function(){var t=e("<li>").addClass("bb-typeahead-item");return t.text(this.callToActionText),t},noResultHtml:function(t){var n=e("<li>").addClass("bb-typeahead-item");return t.searching?(n.addClass("bb-typeahead-searching"),n.text(interpolate(this.searchingText,{query:t.query},!0))):n.text(interpolate(this.noResultsText,{query:t.query},!0)),n},initialize:function(t){this.$ul=e("<ul></ul>"),this.$el.append(this.$ul),this.$el.attr("id",n.uniqueId("bb-typeahead-suggestions-")),this.$el.css("z-index",5e3),this.views={},this.models=[],this.index=0,t=t||{},this.suggestionView=t.suggestionView||i,this.callToActionText=t.callToActionText||gettext("Begin typing to search"),this.noResultsText=t.noResultsText||gettext("Found no matches for %(query)s"),this.searchingText=t.searchingText||gettext("Searching for %(query)s"),this.extraClasses=t.extraClasses||"",this.suggestionTemplate=t.suggestionTemplate||"mention-result",this.transformModelId=t.transformModelId||function(e){return e}},render:function(t){if(!t)return this;var i=this;return i.models=t.results,i.$ul.removeClass("bb-typeahead-suggestions-none").children("li").detach().find("a").removeClass("active"),i.$el.addClass(n.result(i,"extraClassNames")),i.models.length?n.each(i.models,function(n,r){var o,s=n.get(n.idAttribute);(o=i.views[s])?o.setQuery(t.query):o=i.views[s]=new(i.viewClass())({model:n,query:t.query,templateName:i.suggestionTemplate}),o.render(),o.$el.attr("data-model-id",n.get(n.idAttribute)),0===r&&o.$el.addClass("active"),i.$ul.append(e('<li class="bb-typeahead-item">').append(o.el))}):i.$ul.addClass("bb-typeahead-suggestions-none").append(t.query?this.noResultHtml({query:t.query,searching:t.searching}):this.callToActionHtml({})),i},count:function(){return this.models.length},activeModel:function(){var e,t=this.$ul.find("a.active");return t.length?(e=this.transformModelId(t.attr("data-model-id")),n.find(this.models,function(t){return t.get(t.idAttribute)===e})):null},replacementText:function(){var e=this.activeModel();return e?e.replacementText():null}})}),define("components/typeahead/typeahead-completion",["backbone","underscore","components/typeahead/cursores","components/typeahead/typeahead-suggestions","data/client"],function(e,t,n,i,r){return e.View.extend({BACKSPACE:8,DELETE:46,ESC:27,ENTER:13,LEFT:37,RIGHT:39,TAB:9,className:"bb-typeahead-input",boundEventTypes:["keydown","keypress","focus","paste","cut"],events:function(){var e={keydown:"onKeyDown",keypress:"onKeyPress",focus:"onFocus",paste:"onChange",cut:"onChange"},n={};return t.each(this.boundEventTypes,function(t){n[t+" ."+this.className]=e[t]}.bind(this)),n},initialize:function(e){if(this.hide=t.has(e,"hide")?!!e.hide:!0,this.focus=t.has(e,"focus")?!!e.focus:!0,this.source=e.source,this.source.on("respond",this.respond,this),e.results&&e.results.cid)this.results=e.results;else{var n=e.results||i;this.results=new n({suggestionView:e.resultView,callToActionText:e.callToActionText,extraClasses:e.resultsClasses,suggestionTemplate:e.resultTemplate,noResultsText:e.noResultsText,searchingText:e.searchingText})}this.results.$el.on("aui-dropdown2-show aui-dropdown2-hide",t.bind(this.onToggleDropdownVisibility,this)).appendTo("body"),this.results.$el.delegate(".bb-typeahead-item","click",t.bind(this.complete,this)),this.showingSuggestions=!1,this.currentEl=null,this.escPressed=!1,this.searchingTimeout=null,this.onFocusTimeout=null,this.queueQuery=t.debounce(this.queueQuery,e.queryDelay||600)},respond:function(e){var n=this,i=e.query||"",r=!!i&&n.source.activeQueryCount>0;n.hide&&i&&!e.results.length?n.showingSuggestions&&!r&&n.hideSuggestions(n.currentEl):(n.showSuggestions(n.currentEl),n.results.render(t.extend(e,{searching:r}))),clearTimeout(n.searchingTimeout),r&&!e.results.length?n.searchingTimeout=setTimeout(function(){$(n.currentEl).addClass("bb-typeahead-searching")},300):$(n.currentEl).removeClass("bb-typeahead-searching")},onKeyDown:function(e){if(this.currentEl=e.target,e.which===this.BACKSPACE||e.which===this.DELETE)return void this.queueQuery(e.target);if(this.showingSuggestions)switch(e.which){case this.LEFT:case this.RIGHT:this.queueQuery(e.target),e.stopPropagation();break;case this.ESC:e.preventDefault(),e.stopPropagation(),this.escPressed=!0,this.hideSuggestions(e.target);break;case this.TAB:1===this.results.count()&&(e.preventDefault(),e.stopPropagation(),this.complete(e))}},shouldStopSuggesting:function(){return!1},shouldSuppressSuggestions:function(){return this.escPressed},stopSuppressingSuggestions:function(){this.escPressed=!1},isWithinCodeBlock:function(){return!1},onKeyPress:function(e){if(0!==e.which&&e.which!==this.ENTER){var t=e.target;this.currentEl=t,this.shouldStopSuggesting(e)?this.hideSuggestions(t):this.queueQuery(t)}},onChange:function(e){this.currentEl=e.target,this.queueQuery(this.currentEl)},onFocus:function(e){var t=this,n=e.target;t.currentEl=n,null===this.onFocusTimeout&&(this.onFocusTimeout=setTimeout(function(){t.focus&&!n.value&&"false"!==$(n).attr("data-bb-typeahead-focus")&&($(n).attr("data-bb-typeahead-focus","false"),t.queueQuery(n)),t.onFocusTimeout=null},200))},hideSuggestions:function(e){this.results.$el.is(":visible")&&$(e).trigger("aui-button-invoke"),this.setShowingState(e,!1)},cursor:function(){return new n(/(.*)/,/(.*)/)},queryTerm:function(e){return this.cursor().token(e).value},queueQuery:function(e){var t=this;setTimeout(function(){!e.value&&t.shouldSuppressSuggestions()&&t.stopSuppressingSuggestions();var n=t.queryTerm(e);null!==n?t.source.query(n):t.hideSuggestions(e)},0)},onToggleDropdownVisibility:function(e){this.setShowingState(this.currentEl,"aui-dropdown2-show"===e.type)},setShowingState:function(e,t){this.showingSuggestions=t,t||$(e).removeClass("aui-dropdown2-trigger")},showSuggestions:function(e){this.isWithinCodeBlock(e)||this.shouldSuppressSuggestions()||(this.setShowingState(e,!0),this.results.$el.is(":visible")||$(e).attr({"aria-owns":this.results.$el.attr("id"),"aria-haspopup":"true"}).addClass("aui-dropdown2-trigger").trigger("aui-button-invoke"))},complete:function(e){var t="click"===e.type?this.currentEl:e.target,n=this.results.replacementText();null!==n&&(this.replaceText(t,n),"click"===e.type&&"Firefox"===r.browser&&$(t).focus()),this.hideSuggestions(t)},replaceText:function(e,t){var n=$(e);$.browser.msie&&parseInt($.browser.version,10)<10&&n.focus(),this.cursor().replace(e,t),n.trigger("typeahead-completed")},setSource:function(e){this.source.off("respond",this.respond,this),this.source=e,this.source.on("respond",this.respond,this)}})}),function(e){define("textarea-caret-position",[],function(){return function(){return function(){function e(e,i){var r=document.createElement("div");r.id="input-textarea-caret-position-mirror-div",document.body.appendChild(r);var o=r.style,s=window.getComputedStyle?getComputedStyle(e):e.currentStyle;o.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(o.wordWrap="break-word"),o.position="absolute",o.visibility="hidden",t.forEach(function(e){o[e]=s[e]}),n?e.scrollHeight>parseInt(s.height)&&(o.overflowY="scroll"):o.overflow="hidden",r.textContent=e.value.substring(0,i),"INPUT"===e.nodeName&&(r.textContent=r.textContent.replace(/\s/g,""));var a=document.createElement("span");a.textContent=e.value.substring(i)||".",r.appendChild(a);var l={top:a.offsetTop+parseInt(s.borderTopWidth),left:a.offsetLeft+parseInt(s.borderLeftWidth)};return document.body.removeChild(r),l}var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],n=null!=window.mozInnerScreenX;"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:window.getCaretCoordinates=e}(),e.getCaretCoordinates=getCaretCoordinates}.apply(e,arguments)})}(this),define("components/typeahead/prefix-typeahead-completion",["backbone","underscore","components/typeahead/cursores","components/typeahead/typeahead-completion","textarea-caret-position"],function(e,t,n,i,r){return i.extend({className:"bb-mention-input",boundEventTypes:["keydown","keypress"],initialize:function(e){if(i.prototype.initialize.call(this,t.extend({hide:!1,focus:!1},e)),this.prefixCursor=n.startsWith(this.prefix),this.results.$el.on("aui-dropdown2-show",t.bind(this.setAbsolutePosition,this)).addClass("aui-dropdown2-tailed"),this.prefix=this.prefix||e.prefix,!this.prefix)throw new Error("A prefix must be defined")},cursor:function(){return this.prefixCursor},isWithinCodeBlock:function(){return!1},onKeyPress:function(e){i.prototype.onKeyPress.call(this,e);var t=String.fromCharCode(e.which);this.isWithinCodeBlock(e.target)||!this.shouldSuppressSuggestions()||this.showingSuggestions||t!==this.prefix||i.prototype.stopSuppressingSuggestions.call(this)},setAbsolutePosition:function(){var e,t,n=this.currentEl,i=$(n),o=n.selectionStart,s=this.cursor().token(n),a=parseInt(i.css("font-size"),10);n.setSelectionRange(o-s.prefix.length,o-s.prefix.length),e=r(n,n.selectionEnd),n.setSelectionRange(o-(s.prefix.length-1),o-(s.prefix.length-1)),t=r(n,n.selectionEnd),n.setSelectionRange(o,o);var l=i.offset(),u=(t.left-e.left)/2,c=20,d=8,h=2;this.results.$el.css({top:l.top+t.top+a+h,left:l.left+e.left+u-(c+d),"min-width":350,"max-width":350})},queryTerm:function(e){var t=this.cursor().token(e);return t.value?t.value.slice(this.prefix.length):null}})}),define("utils/validation/regexes",[],function(){return{email:/^.+@.+$/,mention:/^[\.\w-]+$/,username:/^[\w-]+$/}}),define("components/typeahead/mention-completion",["underscore","components/typeahead/prefix-typeahead-completion","utils/validation/regexes"],function(e,t,n){return t.extend({prefix:"@",shouldStopSuggesting:function(t){var i=String.fromCharCode(t.which);if(n.mention.test(i))return!1;var r=this.results.models.length,o=this.cursor().token(t.target).prefix.slice(1),s=0===this.source.activeQueryCount,a=0===r,l=1===r&&this.results.replacementText()===o,u=e.any(this.results.models,function(e){return 0===e.get("username").indexOf(o)});return s&&(u||a||l)},replaceText:function(e,n){var i=e.selectionStart===e.value.length?" ":"";t.prototype.replaceText.call(this,e,"@"+n+i)}})}),define("components/mentions/mention-autocomplete",["underscore","components/typeahead/cursores","components/typeahead/mention-completion"],function(e,t,n){return n.extend({initialize:function(e){this.usernameCursor=this._getUsernameCursor(),this.relaxedCursor=this._getRelaxedCursor(),n.prototype.initialize.call(this,e)},_getUsernameCursor:function(){return new t(/(?:^|\s)(@[^@,?!'"\s]*[^\.])/,/([^.,?!'"\s]+)/)},_getRelaxedCursor:function(){return new t(/(?:^|\s)(@$|@[^@\s][^@\n]*[^\.])/,/([^.,?!'"\s]+)/)},cursor:function(){return this.showingSuggestions?this.relaxedCursor:this.usernameCursor},isWithinCodeBlock:function(e){var t=e.value.substring(0,e.selectionEnd),n=e.value.substring(0,e.selectionEnd).split("\n"),i=n[n.length-1],r=t.split("```").length%2===0,o=0===i.indexOf("    ");return r||o}})}),define("components/typeahead/typeahead-model",["backbone","underscore"],function(e,t){return e.Model.extend({replacementText:function(){return this.get(this.idAttribute)},highlightAttrs:function(){return[this.idAttribute]},toHighlightedJSON:function(e){var n=this.toJSON();return t.each(t.result(this,"highlightAttrs"),function(t){n[t]&&(n[t]=this.highlightSubstring(n[t],e))},this),n},highlight:function(e,n){return n=n.toLowerCase(),0===n.length||0!==e.toLowerCase().indexOf(n)?t.escape(n):["<em>",t.escape(e.slice(0,n.length)),"</em>",t.escape(e.slice(n.length))].join("")},highlightSubstring:function(e,n){n=n.toLowerCase();var i=this.splitWords(e);if(!i.length||!n)return t.escape(e);for(var r=[];i.length;){if(0===i.join("").toLowerCase().indexOf(n)){r.push(this.highlight(i.join(""),n));break}r.push(t.escape(i.shift(),n))}return r.join("")},splitWordsRegExp:/\s+/,splitWords:function(e){for(var t=[],n=e.split(this.splitWordsRegExp);n.length;){var i=n.shift();if(i){var r=e.indexOf(i);r>0&&t.push(e.slice(0,r)),t.push(i),e=e.slice(r+i.length)}}return e&&t.push(e),t},startsWith:function(e,t){var n=this.splitWords(e.toLowerCase());if(!n.length)return!1;for(/\s+/.test(n[0])&&n.shift(),t=t.toLowerCase();n.length;){if(0===n.join("").indexOf(t))return!0;n=n.slice(2)}return!1},matches:function(e){return e?this.startsWith(this.replacementText(),e):!0}},{matcher:function(e,t){var n=this;return e.matches(t,n)}})}),define("components/mentions/typeahead-user-model",["underscore","components/typeahead/typeahead-model"],function(e,t){return t.extend({idAttribute:"username",highlightAttrs:["display_name","username"],sortKeys:function(e){var t=this.get("display_name")||this.get("username");return[!(e.toLowerCase()===this.get("username").toLowerCase()),this.get("is_team"),!this.get("is_teammate"),!(this.usernameMatch(e)||this.displayNameMatch(e)),t.toLowerCase(),this.get("username").toLowerCase()]},usernameMatch:function(e){return this.startsWith(this.get("username"),e)},displayNameMatch:function(e){var t=this.get("display_name");return t&&this.startsWith(t,e)},keywordMatch:function(t){return e.some(this.get("keywords"),function(e){return this.startsWith(e,t)},this)},matches:function(e,t){var n=t.getQueryData(e),i=n.include_teams||!this.get("is_team");if(!e)return i;var r=this.usernameMatch(e),o=this.displayNameMatch(e),s=this.keywordMatch(e);return i&&(r||o||s)}})}),function(e){define("progressive-data-set",["aui","backbone"],function(){return function(){AJS.ProgressiveDataSet=Backbone.Collection.extend({initialize:function(e,t){t||(t={}),t.matcher&&(this.matcher=t.matcher),t.model&&(this.model=t.model),this._idAttribute=(new this.model).idAttribute,this._maxResults=t.maxResults||5,this._queryData=t.queryData||{},this._queryParamKey=t.queryParamKey||"q",this._queryEndpoint=t.queryEndpoint||"",this.value=null,this.queryCache={},this.activeQueryCount=0,_.bindAll(this,"query","respond")},url:function(){return this._queryEndpoint},query:function(e){var t,n;this.value=e,n=this.getFilteredResults(e),this.respond(e,n),e&&this._queryEndpoint&&!this.hasQueryCache(e)&&this.shouldGetMoreResults(n)&&(t=this.fetch(e),this.activeQueryCount++,this.trigger("activity",{activity:!0}),t.always(_.bind(function(){this.activeQueryCount--,this.trigger("activity",{activity:!!this.activeQueryCount})},this)),t.done(_.bind(function(t,n,i){this.addQueryCache(e,t,i)},this)),t.done(_.bind(function(){e=this.value,n=this.getFilteredResults(e),this.respond(e,n)},this)))},getQueryData:function(e){var t=_.isFunction(this._queryData)?this._queryData(e):this._queryData,n=_.extend({},t);return n[this._queryParamKey]=e,n},fetch:function(e){var t=this.getQueryData(e),n={add:!0,update:!0,remove:!1,data:t},i=Backbone.Collection.prototype.fetch.call(this,n);return i},respond:function(e,t){return this.trigger("respond",{query:e,results:t}),t},matcher:function(){},getFilteredResults:function(e){var t=[];return e?(t=this.filter(function(t){return!!this.matcher(t,e)},this),this._maxResults&&(t=_.first(t,this._maxResults)),t):t},addQueryCache:function(e,t,n){var i=this.queryCache,r=this.parse(t,n);i[e]=_.pluck(r,this._idAttribute)},hasQueryCache:function(e){return this.queryCache.hasOwnProperty(e)},findQueryCache:function(e){return this.queryCache[e]},shouldGetMoreResults:function(e){return e.length<this._maxResults},setMaxResults:function(e){this._maxResults=e,this.value&&this.respond(this.value,this.getFilteredResults(this.value))}})}.apply(e,arguments)})}(this),function(e){define("truncating-progressive-data-set",["progressive-data-set"],function(){return function(){AJS.TruncatingProgressiveDataSet=AJS.ProgressiveDataSet.extend({initialize:function(e,t){this._maxResponseSize=t.maxResponseSize,AJS.ProgressiveDataSet.prototype.initialize.call(this,e,t)},shouldGetMoreResults:function(){var e=this.findQueryResponse(this.value);return!e||e.length===this._maxResponseSize},findQueryResponse:function(e){for(;e;){var t=this.findQueryCache(e);if(t)return t;e=e.substr(0,e.length-1)}return null}})}.apply(e,arguments)})}(this),define("utils/progressive-data-set",["jquery","underscore","aui","truncating-progressive-data-set"],function(e,t,n){var i=n.TruncatingProgressiveDataSet;return i.extend({initialize:function(e,t){t.maxResponseSize=t.maxResponseSize||20,this.allowMultipleActiveQueries=!!t.allowMultipleActiveQueries,this.queries=[],i.prototype.initialize.call(this,e,t)},getFilteredResults:function(e){var n=this.filter(function(t){return this.matcher(t,e)},this);return n=t.sortBy(n,function(t){return t.sortKeys(e)}),n=t.first(n,this._maxResults)},query:function(t){var i=e.when.apply(this,this.queries);i.then(function(){this.queries=[]}.bind(this)),this.allowMultipleActiveQueries?n.TruncatingProgressiveDataSet.prototype.query.call(this,t):i.then(function(){n.TruncatingProgressiveDataSet.prototype.query.call(this,t)}.bind(this))},fetch:function(e){var t=n.TruncatingProgressiveDataSet.prototype.fetch.call(this,e);return this.queries.push(t),t}})}),define("data/settings",["jquery"],function(e){return e(document.body).data("settings")}),define("components/typeahead/typeahead-data-set",["utils/progressive-data-set","data/settings"],function(e,t){return e.extend({hasQueryCache:function(n){return n.length<t.MENTIONS_MIN_QUERY_LENGTH||e.prototype.hasQueryCache.call(this,n)}})}),define("components/mentions/user-data-set",["components/typeahead/typeahead-data-set"],function(e){return e.extend({getFilteredResults:function(t){var n=e.prototype.getFilteredResults.call(this,t),i=_.filter(n,function(e){return e.get("is_teammate")}),r=_.filter(n,function(e){return!e.get("is_teammate")&&t.toLowerCase()===e.get("username").toLowerCase()}),o=_.filter(n,function(e){return!e.get("is_teammate")&&t.toLowerCase()!==e.get("username").toLowerCase()
});return i.concat(r).concat(o)}})}),define("components/mentions/user-typeahead",["underscore","components/typeahead/typeahead-completion"],function(e,t){return t.extend({className:"bb-user-typeahead"})}),define("components/mentions/user-and-team-typeahead",["components/mentions/user-typeahead"],function(e){return e.extend({className:"bb-user-team-typeahead"})}),define("components/mentions/user-suggestions",["underscore","utils/mustache","components/typeahead/typeahead-suggestions","data/settings"],function(e,t,n,i){return n.extend({extraClassNames:function(){return n.prototype.extraClassNames.call(this)+" bb-user-suggestions"},callToActionHtml:e.bind(t.toHtml,null,"mention-call-to-action"),noResultHtml:function(e){return e.query.length>=i.MENTIONS_MIN_QUERY_LENGTH?n.prototype.noResultHtml.call(this,e):this.callToActionHtml(e)}})}),define("components/mentions/typeahead-user",["underscore","components/typeahead/typeahead-view"],function(e,t){return t.extend({extraClassNames:function(){return this.model.get("is_team")?"bb-typeahead-team":"bb-typeahead-user"}})}),define("utils/exists",["jquery"],function(e){return function(t,n){var i=e(t);1===i.length&&n(i)}}),define("components/mentions/index",["on-ready","underscore","components/mentions/mention-autocomplete","components/mentions/typeahead-user-model","components/mentions/user-data-set","components/mentions/user-and-team-typeahead","components/mentions/user-typeahead","components/mentions/user-suggestions","components/mentions/typeahead-user","utils/exists","data/current-user"],function(e,t,n,i,r,o,s,a,l,u,c){function d(){var e=[];c.id&&(e=t.map($("#recently-mentioned-"+c.id).data("value"),function(e){return new i(e)}));var u=$("body")[0],d={model:i,matcher:i.matcher,queryEndpoint:"/xhr/user-mention",queryParamKey:"term",maxResponseSize:20},h=new r(e,d),p=new r(e,t.extend({},d,{model:i,matcher:i.matcher})),f=new r(e,t.extend(d,{queryData:{include_teams:!0}})),m={el:u,results:a,resultView:l};new n(t.extend({source:p},m)).render(),new s(t.extend({source:h},m)).render(),new o(t.extend({source:f},m)).render()}return e(function(){d()})}),define("components/repo-typeahead/repo-typeahead-model",["underscore","components/typeahead/typeahead-model","data/current-user"],function(e,t,n){return t.extend({idAttribute:"full_slug",splitWordsRegExp:/[-_]/,initialize:function(e){this.set(this.parse(e))},highlightAttrs:["owner","slug"],getFullSlug:function(){return"{}/{}".format(this.get("owner"),this.get("slug"))},queryParts:function(e){var t,n,i=e.split("/");return i.length>1?(t=i[0],n=i[1]):(t="",n=e),{owner:t,slug:n}},toHighlightedJSON:function(t){var n=this.queryParts(t),i=this.toJSON();return e.extend(i,{owner:this.highlightSubstring(this.get("owner"),n.owner||n.slug),slug:this.highlightSubstring(this.get("slug"),n.slug)})},sortKeys:function(e){var t=this.queryParts(e);return t.owner&&t.slug?[!(this.get("owner")===n.username),!(this.get("owner")===t.owner),!(this.get("slug")===t.slug),this.get("owner"),this.get("slug")]:t.owner?[!(this.get("owner")===n.username),!(this.get("owner")===t.owner),this.get("owner"),this.get("slug")]:[!(this.get("owner")===n.username),!(this.get("owner")===e),!(this.get("slug")===e),this.get("owner"),this.get("slug")]},matches:function(e){var t,n,i=this.queryParts(e);return i.owner&&i.slug?(t=this.startsWith(this.get("owner"),i.owner),n=this.startsWith(this.get("slug"),i.slug),t&&n):i.owner?t=this.startsWith(this.get("owner"),i.owner):(t=this.startsWith(this.get("owner"),e),n=this.startsWith(this.get("slug"),e),t||n)}})}),define("components/repo-typeahead/repo-typeahead-view",["underscore","components/typeahead/typeahead-view"],function(e,t){return t.extend({extraClassNames:function(){return"bb-repo-typeahead"},render:function(){this.$el.attr("title",this.model.getFullSlug()),this.$el.attr("href",this.model.get("href")),t.prototype.render.apply(this,arguments)}})}),define("components/repo-typeahead/repo-typeahead-data-set",["components/typeahead/typeahead-data-set"],function(e){return e.extend({findQueryResponse:function(e){return this.findQueryCache(e)}})}),define("components/repo-typeahead/repo-quick-search",["underscore","components/typeahead/typeahead-completion","utils/event-tracking-helper"],function(e,t,n){var i=n("Page Header");return t.extend({className:"bb-repo-typeahead",complete:function(e){i("QuickSearch Result Clicked",$(e.target).closest("a").attr("href"))}})}),define("components/repo-typeahead/index",["on-ready","components/repo-typeahead/repo-typeahead-model","components/repo-typeahead/repo-typeahead-view","components/repo-typeahead/repo-typeahead-data-set","components/repo-typeahead/repo-quick-search","components/typeahead/typeahead-data-set","components/typeahead/typeahead-suggestions"],function(e,t,n,i,r,o,s){return e(function(){var e=new i([],{model:t,matcher:t.matcher,queryEndpoint:"/xhr/repos",queryParamKey:"term",maxResults:10,maxResponseSize:20});new r({el:document.body,source:e,results:s,resultsClasses:"bb-repo-typeahead-suggestions",resultView:n,resultTemplate:"repo-typeahead-result"}).render()})}),define("components/tooltip",["aui","on-ready"],function(e,t){return t(function(e){e.tooltip()})}),define("config/bitbucket",["bitbucket"],function(e){e.proxy_url="/!api/1.0/"}),function(){var e;e=function(e){var t,n={},i="herment-storage-key",r=100;return n.getServerName=function(){var e;return"undefined"!=typeof document.location&&"undefined"!=typeof document.location.hostname&&(e=document.location.hostname),""===e&&(e="-"),e},n.getProductNameFromServerName=function(e){return"undefined"!=typeof e?e.replace(".com","").replace(".net","").replace(".org","").replace(".au","").replace(".io",""):"-"},n.getSubdomain=function(e){var t="-",n=e.match(/^([a-z0-9\.]*)[\-\.]{1}([a-z0-9]+)+\.([a-z]{2,6})$/i);if(n){var i=e.split(".");i=2===i[i.length-1].length?i.slice(0,i.length-3):i.slice(0,i.length-2),0!==i.length&&(t=i.join("."))}return t},n.ajaxPost=function(e,t){var n;if(window.XMLHttpRequest)n=new XMLHttpRequest;else{if(!window.ActiveXObject)return;n=new window.ActiveXObject("Microsoft.XMLHTTP")}n.open("POST",e,!0),"undefined"!=typeof n.setRequestHeader&&(n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("Accept","application/json, text/javascript, */*;")),n.send(t)},n.parseConfig=function(e,t){var n,i,o,s,a,l,u,c;if("undefined"==typeof e||"undefined"==typeof e.queue){var d=window.AJS=window.AJS||{};d.EventQueue=d.EventQueue||[],n=d.EventQueue}else n=e.queue;return i="undefined"==typeof e||"undefined"==typeof e.analyticsserver?"analytics.atlassian.com":e.analyticsserver,o="undefined"==typeof e||"undefined"==typeof e.analyticsurl?"/analytics/events":e.analyticsurl,s="undefined"==typeof e||"undefined"==typeof e.server?t.getServerName():e.server,a="undefined"==typeof e||"undefined"==typeof e.product?t.getProductNameFromServerName(s):e.product,"undefined"==typeof e||"undefined"==typeof e.subproduct?(l=t.getSubdomain(s),"undefined"==typeof l&&(l="-")):l=e.subproduct,u="undefined"==typeof e||"undefined"==typeof e.ajax?t.ajaxPost:e.ajax,c="undefined"==typeof e||"undefined"==typeof e.maxevents?r:e.maxevents,{queue:n,gasServer:i,gasUrl:o,serverName:s,productName:a,subProductName:l,post:u,maxevents:c}},t=n.parseConfig(e,n),n.config=t,n.pushToServer=function(e,i){var r="undefined"!=typeof i?i:n.config.post,o="https://"+t.gasServer+t.gasUrl,s={events:e},a=JSON.stringify(s);r(o,a)},n.addEventsToArray=function(e,t,i,r,o){for(var s in e)if(e.hasOwnProperty(s)){var a=e[s];if(t.length>=n.config.maxevents)break;if(a.name&&a.properties){var l={name:a.name,properties:a.properties,serverTime:a.time||0,server:i,user:"default",product:r,subproduct:o};t.push(l)}}},n.publishFromQueueAndStorage=function(e){var i="undefined"!=typeof e?e:n.pushToServer,r=[];if(!(t.queue.length<1&&window.sessionStorage.length<1)){n.addEventsToArray(t.queue,r,t.serverName,t.productName,t.subProductName);var o=n.popEventsFromStorage();n.addEventsToArray(o,r,t.serverName,t.productName,t.subProductName),t.queue.length=0,r&&r.length&&i(r)}},n.serialiseEventsToString=function(e){return JSON.stringify(e)},n.deserialiseEvents=function(e){return JSON.parse(e)},n.storeEvents=function(e){if("undefined"!=typeof window.sessionStorage){if(window.sessionStorage[i]){var t=n.deserialiseEvents(window.sessionStorage[i])||[];t.length<n.config.maxevents&&t.push.apply(t,e),e=t}try{window.sessionStorage.setItem(i,n.serialiseEventsToString(e))}catch(r){}}},n.popEventsFromStorage=function(){if("undefined"==typeof window.sessionStorage)return[];if(window.sessionStorage[i]){var e=n.deserialiseEvents(window.sessionStorage[i]);return window.sessionStorage[i]=n.serialiseEventsToString([]),e}return[]},n.moveQueueToStorage=function(){0!==t.queue.length&&"undefined"!=typeof window.sessionStorage&&(n.storeEvents(t.queue),t.queue.length=0)},n.start=function(){var e=Array.prototype.push;t.queue.push=function(n){n.time=(new Date).getTime(),e.call(t.queue,n)},setInterval(n.publishFromQueueAndStorage,5e3),setInterval(n.moveQueueToStorage,1e3)},"undefined"==typeof window.onunload&&(window.onunload=function(){n.moveQueueToStorage()}),n},window["herment-gas-client"]=e,window.define&&window.define("herment",[],function(){return e})}(),define("herment",function(){}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/matches-selector",[],function(){var e=window.HTMLElement.prototype,t=e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector;return t}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/debounce",[],function(){return function(e){var t=!1;return function(){t||(t=!0,setTimeout(function(){t=!1,e()},1))}}}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/mutation-observer-polyfill",["./debounce"],function(e){function t(e){this.callback=e,this.elements=[]}function n(e,t){return{addedNodes:null,attributeName:null,attributeNamespace:null,nextSibling:null,oldValue:null,previousSibling:null,removedNodes:null,target:e,type:t||"childList"}}function i(e,t){return 1!==e.nodeType?!1:e.contains?e.contains(t):r.call(e,t)}t.prototype={observe:function(t,r){function o(e){h.push(e),f()}function s(e){var t=e.target;if(t){var r=t.parentNode;l(r)&&(u&&i(u,t)||(c&&c.target===r||p.push(c=n(r)),r?(c.addedNodes||(c.addedNodes=[]),c.addedNodes.push(t)):(c.removedNodes||(c.removedNodes=[]),c.removedNodes.push(t)),u=t))}}function a(e){return r.attributes&&(r.subtree||e===t)}function l(e){return r.childList&&(r.subtree||e===t)}var u,c,d=this,h=[],p=[],f=e(function(){for(var e=h.length,t=0;e>t;t++)s(h[t]);d.callback(p),h=[],p=[],u=void 0,c=void 0}),m={},g=[],v=e(function(){var e=g.length;d.callback(g),g.splice(0,e)}),y={target:t,options:r,insertHandler:o,removeHandler:o,attributeHandler:function(e){var t=e.target;if(a(t)){var i=e.attrName,o=e.prevValue,s=e.newValue,l=n(t,"attributes");l.attributeName=i,r.attributeOldValue&&(l.oldValue=m[i]||o||null),g.push(l),r.attributeOldValue&&(m[i]=s),v()}}};return this.elements.push(y),r.childList&&(t.addEventListener("DOMNodeInserted",y.insertHandler),t.addEventListener("DOMNodeRemoved",y.removeHandler)),r.attributes&&t.addEventListener("DOMAttrModified",y.attributeHandler),this},disconnect:function(){return this.elements.forEach(function(e){e.target.removeEventListener("DOMNodeInserted",e.insertHandler),e.target.removeEventListener("DOMNodeRemoved",e.removeHandler),e.target.removeEventListener("DOMAttrModified",e.attributeHandler)}),this.elements=[],this}};var r=window.HTMLElement.prototype.contains;return t}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/mutation-observer",["./mutation-observer-polyfill"],function(e){return window.MutationObserver||window.WebkitMutationObserver||window.MozMutationObserver||e}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/multi-value-map",[],function(){function e(){this._items={},this.length=0}return e.prototype.add=function(e,t){this._items.hasOwnProperty(e)||(this.length++,this._items[e]=[]),this._items[e].push(t)},e.prototype.remove=function(e,t){var n,i=!1;return this._items.hasOwnProperty(e)&&(1===arguments.length?(delete this._items[e],i=!0):(n=this._items[e].indexOf(t),n>-1&&(this._items[e].splice(n,1),0===this._items[e].length&&delete this._items[e],i=!0))),i},e.prototype.get=function(e){return this._items.hasOwnProperty(e)?this._items[e]:[]},e.prototype.forEach=function(e){var t=this._items;Object.keys(t).forEach(function(n){e(t[n],n)})},e}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/element-hound",["jquery","./matches-selector","./mutation-observer","./multi-value-map"],function(e,t,n,i){function r(e,t){u||(a.observe(document,{attributes:!0,childList:!0,subtree:!0}),u=!0),l.add(e,t)}function o(){l.remove.apply(l,arguments),0===l.length&&(a.disconnect(),u=!1)}function s(t){var n,i,s=[];return t.forEach||(t=[t]),t.forEach(function(t){var n;document.querySelector(t)||(n=e.Deferred(),n.selector=t,n.callback=function(){n.resolve()},s.push(n),r(t,n.callback))}),n=e.when.apply(e,s),n.always(function(){s.forEach(function(e){o(e.selector,e.callback)})}),i=n.promise(),i.dismiss=function(){s.forEach(function(e){e.reject()})},i}var a,l,u=!1;return l=new i,a=new n(function(e){e.forEach(function(e){var n="childList"===e.type&&e.addedNodes&&e.addedNodes.length>0,i="attributes"===e.type;(n||i)&&l.forEach(function(n,i){(e.target.querySelector(i)||t.call(e.target,i))&&(n.forEach(function(e){e()}),o(i))})})}),s}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/element-wolf",["jquery","./matches-selector","./mutation-observer","./multi-value-map"],function(e,t,n,i){function r(e,t){u||(a.observe(document,{childList:!0,subtree:!0}),u=!0),l.add(e,t)}function o(){l.remove.apply(l,arguments),0===l.length&&(a.disconnect(),u=!1)}function s(t){var n,i,s=[];return t.forEach||(t=[t]),t.forEach(function(t){var n;document.querySelector(t)&&(n=e.Deferred(),n.selector=t,n.callback=function(){n.resolve()},s.push(n),r(t,n.callback))}),n=e.when.apply(e,s),n.always(function(){s.forEach(function(e){o(e.selector,e.callback)})}),i=n.promise(),i.dismiss=function(){s.forEach(function(e){e.reject()})},i}var a,l,u=!1;return l=new i,a=new n(function(e){e.forEach(function(e){var n="childList"===e.type&&e.removedNodes&&e.removedNodes.length>0;n&&l.forEach(function(n,i){for(var r,s=0;s<e.removedNodes.length;s++)if(r=e.removedNodes[s],r.querySelector&&(r.querySelector(i)||t.call(r,i))){for(var a=0;a<n.length;a++)n[a]();o(i)}})})}),s}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/event-bus",[],function(){var e={},t={},n=function(e,n,i){"undefined"!=typeof t[e]?t[e].push({callback:n,once:i}):t[e]=[{callback:n,once:i}]};return e.on=function(e,t){n(e,t,!1)},e.one=function(e,t){n(e,t,!0)},e.trigger=function(e,n){if("undefined"!=typeof t[e]){for(var i=t[e].length,r=[],o=0;i>o;o++){var s=t[e][o];s&&s.callback&&(s.callback.apply(void 0,[n]),s.once||r.push(s))}t[e]=r}},e}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/promise/resolved",["jquery"],function(e){return function(){var t=e.Deferred();return t.resolve.apply(t,arguments),t.promise()}}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/util/is-dom-content-loaded-done",["jquery"],function(e){function t(){return n}var n=!1;return e(function(){setTimeout(function(){n=!0},0)}),t}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/api",["jquery","./element-hound","./element-wolf","./event-bus","./promise/resolved","./util/is-dom-content-loaded-done"],function(e,t,n,i,r,o){function s(e,t){return Array.isArray(e)||(e=[e]),e.map(function(e){"string"==typeof e&&(e={selector:e});var n,i={};for(n in t)i[n]=t[n];for(n in e)i[n]=e[n];return i})}function a(o){var s;return s=o.map(function(e){var o;return e.requireUpdate?(o=new n(e.selector),i.one("start",function(){o.dismiss()})):o=r(),o.pipe(function(){var n=new t(e.selector);return i.one("start",function(){n.dismiss()}),n})}),e.when.apply(e,s)}var l={};return l.start=function(e){var t,n="isInitial"in e?e.isInitial:o()===!1;i.trigger("start",{key:e.key,isInitial:n}),e.ready&&(t=s(e.ready,{requireUpdate:!n}),a(t).done(function(){l.end({key:e.key})}))},l.end=function(e){i.trigger("end",{key:e.key})},l}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/lib/ajs",[],function(){return window.AJS||(window.AJS={})}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/publish",["./lib/ajs"],function(e){function t(t,n){e.EventQueue.push({name:t,properties:n})}return e.EventQueue=e.EventQueue||[],t}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/badger",["jquery"],function(e){function t(t,n){function i(){var e=t();void 0!==e&&(clearInterval(r),o.resolve(e))}var r,o=e.Deferred();return r=setInterval(i,n),i(),o.promise()}return t}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/metrics/navigation",[],function(){function e(){var e={};return window.performance&&window.performance.navigation&&window.performance.navigation.redirectCount>0&&(e.redirectCount=window.performance.navigation.redirectCount),e}return e}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/promise/rejected",["jquery"],function(e){return function(){var t=e.Deferred();return t.reject.apply(t,arguments),t.promise()}}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/metrics/timing",["../promise/resolved","../promise/rejected","../badger"],function(e,t,n){function i(){return window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}function r(){function r(){var e=window.performance.timing.loadEventEnd;return e>0?e:void 0}function s(){var t={};return o.forEach(function(e){var n=window.performance.timing[e];n>0&&(t[e]=n)}),e(t)}return i()?n(r,500).pipe(s):t()}var o=["navigationStart","unloadEventStart","unloadEventEnd","redirectStart","redirectEnd","fetchStart","domainLookupStart","domainLookupEnd","connectStart","connectEnd","secureConnectionStart","requestStart","responseStart","responseEnd","domLoading","domInteractive","domContentLoadedEventStart","domContentLoadedEventEnd","domComplete","loadEventStart","loadEventEnd"];return r}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/util/merge",[],function(){function e(){for(var e,n,i={},r=0,o=arguments.length;o>r;r++){e=arguments[r];for(n in e)t.call(e,n)&&(i[n]=e[n])}return i}var t=Object.prototype.hasOwnProperty;return e}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/util/offset",[],function(){function e(e,t){var n={};return Object.keys(e).forEach(function(i){n[i]=e[i]+t}),n}return e}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/report",["./badger","./metrics/navigation","./metrics/timing","./promise/resolved","./util/merge","./util/offset","jquery"],function(e,t,n,i,r,o,s){function a(){var e="browser-metrics-journey-id-key",t="undefined";return"undefined"===window.sessionStorage?t:(window.sessionStorage[e]?t=window.sessionStorage.getItem(e):(t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)}),window.sessionStorage.setItem(e,t)),t)}function l(e){var l=i(),u=e.start,c={},d=s.Deferred();return e.isInitial&&(l=l.pipe(n).pipe(function(e){c=r(c,e),u=c.navigationStart,delete c.navigationStart})),l.always(function(){c=r(c,{readyForUser:Math.round(e.end)}),c=o(c,-u),c=r(c,{key:e.key,isInitial:e.isInitial,userAgent:window.navigator.userAgent,journeyId:a()},t()),d.resolve(c)}),d.promise()}return l}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/util/now",[],function(){var e;return e=window.performance&&window.performance.now?function(){return window.performance.timing.navigationStart+window.performance.now()}:window.Date.now.bind(window.Date)}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/agent",["./publish","./report","./util/merge","./util/now"],function(e,t,n,i){function r(e){return n({start:i(),end:null},e)}function o(n){var o;n.on("start",function(e){o=r(e)}),n.on("end",function(n){o&&o.key===n.key&&(o.end=i(),t(o).done(function(t){e("browser.metrics.navigation",t)}),o=null)})}return o}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/lib/wrm",[],function(){return window.WRM||(window.WRM={})}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics/is-enabled",["./lib/wrm"],function(e){function t(e){return!!(e&&e.constructor&&e.call&&e.apply)}function n(n,i){return e&&e.data&&e.data.claim&&t(e.data.claim)?e.data.claim(n):e&&e.data&&t(e.data)?e.data(n):i}function i(){return void 0===r&&(r=n(o,!0)),r}var r,o="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:api.feature-data-provider";return i}),define("bower/browser-metrics/browser-metrics/src/internal/browser-metrics",["./browser-metrics/api","./browser-metrics/agent","./browser-metrics/event-bus","./browser-metrics/is-enabled"],function(e,t,n,i){return i()?(t(n),e):{start:function(){},end:function(){}}}),define("utils/browser-metrics",["bower/browser-metrics/browser-metrics/src/internal/browser-metrics","herment"],function(e,t){if(Math.random()<=.1&&t){var n=t({product:"bitbucket",subproduct:"web"});n.start();var i=$('meta[name="bb-view-name"]').attr("content");e.start({key:i,isInitial:!0}),e.end({key:i})}}),define("utils/csrf",["jquery"],function(e){function t(t){var n=null;if(document.cookie&&""!==document.cookie)for(var i=document.cookie.split(";"),r=0;r<i.length;r++){var o=e.trim(i[r]);if(o.substring(0,t.length+1)==t+"="){n=decodeURIComponent(o.substring(t.length+1));break}}return n}e.ajaxSetup({beforeSend:function(e,n){/^(?!https?:)/.test(n.url)&&e.setRequestHeader("X-CSRFToken",t("csrftoken"))}})}),define("utils/deferred-image-loader",["jquery"],function(e){return function(){e(".deferred-image").each(function(){var t=e(this),n=t.attr("data-src-url"),i=t.attr("data-src-url-2x");window.devicePixelRatio>1.5&&i?t.attr("src",i):n&&t.attr("src",t.attr("data-src-url")),t.removeClass("deferred-image")})}}),define("utils/replace-url",["jquery","jquery-plugins/jquery.pjax"],function(e){var t=/<meta .*>/;if(e.support.pjax){var n=e("body").attr("data-replace-url");n&&window.history.replaceState({},"",n),e(document).on("pjax:success",function(i,r){if(r){var o=r.match(t);if(o){var s=e(o[0]);n=s.attr("content"),n&&window.history.replaceState({},"",n)}}})}}),define("utils/retina",["jquery","on-ready"],function(e,t){return window.devicePixelRatio<=1.5?t():t(function(e){if(e.is('[src*="language-avatars"]')){var t=e.attr("src"),n=/(\d+)\.png$/,i=t.match(n),r=parseInt(i[1],10);e.attr("src",t.replace(n,2*r+".png"))}})}),define("utils/trigger-events",["jquery","store"],function(e,t){var n=t.get("events");n&&n.length&&e.ajax({url:"/xhr/trigger-events/",type:"POST",dataType:"json",data:JSON.stringify(n)}),t.set("events",[])}),function(e){define("jquery-migrate",["jquery"],function(){return function(){!function(e,t,n){function i(n){var i=t.console;o[n]||(o[n]=!0,e.migrateWarnings.push(n),i&&i.warn&&!e.migrateMute&&(i.warn("JQMIGRATE: "+n),e.migrateTrace&&i.trace&&i.trace()))}function r(t,n,r,o){if(Object.defineProperty)try{return void Object.defineProperty(t,n,{configurable:!0,enumerable:!0,get:function(){return i(o),r},set:function(e){i(o),r=e}})}catch(s){}e._definePropertyBroken=!0,t[n]=r}var o={};e.migrateWarnings=[],!e.migrateMute&&t.console&&t.console.log&&t.console.log("JQMIGRATE: Logging is active"),e.migrateTrace===n&&(e.migrateTrace=!0),e.migrateReset=function(){o={},e.migrateWarnings.length=0},"BackCompat"===document.compatMode&&i("jQuery is not compatible with Quirks Mode");var s=e("<input/>",{size:1}).attr("size")&&e.attrFn,a=e.attr,l=e.attrHooks.value&&e.attrHooks.value.get||function(){return null},u=e.attrHooks.value&&e.attrHooks.value.set||function(){return n},c=/^(?:input|button)$/i,d=/^[238]$/,h=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,p=/^(?:checked|selected)$/i;r(e,"attrFn",s||{},"jQuery.attrFn is deprecated"),e.attr=function(t,r,o,l){var u=r.toLowerCase(),f=t&&t.nodeType;return l&&(a.length<4&&i("jQuery.fn.attr( props, pass ) is deprecated"),t&&!d.test(f)&&(s?r in s:e.isFunction(e.fn[r])))?e(t)[r](o):("type"===r&&o!==n&&c.test(t.nodeName)&&t.parentNode&&i("Can't change the 'type' of an input or button in IE 6/7/8"),!e.attrHooks[u]&&h.test(u)&&(e.attrHooks[u]={get:function(t,i){var r,o=e.prop(t,i);return o===!0||"boolean"!=typeof o&&(r=t.getAttributeNode(i))&&r.nodeValue!==!1?i.toLowerCase():n},set:function(t,n,i){var r;return n===!1?e.removeAttr(t,i):(r=e.propFix[i]||i,r in t&&(t[r]=!0),t.setAttribute(i,i.toLowerCase())),i}},p.test(u)&&i("jQuery.fn.attr('"+u+"') may use property instead of attribute")),a.call(e,t,r,o))},e.attrHooks.value={get:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?l.apply(this,arguments):("input"!==n&&"option"!==n&&i("jQuery.fn.attr('value') no longer gets properties"),t in e?e.value:null)},set:function(e,t){var n=(e.nodeName||"").toLowerCase();return"button"===n?u.apply(this,arguments):("input"!==n&&"option"!==n&&i("jQuery.fn.attr('value', val) no longer sets properties"),void(e.value=t))}};var f,m,g=e.fn.init,v=e.parseJSON,y=/^([^<]*)(<[\w\W]+>)([^>]*)$/;e.fn.init=function(t,n,r){var o;return t&&"string"==typeof t&&!e.isPlainObject(n)&&(o=y.exec(e.trim(t)))&&o[0]&&("<"!==t.charAt(0)&&i("$(html) HTML strings must start with '<' character"),o[3]&&i("$(html) HTML text after last tag is ignored"),"#"===o[0].charAt(0)&&(i("HTML string cannot start with a '#' character"),e.error("JQMIGRATE: Invalid selector string (XSS)")),n&&n.context&&(n=n.context),e.parseHTML)?g.call(this,e.parseHTML(o[2],n,!0),n,r):g.apply(this,arguments)},e.fn.init.prototype=e.fn,e.parseJSON=function(e){return e||null===e?v.apply(this,arguments):(i("jQuery.parseJSON requires a valid JSON string"),null)},e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e.browser||(f=e.uaMatch(navigator.userAgent),m={},f.browser&&(m[f.browser]=!0,m.version=f.version),m.chrome?m.webkit=!0:m.webkit&&(m.safari=!0),e.browser=m),r(e,"browser",e.browser,"jQuery.browser is deprecated"),e.sub=function(){function t(e,n){return new t.fn.init(e,n)}e.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(i,r){return r&&r instanceof e&&!(r instanceof t)&&(r=t(r)),e.fn.init.call(this,i,r,n)},t.fn.init.prototype=t.fn;var n=t(document);return i("jQuery.sub() is deprecated"),t},e.ajaxSetup({converters:{"text json":e.parseJSON}});var b=e.fn.data;e.fn.data=function(t){var r,o,s=this[0];return!s||"events"!==t||1!==arguments.length||(r=e.data(s,t),o=e._data(s,t),r!==n&&r!==o||o===n)?b.apply(this,arguments):(i("Use of jQuery.fn.data('events') is deprecated"),o)};var w=/\/(java|ecma)script/i,x=e.fn.andSelf||e.fn.addBack;e.fn.andSelf=function(){return i("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"),x.apply(this,arguments)},e.clean||(e.clean=function(t,n,r,o){n=n||document,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,i("jQuery.clean() is deprecated");var s,a,l,u,c=[];if(e.merge(c,e.buildFragment(t,n).childNodes),r)for(l=function(e){return!e.type||w.test(e.type)?o?o.push(e.parentNode?e.parentNode.removeChild(e):e):r.appendChild(e):void 0},s=0;null!=(a=c[s]);s++)e.nodeName(a,"script")&&l(a)||(r.appendChild(a),"undefined"!=typeof a.getElementsByTagName&&(u=e.grep(e.merge([],a.getElementsByTagName("script")),l),c.splice.apply(c,[s+1,0].concat(u)),s+=u.length));return c});var _=e.event.add,k=e.event.remove,C=e.event.trigger,S=e.fn.toggle,$=e.fn.live,T=e.fn.die,A="ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess",E=new RegExp("\\b(?:"+A+")\\b"),j=/(?:^|\s)hover(\.\S+|)\b/,D=function(t){return"string"!=typeof t||e.event.special.hover?t:(j.test(t)&&i("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"),t&&t.replace(j,"mouseenter$1 mouseleave$1"))};e.event.props&&"attrChange"!==e.event.props[0]&&e.event.props.unshift("attrChange","attrName","relatedNode","srcElement"),e.event.dispatch&&r(e.event,"handle",e.event.dispatch,"jQuery.event.handle is undocumented and deprecated"),e.event.add=function(e,t,n,r,o){e!==document&&E.test(t)&&i("AJAX events should be attached to document: "+t),_.call(this,e,D(t||""),n,r,o)},e.event.remove=function(e,t,n,i,r){k.call(this,e,D(t)||"",n,i,r)},e.fn.error=function(){var e=Array.prototype.slice.call(arguments,0);return i("jQuery.fn.error() is deprecated"),e.splice(0,0,"error"),arguments.length?this.bind.apply(this,e):(this.triggerHandler.apply(this,e),this)},e.fn.toggle=function(t,n){if(!e.isFunction(t)||!e.isFunction(n))return S.apply(this,arguments);i("jQuery.fn.toggle(handler, handler...) is deprecated");var r=arguments,o=t.guid||e.guid++,s=0,a=function(n){var i=(e._data(this,"lastToggle"+t.guid)||0)%s;return e._data(this,"lastToggle"+t.guid,i+1),n.preventDefault(),r[i].apply(this,arguments)||!1};for(a.guid=o;s<r.length;)r[s++].guid=o;return this.click(a)},e.fn.live=function(t,n,r){return i("jQuery.fn.live() is deprecated"),$?$.apply(this,arguments):(e(this.context).on(t,this.selector,n,r),this)},e.fn.die=function(t,n){return i("jQuery.fn.die() is deprecated"),T?T.apply(this,arguments):(e(this.context).off(t,this.selector||"**",n),this)},e.event.trigger=function(e,t,n,r){return n||E.test(e)||i("Global events are undocumented and deprecated"),C.call(this,e,t,n||document,r)},e.each(A.split("|"),function(t,n){e.event.special[n]={setup:function(){var t=this;return t!==document&&(e.event.add(document,n+"."+e.guid,function(){e.event.trigger(n,null,t,!0)}),e._data(this,n,e.guid++)),!1},teardown:function(){return this!==document&&e.event.remove(document,n+"."+e._data(this,n)),!1}}})}(jQuery,window)}.apply(e,arguments)})}(this),define("global",["aui","jquery","underscore","data/i18n","data/environment","shims/string-extensions","shims/string-format","shims/string-format-transformers","initialization","utils/on-load","i18n/index","localization","tracking","keyboard-shortcuts","select2","components/banner","registration/create-team-link","header/index","components/follow","components/follow-list","components/footer","components/hipchat-integration-dialog","components/hipchat-integration-message","components/hipchat-integration-trigger","components/image-diff","components/mentions/index","components/repo-typeahead/index","components/tooltip","config/bitbucket","utils/browser-metrics","utils/csrf","utils/deferred-image-loader","utils/replace-url","utils/retina","utils/trigger-events","jquery-migrate"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,S,$,T,A,E,j,D){var q=t(window);window.$=window.jQuery=t,t.migrateMute="production"===r,n.extend(e.I18n.keys,i),u(function(){q.off("focus",D),D()}),document.hasFocus&&!document.hasFocus()&&q.one("focus",D),t(document).on("pjax:end",D)}),define("utils/feature-detects/has-history",[],function(){var e=navigator.userAgent;return-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone")?window.history&&"pushState"in window.history:!1}),define("utils/load-modules",["jquery","underscore"],function(e,t){function n(e){return function(){t.each(arguments,function(n){n&&t.isFunction(n.onReady)&&n.onReady(e)})}}return function(t){t.find("[data-modules]").each(function(){var t=e(this),i=t.attr("data-modules").trim();i&&require(i.split(/\s*,\s*/),n(t))})}}),define("snippets/index",["backbone","jquery"],function(e,t){var n=e.Router.extend({routes:{"snippets/new":"new","snippets/:owner/:id/edit/":"edit"},"new":function(){require(["snippets/snippet","snippets/form"],function(e,n){var i=t(".snippet-form"),r=i.find(".snippets-owner-input option:selected").data("user"),o=new e({owner:r});
new n({el:i,model:o}).render()})},edit:function(){require(["snippets/snippet","snippets/form"],function(e,n){var i=t(".snippet-form"),r=JSON.parse(i.find(".snippets-json").text()),o=new e(r,{parse:!0});new n({el:i,model:o}).render()})}});return new n}),define("bootstrap",["backbone","global","jquery","js/global/events","utils/feature-detects/has-history","utils/load-modules","snippets/index"],function(e,t,n,i,r,o){i.vent.on("change:content",function(e){o(e)}),n(document).on("pjax:end",function(e){i.vent.trigger("change:content",n(e.target))}),n(function(){i.vent.trigger("change:content",n(document.body)),e.history.start({pushState:r})})});var REQUIRE_JS_CONFIG;!function(){var e=function(e){REQUIRE_JS_CONFIG=e};e({paths:{aui:"./utils/aui","aui-soy":"../bower_components/aui-stable/aui-next/js/aui-soy","aui-stable":"../bower_components/aui-stable/aui-next/js/aui","aui-experimental":"../bower_components/aui-stable/aui-next/js/aui-experimental",backbone:"../bower_components/backbone/backbone","backbone.babysitter":"../bower_components/backbone.babysitter/lib/backbone.babysitter","backbone.wreqr":"../bower_components/backbone.wreqr/lib/backbone.wreqr",bitbucket:"../bower_components/bitbucket/bitbucket",bower:"../bower_components",bytes:"../bower_components/bytes/dist/bytes",codemirror:"./utils/codemirror","django-connect":"../bower_components/django-connect","atlassian-connect-js":"../bower_components/atlassian-connect-js",cssesc:"../bower_components/cssesc/cssesc",cursores:"../bower_components/cursores/cursores","diff-match-patch":"../bower_components/google-diff-match-patch-js/diff_match_patch",eevee:"../bower_components/eevee/lib/eevee",eve:"../bower_components/eve-adobe/eve","fd-slider":"../bower_components/fd-slider/js/fd-slider",herment:"../bower_components/herment/target/herment","image-diff-toolbar":"../bower_components/image-differ/lib/image-diff-toolbar","image-differ":"../bower_components/image-differ/lib/image-differ",imagesloaded:"../bower_components/imagesloaded/jquery.imagesloaded",jquery:"../bower_components/jquery/dist/jquery","jquery-migrate":"../bower_components/jquery-migrate/index","jquery-plugins/jquery.chosen":"../bower_components/chosen/chosen/chosen.jquery","jquery-plugins/jquery.client":"../bower_components/jquery-client/jquery.client","jquery-plugins/jquery.cookie":"../bower_components/jquery-cookie/jquery.cookie","jquery-plugins/jquery.fancybox":"../bower_components/fancybox/source/jquery.fancybox","jquery-plugins/jquery.getscrollbarwidth":"../bower_components/jquery-getscrollbarwidth/jquery.getscrollbarwidth","jquery-plugins/jquery.hoverIntent":"../bower_components/jquery-hoverIntent/jquery.hoverIntent","jquery-plugins/jquery.jeditable":"../bower_components/jeditable/jquery.jeditable","jquery-plugins/jquery.localize":"../bower_components/jquery-localize/jquery.localize","jquery-plugins/jquery.markitup":"../bower_components/markitup/markitup/jquery.markitup","jquery-plugins/jquery.pjax":"../bower_components/jquery-pjax/jquery.pjax","jquery-plugins/jquery.placeholder":"../bower_components/jquery-placeholder/jquery.placeholder","jquery-plugins/jquery.scrollTo":"../bower_components/jquery.scrollTo/jquery.scrollTo","jquery-plugins/jquery.spin":"../bower_components/spin.js/jquery.spin","jquery-plugins/jquery.ui.core":"../bower_components/jquery-ui/ui/jquery.ui.core","jquery-plugins/jquery.ui.draggable":"../bower_components/jquery-ui/ui/jquery.ui.draggable","jquery-plugins/jquery.ui.mouse":"../bower_components/jquery-ui/ui/jquery.ui.mouse","jquery-plugins/jquery.ui.widget":"../bower_components/jquery-ui/ui/jquery.ui.widget",js:"../js",liquidmetal:"../bower_components/liquidmetal/liquidmetal",marionette:"./utils/marionette","marionette-lib":"../bower_components/marionette/lib/backbone.marionette",mustache:"../bower_components/mustache/mustache","on-ready":"./utils/on-ready","progressive-data-set":"../bower_components/progressive-dataset/index","require-lib":"../bower_components/requirejs/require","shims/string-extensions":"../bower_components/string-tools/string-extensions","shims/string-format":"../bower_components/string-tools/string-format","shims/string-format-transformers":"../bower_components/string-tools/string-format-transformers",spin:"../bower_components/spin.js/spin",store:"../bower_components/store/store",text:"../bower_components/requirejs-text/text","truncating-progressive-data-set":"../bower_components/truncating-progressive-dataset/index","textarea-caret-position":"../bower_components/textarea-caret-position/index",underscore:"../bower_components/underscore/underscore"},shim:{"aui-stable":{deps:["jquery","aui-soy"],exports:"AJS"},"aui-experimental":{deps:["aui-stable"]},"django-connect/connect-views":{deps:["aui-stable"]},"progressive-data-set":{deps:["aui","backbone"]},"truncating-progressive-data-set":{deps:["progressive-data-set"]},bitbucket:{deps:["jquery"],exports:"bitbucket"},"bower/browser-metrics/browser-metrics/src/internal/browser-metrics":{deps:["herment"]},"diff-match-patch":{exports:"diff_match_patch"},"fd-slider":{exports:"fdSlider"},"jquery-migrate":["jquery"],imagesloaded:["jquery"],"jquery-plugins/jquery.chosen":["jquery"],"jquery-plugins/jquery.client":["jquery"],"jquery-plugins/jquery.cookie":["jquery"],"jquery-plugins/jquery.fancybox":["jquery"],"jquery-plugins/jquery.getscrollbarwidth":["jquery"],"jquery-plugins/jquery.hoverIntent":["jquery"],"jquery-plugins/jquery.jeditable":["jquery"],"jquery-plugins/jquery.localize":["jquery"],"jquery-plugins/jquery.markitup":["jquery"],"jquery-plugins/jquery.pjax":["jquery"],"jquery-plugins/jquery.placeholder":["jquery"],"jquery-plugins/jquery.scrollTo":["jquery"],"jquery-plugins/jquery.textinputs":["jquery"],"jquery-plugins/jquery.ui.core":{deps:["jquery"]},"jquery-plugins/jquery.ui.draggable":{deps:["jquery-plugins/jquery.ui.mouse"]},"jquery-plugins/jquery.ui.mouse":{deps:["jquery-plugins/jquery.ui.widget"]},"jquery-plugins/jquery.ui.widget":{deps:["jquery-plugins/jquery.ui.core"]},liquidmetal:{exports:"LiquidMetal"},"textarea-caret-position":{exports:"getCaretCoordinates"},mustache:{exports:"Mustache"},"shims/string-extensions":["underscore"],"shims/string-format-transformers":["shims/string-format","underscore"],store:{exports:"store"}}})}(),"undefined"!=typeof module&&module.exports?module.exports.REQUIRE_JS_CONFIG=REQUIRE_JS_CONFIG:(requirejs.config(REQUIRE_JS_CONFIG),require(["bootstrap"])),define("main",function(){}),define("account-admin/2fa",["jquery","on-ready"],function(e,t){return t(function(t){var n=t.find(".pjax-container");n.on("submit","form",function(t){e.pjax.submit(t,n)}),n.on("pjax:beforeSend",function(){n.addClass("has-mask")}),n.on("pjax:complete",function(){n.removeClass("has-mask")}),n.on("click",".toggle-link",function(t){t.preventDefault();var n=e(this),i=n.attr("data-toggle-container");e("#"+i).toggleClass("show"),n.toggleClass("showing")})})}),define("utils/select-avatar-formatter",["jquery","utils/mustache"],function(e,t){return function(n){var i=e(n.element),r=i.data("user");return r||(r={display_name:n.text,avatar:i.data("avatar")}),t.toHtml("user-select-template",r)}}),define("account-admin/account-selector",["aui","jquery","on-ready","underscore","utils/mustache","utils/select-avatar-formatter","data/header-info","data/current-user"],function(e,t,n,i,r,o,s,a){return n(function(e){function t(t){u!==a.username&&e.prepend(r.toHtml("target-user-template",{username:a.username,display_name:a.displayName,avatar:a.avatarUrl}));var o=i.chain(t.teams).filter(n).filter(l).value();i.each(o,function(t){e.append(r.toHtml("target-user-template",t))}),e.on("change",function(e){window.location.href=e.val})}function n(e){return e.username!=u}function l(e){return"admin"==e.privilege}var u=e.attr("data-target-user");e.auiSelect2({formatResult:o,formatSelection:o,dropdownAutoWidth:!0,minimumResultsForSearch:-1}),s.done(t)})}),define("account-admin/connected-accounts",["aui","jquery","on-ready","utils/api-helper"],function(e,t,n,i){return n(function(){var n=t("#connected-accounts"),r=n.attr("data-password-change-url");n.on("click",'a[href="#delete"]',function(n){n.preventDefault();var o=t(this).closest("tr"),s=o.find("script").html(),a=o.data("type"),l=o.data("pk"),u=i.concat("user","3rdparty",a);t.ajax({type:"DELETE",url:u.toString(l),dataType:"json",success:function(){if("openid"!==a)t(n.target).closest("div").replaceWith(s);else{var e=o.closest("tbody");o.remove(),0===e.find("tr").length&&(t("h2").remove(),e.closest("table").remove())}"github"==a&&(o.find(".github-import").remove(),t("#import-github-repo-link").remove())},error:function(){var t=gettext('Please <a href="%(password_change_url)s">set a password</a> before disconnecting this account');e.messages.error({body:interpolate(t,{password_change_url:r},!0)})}})})})}),define("components/modal-dialog",["aui","jquery","utils/mustache","js/components/aui-dialog"],function(e,t,n,i){function r(i,r){var o=t(n.toHtml("dialog2-template",{classes:i.warning?"aui-dialog2-warning":"",title:i.title,isSafeContent:i.isSafeContent,contents:i.content,size:i.size||"medium",showCancel:i.showCancel,buttonText:i.buttonText,closeText:i.cancelText}));t(window.body).append(o);var s=e.dialog2(o);return o.on("click",".dialog-accept",function(){r.resolve(),s.remove()}).on("click",".dialog-close",function(){s.remove(),r.reject()}),s}var o=0;return function(e,n){if(e.dialog2)return r(e,n);var s,a=e.id||o++,l=new i({width:e.width||450,height:e.height||"auto",id:"bb-"+a+"-confirmation-dialog"}),u=e.buttonText||gettext("Okay");return s=e.isSafeContent?e.content:t("<div></div>").text(e.content),e.title&&l.addHeader(e.title),l.addPanel("main",s,"confirmation-dialog-body"),l.addButton(u,function(e){e.remove(),n.resolve()}),l}}),define("components/confirm-dialog",["jquery","components/modal-dialog"],function(e,t){return function(n){var i,r=new e.Deferred;i="string"==typeof n?{content:n}:n,i.buttonText=i.buttonText||gettext("Confirm"),i.cancelText=i.cancelText||gettext("Cancel"),i.showCancel=!0;var o=t(i,r);return i.dialog2||o.addCancel(i.cancelText,function(e){e.remove(),r.reject()}),o.show(),r.promise()}}),define("account-admin/delete",["jquery","on-ready","components/confirm-dialog"],function(e,t,n){return t(function(){e("#delete-account").on("click","form button",function(t){t.preventDefault(),n({id:"delete-account",title:gettext("Delete account"),content:gettext("This is a destructive operation. Delete account?"),buttonText:gettext("Delete")}).done(function(){e(t.target).closest("form").submit()})})})}),define("account-admin/edit-oauth-consumer",["jquery","on-ready","underscore"],function(e,t,n){function i(e,t){return e.find(t.map(function(e){return'[data-scope="'+e+'"]'}).join(", "))}function r(e,t){var r=[],o=[];n.each(t,function(t,n){var s=i(e,[n]);if(s.is(":checked")){r.push.apply(r,t);var a=i(e,t);a.prop({disabled:!0,checked:!0})}else o.push.apply(o,t)}),r=n.uniq(r),o=n.uniq(o);var s=o.filter(function(e){return!n.contains(r,e)}),a=i(e,s);a.prop({disabled:!1})}var o={account:["email"],"account:write":["email","account"],"team:write":["team"],"repository:write":["repository"],pullrequest:["repository"],"pullrequest:write":["repository","repository:write","pullrequest"],"issue:write":["issue"],"snippet:write":["snippet"]};return t(function(e){e.on("change","[data-scope]",function(){r(e,o)}),r(e,o)})}),define("account-admin/email",["aui","backbone","jquery","underscore","on-ready","utils/api-helper","utils/delay","utils/mustache"],function(e,t,n,i,r,o,s,a){var l=t.Model.extend({idAttribute:"email"}),u=t.Collection.extend({model:l,initialize:function(e,t){this.emailsApi=t.emailsApi,this.isTeam=t.isTeam},comparator:function(e){return[e.get("primary")?0:1,e.get("active")?0:1,e.get("email").toLowerCase()]},url:function(){return this.emailsApi.toString()}}),c=t.View.extend({tagName:"tr",template:"email-template",events:{'click [href="#delete"]':"deleteEmail",'click [href="#resend"]':"resend",'click [href="#set-as-primary"]':"setAsPrimary"},initialize:function(){this.model.on("change",this.render,this)},render:function(e){e="boolean"==typeof e&&e;var t=this.model.toJSON();return t.team=this.model.collection.isTeam,this.$el.html(a.toHtml(this.template,t)),e&&this.model.get("primary")&&this.highlight(),this},highlight:function(){var e=this.$el.addClass("highlight");setTimeout(function(){e.animate({backgroundColor:"#fff"},{duration:1e3,complete:function(){e.removeClass("highlight")}})},1e3)},markSent:function(){var e=gettext("confirmation sent");return this.$(".status").addClass("sent").hide().html("<div>{}</div>".format(i.escape(e))).fadeIn("slow"),this},resend:function(t){return t.preventDefault(),this.model.save({},{wait:!0,success:function(t){t.get("active")?e.messages.success({body:gettext("Your email address has been confirmed."),fadeout:!0}):this.markSent()}.bind(this)}),this},deleteEmail:function(e){return e.preventDefault(),this.model.destroy({wait:!0,error:function(e,t){var n=t.responseText;this.parent.respond(n?n.substr(0,140):gettext("An unknown error occurred."))}.bind(this)}),this},setAsPrimary:function(t){t.preventDefault(),this.model.save({primary:!0},{wait:!0,success:function(){e.messages.success({body:gettext("Your primary email address has been updated."),fadeout:!0})}})}}),d=t.View.extend({events:{"submit form":"onSubmit"},initialize:function(){this.submitDisabled=!1,this.$table=this.$("table.widget"),this.$form=this.$("form"),this.$inputRow=this.$("tr.form"),this.$body=this.$("tbody"),this.$emailAddress=this.$("#email-input"),this.$error=this.$(".error"),this.collection.on("add",this.emailAdd,this),this.collection.on("remove",this.emailRemove,this),this.collection.on("reset",this.render,this),this.collection.on("change:primary",this.reorder,this)},render:function(e){if(this.$inputRow=this.$inputRow.detach(),this.$body.empty(),this.$body.append(this.$inputRow),this.collection.length)this.collection.forEach(function(t){var n=new c({model:t});return n.parent=this,this.$body.append(n.render(e).el),this}.bind(this));else{var t;t=gettext(this.collection.isTeam?"Adding email addresses to teams is no longer supported":"No email addresses"),this.$body.append('<tr><td colspan="3">{text}</td></tr>'.format({text:t}))}return this},reorder:function(e){var t=this.collection.find(function(t){return t.get("email")!==e.get("email")&&t.get("primary")});t&&t.set({primary:!1},{silent:!0}),this.collection.sort(),this.render(!0)},emailAdd:function(e){var t=new c({model:e}),n=this.collection.indexOf(e);t.parent=this,this.$inputRow.nextAll().eq(n-1).after(t.render().el),t.highlight(),this.respond()},emailRemove:function(e,t,n){var i=this.$inputRow.nextAll().eq(n.index);i.slideUp(function(){i.remove()}),this.respond()},_reword:function(e){var t=/not a valid email address/.test(e);return t?gettext("Invalid email address."):e},respond:function(e){if(e){var t=this._reword(e);this.$error.removeClass("hidden").find(".message").text(t)}else this.$error.addClass("hidden").find(".message").text("")},onSubmit:function(e){e.preventDefault();var t=this.$emailAddress.val().trim();if(!this.submitDisabled&&t){if(this.collection.get(t.toLowerCase()))return void this.respond(gettext("You've already added this email address."));var n=this;n.submitDisabled=!0;var i=s(400,function(){n.$form.addClass("loading")}),r=function(){window.clearTimeout(i),n.$form.removeClass("loading"),n.submitDisabled=!1};n.collection.create({email:t},{wait:!0,complete:r,error:function(e,t){return n.respond(t.responseText)},success:function(){n.$emailAddress.val(""),n.respond()}})}}});return r(function(){var e=n("#account-email"),t=new u([],{emailsApi:o.concat("users",e.attr("data-target-user"),"emails"),isTeam:!!e.attr("data-target-user-is-team")});new d({el:n("#email-pane")[0],collection:t}),t.fetch({reset:!0})})}),define("components/paginate",["jquery","jquery-plugins/jquery.pjax"],function(){return function(e,t){t=t||{},t.container=t.$pjaxContainer&&t.$pjaxContainer.length?t.$pjaxContainer:e,e.pjax(".aui-nav-pagination a",t).on("click",".aui-nav-pagination a",function(e){$(e.target).attr("aria-disabled")&&e.preventDefault()}),t.setMask!==!1&&e.on("pjax:send",function(){t.container.find(".maskable").addClass("has-mask")}).on("pjax:complete",function(){t.container.find(".maskable").removeClass("has-mask")})}}),define("utils/query-params",["jquery","underscore","utils/ready"],function(e,t,n){function i(e){if(!e)return{};for(var t={},n=0;n<e.length;++n){var i=e[n].split("=");2===i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return t}function r(e,n){t.isNull(e)||t.isUndefined(e)||-1!==a.indexOf(n)?delete s[n]:s[n]=e}function o(){}var s={},a=[];return n(function(){var e=i(window.location.search.substr(1).split("&"));s={},t.each(e,r)}),o.prototype.update=function(){var e=Array.prototype.slice.apply(arguments);return 1===e.length?t.each(e[0],r):2===e.length&&r(e[1],e[0]),this},o.prototype.get=function(){var e=Array.prototype.slice.apply(arguments);return 1===e.length?t.has(s,e[0])?s[e[0]]:null:s},o.prototype.ignore=function(e){return e&&(delete s[e],a.push(e)),this},o.prototype.asUrl=function(n){var i=n.match(/([^#]*)(#.*)?/),r=i[1],o=i[2];return r=r.match(/([^?]*)\??/)[1],"{url}{query}{hash}".format({url:r,query:t.keys(s).length?"?"+e.param(s):"",hash:o})},new o}),define("components/filter/status",["jquery","utils/query-params","jquery-plugins/jquery.pjax"],function(e,t){return function(n){var i=n.$container,r=n.$pjaxContainer,o=n.filterTerm||i.find(".filter-status").attr("data-filter-term"),s=e.extend({},{timeout:3e4},n.pjaxOptions);r.on("pjax:send",function(){r.find(".maskable").addClass("has-mask")}),r.on("pjax:complete",function(){r.find(".maskable").removeClass("has-mask")}),r.on("pjax:end",function(){var t=r.find("[data-current-status]").attr("data-current-status");i.find(".filter-status li").removeAttr("aria-pressed"),t&&e("[data-status={}]".format(t)).parent("li").attr("aria-pressed","true")}),t.ignore(n.ignoreQuery),e.support.pjax&&i.on("click",".filter-status a",function(n){var i=e(this),a=i.attr("data-status"),l=i.attr("href");e.pjax.click(n,e.extend({},s,{container:r,url:t.update(o,a).asUrl(l)}))})}}),define("components/filter/search",["jquery","utils/query-params","jquery-plugins/jquery.pjax"],function(e,t){return function(n){var i,r=n.$pjaxContainer,o=n.$controls,s=o.find('input[type="search"]'),a=e.extend({},{timeout:3e4},n.pjaxOptions),l=s.val();s.on("input",function(t){clearTimeout(i);var n=e(this),r=n.val();if(13!=t.keyCode&&r!=e("#corrected-search").attr("data-value")&&r!==l){l=r;var o=n.closest("form");i=setTimeout(function(){o.submit()},300)}}),r.on("pjax:start",function(){r.find(".maskable").addClass("has-mask")}).on("pjax:end",function(){r.find(".maskable").removeClass("has-mask"),s.focus()}),t.ignore(n.ignoreQuery),o.on("submit",function(n){n.preventDefault();var i=e(this),o=i.attr("data-url"),s=i.find("input").val(),l=i.attr("data-search-term");e.pjax(e.extend({},a||{},{container:r,url:t.update(l,s).asUrl(o)}))})}}),define("account-admin/groups/filter",["jquery","aui","on-ready","components/paginate","components/filter/status","components/filter/search","utils/query-params"],function(e,t,n,i,r,o,s){return n(function(){function t(t,n){return function(){var i=window.location.href,r=window.location.search.length,o=i.slice(0,-r),a={};a[t]=n,o=o+"?"+e.param(a),s.update({repositories:null,members:null}).update(t,n),e.support.pjax?window.history.replaceState({},"",o):window.location.replace(o)}}var n=e("#group-repositories"),a=e("#repositories-pane"),l=e("#group-members"),u=e("#members-pane"),c=a.find(".maskable").data("page"),d=u.find("#add-member-form").data("page"),h={timeout:3e4,scrollTo:!1};i(u,e.extend({$pjaxContainer:l},h)),i(a,e.extend({$pjaxContainer:n},h)),a.on("pjax:beforeReplace",function(t,n){c=e(n[1]).closest("[data-page]").data("page")}),u.on("pjax:beforeReplace",function(t,n){d=e(n[1]).closest("[data-page]").data("page")}),e("#repositories-tab").on("tabSelect",t("repositories",c)),e("#members-tab").on("tabSelect",t("members",d)),r({$container:a,$pjaxContainer:n,filterTerm:a.find(".filter-status").attr("data-filter-term"),ignoreQuery:"repositories",pjaxOptions:h}),o({$pjaxContainer:n,$controls:e("#repo-filter"),ignoreQuery:"repositories",pjaxOptions:h})})}),define("utils/forms",["jquery"],function(e){function t(t){var n=t.find(".aui-message.error");return n.length||(n=e("<div>").addClass("aui-message error").append(e("<p>").addClass("title").append(e("<span>").addClass("aui-icon aui-icon-error"),e("<span>").addClass("error-message"))).prependTo(t)),n}function n(t,n){var i=t.find('[name="{}"]'.format(n)),r=i.next(".error");return r.length||(r=e("<div>").addClass("error").insertAfter(i)),r}function i(e,i){var r=JSON.parse(i.responseText),o=r.error.message,s=r.error.fields;if(s)for(var a in s)n(e,a).removeClass("hidden").text(s[a]);t(e).removeClass("hidden").find(".error-message").text(o)}return{markApiErrors:i}}),define("account-admin/groups/edit-group",["jquery","aui","js/components/aui-dialog","utils/forms","utils/loading","utils/mustache"],function(e,t,n,i,r,o){function s(t,n){var r=t.getCurrentPanel().body.find("form"),o=r.serializeArray().reduce(function(e,t){return e[t.name]=t.value,e},{}),s=r.find("#group-emails"),a=t.getPage(0).button[0].item;o[s.attr("name")]=!s.is(":checked"),a.loading(e.ajax(e.extend(n(r),{data:JSON.stringify(o),contentType:"application/json"}))).done(function(e){window.location=e.links.web.href}).fail(function(e){i.markApiErrors(r,e)})}function a(e){e.beforeDialogShow=e.beforeDialogShow||function(e){e.find(".error").addClass("hidden").find(".error-message").text("")};var t=new n({width:600,height:"auto",id:e.id,closeOnOutsideClick:!0});t.addHeader(e.header).addPanel("main",o.toHtml("add-group-form-template",{})).addButton(e.saveText||gettext("Save"),function(t){s(t,e.saveOptions)}).addCancel(gettext("Cancel"),function(e){e.hide()});var i=t.getCurrentPanel().body,r=i.find("select"),a=i.find("#group-access"),l=i.find(".group-notifications");return r.auiSelect2({minimumResultsForSearch:-1,dropdownAutoWidth:!0}),a.on("change",function(e){e.val&&l.toggleClass("hidden","admin"!==e.val)}),e.$trigger.on("click",function(n){n.preventDefault(),e.beforeDialogShow(i),t.show()}),t}return a}),define("utils/event-push",["store","underscore"],function(e,t){return function(n,i){var r=e.get("events")||[];r.push({verb:n,data:t.extend(i,{published:Date.now()})}),e.set("events",r)}}),define("account-admin/groups/add-member",["jquery","aui","js/components/aui-dialog","utils/event-push","utils/mustache","utils/loading"],function(e,t,n,i,r){function o(t,n){if(402===t.status){var o=e.parseJSON(t.responseText).data;o.messageType="warning",o.owner=!0;var s=e(r.toHtml("over-limit-template",o)),a=s.find(".upgrade-button");s.insertAfter(n),n.addClass("hidden"),a.on("mousedown",function(){i("upgrade_dialog_button_clicked",{user:o.user.username})}).on("click",function(t){t.preventDefault();var n=a.loading(e.ajax({type:"POST",url:a.attr("data-upgrade-url"),dataType:"json"}));n.done(function(e){e.href&&(window.location.href=e.href)})})}else{var l=JSON.parse(t.responseText),u=l.error;n.removeClass("hidden").find(".error-message").text(u)}}function s(t,n){var i=t.getCurrentPanel().body.find("form"),r=i.serialize(),s=t.getPage(0).button[0].item,a=i.find(".error"),l=i.find(".warning");a.addClass("hidden").find(".error-message").text(""),l.addClass("hidden").find(".warning-message").text(""),s.loading(e.ajax({url:i.attr("action"),type:"POST",data:r})).done(function(e){t.hide(),n(e.groups)}).fail(function(e){o(e,a)})}function a(t){var i=new n({width:600,height:"auto",id:"group-add-member-dialog",closeOnOutsideClick:!0});i.addHeader(gettext("Add team member")).addPanel("main",r.toHtml("add-group-member-template",{})).addButton(gettext("Add"),function(e){s(e,t.memberAdded)}).addCancel(gettext("Cancel"),function(e){e.hide()});var o=i.getCurrentPanel().body,a=e("#group-add-member"),l=e("#group-selection");return l.auiSelect2({dropdownAutoWidth:!0}),t.$trigger.on("click",function(e){e.preventDefault(),o.find(".error").addClass("hidden").find(".error-message").text(""),i.show(),a.val(""),l.auiSelect2("val","")}),i}return a}),define("account-admin/groups/group-list",["jquery","aui","account-admin/groups/edit-group","account-admin/groups/add-member","utils/mustache","on-ready","utils/loading"],function(e,t,n,i,r,o){return o(function(){n({$trigger:e("#add-group-button"),id:"add-group-dialog",header:gettext("Add group"),saveText:gettext("Add"),saveOptions:function(e){return{url:e.attr("action"),type:"POST"}}});var r=e("#groups"),o=e("#group-errors"),s=r.find("tbody"),a=r.attr("data-remove-group-url");s.on("click",".remove-group",function(n){n.preventDefault();var i=e(this),r=i.parents("tr"),s=r.attr("data-group");i.loading(e.ajax({url:a.format(s),type:"DELETE"})).done(function(){r.remove()}).fail(function(e){t.messages.error(o,{title:JSON.parse(e.responseText).error.message,closeable:!1})})}),i({$trigger:e("#add-member-button"),memberAdded:function(e){e.forEach(function(e){var t=s.find("[data-group="+e+"] .member-count"),n=parseInt(t.text(),10);t.text(n+1)})}})})}),define("account-admin/groups/target-user",["jquery"],function(e){return e("#groups").attr("data-target-user")}),define("components/alert-dialog",["jquery","components/modal-dialog"],function(e,t){var n={title:"Error"};return function(i){var r,o=e.Deferred();return r="string"==typeof i?{content:i}:i,t(e.extend(n,r),o).show(),o.promise()}}),define("account-admin/groups/group-account-privilege-view",["backbone","underscore","account-admin/groups/target-user","components/alert-dialog","data/current-user","utils/mustache"],function(e,t,n,i,r,o){return e.View.extend({className:"group-account-privileges",initialize:function(){this.model.on("change",this.render,this)},events:{"change input":"update"},errors:{403:gettext("You no longer have account admin access.")},render:function(){if(this.$el.children().length)switch(this.model.get("privilege")){case"admin":this.$admin.prop({checked:!0}),this.$collaborator.prop({checked:!0,disabled:!0});break;case"collaborator":this.$admin.prop({checked:!1}),this.$collaborator.prop({checked:!0,disabled:!1});break;default:this.$admin.prop({checked:!1}),this.$collaborator.prop({checked:!1,disabled:!1})}else this.$el.html(o.toHtml("team-privileges-template",this.model.toJSON())),this.$admin=this.$("input[name=admin]"),this.$collaborator=this.$("input[name=collaborator]");return this},update:function(){var e;return e=this.$admin.prop("checked")?"admin":this.$collaborator.prop("checked")?"collaborator":null,"admin"===this.model.get("privilege")&&"admin"!==e&&r.username!==n&&this.model.get("group").isLastAccountAdminGroup(r.username)?(i({title:gettext("Can't revoke admin access"),content:gettext("You cannot revoke your own account admin access.")}),void this.render()):void this.model.save({privilege:e},{wait:!0,error:t.bind(this.error,this,this.model.previousAttributes())})},error:function(e,t,n){i(this.errors[n.status]||gettext("An unexpected error occurred.")),t.set(e)}})}),define("account-admin/groups/group-forward-emails-view",["backbone","underscore","utils/mustache","components/alert-dialog"],function(e,t,n,i){return e.View.extend({initialize:function(){this.model.privilege.on("change",this.toggleForwardEmails,this)},events:{"change input":"updateForwardEmails"},render:function(){var e=this.model.toJSON();return e.admin="admin"===this.model.privilege.get("privilege"),this.$el.html(n.toHtml("forward-emails-template",e)),this},updateForwardEmails:function(){this.model.save({email_forwarding_disabled:!this.$el.find("input").is(":checked")},{wait:!0,error:t.bind(this.error,this,this.model.previousAttributes())})},toggleForwardEmails:function(){var e="admin"===this.model.privilege.get("privilege");this.$el.find(".forward-emails").toggleClass("hidden",!e)},error:function(e,t,n){i(this.errors[n.status]||gettext("An unexpected error occurred.")),t.set(e)}})}),define("data/no-avatar-image",["jquery"],function(e){var t=e(document.body).attr("data-no-avatar-image");return t}),define("components/groups/index",["bitbucket","backbone","utils/api-helper","data/no-avatar-image"],function(e,t,n,i){var r={},o=r.GroupMember=t.Model.extend({idAttribute:"username",group_:null,group:function(){return this.group_},setGroup:function(e){return this.group_=e,this},url:function(){var e,i=this.group();return i?e=i.isMine()?n.toString("groups",i.owner().get("username"),i.get("slug"),"members",this.get("username")):n.toString("group-privileges",i.get("targetUser").username,i.owner().get("username"),i.get("slug"),{"private":!0}):(e=t.Model.prototype.url.call(this),this.isNew()&&(e+=this.get("username"))),e},displayName:function(){return this.get("display_name")},avatarUrl:function(){return this.get("avatar")||i},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e.displayName=this.displayName(),e.avatarUrl=this.avatarUrl(),e}}),s=r.GroupMembers=t.Collection.extend({model:o,group_:null,group:function(){return this.group_},setGroup:function(e){this.group_=e,this.invoke("setGroup",e)},comparator:function(e){return e.displayName().toLowerCase()},url:function(){var e=n.concat("groups",this.group().get("owner").username);return e.toString(this.group().get("slug"),"members")}}),a=r.Repository=t.Model.extend({displayName:function(){return this.get("owner").username+"/"+this.get("slug")}}),l=(r.Repositories=t.Collection.extend({model:a}),r.Group=t.Model.extend({idAttribute:"slug",groupMembers_:null,owner_:null,repositories_:null,initialize:function(e){this.parseOwner_(e),this.parseGroupMembers_(e),this.get("owner").is_team&&(this.privilege=new u({group:this,privilege:null}))},parse:function(e){return this.parseGroupMembers_(e),e},parseGroupMembers_:function(e){e.members&&(null===this.groupMembers()&&this.setGroupMembers(new s),this.groupMembers().reset(e.members),delete e.members)},parseOwner_:function(e){this.setOwner(new o(e.owner))},groupMembers:function(){return this.groupMembers_},setGroupMembers:function(e){return this.groupMembers_=e,this.groupMembers_.setGroup(this),this},owner:function(){return this.owner_},setOwner:function(e){return this.owner_=e,this},repositories:function(){return this.repositories_},setRepositories:function(e){return this.repositories_=e,this},displayName:function(){return"{}:{}".format(this.owner().get("username"),this.get("slug"))},isMine:function(){return function(){return this.owner().get("username")===this.get("targetUser").username}}(),toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return this.groupMembers()&&(e.members=this.groupMembers().toJSON()),e.auto_add?e[e.permission]=!0:e.no=!0,e},isLastAccountAdminGroup:function(e){var t=this.collection.accountAdminGroups(e);return 1===t.length&&_.indexOf(t,this)>=0}}));r.Groups=t.Collection.extend({idAttribute:"slug",model:l,initialize:function(e,t){this.targetUser=t.targetUser},url:function(){return n.concat("groups",this.targetUser).toString()},comparator:function(e){return e.displayName().toLowerCase()},accountAdminGroups:function(e){var t=this.filter(function(e){return"admin"===e.privilege.get("privilege")&&e.groupMembers().length});return e?_.filter(t,function(t){return 1===t.groupMembers().filter(function(t){return t.get("username")===e}).length}):t}});var u=(r.Message=t.Model.extend({defaults:{title:null}}),r.GroupAccountPrivilege=t.Model.extend({toJSON:function(){var e={privilege:this.get("privilege")};return e[e.privilege]=!0,e},parse:function(e){return{privilege:e?_.values(e)[0]:null}},url:function(){var e=this.get("group"),t=e.get("owner").username,i=e.get("slug");return n.toString("users",t,"privileges",t,i)},sync:function(e,n,i){"read"!==e&&(e=n.get("privilege")?"update":"delete");var r=i.error;return i.error=function(e,t){return 404===e.status?i.success(null,t,e):void r(e)},t.sync.call(this,e,n,i)}}));return r}),define("account-admin/groups/group-member-view",["backbone","components/alert-dialog","components/groups/index","data/current-user","utils/mustache"],function(e,t,n,i,r){return e.View.extend({model:n.GroupMember,tagName:"tr",className:"group-member",errors_:{401:gettext("You must be logged in to remove a member."),403:gettext("You are not authorized to remove this member.")},events:{'click a[href="#delete"]':"removeMember"},removeMember:function(e){e.preventDefault();
var n=this.model.collection.group();if(this.model.get("username")===i.username){if(n.get("owner").is_team&&n.isLastAccountAdminGroup(i.username))return void t({title:gettext("Can't revoke admin access"),content:gettext("You cannot revoke your own account admin access.")})}else if(1==this.model.collection.length&&n.get("owner").is_team&&n.isLastAccountAdminGroup())return void t(gettext("You cannot remove the last administrator of this account."));this.toggleSpinner(),this.model.destroy({error:this.removeMemberError.bind(this),wait:!0})},render:function(){return this.$el.html(r.toHtml("group-member-template",this.model.toJSON())),this},remove:function(){this.$el.slideUp(function(){this.$el.remove()}.bind(this)),this.toggleSpinner()},removeMemberError:function(e,t){this.toggleSpinner();var n=this.errors_[t.status],i=this.$el.closest(".group-members").find(".error-bar");AJS.messages.error(i,{body:n||gettext("There was a problem processing your request.")})},toggleSpinner:function(){this.$('a[href="#delete"]').toggleClass("loading")}})}),define("utils/dialog-positions",["aui","jquery"],function(e){function t(t){return function(n,i,r,o){var s=e.InlineDialog.opts.calculatePositions(n,i,r,o),a=i.target,l=a.offset(),u=n.outerWidth(),c=a.outerWidth(),d=l.left+c/2;return s.popupCss.right="auto",s.popupCss.left=t(a,l,u,c,o),s.arrowCss.right="auto",s.arrowCss.left=d-s.popupCss.left-8,s}}var n=34;return{alignCenter:function(){return t(function(e,t,n,i,r){return t.left+i/2-n/2+r.offsetX})},alignRight:function(){return t(function(e,t,n,i,r){return t.left+i-n+r.offsetX})},alignLeft:function(){return t(function(e,t,n,i,r){return t.left+r.offsetX})},alignTo:function(e){return t(e)},sidebarOffsetY:function(e,t){var i=t.target.height()/2,r=e.height()/2;return r-i-n},sidebarArrowOffsetY:function(e,t){var i=t.target.height()/2,r=e.height()/2;return-r+i+n},replaceExisting:function(t,n,i,r){var o,s,a=e.InlineDialog.opts.calculatePositions(t,n,i,r),l=n.target.closest(".aui-inline-dialog");return l.length&&(s=l.offset(),a.popupCss.left=s.left,a.popupCss.top=s.top,o=l.find(".aui-inline-dialog-arrow"),o.length&&(a.arrowCss.top=o.offset().top-a.popupCss.top)),a}}}),define("components/upgrade-dialog",["aui","jquery","on-ready","utils/dialog-positions","utils/event-push","utils/gaq-push","utils/mustache"],function(e,t,n,i,r,o,s){return function(n,a){function l(e,n,i){e.html(s.toHtml("upgrade-dialog-template",c));var o=e.find(".upgrade-button");o.on("mousedown",function(){r("upgrade_dialog_button_clicked",{user:c.user.username})}),o.on("click",function(e){e.preventDefault();var n=o.loading(t.ajax({type:"POST",url:o.attr("data-upgrade-url"),dataType:"json"}));n.done(function(e){e.href&&(window.location.href=e.href)})}),i&&i()}a=a||{};var u,c=a.data||{};u=e.InlineDialog(n,"upgrade-dialog",l,{closeOthers:!1,hideCallback:function(){t(u).remove()},initCallback:function(){},cacheContent:!1,hideDelay:null,noBind:!0,calculatePositions:a.calculatePositions||i.alignRight()}),u.show(),o(["atl._trackEvent","Account","Upgrade Dialog","Shown"]),t(u).on("click","a",function(){o(["atl._trackEvent","Account","Upgrade Dialog","Clicked"])}),r("upgrade_dialog_shown",{user:c.user.username})}}),define("utils/backbone-ui-helper",["backbone","jquery"],function(e){var t={};return t.CollectionView=e.View.extend({view:null,views_:null,initialize:function(e){e.view&&(this.view=e.view),this.init_(),this.collection.on("add",this.add_,this),this.collection.on("remove",this.remove_,this),this.collection.on("reset",this.refresh_,this)},init_:function(){var e=this;this.views_={},this.collection.each(function(t){var n=e.views_[t.cid]=new e.view({model:t});t.on("change",n.render,n)})},add_:function(e){var t=this.views_[e.cid]=new this.view({model:e});this.collection.comparator?this.render():this.$el.append(t.render().el)},remove_:function(e){var t=this.views_[e.cid];t&&(t.remove(),delete this.views_[e.cid])},refresh_:function(){this.init_(),this.render()},render:function(){var e=this,t=this.$el;return t.children().detach(),this.collection.each(function(n){t.append(e.views_[n.cid].render().el)}),this}}),t}),define("utils/valid",[],function(){return{email:function(e){return/^[^@\s]+@[^.@\s]+(\.[^.@\s]+)+$/.test(e)},url:function(e){return/^[^.@\s]+(\.[^.@\s]+)+$/.test(e)}}}),define("account-admin/groups/group-members-view",["backbone","underscore","account-admin/groups/group-member-view","components/upgrade-dialog","utils/backbone-ui-helper","utils/mustache","utils/valid","data/current-user"],function(e,t,n,i,r,o,s,a){return e.View.extend({className:"group-members",errors_:{404:gettext("The requested user does not exist."),409:gettext("The user is already in the group."),402:gettext("You are already at your plan limit and must upgrade before adding more users.")},events:{"submit form":"addMember"},collectionView_:null,initialize:function(){this.collectionView_=new r.CollectionView({collection:this.collection,view:n,tagName:"tbody"})},addMember:function(e){e.preventDefault();var n=this.$("input.username"),i=n.val().trim();return i?(this.toggleSpinner(),void this.collection.create({username:i},{wait:!0,success:t.bind(this.addMemberSuccess,this),error:t.bind(this.addMemberError,this)})):void n.focus()},addMemberSuccess:function(){this.toggleSpinner(),this.clearError(),this.$("input.username").val("").blur().focus()},clearError:function(){this.$el.find(".error-bar .aui-message").closeMessage()},addMemberError:function(e,t){if(this.clearError(),404===t.status&&s.email(e.get("username")))this.addMemberSuccess(),this.$el.trigger("bb:groups:invite",[e.get("username")]);else{if(this.toggleSpinner(),this.$("input.username").blur().focus(),402===t.status){var n=$.parseJSON(t.responseText).data;n.extra_users=n.users_required-n.plan_users,n.owner=a.username===n.user.username,i(this.$("button.add-button"),{data:n})}AJS.messages.error(this.$el.find(".error-bar"),{body:this.errors_[t.status]||t.responseText})}},toggleSpinner:function(){this.$("input.username").toggleClass("loading")},render:function(){return this.collectionView_.el.parentNode?this.collectionView_.render():this.$el.html(o.toHtml("group-members-template",this.collectionView_.collection.group().toJSON())).find("table.widget.users thead").after(this.collectionView_.render().el),this}})}),define("components/form-dialog",["jquery","aui","js/components/aui-dialog","utils/mustache"],function(e,t,n,i){e(document).on("keydown",".aui-dialog .button-panel-button, .aui-dialog .button-panel-link",function(t){13===t.keyCode&&e(this).click()});var r=function(t,n){n=n||{},"function"==typeof n&&(n={onUpdateContents:n}),this.useLiveEvents=!!n.useLiveEvents,this.useLiveEvents?this.trigger=t:this.$trigger_=e(t),this.onUpdateContents_=n.onUpdateContents,this.template_=n.template,this.templateData_=n.templateData,this.boundClick_=null,this.timeout_=null,this.success=n.success,this.complete=n.complete,this.error=n.error,this.onSubmit=n.submit,this.isStaticContent=!!n.isStaticContent,this.dataType=n.dataType,this.width=n.width||600,this.height=n.height||"auto",this.urlAttr=n.urlAttr||"href",this.id=this.useLiveEvents?n.id:n.id||this.$trigger_.attr("id")};return r.prototype=function(){var o=r.prototype;return o.bind=function(){if(this.boundClick_=this.open.bind(this),this.useLiveEvents){var t=e("body");t.off("click.disabled",this.trigger),t.on("click.formdialog",this.trigger,this.boundClick_)}else this.$trigger_.unbind("click.disabled").click(this.boundClick_);return this},o.unbind=function(){return this.boundClick_&&(this.useLiveEvents?e("body").off("click.formdialog",this.trigger,this.boundClick_):this.$trigger_.unbind("click",this.boundClick_),this.boundClick_=null),this},o.disable=function(){this.unbind();var t=function(e){e.preventDefault()};this.useLiveEvents?e("body").on("click.disabled",this.trigger,t()):this.$trigger_.bind("click.disabled",t)},o.open=function(t){var r;if(t.preventDefault(),this.useLiveEvents){if(e(this.trigger).attr("aria-disabled"))return}else if(this.$trigger_.attr("aria-disabled"))return;if(this.$dialog_||(this.$dialog_=new n({width:this.width,height:this.height,id:"bb-"+this.id+"-dialog"}),this.$dialog_.addPanel("main"),this.$element_=this.$dialog_.popup.element,this.$errorContainer_=this.$element_.find(".error-container")),this.$dialog_.initialized&&this.isStaticContent)this.$dialog_.show();else{var o=this.useLiveEvents?e(t.target):this.$trigger_;if(o.addClass("loading"),this.template_)r="function"==typeof this.templateData_?this.templateData_():this.templateData_,this.open_(i.toHtml(this.template_,r||{}),o);else{var s={type:"get",url:o.attr(this.urlAttr),success:this.open_.bind(this)};this.dataType&&(s.dataType=this.dataType),e.ajax(s)}}this.clearErrors()},o.open_=function(e,t){"string"==typeof e&&(e={html:e}),this.useLiveEvents?t.removeClass("loading"):this.$trigger_.removeClass("loading"),e.redirect?window.location=e.redirect:(this.updateContents(e.html,t),this.$dialog_.initialized=!0,this.$dialog_.show())},o.updateContents=function(e,t){this.$dialog_.getCurrentPanel().html(e),this.$form_=this.$element_.find("form"),this.$form_.find(".submit").hide(),this.$originalSubmit_=this.$form_.find("input[type=submit]"),this.$form_.find("input").keypress(this.submitOnEnter.bind(this)),this.$element_.find(".dialog-button-panel").empty(),this.$dialog_.addHeader(this.$form_.attr("title")||this.$form_.attr("data-title")).addButton(this.$originalSubmit_.attr("value")||"Submit",this.submit.bind(this),"aui-button aui-style").addCancel("Cancel",function(e){e.hide()});var n=this.$originalSubmit_.attr("value");this.$submit_=this.$element_.find(".dialog-button-panel").find('button:contains("'+n+'")'),this.$errorContainer_=this.$element_.find(".error-container"),this.onUpdateContents_&&this.onUpdateContents_(this.$dialog_,t)},o.submitOnEnter=function(e){"keypress"===e.type&&13===e.keyCode&&(e.preventDefault(),this.submit())},o.submit=function(){var t=this.$submit_;this.clearErrors(),this.timeout_=setTimeout(function(){t.addClass("loading")},300),t.attr("aria-disabled",!0).addClass("disabled"),this.onSubmit?this.onSubmit(this.$form_):e.ajax({type:this.$form_.attr("method")||"POST",url:this.$form_.attr("action"),data:this.$form_.serialize(),success:this.submit_.bind(this),error:this.error_.bind(this)})},o.complete_=function(){clearTimeout(this.timeout_),this.$dialog_.enable(),this.$submit_.attr("aria-disabled",!1).removeClass("loading disabled")},o.submit_=function(e){"string"==typeof e&&(e={html:e}),e.success?e.redirect?window.location=e.redirect:this.success&&(this.success(this.$element,e),this.complete?this.complete():this.complete_()):e.html?(this.updateContents(e.html),this.complete?this.complete():this.complete_()):this.success&&(this.success(this.$element,e),this.complete?this.complete():this.complete_())},o.error_=function(e){this.error&&this.error(this.$element,e),this.complete_()},o.close=function(){this.$dialog_.hide()},o.remove=function(){this.$dialog_&&this.$dialog_.remove()},o.displayError=function(e){this.clearErrors(),t.messages.error(this.$errorContainer_,e)},o.clearErrors=function(){this.$errorContainer_.empty()},o}(),r}),define("account-admin/groups/group-view",["backbone","jquery","account-admin/groups/group-account-privilege-view","account-admin/groups/group-forward-emails-view","account-admin/groups/group-members-view","account-admin/groups/target-user","components/form-dialog","components/alert-dialog","components/confirm-dialog","data/current-user","utils/mustache"],function(e,t,n,i,r,o,s,a,l,u,c){return e.View.extend({tagName:"li",className:"group-view",membersView_:null,privilegeView_:null,forwardEmailView_:null,events:{"click .delete-group":"deleteGroup","change .access":"updatePermission"},initialize:function(){this.membersView_=new r({collection:this.model.groupMembers()}),this.privilegeView_=this.model.privilege?new n({model:this.model.privilege}):null,this.forwardEmailView_=this.model.privilege?new i({model:this.model}):null,this.model.view=this},errors_:{400:gettext("A group with that name already exists."),404:gettext("This group no longer exists.")},deleteGroup:function(e){if(e.preventDefault(),!this.$el.hasClass("waiting")){if(this.model.get("owner").is_team&&u.username!==o&&this.model.isLastAccountAdminGroup(u.username))return void a({title:gettext("Can't revoke admin access"),content:gettext("You cannot revoke your own account admin access.")});if(this.model.get("owner").is_team&&u.username===o&&this.model.isLastAccountAdminGroup())return void a(gettext("You cannot remove the last administrator of this account."));var t=gettext("Are you sure you want to delete the group %(group_name)s?");l({title:gettext("Delete group?"),content:interpolate(t,{group_name:this.model.displayName()},!0)}).done(function(){this.dialog.unbind().remove(),this.model.destroy({wait:!0,error:this.groupError.bind(this)})}.bind(this))}},select:function(e,t){var n=t.auto_add?t.permission:"no",i=this.$(".access ."+n);i.addClass("selected").siblings().removeClass("selected")},groupError:function(e,n){var i=t(n.responseText).find(".errorlist:last li").text();i=i||this.errors_[n.status],a(i||gettext("There was a problem processing your request."))},updatePermission:function(e){var n,i=this.$el.closest("li"),r=t(e.target);if(!r.is(":disabled")){n=setTimeout(function(){i.addClass("loading")},300),r.addClass("waiting").prop({disabled:!0,"aria-disabled":!0});var o=this.model.attributes,s="{owner.username}/{slug}".format(o),a=r.val();"no"===a&&(a=null);var u=function(){r.auiSelect2("val",o.permission||"no")},c=function(e){e?this.model.save({auto_add:!!a,permission:a},{wait:!0,success:this.select.bind(this),error:function(){this.groupError.apply(this,arguments),u()}.bind(this)}):u()}.bind(this),d=function(e){if(clearTimeout(n),i.removeClass("loading"),r.removeClass("waiting").prop({disabled:!1,"aria-disabled":!1}),0===e)c(!0);else{var t=gettext("This will update the group's permissions on %(affected_repos)s of your repositories.");l({title:gettext("Apply permissions to existing repositories?"),content:interpolate(t,{affected_repos:e},!0)}).done(function(){c(!0)}).fail(function(){c(!1)})}}.bind(this);t.ajax({url:"/account/xhr/affected_repositories/{}".format(s),dataType:"json"}).done(function(e){d(e.repo_count)})}},remove:function(){var e=this.$el.slideUp(function(){t("#no-groups").toggle(!e.siblings().length),e.remove()})},editGroupError:function(e,t){var n,i=e.find("div.error");n=t.status?this.errors_[t.status]||gettext("There was a problem processing your request."):t,i.removeClass("hidden"),i.find(".message").text(n)},editGroup:function(e){var t=this.model.get("name"),n=e.find(".group-name-input").val(),i=this.dialog;return n===t?void i.close():n?void this.model.save({name:n},{wait:!0,success:function(){i.unbind().remove()}.bind(this),error:function(t,n){this.editGroupError(e,n)}.bind(this)}):void this.editGroupError(e,gettext("Name is required."))},render:function(){var e=this.$el;return e.attr("id","group:"+this.model.get("slug")).addClass("group-cid-{}".format(this.model.cid)),this.privilegeView_&&(this.privilegeView_.$el.detach(),this.forwardEmailView_.$el.detach()),this.membersView_.$el.detach(),e.html(c.toHtml("group-template",this.model.toJSON())),this.privilegeView_&&(e.find("header").append(this.privilegeView_.render().el),this.privilegeView_.$(".checkbox.admin").after(this.forwardEmailView_.render().el)),e.append(this.membersView_.render().el),e.data("identifier","{owner.username}/{slug}".format(this.model.attributes)),e.find("select").auiSelect2({minimumResultsForSearch:-1}),this.dialog&&this.model.get("slug")==this.dialog.slug?this:(this.dialog=new s("#groups .group-cid-{} .edit-group".format(this.model.cid),{id:"edit-group-"+this.model.get("slug"),useLiveEvents:!0,template:"group-form-template",templateData:{isNew:!1,slug:this.model.get("slug")},submit:this.editGroup.bind(this),onUpdateContents:function(e){var t=e.popup.element.find("form"),n=this.model.get("name");t.find(".group-name-input").val(n)}.bind(this)}).bind(),this.dialog.slug=this.model.get("slug"),this)}})}),define("utils/delegate",[],function(){return function(e,t,n){return $(function(i){i(document.body).on(t,e,n)}),function(){$(document.body).off(t,e,n)}}}),define("account-admin/groups/groups-admin-view",["backbone","bitbucket","jquery","underscore","on-ready","account-admin/groups/group-view","account-admin/groups/target-user","components/form-dialog","components/groups/index","data/current-user","utils/backbone-ui-helper","utils/delay","utils/delegate","utils/gaq-push","utils/mustache"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p,f){return e.View.extend({className:"groups-admin",errors_:{400:gettext("A group with that name already exists."),401:gettext("You are not authorized to add a new group."),404:gettext("You user account no longer exists or has been moved.")},groupsView_:null,initialize:function(e){this.isTeam=!!e.isTeam,this.groupsView_=new c.CollectionView({collection:this.collection,view:o,tagName:"ol"});var r=t.user(s);r.invitations(function(e){var t={};i.each(e,function(e){i.each(e.groups,function(n){(t[n]||(t[n]=[])).push(e)})}),this.collection.each(function(e){var r=e.view.$("table.widget.invitations tbody");i.each(i.sortBy(t["{owner.username}/{slug}".format(e.attributes)],function(e){return e.email.toLowerCase()}),function(e){r.append(n(f.toHtml("group-invitation-template",e)))})})}.bind(this)),h("#groups-container > ol > li.group-view","bb:groups:invite",function(t,i){var o=n(this);r.invite(i,o.data("identifier"),function(){for(var e=o.find("table.widget.invitations"),t=e.children(".invitation"),r=0,s=t.length;s>r;r+=1){var a=n(t[r]);if(i.toLowerCase()<a.data("email").toLowerCase())return void a.before(n(f.toHtml("group-invitation-template",{email:i})))}e.append(n(f.toHtml("group-invitation-template",{email:i})))}),p(["atl._trackEvent","Share","Invite To Group - "+(e.isTeam?"Team":"Individual")])}),h('.invitation a[href="#delete"]',"click",function(e){e.preventDefault();var t=n(e.target).closest("tr");r.uninvite(t.data("email"),t.closest("li.group-view").data("identifier"),function(){t.remove()})}),h(".invitation .resend-invitation a","click",function(e){e.preventDefault();var t=n(e.target).closest("tr");r.invite(t.data("email"),t.closest("li.group-view").data("identifier"),function(){n(e.target).closest(".resend-invitation").fadeOut(200,function(){var e=gettext("Invitation sent");n(this).replaceWith('<span class="aui-lozenge aui-lozenge-success">{}</span>'.format(i.escape(e))).fadeIn(200)})})})},addGroup:function(e){this.dialog.$form_.find("div.error").addClass("hidden");var t=e.find(".group-name-input"),i=t.val().trim();if(!i)return t.focus(),void this.showError(gettext("You must provide a group name."));var r={name:i,owner:{username:s,is_team:this.isTeam}};this.collection.create(r,{wait:!0,success:function(e){window.location.hash="#group:"+e.get("slug"),t.val(""),this.dialog.close(),n("#no-groups").hide()}.bind(this),error:this.addGroupError.bind(this)})},addGroupError:function(e,t){this.showError(this.errors_[t.status]||gettext("There was a problem processing your request."))},showError:function(e){var t=this.dialog.$form_.find("div.error");t.removeClass("hidden"),t.find(".message").text(e)},render:function(){var e=this.groupsView_.render().$el;return n("#no-groups").toggle(!e.children().length),e.detach(),this.$el.empty().append(e),this.dialog=new a("#add-group",{id:"add-group",template:"group-form-template",templateData:{isNew:!0},submit:this.addGroup.bind(this)}).bind(),this}})}),define("account-admin/groups/index",["backbone","bitbucket","jquery","on-ready","account-admin/groups/groups-admin-view","account-admin/groups/target-user","components/form-dialog","components/groups/index","data/current-user","utils/backbone-ui-helper","utils/delay"],function(e,t,n,i,r,o,s,a,l,u,c){return i(function(){var e=n("#groups"),t=e.find("#groups-container"),i=t.data("account-privileges"),s=new a.Groups([],{targetUser:o});t.addClass("loading"),s.fetch({reset:!0,success:function(e){t.removeClass("loading"),e.each(function(e){var t=e.get("owner").username,n=e.get("slug");e.get("owner").is_team&&(e.privilege=new a.GroupAccountPrivilege({group:e,privilege:i["{}/{}".format(t,n)]||null}))}),new r({el:t,collection:e,isTeam:t.data("is-team")}).render();var o=n(location.hash.replace(/:/,"\\:"));o.length&&c(500,function(){var e=o.closest("li").offset().top-20;n(document.body).scrollTop(e)})}})})}),define("account-admin/groups/member-form",["jquery","aui","on-ready","components/upgrade-dialog","utils/loading","utils/mustache","utils/validation/regexes"],function(e,t,n,i,r,o,s){return n(function(n){function r(t){return e.ajax({url:y,type:"POST",data:{username:t}})}function a(t){return e.ajax({url:b.format(t),type:"PUT"})}function l(e,t){return function(n){var i,r;if("user"===e?(i=n,i.avatar=n.links.avatar.href,r="group-member-template"):(i={email:t},r="group-invite-template"),"email"===e)g.append(o.toHtml(r,i));else{var s=g.find("[data-email]");s.length?s.before(o.toHtml(r,i)):g.append(o.toHtml(r,i))}v.val(""),g.find(".empty").addClass("hidden"),m.empty()}}function u(e){m.empty(),t.messages.error(m,{title:JSON.parse(e.responseText).error.message,closeable:!1})}function c(t){t.preventDefault();var n=e(this),i=n.closest("tr"),r=i.attr("data-username");n.loading(e.ajax({url:w.format(r),type:"DELETE"})).done(function(){h(i)}).fail(u)}function d(t){t.preventDefault();var n=e(this),i=n.closest("tr"),r=i.attr("data-email");n.loading(e.ajax({url:b.format(r),type:"DELETE"})).done(function(){h(i)})}function h(e){m.empty(),e.remove();var t=!!g.find(".iterable-item").length,n=g.find(".empty");n.toggleClass("hidden",t)}function p(n){n.preventDefault();var i=e(this),r=i.closest("tr"),o=r.attr("data-email");a(o).done(function(){t.messages.success({body:gettext("Your invitation has been re-sent"),fadeout:!0})})}var f=e("#add-member-form"),m=e("#member-error"),g=f.find("tbody"),v=e("#group-add-member"),y=f.attr("data-group-url"),b=f.attr("data-invite-url"),w=f.attr("data-remove-member-url");f.submit(function(t){t.preventDefault();var n=v.val();n.trim()&&r(n).done(l("user")).fail(function(t){if(404===t.status&&s.email.test(n))a(n).done(l("email",n)).fail(u);else if(402===t.status){var r=e.parseJSON(t.responseText).data;r.owner=!0,i(f.find(".add-button"),{data:r})}else u(t)})}),n.on("click",".remove-member",c).on("click",".remove-email",d).on("click","[href=#resend]",p)})}),define("account-admin/groups/view",["jquery","aui","on-ready","components/confirm-dialog","account-admin/groups/edit-group"],function(e,t,n,i,r){return n(function(){function n(e){e.find("#group-name").val(s.attr("data-name")),e.find(".error").addClass("hidden"),e.find("#group-access").find('option[value="{}"]'.format(s.attr("data-team-access"))).prop("selected",!0).change(),e.find("#default-access").find('option[value="{}"]'.format(s.attr("data-repo-access"))).prop("selected",!0).change(),e.find("#group-emails").prop("checked","True"!==s.attr("data-emails"))}function o(){a.loading(e.ajax({url:a.attr("data-url-delete"),type:"DELETE"})).done(function(){window.location.href=e("#group-heading").find("a").attr("href")}).fail(function(){t.messages.error({body:gettext("There was an error deleting this group")})})}var s=e("#group-data"),a=e("#delete-button");r({$trigger:e("#edit-button"),id:"edit-group-dialog",header:gettext("Edit group"),beforeDialogShow:n,saveOptions:function(e){return{url:e.attr("data-update-url"),type:"PUT"}}}),a.on("click",function(){i({content:gettext("Are you sure you want to delete this group?"),title:gettext("Delete group?"),buttonText:gettext("Delete")}).done(o)})})}),define("account-admin/import-ssh-keys",["aui","jquery","on-ready"],function(e,t,n){return n(function(n){n.on("click",function(){var i=n.data("import-url");n.addClass("loading"),t.ajax({url:i,dataType:"json"}).success(function(t){if(n.removeClass("loading"),t.length>0){var i=ngettext("%(key_count)d key imported from GitHub","%(key_count)d keys imported from GitHub",t.length);e.messages.success({body:interpolate(i,{key_count:t.length},!0),fadeout:!0}),setTimeout(function(){window.location.reload(!0)},500)}else e.messages.error({body:gettext("Import failed. Are your keys already associated with another Bitbucket account?")})})})})}),define("account-admin/index",["on-ready"],function(e){return e(function(){var e={"#custom-domain":"/account/cnames/","#email-addresses":"/account/email/","#plans-and-billing":"/account/plans-and-billing/","#ssh-keys":"/account/ssh-keys/"},t=e[window.location.hash];t&&window.location.replace(t)})}),define("account-admin/language-selector",["aui","jquery","on-ready","underscore","js/components/aui-dialog","utils/gaq-push"],function(e,t,n,i,r,o){return n(function(e){function n(){var e=d.data("languages");return i.indexOf(e,l.val())<0}function s(){!h&&e.data("banner-referrer")&&(o(["atl._trackEvent","i18n","Language field referrer","banner"]),h=!0)}var a=e.closest("form"),l=t("#id_language_code"),u=t("#translate-progress-content"),c=null,d=t("#help-translate-message");l.on("change",function(){d.is(":visible")?n(l.val())||d.slideUp():n(l.val())&&d.slideDown()});var h=!1;l.on("change",function(){s(),c=t.get(u.attr("data-stats-url"))}),d.on("click",".translate-link",s);var p=l.val();a.on("submit",function(){if(l.val()!==p){var e=p+" -> "+l.val();o(["atl._trackEvent","i18n","Save language change",e])}});var f=!1,m=new r({width:450,height:"auto",id:"translate-progress-dialog"});m.addPanel("main").addHeader("This translation is incomplete").addButton("Save settings",function(){f=!0,a.submit()},"aui-button aui-button-primary").addCancel("Cancel",function(e){e.hide()}),m.getCurrentPanel().body.append(u.show()),a.on("submit",function(e){var i=l.val();if(i!==p&&n(i)&&!f){e.preventDefault();var r=a.find("button[type=submit]"),o=setTimeout(function(){r.addClass("loading").attr("aria-disabled",!0).attr("disabled",!0)},400);c.done(function(e){clearTimeout(o),r.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");var n=e[i]||0;t("#translate-progress-content").find("span.language").text(l.find(":selected").text()).end().find("span.percent").text(n).end().find(".progress").css("width",n+"%"),m.show()})}}),e.on("click",".translate-link",function(e){var n=t(e.target).attr("data-type");o(["atl._trackEvent","i18n","Translate",n])})})}),define("account-admin/notifications",["backbone","jquery","on-ready","underscore","js/components/aui-dialog","utils/api-helper","components/confirm-dialog","utils/mustache"],function(e,t,n,i,r,o,s,a){function l(e,t){var n=l.dialog;return n?n.getCurrentPanel().html(t):(n=l.dialog=new r({width:800,height:550,id:"bb-manage-watched-items-dialog"}),n.addPanel("main",t),n.addLink("Close",function(e){e.hide()})),n.addHeader(e),c(t),n}function u(e){var n="manage-watched-items-content",i=t(e.target).closest("a"),r=t('<div class="maskable has-mask"></div>').attr("id",n),o=l(i.attr("title"),r),s=o.popup.element.find("#"+n);t.support.pjax&&(t(document).one("pjax:beforeSend","#"+n,function(){o.show()}).one("pjax:complete","#"+n,function(){s.removeClass("has-mask")}),t.pjax.click(e,{url:t(this).attr("href"),push:!1,container:s,timeout:3e4}))}function c(e){var n=t("#account-notifications");e.on("click","a.unwatch-all",function(i){e.addClass("has-mask"),i.preventDefault();{var r=t(i.target),o=r.attr("href"),s=e.find("#watched-items").attr("data-type");e.find("#watched-items").attr("data-name")}t.ajax({url:o,type:"DELETE",dataType:"json"}).done(function(){AJS.messages.info({body:m[s],fadeout:!0}),e.find("table tbody tr a.follow").each(function(){t(this).trigger("toggle-follow",{isNowFollowing:!1})}),n.trigger("watched-items:clear",{type:s})}).complete(function(){e.removeClass("has-mask")})});var i={pullrequest:"pullrequests",repo:"repositories",issue:"issues",snippet:"snippets"};e.on("follow:repo follow:pullrequest follow:issue follow:snippet","a.follow",function(e,r){var o=t(e.target).attr("data-type");r?n.trigger("watched-items:increment",{type:i[o]}):n.trigger("watched-items:decrement",{type:i[o]})})}var d={},h=d.EmailPreference=e.Model.extend({idAttribute:"key"}),p=d.EmailPreferences=e.Collection.extend({model:h,initialize:function(e,t){this.prefsApi=t.prefsApi},url:function(){return this.prefsApi.toString()},findByKey:function(e){return this.find(function(t){return t.attributes.key==e})}});d.ui={};var f=d.ui.EmailPreferencesView=e.View.extend({events:{"click input.checkbox":"updatePreferences","click #toggle-email":"toggleEmail"},togglePreference:function(e,t){var n=this.collection.findByKey(e);n?(t&&t(!1),n.destroy({success:function(){AJS.messages.success({body:gettext("Email preferences updated."),fadeout:!0})},error:function(e){AJS.messages.error({body:gettext("Email preferences failed to update.")}),this.collection.add(e),t&&t(!0)}.bind(this)})):(n=new h({key:e,value:!0}),this.collection.add(n),t&&t(!0),n.save({},{success:function(){AJS.messages.success({body:gettext("Email preferences updated."),fadeout:!0})},error:function(){AJS.messages.error({body:gettext("Email preferences failed to update.")}),this.collection.remove(n),t&&t(!1)}.bind(this)}))},updatePreferences:function(e){var n=t(e.target),i=t(e.target).attr("name");this.togglePreference(i,function(e){e?n.attr("checked","checked"):n.removeAttr("checked")})},toggleEmail:function(e){function n(e){var n=t(a.toHtml("toggle-email-template",{email_enabled:e}));i.toggleClass("disabled",!e),r.replaceWith(n)}e.preventDefault();var i=this.$el.find("form.email-notifications"),r=t("#toggle-email-container"),o=function(){this.togglePreference("enabled",n)}.bind(this);i.hasClass("disabled")?o(!0):s({title:"Okay, we'll be quiet",isSafeContent:!0,content:a.toHtml("disable-email-confirmation-template")}).done(o)}}),m={repositories:gettext("All repositories unwatched."),pullrequests:gettext("All pull requests unwatched."),issues:gettext("All issues unwatched."),snippets:gettext("All snippets unwatched.")};return n(function(){function e(e){return n.find(".type."+e+" .watched-count")}var n=t("#account-notifications"),r=n.find("form.email-notifications"),s={enabled:!r.hasClass("disabled"),mentions:r.find("#id_mentions").is(":checked"),direct_messages:r.find("#id_direct_messages").is(":checked"),access_changes:r.find("#id_access_changes").is(":checked"),bb_updates:r.find("#id_bb_updates").is(":checked")},a=[];i.map(s,function(e,t){e&&a.push(new h({key:t,value:e}))});var l=new p(a,{prefsApi:o.concat("user","emailpreferences",n.attr("data-target-user"))});new f({el:n[0],collection:l}),r.find("div.description").each(function(e,n){var i=t(n);i.tooltip({title:function(){return i.text()}})}),n.find("a.manage-watched-items").on("click",u),n.bind("watched-items:clear",function(t,i){var r=i.type;e(r).text("0"),n.find(".type."+r+" + .actions a").hide()}),n.bind("watched-items:increment",function(t,i){var r=i.type,o=e(r),s=parseInt(o.text());o.text(++s),s&&n.find(".type."+r+" + .actions a").show()}),n.bind("watched-items:decrement",function(t,i){var r=i.type,o=e(r),s=parseInt(o.text());o.text(--s),s||n.find(".type."+r+" + .actions a").hide()});var d=t("#watched-pull-requests, #watched-issues, #watched-repositories, #watched-snippets");c(d.find(".maskable"))})}),define("account-admin/oauth-consumers",["bitbucket","jquery","on-ready","underscore","utils/mustache"],function(e,t,n,i,r){return n(function(){function n(e){if(!e.find("tbody tr").length){var n=t('<tr class="empty"><td colspan="2">You have no consumers configured.</td><td></td></tr>');e.find("tbody").append(n)}}var o=t("#oauth-consumers"),s=o.find("table.widget"),a=o.attr("data-target-user"),l=e.user(a);i.each(o.data("consumers"),function(e){var n=t(r.toHtml("oauth-consumer-template",e)).data(e);s.append(n)}),s.find("tr.loading").remove(),n(s),t(".consumer").on("click",'a[href="#delete"]',function(){var e=t(this).closest(".consumer").attr("data-consumer"),i=t("#"+e);l.delete_consumer(i.data("id"),{success:function(){i.next().remove(),i.remove(),n(s)}})}),s.on("click","tr a.name",function(e){e.preventDefault(),t(this).closest("tr").toggleClass("revealed"),t(this).children(".expander").toggleClass("aui-iconfont-collapsed").toggleClass("aui-iconfont-expanded")
})})}),define("components/plans/index",["backbone","data/current-user","components/groups/index"],function(e,t,n){{var i={},r=(i.GroupMemberships=e.Collection.extend({model:n.GroupMember,url:function(){},comparator:function(e){return e.group().displayName().toLowerCase()}}),i.UserGroupMemberships=e.Model.extend({user_:null,memberships_:null,user:function(){return this.user_},setUser:function(e){return this.user_=e,this},memberships:function(){return this.memberships_},setMemberships:function(e){return this.memberships_=e,this},sync:function(e,t,n){n.success()},toJSON:function(){var e=this.user().toJSON();return e.groupsCount=this.memberships().length,e}}));i.AllUsersGroupMemberships=e.Collection.extend({model:r,comparator:function(e){var n=e.user_;return[n.get("username")===t.username?0:1,n.displayName().toLowerCase()]}})}return i}),define("utils/account",["jquery","underscore","utils/query-params","utils/api-helper"],function(e,t,n,i){function r(e){return"function"!=typeof e?e:{error:function(){alert("An unexpected error occurred.")},success:e}}var o={};return o.avatar=function(e,t){return e.endsWith(/\/default_(team_)?avatar\/([0-9]+)\/(team_|user_)blue[.]png/)?e.replace(/[0-9]+(?=\/(team_|user_)blue[.]png$)/,t):e.replace(/\bs=\d+$/,"s="+t)},o.groupPrivileges=function(n,o){n=r(n);var s=n.success;e.ajax(t.extend(n,{url:i.toString("group-privileges",o),dataType:"json",success:function(e,n,i){var r={};t.each(e,function(e){var t="{owner.username}/{slug}".format(e.group);r[t]||(r[t]={read:[],write:[],admin:[]}),r[t][e.privilege].push(e.repo)}),s(r,n,i)}}))},o.displayName=function(e){return e.display_name},o}),define("account-admin/plans",["aui","backbone","bitbucket","jquery","on-ready","underscore","components/confirm-dialog","components/groups/index","components/plans/index","data/current-user","utils/account","utils/api-helper","utils/backbone-ui-helper","utils/mustache","utils/disable"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p){return r(function(){function r(e,t){var n={},i={},r={},s="{owner.username}:{slug}".format();o.each(t.data("groups"),function(t){t.owner={username:w.username},e.push({group:t})}),o.each(e,function(e){var t=e.group,o=i[s(t)]||function(){return t.targetUser=w,(i[s(t)]=new a.Group(t)).setRepositories(new a.Repositories)}();o.repositories().add(r[e.repo]||new a.Repository(e.repository)),o.groupMembers().each(function(e){if(e.get("username")!==w.username){e.setGroup(o);var t=n[e.get("username")];t||(t=n[e.get("username")]=new l.UserGroupMemberships,t.setUser(e).setMemberships(new l.GroupMemberships)),t.memberships().any(function(t){return s(t.group().attributes)===s(e.group().attributes)})||t.memberships().add(e)}})});var u=new l.AllUsersGroupMemberships;return u.reset(o.values(n)),u}function f(){var e=parseInt(j.text(),10);j.text(e-1)}l.ui={};var m=l.ui.GroupMembershipView=t.View.extend({model:a.GroupMember,tagName:"li",render:function(){return this.$el.html(p.toHtml("account-group-membership-template",this.model.group())),this}}),g=l.ui.UserGroupMembershipsView=t.View.extend({model:l.UserGroupMemberships,tagName:"tr",userView_:null,events:{'click a[href="#delete"]':"deleteAll"},initialize:function(){this.collectionView_=new h.CollectionView({view:m,collection:this.model.memberships(),tagName:"ol",className:"children"})},deleteAll:function(e){e.preventDefault();var t=this.collectionView_.collection,n=function(){var e=t.first();e?e.destroy({wait:!0,success:n}):_()},i=gettext("This will remove %(display_name)s from any groups on your account. In addition, if %(display_name)s is a member of any groups not under your account, those groups will no longer be able to access your private repositories. Do you wish to continue?");s({content:interpolate(i,{display_name:this.model.user().displayName()},!0),buttonText:gettext("Remove"),title:gettext("Remove access?")}).done(n)},render:function(){var e=this.$el,t=this.model.user().get("username");return e.addClass("data-username user").data("username",t).append(i(p.toHtml("account-access-group-template",this.model.toJSON()))),t===u.username&&e.find('a[href="#delete"]').remove(),e.data("groups",this.model.memberships()),this}}),v=l.ui.AccessViaGroupsView=t.View.extend({userGroupViews_:null,el:"#access-via-groups table",initialize:function(){this.userGroupViews_=new h.CollectionView({collection:this.collection,view:g,tagName:"tbody"})},render:function(){this.$("tbody").remove(),this.$el.append(this.userGroupViews_.render().el);var t=function(e,t,r){var o=i(t).closest("tr"),s=new h.CollectionView({view:m,collection:o.data("groups"),tagName:"ol"});e.empty(),e.append(i(s.render().el)),n.refresh(),r&&r()},n=e.InlineDialog('#access-via-groups a[href="#groups"]',"access-groups",t,{useLiveEvents:!0});return this}}),y=i("#plans-and-billing"),b=y.data(),w={username:y.attr("data-target-username"),avatarUrl:b.targetAvatar,isTeam:b.targetIsTeam,displayName:y.attr("data-target-display-name")},x=i("#access-via-groups");if(x.length){var _=function(){var e=d.toString("group-privileges",w.username,{"private":!0});return function(){i.get(e,function(e){new v({collection:r(e,x)}).render()}),x.trigger("bb:account:updatecount")}}();_()}var k=i("#direct-access");if(k.length){var C=k.data("users");o.each(C,function(e){e.displayName=e.display_name}),C=o.sortBy(C,function(e){return e.displayName.toLowerCase()});var S=k.find("table.widget tbody");S.empty();var $=i(p.toHtml("direct-access-user-template",o.extend({},w,{avatar:c.avatar(w.avatarUrl,32)})));$.removeClass("data-username"),$.find("a").remove(),w.isTeam||$.appendTo(S),o.each(C,function(e){S.append(i(p.toHtml("direct-access-user-template",o.extend({},e,{avatar:c.avatar(e.avatar,32)}))))});var T=function(e){var t=i("<ol>");return o.each(o.keys(e),function(e){t.append(i(p.toHtml("direct-access-repo-template",{repo:e})))}),t},A=function(e,t,r){var s=i(t),a=s.closest("tr");if(!s.hasClass("loading"))if(e.empty(),a.data("repos"))e.append(T(a.data("repos"))),E.refresh(),r&&r();else{s.addClass("loading");var l=a.data("username"),u=n.user(w.username);u.privileges(n.flags.access.direct,function(t){var n=o.reduce(t,function(e,t,n){var i=t[l];return i&&(e[n]=i),e},{});s.removeClass("loading"),a.data("repos",n),e.append(T(n)),E.refresh(),r&&r()})}},E=e.InlineDialog('#direct-access a[href="#repos"]',"direct-access",A,{useLiveEvents:!0});k.delegate('a[href="#delete"]',"click",function(e){e.preventDefault();var t=i(this),n=t.closest("tr"),r=t.data("confirm-msg")||"Are you sure?";s({title:gettext("Remove access?"),content:r,buttonText:gettext("Remove")}).done(function(){i.ajax({url:d.toString("privileges",w.username,{"private":!0,username:n.data("username")}),type:"DELETE",dataType:"json",success:function(){k.trigger("bb:account:updatecount"),n.slideUp(function(){n.remove()})}})})})}var j=i(".plan-count");k.on("bb:account:updatecount",f),x.on("bb:account:updatecount",f)})}),define("account-admin/plans-performance",["aui","jquery","on-ready","components/paginate","utils/mustache"],function(e,t,n,i,r){return n(function(n){var o=n.attr("data-target-username"),s=e.dialog2("#plans-dialog"),a=n.attr("data-access-url").replace("[[targetUser]]",o),l=t("#user-access-content");n.on("click",".view-access button",function(){var e=t(this);e.loading(t.ajax({type:"GET",url:a,data:{user:e.attr("data-user")}})).done(function(e){e.title=interpolate(gettext("User access for %(user)s"),{user:e.user.display_name},!0),e.hasRepos=!!e.repos.length,e.hasGroups=!!e.groups.length,l.html(r.toHtml("plan-access-template",e)),s.show()})}),t("#close-button").on("click",function(){s.hide()}),i(n,{$pjaxContainer:t("#members-pjax")})})}),function(e){define("jquery-plugins/jquery.ui.core",["jquery"],function(){return function(){!function(e,t){function n(t,n){var r,o,s,a=t.nodeName.toLowerCase();return"area"===a?(r=t.parentNode,o=r.name,t.href&&o&&"map"===r.nodeName.toLowerCase()?(s=e("img[usemap=#"+o+"]")[0],!!s&&i(s)):!1):(/input|select|textarea|button|object/.test(a)?!t.disabled:"a"===a?t.href||n:n)&&i(t)}function i(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(n,i){return"number"==typeof n?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),i&&i.call(t)},n)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(n){if(n!==t)return this.css("zIndex",n);if(this.length)for(var i,r,o=e(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(r=parseInt(o.css("zIndex"),10),!isNaN(r)&&0!==r))return r;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(n){return!!e.data(n,t)}}):function(t,n,i){return!!e.data(t,i[3])},focusable:function(t){return n(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var i=e.attr(t,"tabindex"),r=isNaN(i);return(r||i>=0)&&n(t,!r)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(n,i){function r(t,n,i,r){return e.each(o,function(){n-=parseFloat(e.css(t,"padding"+this))||0,i&&(n-=parseFloat(e.css(t,"border"+this+"Width"))||0),r&&(n-=parseFloat(e.css(t,"margin"+this))||0)}),n}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(n){return n===t?a["inner"+i].call(this):this.each(function(){e(this).css(s,r(this,n)+"px")})},e.fn["outer"+i]=function(t,n){return"number"!=typeof t?a["outer"+i].call(this,t):this.each(function(){e(this).css(s,r(this,t,!0,n)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(n){return arguments.length?t.call(this,e.camelCase(n)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,n,i){var r,o=e.ui[t].prototype;for(r in i)o.plugins[r]=o.plugins[r]||[],o.plugins[r].push([n,i[r]])},call:function(e,t,n){var i,r=e.plugins[t];if(r&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(i=0;i<r.length;i++)e.options[r[i][0]]&&r[i][1].apply(e.element,n)}},hasScroll:function(t,n){if("hidden"===e(t).css("overflow"))return!1;var i=n&&"left"===n?"scrollLeft":"scrollTop",r=!1;return t[i]>0?!0:(t[i]=1,r=t[i]>0,t[i]=0,r)}})}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery-plugins/jquery.ui.widget",["jquery-plugins/jquery.ui.core"],function(){return function(){!function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(o){}r(t)},e.widget=function(t,n,i){var r,o,s,a,l={},u=t.split(".")[0];t=t.split(".")[1],r=u+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[u]=e[u]||{},o=e[u][t],s=e[u][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new s(e,t)},e.extend(s,o,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),a=new n,a.options=e.widget.extend({},a.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,o=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=o,t}}()):void(l[t]=i)}),s.prototype=e.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||t:t},l,{constructor:s,namespace:u,widgetName:t,widgetFullName:r}),o?(e.each(o._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,s,n._proto)}),delete o._childConstructors):n._childConstructors.push(s),e.widget.bridge(t,s)},e.widget.extend=function(n){for(var r,o,s=i.call(arguments,1),a=0,l=s.length;l>a;a++)for(r in s[a])o=s[a][r],s[a].hasOwnProperty(r)&&o!==t&&(n[r]=e.isPlainObject(o)?e.isPlainObject(n[r])?e.widget.extend({},n[r],o):e.widget.extend({},o):o);return n},e.widget.bridge=function(n,r){var o=r.prototype.widgetFullName||n;e.fn[n]=function(s){var a="string"==typeof s,l=i.call(arguments,1),u=this;return s=!a&&l.length?e.widget.extend.apply(null,[s].concat(l)):s,this.each(a?function(){var i,r=e.data(this,o);return r?e.isFunction(r[s])&&"_"!==s.charAt(0)?(i=r[s].apply(r,l),i!==r&&i!==t?(u=i&&i.jquery?u.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+s+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+s+"'")}:function(){var t=e.data(this,o);t?t.option(s||{})._init():e.data(this,o,new r(s,this))}),u}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var r,o,s,a=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(a={},r=n.split("."),n=r.shift(),r.length){for(o=a[n]=e.widget.extend({},this.options[n]),s=0;s<r.length-1;s++)o[r[s]]=o[r[s]]||{},o=o[r[s]];if(n=r.pop(),1===arguments.length)return o[n]===t?null:o[n];o[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];a[n]=i}return this._setOptions(a),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,o=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,s){function a(){return t||o.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),u=l[1]+o.eventNamespace,c=l[2];c?r.delegate(c,u,a):n.bind(u,a)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,o,s=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(r in o)r in n||(n[r]=o[r]);return this.element.trigger(n,i),!(e.isFunction(s)&&s.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,o){"string"==typeof r&&(r={effect:r});var s,a=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),s=!e.isEmptyObject(r),r.complete=o,r.delay&&i.delay(r.delay),s&&e.effects&&e.effects.effect[a]?i[t](r):a!==t&&i[a]?i[a](r.duration,r.easing,o):i.queue(function(n){e(this)[t](),o&&o.call(i[0]),n()})}})}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery-plugins/jquery.ui.mouse",["jquery-plugins/jquery.ui.widget"],function(){return function(){!function(e){var t=!1;e(document).mouseup(function(){t=!1}),e.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(n){return!0===e.data(n.target,t.widgetName+".preventClickEvent")?(e.removeData(n.target,t.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(n){if(!t){this._mouseStarted&&this._mouseUp(n),this._mouseDownEvent=n;var i=this,r=1===n.which,o="string"==typeof this.options.cancel&&n.target.nodeName?e(n.target).closest(this.options.cancel).length:!1;return r&&!o&&this._mouseCapture(n)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){i.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(n)&&this._mouseDelayMet(n)&&(this._mouseStarted=this._mouseStart(n)!==!1,!this._mouseStarted)?(n.preventDefault(),!0):(!0===e.data(n.target,this.widgetName+".preventClickEvent")&&e.removeData(n.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return i._mouseMove(e)},this._mouseUpDelegate=function(e){return i._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),n.preventDefault(),t=!0,!0)):!0}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery-plugins/jquery.ui.draggable",["jquery-plugins/jquery.ui.mouse"],function(){return function(){!function(e){e.widget("ui.draggable",e.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(t){var n=this.options;return this.helper||n.disabled||e(t.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(t),this.handle?(e(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){e("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(e(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(t){var n=this.options;return this.helper=this._createHelper(t),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),e.ui.ddmanager&&(e.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,e.extend(this.offset,{click:{left:t.pageX-this.offset.left,top:t.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",t)===!1?(this._clear(),!1):(this._cacheHelperProportions(),e.ui.ddmanager&&!n.dropBehaviour&&e.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),e.ui.ddmanager&&e.ui.ddmanager.dragStart(this,t),!0)},_mouseDrag:function(t,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),!n){var i=this._uiHash();if(this._trigger("drag",t,i)===!1)return this._mouseUp({}),!1;this.position=i.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),e.ui.ddmanager&&e.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var n=this,i=!1;return e.ui.ddmanager&&!this.options.dropBehaviour&&(i=e.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"original"!==this.options.helper||e.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||this.options.revert===!0||e.isFunction(this.options.revert)&&this.options.revert.call(this.element,i)?e(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",t)!==!1&&n._clear()}):this._trigger("stop",t)!==!1&&this._clear(),!1):!1},_mouseUp:function(t){return e("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),e.ui.ddmanager&&e.ui.ddmanager.dragStop(this,t),e.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(t){return this.options.handle?!!e(t.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(t){var n=this.options,i=e.isFunction(n.helper)?e(n.helper.apply(this.element[0],[t])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return i.parents("body").length||i.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),i[0]===this.element[0]||/(fixed|absolute)/.test(i.css("position"))||i.css("position","absolute"),i},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),e.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&e.ui.ie)&&(t={top:0,left:0}),{top:t.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var e=this.element.position();return{top:e.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:e.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,n,i,r=this.options;return r.containment?"window"===r.containment?void(this.containment=[e(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,e(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,e(window).scrollLeft()+e(window).width()-this.helperProportions.width-this.margins.left,e(window).scrollTop()+(e(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===r.containment?void(this.containment=[0,0,e(document).width()-this.helperProportions.width-this.margins.left,(e(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):r.containment.constructor===Array?void(this.containment=r.containment):("parent"===r.containment&&(r.containment=this.helper[0].parentNode),n=e(r.containment),i=n[0],void(i&&(t="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(t?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(t,n){n||(n=this.position);var i="absolute"===t?1:-1,r="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:r.scrollTop(),left:r.scrollLeft()}),{top:n.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*i,left:n.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*i}},_generatePosition:function(t){var n,i,r,o,s=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&e.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=t.pageX,u=t.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(i=this.relative_container.offset(),n=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]):n=this.containment,t.pageX-this.offset.click.left<n[0]&&(l=n[0]+this.offset.click.left),t.pageY-this.offset.click.top<n[1]&&(u=n[1]+this.offset.click.top),t.pageX-this.offset.click.left>n[2]&&(l=n[2]+this.offset.click.left),t.pageY-this.offset.click.top>n[3]&&(u=n[3]+this.offset.click.top)),s.grid&&(r=s.grid[1]?this.originalPageY+Math.round((u-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,u=n?r-this.offset.click.top>=n[1]||r-this.offset.click.top>n[3]?r:r-this.offset.click.top>=n[1]?r-s.grid[1]:r+s.grid[1]:r,o=s.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,l=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o)),{top:u-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(t,n,i){return i=i||this._uiHash(),e.ui.plugin.call(this,t,[n,i]),"drag"===t&&(this.positionAbs=this._convertPositionTo("absolute")),e.Widget.prototype._trigger.call(this,t,n,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),e.ui.plugin.add("draggable","connectToSortable",{start:function(t,n){var i=e(this).data("ui-draggable"),r=i.options,o=e.extend({},n,{item:i.element});
i.sortables=[],e(r.connectToSortable).each(function(){var n=e.data(this,"ui-sortable");n&&!n.options.disabled&&(i.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",t,o))})},stop:function(t,n){var i=e(this).data("ui-draggable"),r=e.extend({},n,{item:i.element});e.each(i.sortables,function(){this.instance.isOver?(this.instance.isOver=0,i.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(t),this.instance.options.helper=this.instance.options._helper,"original"===i.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",t,r))})},drag:function(t,n){var i=e(this).data("ui-draggable"),r=this;e.each(i.sortables,function(){var o=!1,s=this;this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,e.each(i.sortables,function(){return this.instance.positionAbs=i.positionAbs,this.instance.helperProportions=i.helperProportions,this.instance.offset.click=i.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&e.contains(s.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=e(r).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},t.target=this.instance.currentItem[0],this.instance._mouseCapture(t,!0),this.instance._mouseStart(t,!0,!0),this.instance.offset.click.top=i.offset.click.top,this.instance.offset.click.left=i.offset.click.left,this.instance.offset.parent.left-=i.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=i.offset.parent.top-this.instance.offset.parent.top,i._trigger("toSortable",t),i.dropped=this.instance.element,i.currentItem=i.element,this.instance.fromOutside=i),this.instance.currentItem&&this.instance._mouseDrag(t)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",t,this.instance._uiHash(this.instance)),this.instance._mouseStop(t,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),i._trigger("fromSortable",t),i.dropped=!1)})}}),e.ui.plugin.add("draggable","cursor",{start:function(){var t=e("body"),n=e(this).data("ui-draggable").options;t.css("cursor")&&(n._cursor=t.css("cursor")),t.css("cursor",n.cursor)},stop:function(){var t=e(this).data("ui-draggable").options;t._cursor&&e("body").css("cursor",t._cursor)}}),e.ui.plugin.add("draggable","opacity",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("opacity")&&(r._opacity=i.css("opacity")),i.css("opacity",r.opacity)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._opacity&&e(n.helper).css("opacity",i._opacity)}}),e.ui.plugin.add("draggable","scroll",{start:function(){var t=e(this).data("ui-draggable");t.scrollParent[0]!==document&&"HTML"!==t.scrollParent[0].tagName&&(t.overflowOffset=t.scrollParent.offset())},drag:function(t){var n=e(this).data("ui-draggable"),i=n.options,r=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(i.axis&&"x"===i.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-t.pageY<i.scrollSensitivity?n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop+i.scrollSpeed:t.pageY-n.overflowOffset.top<i.scrollSensitivity&&(n.scrollParent[0].scrollTop=r=n.scrollParent[0].scrollTop-i.scrollSpeed)),i.axis&&"y"===i.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-t.pageX<i.scrollSensitivity?n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft+i.scrollSpeed:t.pageX-n.overflowOffset.left<i.scrollSensitivity&&(n.scrollParent[0].scrollLeft=r=n.scrollParent[0].scrollLeft-i.scrollSpeed))):(i.axis&&"x"===i.axis||(t.pageY-e(document).scrollTop()<i.scrollSensitivity?r=e(document).scrollTop(e(document).scrollTop()-i.scrollSpeed):e(window).height()-(t.pageY-e(document).scrollTop())<i.scrollSensitivity&&(r=e(document).scrollTop(e(document).scrollTop()+i.scrollSpeed))),i.axis&&"y"===i.axis||(t.pageX-e(document).scrollLeft()<i.scrollSensitivity?r=e(document).scrollLeft(e(document).scrollLeft()-i.scrollSpeed):e(window).width()-(t.pageX-e(document).scrollLeft())<i.scrollSensitivity&&(r=e(document).scrollLeft(e(document).scrollLeft()+i.scrollSpeed)))),r!==!1&&e.ui.ddmanager&&!i.dropBehaviour&&e.ui.ddmanager.prepareOffsets(n,t)}}),e.ui.plugin.add("draggable","snap",{start:function(){var t=e(this).data("ui-draggable"),n=t.options;t.snapElements=[],e(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=e(this),i=n.offset();this!==t.element[0]&&t.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:i.top,left:i.left})})},drag:function(t,n){var i,r,o,s,a,l,u,c,d,h,p=e(this).data("ui-draggable"),f=p.options,m=f.snapTolerance,g=n.offset.left,v=g+p.helperProportions.width,y=n.offset.top,b=y+p.helperProportions.height;for(d=p.snapElements.length-1;d>=0;d--)a=p.snapElements[d].left,l=a+p.snapElements[d].width,u=p.snapElements[d].top,c=u+p.snapElements[d].height,a-m>v||g>l+m||u-m>b||y>c+m||!e.contains(p.snapElements[d].item.ownerDocument,p.snapElements[d].item)?(p.snapElements[d].snapping&&p.options.snap.release&&p.options.snap.release.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=!1):("inner"!==f.snapMode&&(i=Math.abs(u-b)<=m,r=Math.abs(c-y)<=m,o=Math.abs(a-v)<=m,s=Math.abs(l-g)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:u-p.helperProportions.height,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:c,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a-p.helperProportions.width}).left-p.margins.left),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l}).left-p.margins.left)),h=i||r||o||s,"outer"!==f.snapMode&&(i=Math.abs(u-y)<=m,r=Math.abs(c-b)<=m,o=Math.abs(a-g)<=m,s=Math.abs(l-v)<=m,i&&(n.position.top=p._convertPositionTo("relative",{top:u,left:0}).top-p.margins.top),r&&(n.position.top=p._convertPositionTo("relative",{top:c-p.helperProportions.height,left:0}).top-p.margins.top),o&&(n.position.left=p._convertPositionTo("relative",{top:0,left:a}).left-p.margins.left),s&&(n.position.left=p._convertPositionTo("relative",{top:0,left:l-p.helperProportions.width}).left-p.margins.left)),!p.snapElements[d].snapping&&(i||r||o||s||h)&&p.options.snap.snap&&p.options.snap.snap.call(p.element,t,e.extend(p._uiHash(),{snapItem:p.snapElements[d].item})),p.snapElements[d].snapping=i||r||o||s||h)}}),e.ui.plugin.add("draggable","stack",{start:function(){var t,n=this.data("ui-draggable").options,i=e.makeArray(e(n.stack)).sort(function(t,n){return(parseInt(e(t).css("zIndex"),10)||0)-(parseInt(e(n).css("zIndex"),10)||0)});i.length&&(t=parseInt(e(i[0]).css("zIndex"),10)||0,e(i).each(function(n){e(this).css("zIndex",t+n)}),this.css("zIndex",t+i.length))}}),e.ui.plugin.add("draggable","zIndex",{start:function(t,n){var i=e(n.helper),r=e(this).data("ui-draggable").options;i.css("zIndex")&&(r._zIndex=i.css("zIndex")),i.css("zIndex",r.zIndex)},stop:function(t,n){var i=e(this).data("ui-draggable").options;i._zIndex&&e(n.helper).css("zIndex",i._zIndex)}})}(jQuery)}.apply(e,arguments)})}(this),define("components/image-tools/image-explorer",["jquery","underscore","utils/mustache","fd-slider","jquery-plugins/jquery.ui.draggable"],function(e,t,n,i){function r(){this.init.apply(this,arguments)}return r.scaleModes={fill:"fill",contain:"contain",containAndFill:"containAndFill"},r.zoomModes={localZoom:"localZoom",imageZoom:"imageZoom"},r.prototype.defaults={initialScaleMode:r.scaleModes.containAndFill,zoomMode:r.zoomModes.localZoom,emptyClass:"empty",scaleMax:1},r.prototype.init=function(n,i){this.$container=n,this.$imageView=this.$container.find(".image-explorer-image-view"),this.$sourceImage=this.$container.find(".image-explorer-source"),this.$mask=this.$container.find(".image-explorer-mask"),this.$dragDelegate=this.$container.find(".image-explorer-drag-delegate"),this.$scaleSlider=this.$container.find(".image-explorer-scale-slider"),this.options=e.extend({},this.defaults,i),this.imageProperties={},t.bindAll(this,"getImageSrc","setImageSrc","initImage","initDragDelegate","initScaleSlider","setInitialScale","getFillScale","getContainedScale","getCircularContainedScale","sliderValToScale","scaleToSliderVal","updateImageScale","resetImagePosition","resetScaleSlider","toggleEmpty","get$ImageView","get$SourceImage","get$Mask","get$DragDelegate","getMaskedImageProperties","showError","clearError","hasValidImage","_resetFromError","_removeError"),this.toggleEmpty(!0),this.$sourceImage[0].naturalWidth&&(this.toggleEmpty(!1),this.initImage({target:this.$sourceImage[0]})),this.$sourceImage.on("load",this.initImage),this.initDragDelegate(),this.initScaleSlider()},r.prototype.getImageSrc=function(){return this.$sourceImage?this.$sourceImage.attr("src"):void 0},r.prototype.setImageSrc=function(e){this.$sourceImage&&this.$sourceImage.attr("src","").attr("src",e)},r.prototype.initImage=function(e){var t=e.target;this.imageProperties.naturalWidth=t.naturalWidth,this.imageProperties.naturalHeight=t.naturalHeight,this._removeError(),this.toggleEmpty(!1),this.setInitialScale()},r.prototype.initDragDelegate=function(){var e;this.$dragDelegate.draggable({start:t.bind(function(){e=this.$sourceImage.offset()},this),drag:t.bind(function(t,n){this.$sourceImage.offset({top:e.top+n.position.top-n.originalPosition.top,left:e.left+n.position.left-n.originalPosition.left})},this),revert:!0,revertDuration:0})},r.prototype.initScaleSlider=function(){this.$scaleSlider.on("change",t.bind(function(e){this.updateImageScale(this.sliderValToScale(e.target.value))},this))},r.prototype.setInitialScale=function(){var e=this.$mask.width(),t=this.$mask.height(),n=this.imageProperties.naturalWidth,i=this.imageProperties.naturalHeight,o=1;switch(this.minScale=1,this.options.initialScaleMode){case r.scaleModes.fill:this.minScale=o=this.getFillScale(n,i,e,t);break;case r.scaleModes.contain:this.minScale=o=this.$mask.hasClass("circle-mask")?this.getCircularContainedScale(n,i,e/2):this.getContainedScale(n,i,e,t);break;case r.scaleModes.containAndFill:this.minScale=this.$mask.hasClass("circle-mask")?this.getCircularContainedScale(n,i,e/2):this.getContainedScale(n,i,e,t),o=this.getFillScale(n,i,e,t)}this.maxScale=Math.max(o,this.options.scaleMax),this.resetScaleSlider(this.scaleToSliderVal(o)),this.updateImageScale(o,r.zoomModes.imageZoom),this.resetImagePosition()},r.prototype.getFillScale=function(e,t,n,i){var r=n/e,o=i/t;return Math.max(r,o)},r.prototype.getContainedScale=function(e,t,n,i){var r=n/e,o=i/t;return Math.min(r,o)},r.prototype.getCircularContainedScale=function(e,t,n){var i=Math.atan(t/e),r=Math.cos(i)*n*2;return r/e},r.prototype.sliderValToScale=function(e){var t=e/(this.$scaleSlider.attr("max")-this.$scaleSlider.attr("min"));return this.minScale+t*(this.maxScale-this.minScale)},r.prototype.scaleToSliderVal=function(e){var t=(e-this.minScale)/(this.maxScale-this.minScale);return t*(this.$scaleSlider.attr("max")-this.$scaleSlider.attr("min"))},r.prototype.updateImageScale=function(e,t){var n,i,o=Math.round(e*this.imageProperties.naturalWidth),s=Math.round(e*this.imageProperties.naturalHeight);switch(t=t||this.options.zoomMode){case r.zoomModes.imageZoom:n=-1*o/2,i=-1*s/2;break;case r.zoomModes.localZoom:var a=this.$sourceImage.width(),l=this.$sourceImage.height(),u=parseInt(this.$sourceImage.css("margin-left"),10),c=parseInt(this.$sourceImage.css("margin-top"),10),d=this.$sourceImage.position(),h=this.$imageView.width()/2,p=this.$imageView.height()/2,f=h-d.left-u,m=p-d.top-c,g=f/a*o,v=m/l*s;n=h-d.left-g,i=p-d.top-v}this.$sourceImage.width(o).height(s).css({"margin-left":Math.round(n)+"px","margin-top":Math.round(i)+"px"})},r.prototype.resetImagePosition=function(){this.$sourceImage.css({top:"50%",left:"50%"})},r.prototype.resetScaleSlider=function(e){this.$scaleSlider.val(e).removeClass("disabled").removeAttr("disabled"),i.updateSlider(this.$scaleSlider.attr("id"))},r.prototype.toggleEmpty=function(e){this.$container.toggleClass(this.options.emptyClass,e)},r.prototype.get$ImageView=function(){return this.$imageView},r.prototype.get$SourceImage=function(){return this.$sourceImage},r.prototype.get$Mask=function(){return this.$mask},r.prototype.get$DragDelegate=function(){return this.$dragDelegate},r.prototype.getMaskedImageProperties=function(){var e=this.$sourceImage.width()/this.imageProperties.naturalWidth,t=this.$sourceImage.height()/this.imageProperties.naturalHeight,n=this.$mask.position(),i=this.$sourceImage.position();return n.top+=parseInt(this.$mask.css("margin-top"),10),n.left+=parseInt(this.$mask.css("margin-left"),10),i.top+=parseInt(this.$sourceImage.css("margin-top"),10),i.left+=parseInt(this.$sourceImage.css("margin-left"),10),{maskedAreaImageX:Math.round((n.left-i.left)/e),maskedAreaImageY:Math.round((n.top-i.top)/t),maskedAreaWidth:Math.round(this.$mask.width()/e),maskedAreaHeight:Math.round(this.$mask.height()/t)}},r.prototype.showError=function(t,i){this._removeError(),this.toggleEmpty(!0),this.$container.addClass("error");var r=e(n.toHtml("avatar-error-template",{title:t,contents:i}));r.appendTo(this.$imageView).css({"margin-top":-1*r.outerHeight()/2}),r.on("messageClose",this._resetFromError),AJS.messages.setup()},r.prototype.clearError=function(){this._removeError(),this._resetFromError()},r.prototype.hasValidImage=function(){return!(!this.getImageSrc()||!this.$sourceImage.prop("naturalWidth"))},r.prototype._resetFromError=function(){var e=this.hasValidImage();this.toggleEmpty(!e),this.$container.removeClass("error"),t.isFunction(this.options.onErrorReset)&&this.options.onErrorReset(e?this.getImageSrc():void 0)},r.prototype._removeError=function(){this.$imageView.find(".aui-message.error").remove()},r}),define("components/image-tools/client-file-handler",["jquery","underscore"],function(e,t){function n(e){return this.init(e)}return n.typeFilters={all:/.*/,application:/^application\/.*/,audio:/^audio\/.*/,image:/^image\/.*/,imageWeb:/^image\/(jpeg|png|gif)$/,text:/^text\/.*/,video:/^video\/.*/},n.prototype.defaults={fileTypeFilter:n.typeFilters.all,fileCountLimit:1/0,fileSizeLimit:20971520,onSuccess:e.noop,onError:e.noop},n.prototype.init=function(n){return this.options=e.extend({},this.defaults,n),n&&!n.fileSizeLimit&&(this.options.fileSizeLimit=this.defaults.fileSizeLimit),n&&!n.fileCountLimit&&(this.options.fileCountLimit=this.defaults.fileCountLimit),t.bindAll(this,"handleFiles","filterFiles"),this},n.prototype.handleFiles=function(e){var n=this.filterFiles(e);n.valid.length>0?t.isFunction(this.options.onSuccess)&&this.options.onSuccess(n.valid):t.isFunction(this.options.onError)&&this.options.onError(n.invalid)},n.prototype.filterFiles=function(e){var n=t.isRegExp(this.options.fileTypeFilter)?this.options.fileTypeFilter:this.defaults.fileTypeFilter,i=this.options.fileSizeLimit,r={byType:[],bySize:[],byCount:[]},o=t.filter(e,function(e){return n.test(e.type)?e.size>i?(r.bySize.push(e),!1):!0:(r.byType.push(e),!1)});return o.length>this.options.fileCountLimit&&(r.byCount=o.slice(this.options.fileCountLimit),o=o.slice(0,this.options.fileCountLimit)),{valid:o,invalid:r}},n}),define("components/image-tools/client-file-reader",["jquery","underscore","components/image-tools/client-file-handler"],function(e,t,n){function i(e){if(!i.isSupported())throw new Error("ClientFileReader requires FileReaderAPI support");return this.init(e)}var r=!!(window.File&&window.FileList&&window.FileReader),o={ArrayBuffer:"readAsArrayBuffer",BinaryString:"readAsBinaryString",DataURL:"readAsDataURL",Text:"readAsText"};return i.isSupported=function(){return r},e.extend(i.prototype,n.prototype),i.readMethods={ArrayBuffer:"ArrayBuffer",BinaryString:"BinaryString",DataURL:"DataURL",Text:"Text"},i.typeFilters=n.typeFilters,i.prototype.defaults=e.extend({},n.prototype.defaults,{readMethod:i.readMethods.DataURL,onRead:e.noop}),i.prototype.init=function(e){return t.bindAll(this,"onSuccess","readFile"),n.prototype.init.call(this,e),this.options.onSuccess=this.onSuccess,this},i.prototype.onSuccess=function(e){var n=t.has(o,this.options.readMethod)?o[this.options.readMethod]:void 0;n&&t.each(e,t.bind(function(e){var i=new FileReader;i.onload=t.bind(this.readFile,this,e),i[n](e)},this))},i.prototype.readFile=function(e,n){t.isFunction(this.options.onRead)&&this.options.onRead(n.target.result,e)},i}),define("components/image-tools/drag-drop-file-target",["jquery","underscore"],function(e,t){function n(){return this.init.apply(this,arguments)}return n.prototype.getDefaults=function(){return{activeDropTargetClass:"active-drop-target",uploadPrompt:gettext("Drag a file here to upload"),clientFileHandler:null}},n.prototype.init=function(n,i){t.bindAll(this,"onDragOver","onDragEnd","onDrop"),this.$target=e(n),this.options=e.extend({},this.getDefaults(),i),this.$target.attr("data-upload-prompt",this.options.uploadPrompt),this.$target.on("dragover",this.onDragOver),this.$target.on("dragleave",this.onDragEnd),this.$target.on("dragend",this.onDragEnd),this.$target.on("drop",this.onDrop)},n.prototype.onDragOver=function(e){e.preventDefault(),this.$target.addClass(this.options.activeDropTargetClass)},n.prototype.onDragEnd=function(e){e.preventDefault(),this.$target.removeClass(this.options.activeDropTargetClass)},n.prototype.onDrop=function(e){e.preventDefault(),e.originalEvent.preventDefault(),this.$target.removeClass(this.options.activeDropTargetClass),this.options.clientFileHandler&&this.options.clientFileHandler.handleFiles(e.originalEvent.dataTransfer.files,e.originalEvent.target)},n}),define("components/image-tools/client-file-iframe-uploader",["jquery","underscore","components/image-tools/client-file-handler"],function(e,t,n){function i(e){return this.init(e)}return e.extend(i.prototype,n.prototype),i.prototype.defaults=e.extend({},n.prototype.defaults,{uploadURL:"",uploadFieldName:"file",onUpload:e.noop,responseHandler:function(t,n){var i;try{i=JSON.parse(e(t).html())}catch(r){n.reject()}i?n.resolve(i):n.reject()}}),i.prototype.states={IN_PROGRESS:"IN_PROGRESS",IDLE:"IDLE"},i.prototype.init=function(n){return t.bindAll(this,"createHiddenIframe","onIframeLoad","handleFiles","setStateInProgress","setStateIdle","cancelUpload"),this.options=e.extend({},this.defaults,n),this.$uploadIframe=this.createHiddenIframe(),this.options.cancelTrigger&&(this.$cancelTrigger=e(this.options.cancelTrigger),this.$cancelTrigger.click(t.bind(function(){this.cancelUpload()},this))),this.state=this.states.IDLE,this},i.prototype.createHiddenIframe=function(){return e("<iframe>").attr("name","hidden-upload-iframe").hide().appendTo(document.body).on("load",this.onIframeLoad)},i.prototype.onIframeLoad=function(e){this.state===this.states.IN_PROGRESS&&(this.requestPromise.done(this.options.onUpload).fail(this.options.onError),this.options.responseHandler(e.target.contentDocument.body,this.requestPromise))},i.prototype.handleFiles=function(n,i){if(this.state===this.states.IN_PROGRESS&&this.cancelUpload(),!this.$fileSourceElem){this.$fileSourceElem=e(i),this.$fileSourceElem.attr("name",this.options.uploadFieldName),this.$fileSourceElem.prop("form")||this.$fileSourceElem.wrap("<form>");var r=e(this.$fileSourceElem.prop("form"));r.addClass("hidden-upload-form").attr("action",this.options.uploadURL).attr("method","post").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data").attr("target",this.$uploadIframe.attr("name")),this.$spinner=e('<div class="spinner"></div>').insertBefore(this.$fileSourceElem),e.isPlainObject(this.options.extraData)&&t.each(this.options.extraData,function(t,n){e('<input type="hidden">').attr("name",n).val(t).appendTo(r)})}this.$fileSourceElem.prop("form").submit(),this.requestPromise=e.Deferred(),this.requestPromise.always(this.setStateIdle),this.setStateInProgress()},i.prototype.setStateInProgress=function(){this.state=this.states.IN_PROGRESS,this.$spinner&&this.$spinner.spin(),this.$fileSourceElem&&this.$fileSourceElem.attr("disabled","disabled")},i.prototype.setStateIdle=function(){this.state=this.states.IDLE,this.$spinner&&this.$spinner.spinStop(),this.$fileSourceElem&&this.$fileSourceElem.removeAttr("disabled"),this.requestPromise=null},i.prototype.cancelUpload=function(){this.$uploadIframe.remove(),this.setStateIdle(),this.$uploadIframe=this.createHiddenIframe()},i}),define("components/image-tools/upload-interceptor",["jquery","underscore","data/client"],function(e,t,n){function i(){return this.init.apply(this,arguments)}return i.prototype.defaults={replacementEl:void 0,clientFileHandler:null},i.prototype.init=function(i,r){t.bindAll(this,"onSelectFile","onReplacementClick"),this.$el=e(i),this.options=e.extend({},this.defaults,r),this.$el.on("change",this.onSelectFile),this.options.replacementEl&&(this.$replacement=e(this.options.replacementEl),this.$el.hide(),"Explorer"===n.browser?this.$replacement.is("label")||(this.$replacement.hide(),this.$el.show()):this.$replacement.on("click",this.onReplacementClick))},i.prototype.onSelectFile=function(t){e(t.target).val()&&this.options.clientFileHandler&&this.options.clientFileHandler.handleFiles(t.target.files,this.$el)},i.prototype.onReplacementClick=function(e){e.preventDefault(),this.$el.click()},i.prototype.destroy=function(){this.$el.off("change",this.onSelectFile),this.$replacement.off("click",this.onReplacementClick)},i}),define("components/image-tools/canvas-cropper",["jquery"],function(e){function t(){if(!t.isSupported())throw new Error("This browser doesn't support CanvasCropper.");return this.init.apply(this,arguments)}var n=function(){var e=document.createElement("canvas");return"function"==typeof e.getContext&&e.getContext("2d")}();return t.isSupported=function(){return n},t.prototype.defaults={outputFormat:"image/png",backgroundFillColor:void 0},t.prototype.init=function(t,n,i){return this.width=t,this.height=n||t,this.options=e.extend({},this.defaults,i),this.canvas=e("<canvas/>").attr("width",this.width).attr("height",this.height)[0],this},t.prototype.cropToDataURI=function(e,t,n,i,r){return this.crop(e,t,n,i,r).getDataURI(this.options.outputFormat)},t.prototype.crop=function(e,t,n,i,r){var o=this.canvas.getContext("2d"),s=0,a=0,l=this.width,u=this.height;if(o.clearRect(s,a,l,u),this.options.backgroundFillColor&&(o.fillStyle=this.options.backgroundFillColor,o.fillRect(s,a,l,u)),0>t&&(s=Math.round(Math.abs(t)/i*l),t=0),0>n&&(a=Math.round(Math.abs(n)/r*u),n=0),t+i>e.naturalWidth){var c=e.naturalWidth-t;l*=c/i,i=c}if(n+r>e.naturalHeight){var d=e.naturalHeight-n;u*=d/r,r=d}return o.drawImage(e,t,n,i,r,s,a,l,u),this},t.prototype.getDataURI=function(e){return e?this.canvas.toDataURL(e):null},t}),define("utils/text",["jquery","underscore"],function(e,t){var n=3==="a1a".split(/(\d)/).length;return{toSentenceCase:function(e){return e+="",e?e.charAt(0).toUpperCase()+e.substring(1):""},camelCaseToHyphenated:function(e){return"string"!=typeof e?void 0:e.replace(/([^\s\-_])(?=[A-Z])/g,"$1-").replace(/\s/,"-").toLowerCase()},indent:function(e,t,n){var i="number"==typeof t&&isFinite(t)?t:4,r="string"==typeof n?n:" ";return"string"!=typeof e?void 0:0>i?e:new Array(i+1).join(r)+e},unindent:function(e,t,n){var i="number"==typeof t&&isFinite(t)?t:4,r="string"==typeof n?n:" ";if("string"!=typeof e)return void 0;if(0>i)return e;for(;e.charAt(0)===r&&i;)e=e.substring(1),i--;return e},formatSizeInBytes:function(e){var t=[" bytes","KB","MB","GB","TB","PB"],n=1024,i=0,r=t.length-1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))return"";for(;e>=n&&r>i;)e/=n,i++;return e=Math.floor(10*e)/10,e+t[i]},abbreviateText:function(e,t,n){if("string"!=typeof e)return void 0;if(isNaN(t)||0>t||e.length<=t)return e;var i="string"==typeof n?n:"",r=e.length-t+i.length,o=Math.round(e.length/2);return e.substring(0,o-Math.ceil(r/2))+i+e.substring(o+Math.floor(r/2),e.length)},convertBranchNameToSentence:function(e){if(!e||"string"!=typeof e)return"";if(!n)return e;var i=/([A-Z]{1,10}-\d+)/,r=t.map(e.split(i),function(e,t){return t%2===0?e.replace(/[\-_]/g," "):e});return this.toSentenceCase(r.join(""))},pluralize:function(e,t,n){return 1!=t?void 0!==n?n:e+"s":e}}}),define("components/image-tools/image-upload-and-crop",["jquery","underscore","components/image-tools/image-explorer","components/image-tools/client-file-reader","components/image-tools/drag-drop-file-target","components/image-tools/client-file-iframe-uploader","components/image-tools/upload-interceptor","components/image-tools/canvas-cropper","utils/text"],function(e,t,n,i,r,o,s,a,l){function u(){if(!u.isSupported())throw new Error("This browser doesn't support ImageUploadAndCrop.");this.init.apply(this,arguments)}return u.isSupported=function(){return a.isSupported()},u.prototype.defaults={HiDPIMultiplier:2,dragDropUploadPrompt:gettext("Drag and drop image here"),onImageUpload:e.noop,onImageUploadError:e.noop,onCrop:e.noop,outputFormat:"image/png",fallbackUploadOptions:{},initialScaleMode:n.scaleModes.containAndFill,scaleMax:1,fileSizeLimit:5242880,maxImageDimension:2e3},u.prototype.init=function(l,u){if(this.options=e.extend({},this.defaults,u),this.$container=l,t.bindAll(this,"crop","resetState","_onFileProcessed","setImageSrc","validateImageResolution","_onFilesError","_onFileError","_resetFileUploadField","_onErrorReset"),this.imageExplorer=new n(this.$container.find(".image-explorer-container"),{initialScaleMode:this.options.initialScaleMode,scaleMax:this.options.scaleMax,onErrorReset:this._onErrorReset}),i.isSupported())this.clientFileReader=new i({onRead:this._onFileProcessed,onError:this._onFilesError,fileTypeFilter:i.typeFilters.imageWeb,fileCountLimit:1,fileSizeLimit:this.options.fileSizeLimit}),this.dragDropFileTarget=new r(this.imageExplorer.get$ImageView(),{uploadPrompt:this.options.dragDropUploadPrompt,clientFileHandler:this.clientFileReader});else{this.$container.addClass("filereader-unsupported");var c=e.extend({onUpload:this._onFileProcessed,onError:this._onFileError},this.options.fallbackUploadOptions);this.clientFileReader=new o(c)}this.uploadIntercepter=new s(this.$container.find(".image-upload-field"),{replacementEl:this.$container.find(".image-upload-field-replacement"),clientFileHandler:this.clientFileReader});var d=this.imageExplorer.get$Mask();this.canvasCroppper=new a(d.width()*this.options.HiDPIMultiplier,d.height()*this.options.HiDPIMultiplier,{outputFormat:this.options.outputFormat}),this.options.cropButton&&e(this.options.cropButton).click(this.crop)},u.prototype.crop=function(){var e=this.imageExplorer.getMaskedImageProperties(),n=this.canvasCroppper.cropToDataURI(this.imageExplorer.get$SourceImage()[0],e.maskedAreaImageX,e.maskedAreaImageY,e.maskedAreaWidth,e.maskedAreaHeight);t.isFunction(this.options.onCrop)&&this.options.onCrop(n)},u.prototype.resetState=function(){this.imageExplorer.clearError(),this._resetFileUploadField()},u.prototype._onFileProcessed=function(e){if(e)if(isNaN(this.options.maxImageDimension))this.setImageSrc(e);else{var n=this.validateImageResolution(e);n.done(t.bind(function(){this.setImageSrc(e)},this)).fail(t.bind(function(e,t){var n=gettext("The selected image size is %(image_width)spx * %(image_height)spx. The maximum allowed image size is %(max_dimension)spx * %(max_dimension)spx.");this._onFileError(interpolate(n,{image_width:e,image_height:t,max_dimension:this.options.maxImageDimension},!0))},this))}else this._onFileError()},u.prototype.setImageSrc=function(e){this.imageExplorer.setImageSrc(e),t.isFunction(this.options.onImageUpload)&&this.options.onImageUpload(e),this._resetFileUploadField()},u.prototype.validateImageResolution=function(t){var n=e.Deferred(),i=new Image,r=this;return i.onload=function(){this.naturalWidth>r.options.maxImageDimension||this.naturalHeight>r.options.maxImageDimension?n.reject(this.naturalWidth,this.naturalHeight):n.resolve(this.naturalWidth,this.naturalHeight)},i.src=t,n},u.prototype._onFilesError=function(e){if(e&&e.bySize&&e.bySize.length){var n=t.first(e.bySize),i=gettext('File "%(filename)s" is %(file_size)s which is larger than the maximum allowed size of %(size_limit)s');this._onFileError(AJS.escapeHtml(interpolate(i,{filename:l.abbreviateText(n.name,50),file_size:l.formatSizeInBytes(n.size),size_limit:l.formatSizeInBytes(this.options.fileSizeLimit)},!0)))}else this._onFileError()},u.prototype._onFileError=function(e){var n=gettext("There was an error uploading your image"),i=e||gettext("Please check that your file is a valid image and try again.");this.imageExplorer.showError(n,i),this._resetFileUploadField(),t.isFunction(this.options.onImageUploadError)&&this.options.onImageUploadError(e)},u.prototype._resetFileUploadField=function(){var e=this.$container.find("#image-upload-and-crop-upload-field").prop("form");e&&e.reset()},u.prototype._onErrorReset=function(e){e&&t.isFunction(this.options.onImageUpload)&&this.options.onImageUpload(e)},u}),define("components/avatar-picker-dialog",["jquery","aui","underscore","components/image-tools/image-upload-and-crop","js/components/aui-dialog","utils/mustache"],function(e,t,n,i,r,o){function s(e){if(!s.isSupported())throw new Error("This browser doesn't support AvatarPickerDialog.");return this.init(e)}return s.isSupported=function(){return i.isSupported()},s.prototype.defaults={dialogTitle:gettext("Upload an avatar"),dialogOptions:{width:384,height:610,id:"avatar-picker-dialog",closeOnOutsideClick:!1},templateOptions:{description:gettext("JPG, GIF or PNG image"),deleteText:gettext("Delete avatar")},onCrop:e.noop,onDelete:e.noop,showDelete:!1,trigger:null},s.prototype.init=function(t){n.bindAll(this,"_onImageUpload","_onImageUploadError","_toggleDoneButtonEnabled","chooseAvatar","hide","initDialogContent","show");var o=e.extend(!0,{},this.defaults.templateOptions,t.templateOptions);return this.options=e.extend(!0,{},this.defaults,t,o),this.$dialog=new r(this.options.dialogOptions),this.initDialogContent(),this._toggleDoneButtonEnabled(!1),this.imageUploadAndCrop=new i(this.$dialog.getCurrentPanel().body.find(".image-upload-and-crop-container"),{HiDPIMultiplier:1,onCrop:this.options.onCrop,onImageUpload:this._onImageUpload,onImageUploadError:this._onImageUploadError}),this.options.trigger&&(this.$trigger=e(this.options.trigger),this.$trigger.click(n.bind(function(e){e.preventDefault(),this.show()},this))),this},s.prototype.initDialogContent=function(){this.$dialog.addHeader(this.options.dialogTitle).addPanel().addLink(this.options.templateOptions.deleteText,function(){this.hide(),this.options.onDelete()}.bind(this),this.options.showDelete?"delete-link left":"hidden").addSubmit("Done",this.chooseAvatar).addCancel("Cancel",this.hide).getCurrentPanel().body.append(o.toHtml("avatar-upload-template",this.options.templateOptions)),this.$doneButton=this.$dialog.getCurrentPanel().page.buttonpanel.find(".button-panel-submit-button"),this.$cancelButton=this.$dialog.getCurrentPanel().page.buttonpanel.find(".button-panel-cancel-link")},s.prototype._onImageUpload=function(){this._toggleDoneButtonEnabled(!0)},s.prototype._onImageUploadError=function(){this._toggleDoneButtonEnabled(!1)},s.prototype._toggleDoneButtonEnabled=function(e){null===e&&(e=null!==this.$doneButton.attr("disabled")),e?this.$doneButton.removeAttr("disabled"):this.$doneButton.attr("disabled","disabled")},s.prototype.chooseAvatar=function(){this.imageUploadAndCrop.crop(),this.hide()},s.prototype.hide=function(){this.$dialog.hide(),this.imageUploadAndCrop.resetState()
},s.prototype.show=function(){this.$dialog.show()},s}),define("data/atlassian-id",["jquery","underscore"],function(e,t){function n(){r=e.ajax({type:"GET",url:i.loginStatusUrl,xhrFields:{withCredentials:!0}}),o=e.Deferred(),r.done(function(e,t,n){if(200==n.status){var i=n.getResponseHeader("X-CSRF-TOKEN");o.resolve(e,i)}else o.reject()}).fail(function(){o.reject()})}var i=e(document.body).data("atlassianId")||{},r=null,o=null;return t.extend(i,{loginStatus:function(){return null===r&&n(),o.promise()}})}),define("components/avatar-uploader",["jquery","underscore","on-ready","components/avatar-picker-dialog","data/atlassian-id","utils/gaq-push","utils/loading"],function(e,t,n,i,r,o){function s(n,i,s,l,u,c){var d="POST"===c.type,h=["atl._trackEvent","Avatar",i],p=function(e){u.attr("src",e.avatarUrl+(n?"&s=128":""))};t.extend(c,{contentType:"text/plain; charset=UTF-8",dataType:"json"}),n?r.loginStatus().done(function(n,i){t.extend(c,{headers:{"X-CSRF-TOKEN":i},xhrFields:{withCredentials:!0}}),l.loading(e.ajax(c),a).done(p)}):l.loading(e.ajax(c),a).done(p),s.toggleClass("has-avatar",d),h.push(d?"Upload":"Delete"),o(h)}var a={spin:{color:"#fff",shadow:!0,radius:12,length:10,lines:10}};return function(e){e.isAtlassianId&&r.loginStatus().fail(function(){}),new i(t.extend({onDelete:function(){s(e.isAtlassianId,e.analyticsType,e.trigger,e.uploadIndicator,e.avatars,{type:"DELETE",url:e.endpointUrl})},onCrop:function(t){s(e.isAtlassianId,e.analyticsType,e.trigger,e.uploadIndicator,e.avatars,{data:t,type:"POST",url:e.endpointUrl})}},e))}}),define("account-admin/settings",["jquery","on-ready","components/avatar-uploader","account-admin/language-selector"],function(e,t,n){return t(function(){var t=e("#change-avatar"),i=e("img.avatar, .aui-avatar-inner img"),r=e(".avatar-container"),o=t.data("submitUrl"),s=t.data("isAtlassianId"),a=t.data("textTitle"),l=t.data("textDelete");new n({analyticsType:"Account",avatars:i,endpointUrl:o,dialogTitle:a,isAtlassianId:s,showDelete:t.hasClass("has-avatar"),templateOptions:{deleteText:l,maskClass:"avatar256"},trigger:t,uploadIndicator:r})})}),define("utils/process-form-errors",["jquery","underscore"],function(e,t){return function(n){return t.reduce(e(n).children(),function(t,n){var i=e(n).children().remove().text();return t[e(n).text().trim()]=i,t},{})}}),define("components/ssh/form",["jquery","aui","js/components/aui-dialog","utils/process-form-errors"],function(e,t,n,i){var r=function(t,r,o){function s(){document.location.reload()}function a(t){var n=this,r=i(t.responseText);e.each(r,function(t,i){var r=n.find('[name="'+t+'"]');if(0!==r.length){var o=e("<div>").text(i).addClass("error");r.after(o)}}),n.find("button:submit").attr("aria-disabled",!1).removeClass("disabled")}function l(){var e=r.closest(".aui-popup");e.find(".error").remove();var t={key:e.find("#id_key").val(),label:e.find("#id_label").val()};e.find("button:submit").attr("aria-disabled",!0).addClass("disabled"),o(t,{error:a.bind(e),success:s})}var u,c=r.find("button:submit"),d=r.find("h1"),h=new n({width:800,height:"auto",id:t});return h.addPanel("main"),u=h.getCurrentPanel().body,u.append(r),h.addHeader(d.text()).addButton(c.text(),l,"aui-button aui-style").addCancel("Cancel",function(e){e.hide()}),r.submit(function(e){e.preventDefault(),l()}),r.removeClass("hidden"),d.remove(),{show:function(){u.find(".error").remove(),h.show()},hide:function(){h.hide()},updateForm:function(e){e?(u.find("#ssh_pk").val(e.pk),u.find("#id_label").val(e.label),u.find("#id_key").attr("disabled","disabled").val(e.key),u.find("#id_key_group .description").show()):(u.find("#ssh_pk").val(""),u.find("#id_label").val(""),u.find("#id_key").removeAttr("disabled").val(""),u.find("#id_key_group .description").hide())}}};return r}),define("components/ssh/keys",["jquery","components/alert-dialog","components/ssh/form","data/client","utils/loading"],function(e,t,n,i){return function(r,o){var s=o.onEdit,a=o.onCreate,l=o.onDelete,u=e("#edit-ssh-key"),c=e("#new-ssh-key"),d=r.find("table.widget"),h=n("bb-edit-ssh-key-dialog",u,s);e(".edit-link").click(function(t){t.preventDefault();var n=e(t.target).closest(".ssh-key").data();h.updateForm(n),h.show()});var p=n("bb-new-ssh-key-dialog",c,a);p.updateForm(),e("#add-key").click(function(){p.show()}),r.on("click",'a[href="#delete"]',function(n){n.preventDefault();var i=e(this).closest("tr"),r=i.data().pk,o=i.find("td.actions a[href=#delete]").loading();l(r,{success:function(){o.resolve(),i.remove(),d.find("tbody tr").length||d.find("tbody").html("<tr><td>There are no keys configured</td><td></td><td></td></tr>")},error:function(){o.reject(),t("There was an error communicating with the server, please try again.")}})}),e(".ssh-key-copy-help."+i.os.toLowerCase()).show()}}),define("account-admin/ssh-keys",["bitbucket","jquery","on-ready","components/ssh/keys"],function(e,t,n,i){return n(function(n){var r=n.attr("data-target-user"),o=e.user(r),s=t("#edit-ssh-key");i(n,{onEdit:function(e,t){o.update_ssh_key(s.find("#ssh_pk").val(),e,t)},onCreate:function(e,t){o.add_ssh_key(e,t)},onDelete:function(e,t){o.remove_ssh_key(e,t)}})})}),define("utils/validation/validated-field",["jquery","aui"],function(e){function t(t,n){var i=new e.Deferred;return t(n,{pass:function(){i.resolve()},fail:function(e){i.reject(e)},passWhen:function(e,t){e?i.resolve():i.reject(t)}}),i}function n(){return{onValid:function(){},onInvalid:function(){},onClear:function(){}}}function i(i,r){var o=[],s=function(){};this.$field=i||e(),this.decorator=r||n(),this.validate=function(){var n=this.$field.val();return n?(e.when.apply(null,o.map(function(e){return t(e,n)})).done(function(){this.markValid(),s(!0)}.bind(this)).fail(function(e){this.markInvalid(e),s(!1)}.bind(this)),this):(this.clearStyle(),s(!0),this)}.bind(this),this.addValidation=function(e){return o.push(e),this},this.onValidate=function(e){return s=e.bind(this),this},this.$field.on("blur",this.validate.bind(this)).on("input change propertychange",this.clearStyle.bind(this))}return i.prototype.markValid=function(){this.decorator.onValid(this.$field)},i.prototype.markInvalid=function(e){this.decorator.onInvalid(this.$field,e)},i.prototype.clearStyle=function(){this.decorator.onClear(this.$field)},i}),define("utils/validation/decorators/aui-form",["jquery"],function(e){function t(t){this.options=e.extend({errorClass:"aui-error"},t||{})}return t.prototype.getErrorElement=function(t){var n=t.next(".error");return n.length||(n=e("<div>").addClass("error").insertAfter(t)),n},t.prototype.onValid=function(e){e.removeClass(this.options.errorClass),this.getErrorElement(e).addClass("hidden").text("")},t.prototype.onInvalid=function(e,t){e.addClass(this.options.errorClass),this.getErrorElement(e).removeClass("hidden").text(t)},t.prototype.onClear=function(e){e.removeClass(this.options.errorClass),this.getErrorElement(e).addClass("hidden").text("")},t}),define("billing/address-validation",["on-ready","jquery","underscore","utils/mustache","utils/validation/validated-field","utils/validation/decorators/aui-form","utils/disable"],function(e,t,n,i,r,o){function s(e,t){return e.displayName>t.displayName?1:e.displayName<t.displayName?-1:0}function a(e,t){return e.sortOrder!==t.sortOrder?t.sortOrder-e.sortOrder:s(e,t)}function l(e,i){return function(r,o){var s=r.trim().toUpperCase(),a=new t.Deferred,l=e();return l?(l in f?a.resolve(f[l]):t.ajax({type:"GET",cache:!1,dataType:"json",url:i,data:{country:l}}).done(function(e){f[l]=e.stateNames,a.resolve(e.stateNames)}),void a.done(function(e){return e.length?o.passWhen(n(e).contains(s),gettext("Invalid state")):o.pass()})):o.pass()}}function u(e){return function(t,n){if("US"!==e())return n.pass();var i=/^\d{5}$/;n.passWhen(i.test(t),gettext("Invalid ZIP code"))}}function c(e,n){var i=e(),r=new t.Deferred,o=t("#billing-tax-fields"),s=o.find("input"),a=o.find("label");i in m?r.resolve(m[i]):t.ajax({type:"GET",dataType:"json",url:n.format(i)}).done(function(e){m[i]=e,r.resolve(e)}),r.done(function(e){return a.text(e.taxIdLabel),"Tax"===e.displayName?(s.val(""),o.addClass("hidden")):void o.removeClass("hidden")})}function d(e,n,i,o,s){function a(){return d}var d,h=new r(e,p),f=new r(n,p);return h.addValidation(l(a,i)),f.addValidation(u(a)),h.onValidate(s),f.onValidate(s),function(e){d=t(e.currentTarget).val(),h.validate(),f.validate(),c(a,o)}}var h="cc-error",p=new o({errorClass:h}),f={},m={};return e(function(){function e(){var e=o.hasClass(h),t=!!r.val(),i=!!s.val(),a=s.find(":selected"),c=!!a.data("requiresStates"),d=!c||!!l.val(),p=!!a.data("requiresPostcode"),f=!p||!!u.val(),m=!e&&t&&i&&d&&f;n.trigger("billing-validation",{type:"address",isValid:m})}var n=t(".billing-form"),r=t("#billing-orgname"),o=t(".billing-address").find("input"),s=t("#billing-country"),l=t("#billing-state"),u=t("#billing-postcode"),p=s.attr("data-country-url"),f=s.attr("data-country-tax-url"),m=t.ajax({method:"get",dataType:"json",url:p});o.on("blur input",e),s.disable(!1),s.auiSelect2({placeholder:gettext("Select a country")}),m.done(function(t){var n=s.attr("data-initial-value");t.sort(a).forEach(function(e){e.displayName===n&&(n=e.countryIsoCode),s.append(i.toHtml("address-country-template",e))});var r=d(l,u,p,f,e);s.on("change",r),n&&(s.auiSelect2("val",n),c(function(){return n},f),r({currentTarget:s}),e())})})}),define("billing/credit-card",["underscore"],function(e){function t(t){return e.find(i,function(e){return t.match(e.iin)})}function n(e){for(var t=e.length,n=0,i=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]],r=0;t--;)r+=i[n][parseInt(e.charAt(t),10)],n^=1;return r%10===0&&r>0}var i=[{type:"VISA",iin:/^4/,length:[13,16]},{type:"MASTERCARD",iin:/^5[0-5]/,length:[16]},{type:"AMEX",iin:/^(34|37)/,length:[15]}];return{types:i,luhnCheck:n,getType:t}}),define("billing/credit-card-validation",["on-ready","jquery","underscore","billing/credit-card","utils/validation/validated-field","utils/validation/decorators/aui-form"],function(e,t,n,i,r,o){function s(e){var t=/^\d{3,}[Xx]{4,}\d{4}$/;return t.test(e)}function a(e,t){var n=/^\d+$/.test(e);return s(e)?t.pass():void t.passWhen(n,gettext("Numbers only"))}function l(e,t){var o=new r(e,d),l=gettext("Invalid card number");o.addValidation(a),o.addValidation(function(e,t){var r=i.getType(e);if(!r)return t.fail(l);var o=r.length;t.passWhen(n.contains(o,e.length),l)}),o.addValidation(function(e,t){if(s(e))return t.pass();var n=i.luhnCheck(e);t.passWhen(n,l)}),o.onValidate(t),o.validate()}function u(e,t,n){var i=new Date,o=new r(t,d);o.addValidation(a),o.addValidation(function(t,n){var r=parseInt(t,10),o=e.val(),s=parseInt(o,10);if(t.length<3&&(r+=2e3),!s||!r||1>s||s>12)return n.fail(gettext("Invalid date"));var a=r>i.getFullYear(),l=r==i.getFullYear()&&s>i.getMonth();n.passWhen(a||l,gettext("Card is expired"))}),e.on("blur",o.validate),o.onValidate(n),o.validate()}var c="cc-error",d=new o({errorClass:c});return e(function(){function e(){var e=[r,o,s,a],t=n.any(e,function(e){return""===e.val()||e.hasClass(c)});i.trigger("billing-validation",{type:"creditCard",isValid:!t})}var i=t(".billing-form"),r=t(".cc-number"),o=t(".cc-exp-month"),s=t(".cc-exp-year"),a=t(".cc-name");l(r,e),u(o,s,e),a.on("input",e)})}),define("utils/check-task",["jquery"],function(e){var t=function(n,i){return i=i||e.Deferred(),e.ajax({type:"GET",url:n,dataType:"json",cache:!1}).done(function(e){e.error?i.reject(e.error,e):e.complete?i.resolve(e.url,e):(i.notify(e),setTimeout(function(){t(n,i)},1e3))}).fail(function(){i.reject("An unexpected error occurred.")}),i.done(function(e){e&&setTimeout(function(){window.location=e},0)}),i.promise()};return t}),define("utils/message-helper",[],function(){var e="bb-messages",t="|";return{addMessage:function(n,i){sessionStorage&&(i=i||"success",n=n+t+i,sessionStorage.setItem(e,n))},getMessage:function(){var n=null;if(sessionStorage){var i=sessionStorage.getItem(e);if(sessionStorage.removeItem(e),i){var r=i.split(t);n={body:r[0],type:r[1]}}}return n}}}),define("billing/submit-card",["on-ready","jquery","utils/check-task","utils/message-helper","utils/disable","utils/loading"],function(e,t,n,i){return e(function(){var e,r=t(".billing-form"),o=r.find(".error.aui-message"),s=r.attr("data-next-url");t(document).on("paymentDetailsLoaded",function(t,a){var l=r.attr("data-check-task-url").format(a.payload);"process"===a.action?n(l).done(function(){e.resolve(),r.data("isUpgrade")?i.addMessage(gettext("Your billing details have been updated"),"success"):i.addMessage(gettext("Your plan has been changed"),"success"),window.location.href=s}).fail(function(e){i.addMessage(e,"error"),window.location.reload(!0)}):"error"===a.action?(o.find(".error-text").text(a.payload),o.removeClass("hidden"),e.reject()):"reload"===a.action&&window.location.reload(!0)});var a=r.find("[type=submit]"),l={creditCard:!1,address:!1};r.on("billing-validation",function(e,t){l[t.type]=t.isValid,a.disable(!l.creditCard||!l.address)}),a.on("click",function(){e=new t.Deferred,a.loading(e)})})}),define("utils/compare-branches",[],function(){return function(e,t){return e.mainbranch&&!t.mainbranch?-1:!e.mainbranch&&t.mainbranch?1:e.name>t.name?1:e.name<t.name?-1:0}}),define("utils/format-select2-with-title-text",["underscore"],function(e){return function(t,n){return n.attr("title",t.text),e.escape(t.text)}}),define("branches/create",["aui","jquery","underscore","on-ready","utils/query-params","utils/compare-branches","utils/format-select2-with-title-text"],function(e,t,n,i,r,o,s){return i(function(){function e(e){return e.trim().replace(/[^\w\s\./-]/g,"").replace(/\/\/+/g,"/").replace(/\/$/g,"").replace(/^\//g,"").replace(/\s+/g,"-")}function i(){var t=p.val().trim(),n=e(f.val());t?(m.find(".branch-lozenge.source").removeClass("hidden").find(".name").text(t),n?(m.removeClass("disabled").find(".branch-lozenge.target").removeClass("hidden").find(".name").text(n),g.removeAttr("disabled aria-disabled")):(m.addClass("disabled"),m.find(".branch-lozenge.target").addClass("hidden"),g.attr({disabled:!0,"aria-disabled":!0}))):(m.addClass("disabled").find(".branch-lozenge").addClass("hidden"),g.attr({disabled:!0,"aria-disabled":!0}))}function a(e){var n=t(e.target),i=n.find("option:selected").text(),r="/!api/1.0/repositories/{0}/branches-tags".format(i);p.empty().append(t("<option>Loading&hellip;</option>").val(" ")).prop({disabled:!0,"aria-disabled":!0}).trigger("change"),t.getJSON(r).success(function(e){var n=e.branches.sort(o);p.empty();for(var i=0,r=n.length;r>i;i++)p.append(t("<option></option>").text(n[i].name).val(n[i].name));n.length?p.prop({disabled:!1,"aria-disabled":!1}).trigger("change").auiSelect2("enable",!0):p.append(t("<option></option>").text("No branches found").val(" ")).prop({disabled:!0,"aria-disabled":!0}).trigger("change")}).error(function(){p.empty().append(t("<option></option>").text("Could not load branches").val(" ")).prop({disabled:!0,"aria-disabled":!0}).trigger("change")})}function l(e){window.history.length>1&&(e.preventDefault(),window.history.back())}function u(e){e&&w&&h.val(w)}function c(){localStorage&&localStorage.setItem(b,h.val())}var d=t("#create-branch-form"),h=t("#id_repository"),p=t("#branch-dropdown"),f=t("#id_branch_name"),m=d.find(".branch-diagram"),g=d.find("button.submit"),v=r.get("issueKey"),y=v&&v.split("-")[0],b="bb-jira-repo-map-"+y,w=localStorage&&localStorage.getItem(b);u(y),f.on("keyup input propertychange",n.debounce(i,200)),p.auiSelect2({formatResult:s,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide"}).on("change",i),h.auiSelect2({formatResult:s,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide"}).on("change",a).on("change",c).change(),d.find("a.cancel").on("click",l),d.submit(function(){f.val(e(f.val()))})})}),define("components/ace",["jquery","on-ready","data/current-user"],function(e,t,n){var i=document.charset||document.characterSet,r={host:"ace.atlassian.com",path:"/j/"};return t(function(t){var o,s={},a="{}//{}{}".format(window.location.protocol,r.host,r.path),l=t.attr("data-ace-zone");return n.username?(document.MAX_used=document.MAX_used||",",s.loc=window.location,i&&(s.charset=i),document.URL&&(s.referer=document.URL),document.context&&(s.context=document.context),s.zoneid=l,","!==document.MAX_used?s.exclude=document.MAX_used:s.exclude&&delete s.exclude,o="{}?{}".format(a,e.param(s)),void e.ajax({url:o,dataType:"jsonp",contentType:"application/json"}).done(function(n){function i(){r.contents().find("body").css("margin",0).append(n.html),r.contents().find("a").attr("target","_blank")}if(n.html){var r=e("<iframe></iframe>").attr({id:"ace-integration-{}".format(l),frameBorder:0,width:t.width()});t.html(r),i(),r.on("load",i)}t.removeClass("ace-integration")}).fail(function(){t.removeClass("ace-integration")})):void t.removeClass("ace-integration")})}),define("components/key-navigation",["jquery","data/client"],function(e,t){var n=function(n,i){function r(e){return{tab:9===e.which,enter:13===e.which,up:38===e.which,down:40===e.which,j:74===e.which,k:75===e.which,o:79===e.which,home:36===e.which,end:35===e.which}}function o(e,t){i.clear(),e.length&&(e.addClass("focused"),i.scroll(e,t))}function s(){var e=i.getFirstItem();o(e),n.trigger("navigate:first",e)}function a(){var e=i.getLastItem();o(e),n.trigger("navigate:last",e)}function l(){var e,t=i.getSelectedItem();t.length&&(e=i.getNextItem(t)),e&&e.length||(e=i.getFirstItem()),o(e),n.trigger("navigate:next",e)}function u(){var e,t=i.getSelectedItem();t.length&&(e=i.getPrevItem(t)),e&&e.length||(e=i.getLastItem()),o(e,!0),n.trigger("navigate:previous",e)}function c(){n.trigger("navigate:select",i.getSelectedItem())}var d={defaultAction:function(){},getNextItem:function(e){return e.next()},getPrevItem:function(e){return e.prev()},scroll:function(e){var t=e.offsetParent(),n=t.innerHeight(),i=e.position().top,r=i+e.innerHeight(),o=t.scrollTop();0>i?t.scrollTop(o+i):r>=n&&t.scrollTop(o+r-n)}};return i=e.extend({},d,i),n.on("keyup",function(e){var n=r(e),o="Mac"===t.os,d=o&&e.ctrlKey||!o&&e.altKey,h=n.up||n.k&&d||n.tab&&e.shiftKey,p=n.down||n.j&&d||n.tab&&!e.shiftKey,f=n.enter||n.o&&d,m=n.home,g=n.end;h?u():p?l():f?c():m?s():g?a():i.defaultAction(e)}),{next:l,prev:u,first:s,last:a,select:c}},i=function(t,i,r){var o={getSelectedItem:function(){return i.find(".active-pane .filter-item.focused")},getFirstItem:function(){return i.find(".active-pane .filter-item a:visible").first().parent()},getLastItem:function(){return i.find(".active-pane .filter-item a:visible").last().parent()},getNextItem:function(e){return e.nextAll().find("a:visible").first().parent()},getPrevItem:function(e){return e.prevAll().find("a:visible").first().parent()},clear:function(){i.find(".active-pane .focused").removeClass("focused")}};return t.on("navigate:select",function(t,n){var i=e(n),r=i.find("a");r.length&&r[0].click()}),n(t,e.extend({},o,r))};return{keyNavigation:n,tabbedFilter:i}}),define("utils/repo-filter",["underscore"],function(e){function t(e){return e.replace(n,"\\$&")}var n=/[-[\]{}()*+?.,\\^$|#\s]/g;return{getRegExp:function(e){var n=e.split(/[\/\s]/),i=n.map(t),r=i.join(".*[\\/\\s].*");return new RegExp(r,"i")},filterList:function(t,n){var i=this.getRegExp(n);return e.filter(t,function(e){return e.fullSlug.match(i)})}}}),define("utils/filter",["jquery","utils/repo-filter"],function(e,t){return function(n,i,r){function o(){n.toggleClass("empty",!s.$items.filter(":visible").length)}r=e.extend({delay:200},r);var s={};return{handler:function(a){function l(){function i(t,n){return e(n).text().match(r)}if(u.val()==c){n.trigger("filter",c);var r=t.getRegExp(c);s.$items.addClass("hidden"),s.$items.filter(i).removeClass("hidden"),o()}}var u=e(a.target),c=u.val();return s.$items=s.$items||n.find(i),s.val===c?void o():(s.val=c,void setTimeout(l,r.delay))},update:function(){s.$items=n.find(i),o()}}}}),define("utils/quick-filter",["jquery","utils/filter"],function(e,t){return function(n,i){function r(e){var n=e.find("input.filter-box"),r=t(e,".filter-item a",i);n.bind("keyup input propertychange",r.handler),n.val()&&n.trigger("input")}i=e.extend({delay:200},i),r(n)}}),define("components/tabbed-filter",["jquery","utils/quick-filter"],function(e,t){return function(n){function i(t){var n=e(t.target).closest("a"),i=n.closest("div.tabbed-filter-widget"),r=n.closest("div.filter-tabs"),o=i.find("input.filter-box"),s=n.attr("href").substring(1),a=i.find("#"+s),l=a.data("filter-placeholder");t.preventDefault(),r.find("li.active-tab").removeClass("active-tab"),n.closest("li").addClass("active-tab"),i.find(".tab-pane.active-pane").removeClass("active-pane"),a.addClass("active-pane"),o.attr("placeholder",l),o.val()&&o.val()!==o.attr("placeholder")&&o.trigger("input")}function r(e){e.on("click",".filter-tabs li.menu-item a",i),t(e)}r(n)}}),define("components/branch-dialog",["aui","jquery","on-ready","js/global/events","components/key-navigation","components/tabbed-filter","utils/compare-branches","utils/mustache"],function(e,t,n,i,r,o,s,a){return n(function(){function n(e,n,u){if(!e.find(".branch-dialog").length){e.addClass("loading");var c=function(e){return t.each(e,function(n,i){e[n].safeName=encodeURIComponent(i.name),i.heads&&i.heads.length>1&&(e[n].hasMultipleHeads=!0),e[n].hasMultipleHeads&&t.each(i.heads,function(t,i){e[n].heads[t]={changeset:i,shortChangeset:i.slice(0,7)}})}),e};t.getJSON(l.data("branches-tags-url")).success(function(n){n.branches=c(n.branches),n.branches.sort(s),l.data("ignoreTags")?n.ignoreTags=!0:(n.tags=c(n.tags),n.ignoreTags=!1);var u="branch-dialog-template";a.clear(u),e.removeClass("loading").html(a.toHtml(u,n)),e.on("click",".filter-list a",function(e){i.vent.trigger("branchDialog:click",e)}),o(e.find(".tabbed-filter-widget")),t(document).trigger("branchDialogReady");var d=e.find("input.filter-box");d.focus(),r.tabbedFilter(d,e)}).error(function(){e.removeClass("loading").addClass("load-error").text(gettext("Unable to load branches and tags"))})}u&&u(),setTimeout(function(){e.find("input.filter-box").focus()},0)}var l=t(".branch-dialog-trigger"),u=e.InlineDialog(l,"branch-dialog",n,{hideDelay:null});i.commands.setHandler("branchDialog:hide",function(){u.hide()})})}),define("components/chosen-user-avatar",["jquery","underscore","on-ready"],function(e,t,n){return n(function(){var n=e(".user-select");n.length&&(e('<style type="text/css">').appendTo("head"),n.find("select option").each(function(){var n=e(this).val(),i=e(this).data("avatar"),r=['.user-select .chzn-container span[data-value="'+n+'"]:before','.user-select .chzn-container li[data-value="'+n+'"]:before'],o="background-image: url("+i+") !important;",s=document.styleSheets[document.styleSheets.length-1];t.each(r,function(e){s.insertRule?s.insertRule(e+"{"+o+"}",s.cssRules.length):s.addRule(e,o)})}))})}),define("components/clone/dialog-function-helper",["aui","jquery"],function(e,t){return function(n,i,r){return function(o){function s(t,n,r){var o=e.InlineDialog.current;a.appendTo(t).removeClass("hidden"),r(),setTimeout(function(){return o&&o.id===i?void e.InlineDialog.current.hide():void a.find("input").trigger("select")},0)}var a=t(n);e.InlineDialog(o,i,s,r)}}}),define("components/clone/close-dialog-helper",[],function(){function e(){return setTimeout(function(){t=!0},0),t}var t=!0;return{callback:e,setValue:function(e){"undefined"!=typeof e&&(t=e)}}}),define("components/clone/clone-dialog",["aui","jquery","on-ready","underscore","utils/dialog-positions","components/clone/dialog-function-helper","components/clone/close-dialog-helper"],function(e,t,n,i,r,o,s){var a={width:360,preHideCallback:s.callback,offsetY:r.sidebarOffsetY,arrowOffsetY:r.sidebarArrowOffsetY,calculatePositions:r.replaceExisting,useLiveEvents:!0};return n(function(e){var n=e.attr("id"),i="#"+(e.data("dialog-id")||"repo-clone-dialog"),r=e.data("popup-id")||"repo-clone-dialog",s=o(i,r,a);a.gravity=e.data("gravity")||"w",!e.selector&&n&&(e=t("#"+n)),s(e)})}),define("components/clone/clone-in-sourcetree",["jquery","on-ready","data/current-user"],function(e,t,n){return t(function(e){var t=e.attr("data-https-url"),i=e.attr("data-ssh-url");e.find("button").click(function(){window.location.href="sourcetree://cloneRepo/"+(n.isSshEnabled?i:t)})})}),define("components/clone/clone-wiki-contextual",["on-ready","components/clone/dialog-function-helper","components/clone/close-dialog-helper"],function(e,t,n){return e(t("#wiki-clone-dialog","clone-wiki-dialog",{preHideCallback:n.callback}))}),define("components/clone/url-dropdown",["aui","jquery","on-ready","data/current-user","components/clone/close-dialog-helper"],function(e,t,n,i,r){return n(function(e){function n(t){o.attr("href",t.attr("href")),o.find(".dropdown-text").text(t.text()),s.val(t.attr("data-command")),t.hasClass("ssh")?e.addClass("ssh"):e.removeClass("ssh")}var o=e.find(".aui-dropdown2-trigger"),s=e.find("input"),a={onItemClicked:function(){r.setValue(!1)}};e.find("a.item-link").click(function(e){e.preventDefault(),n(t(this)),s.select(),a.onItemClicked&&a.onItemClicked()}),i.isSshEnabled&&n(e.find("a.item-link.ssh")),s.focus(function(){var e=t(this);e.one("mouseup",function(e){e.preventDefault()}),e.select()})})}),define("components/branch-selector",["jquery"],function(e){return function(t,n){function i(){var i=n.filter('[data-repo="{0}"]'.format(t.val()));n.each(function(){e(this).removeAttr("name").findWidget().hide()}),i.attr({name:i.attr("data-field")}).findWidget().show(),i.trigger("bb:branch:change")}e.fn.findWidget=function(){var e=this.auiSelect2("container");return e.hasClass("select2-container")?e:this},t.on("change",function(){e(this).trigger("bb:repo:change")}),n.on("change",function(){e(this).trigger("bb:branch:change")}),t.on("bb:repo:change",i),t.auiSelect2(),n.auiSelect2()}}),define("components/merge-dialog",["jquery","components/form-dialog","utils/check-task"],function(e,t,n){return function(i,r){r=e.extend({getData:function(){},success:function(e){window.location=e},width:700},r),new t(i,{success:function(e,t){t.result?r.success.call(this,t.result):t.error?this.error(t.error,t):setTimeout(function(){n(t.url).done(r.success.bind(this)).fail(this.error.bind(this))}.bind(this),1e3)},error:function(e,t){if(this.complete_(),t.conflicts&&r.conflictUrl)var n=gettext("View the conflicts");e+=' <a href="{}">{}</a>.'.format(r.conflictUrl,_.escape(n)),this.displayError({title:gettext("Unable to merge"),body:e,closeable:!1})},complete:function(){},onUpdateContents:function(e){var t=e.popup.element,n=-(new Date).getTimezoneOffset(),i=t.find("form").data("hasConflicts");t.find('input[name="tzoffset"]').val(n),i&&(t.find(".dialog-button-panel").empty(),e.addCancel(gettext("Close"),function(e){e.hide()}))},id:r.id,template:"merge-form-template",templateData:r.getData,width:r.width}).bind()}}),define("js/pullrequests/models/task",["backbone"],function(e){return e.Model.extend({defaults:{completed:!1,content:""},toJSON:function(){var e={content:{raw:this.get("content")},comment:{id:this.get("comment").id,path:this.get("comment").path},completed:this.get("completed"),creator:this.get("creator"),state:this.get("completed")?"RESOLVED":"UNRESOLVED"};return this.id&&(e.id=this.id),e},parse:function(e){return{completed:"RESOLVED"===e.state,content:e.content.raw,creator:e.creator,comment:{id:e.comment.id,path:e.comment.inline&&e.comment.inline.path},id:e.id}}})}),define("components/comments/comment",["jquery","backbone","js/pullrequests/models/task","data/current-user"],function(e,t,n,i){return t.Model.extend({initialize:function(e,t){this.urlRoot=t.urlRoot},idAttribute:"comment_id",parse:function(t){return t.isAuthenticated=i.isAuthenticated,t.isEditable=t.username===i.username,t.isAdmin="admin"===e("#user-repo-privilege-data").data().priv,t.utc_created_on=t.utc_created_on.replace(" ","T"),t.convert_markup="True"===t.convert_markup,t.show_tasks=!!t.pull_request_id,t.allow_task_creation=e("#pullrequest").data("allow-task-creation"),t}})}),define("components/drop-target",[],function(){return function(e,t){t=t||{},t.onDrop=t.onDrop||function(){},t.canDrop=t.canDrop||function(){return!0},e.on("dragover dragenter",function(n){t.canDrop(n)&&(e.addClass("file-hover"),n.preventDefault(),n.stopPropagation())}),e.on("dragend dragleave",function(n){t.canDrop(n)&&(e.removeClass("file-hover"),n.preventDefault(),n.stopPropagation())}),e.on("drop",function(n){t.canDrop(n)&&(e.removeClass("file-hover"),t.onDrop(n),n.preventDefault(),n.stopPropagation())})}}),define("utils/feature-detects/has-file-reader",[],function(){return!!window.FileReader}),define("utils/feature-detects/has-ajax-upload",[],function(){return"upload"in new XMLHttpRequest}),define("utils/feature-detects/has-drag-and-drop",[],function(){return"draggable"in document.createElement("span")}),define("components/upload-handler",["jquery","components/drop-target","utils/feature-detects/has-file-reader","utils/feature-detects/has-ajax-upload","utils/feature-detects/has-drag-and-drop"],function(e,t,n,i,r){return function(o,s){function a(e){if(e.lengthComputable){var t=Math.round(100*e.loaded/e.total);c(t.toString())}}function l(t){var n=e('<div class="upload-progress-container"></div>');return e('<div class="progress-bar"><div class="progress"></div></div>').appendTo(n),e('<div class="filename"></div>').text(t).appendTo(n),n}function u(){var e=o.parent();e.toggleClass("hidden"),l(y.name).insertAfter(e),b.find(".error-container").empty()}function c(e){b.find(".progress-bar .progress").css("width",(e||0)+"%")}function d(){o.parent().removeClass("hidden"),b.find(".upload-progress-container").remove()}function h(t){var n=b.find(".error-container");n.length||(n=e('<div class="error-container"></div>').insertBefore(o.parent())),d(),n.empty().text(t)}function p(e){d(),s.complete&&s.complete(e.target)}function f(e){s.error&&s.error(e.target),h("There was an error attempting to upload the file.")}function m(e){s.cancel&&s.cancel(e.target),h("The upload has been canceled by the user or the browser dropped the connection.")}function g(e){if(!y)return void e.preventDefault();var t=new XMLHttpRequest;if(t.upload){var n=o.parent();o.detach();var i=new FormData(b[0]);return n.append(o),i.append(o.attr("name"),y),u(),t.upload.addEventListener("progress",a,!1),t.addEventListener("load",p,!1),t.addEventListener("error",f,!1),t.addEventListener("abort",m,!1),t.open("POST",b.attr("action")),t.send(i),e.preventDefault(),!1}}function v(e){var t=e.originalEvent.dataTransfer,n=t.files;y=n[0],s.fileSelected&&s.fileSelected(y),s.uploadOnDrop&&g(e)}s=s||{};var y,b=o.closest("form"),w=s.$dropTarget||e();return n&&o.on("change",function(){y=o.prop("files")[0],s.fileSelected&&s.fileSelected(y)}),i&&b.on("submit",g),w.length&&r&&t(w,{canDrop:s.canSelect,onDrop:v}),{selectFile:function(e){y=e,s.fileSelected&&s.fileSelected(y)}}}}),define("utils/feature-detects/has-form-data",[],function(){return!!window.FormData}),define("utils/edit-content",["jquery"],function(){return function(e,t){t.removeClass("previewing"),e.removeAttr("aria-pressed")}}),define("utils/preview-content",["jquery","data/current-repo","utils/api-helper","utils/edit-content"],function(e,t,n,i){return function(r,o){if(r.attr("aria-pressed"))i(r,o);else{var s=setTimeout(function(){o.find(".mask").show()},300),a={content:o.find("textarea").val()};t.id&&(a.repo_id=t.id),a.markup_type=o.attr("data-markup-type"),e.ajax({type:"POST",url:n.toString("content-preview"),data:a,dataType:"json",success:function(e){o.addClass("previewing"),r.attr("aria-pressed",!0),o.find(".preview-container").html(e.markup),window.MathJax&&window.MathJax.Hub.Typeset(),clearTimeout(s),o.find(".mask").hide()},error:function(){alert("There was an error rendering your preview."),clearTimeout(s),o.find(".mask").hide()}})}}}),function(root){define("jquery-plugins/jquery.jeditable",["jquery"],function(){return function(){!function($){$.fn.editable=function(e,t){if("disable"==e)return void $(this).data("disabled.editable",!0);if("enable"==e)return void $(this).data("disabled.editable",!1);if("destroy"==e)return void $(this).unbind($(this).data("event.editable")).removeData("disabled.editable").removeData("event.editable");
var n=$.extend({},$.fn.editable.defaults,{target:e},t),i=$.editable.types[n.type].plugin||function(){},r=$.editable.types[n.type].submit||function(){},o=$.editable.types[n.type].buttons||$.editable.types.defaults.buttons,s=$.editable.types[n.type].content||$.editable.types.defaults.content,a=$.editable.types[n.type].element||$.editable.types.defaults.element,l=$.editable.types[n.type].reset||$.editable.types.defaults.reset,u=n.callback||function(){},c=n.onedit||function(){},d=n.onsubmit||function(){},h=n.onreset||function(){},p=n.onerror||l;return n.tooltip&&$(this).attr("title",n.tooltip),n.autowidth="auto"==n.width,n.autoheight="auto"==n.height,this.each(function(){var e=this,t=$(e).width(),f=$(e).height();$(this).data("event.editable",n.event),$.trim($(this).html())||$(this).html(n.placeholder),$(this).bind(n.event,function(h){if(!0!==$(this).data("disabled.editable")&&!e.editing&&!1!==c.apply(this,[n,e])){h.preventDefault(),h.stopPropagation(),n.tooltip&&$(e).removeAttr("title"),0==$(e).width()?(n.width=t,n.height=f):("none"!=n.width&&(n.width=n.autowidth?$(e).width():n.width),"none"!=n.height&&(n.height=n.autoheight?$(e).height():n.height)),$(this).html().toLowerCase().replace(/(;|"|\/)/g,"")==n.placeholder.toLowerCase().replace(/(;|"|\/)/g,"")&&$(this).html(""),e.editing=!0,e.revert=$(e).html(),$(e).html("");var m=$("<form />");n.cssclass&&("inherit"==n.cssclass?m.attr("class",$(e).attr("class")):m.attr("class",n.cssclass)),n.style&&("inherit"==n.style?(m.attr("style",$(e).attr("style")),m.css("display",$(e).css("display"))):m.attr("style",n.style));var g,v=a.apply(m,[n,e]);if(n.loadurl){var y=setTimeout(function(){v.disabled=!0,s.apply(m,[n.loadtext,n,e])},100),b={};b[n.id]=e.id,$.isFunction(n.loaddata)?$.extend(b,n.loaddata.apply(e,[e.revert,n])):$.extend(b,n.loaddata),$.ajax({type:n.loadtype,url:n.loadurl,data:b,async:!1,success:function(e){window.clearTimeout(y),g=e,v.disabled=!1}})}else n.data?(g=n.data,$.isFunction(n.data)&&(g=n.data.apply(e,[e.revert,n]))):g=e.revert;s.apply(m,[g,n,e]),v.attr("name",n.name),o.apply(m,[n,e]),$(e).append(m),i.apply(m,[n,e]),$(":input:visible:enabled:first",m).focus(),n.select&&v.select(),v.keydown(function(t){27==t.keyCode&&(t.preventDefault(),l.apply(m,[n,e]))});var y;v.blur("cancel"==n.onblur?function(){y=setTimeout(function(){l.apply(m,[n,e])},500)}:"submit"==n.onblur?function(){y=setTimeout(function(){m.submit()},200)}:$.isFunction(n.onblur)?function(){n.onblur.apply(e,[v.val(),n])}:function(){}),m.submit(function(t){if(y&&clearTimeout(y),t.preventDefault(),!1!==d.apply(m,[n,e])&&!1!==r.apply(m,[n,e]))if($.isFunction(n.target)){var i=n.target.apply(e,[v.val(),n]);$(e).html(i),e.editing=!1,u.apply(e,[e.innerHTML,n]),$.trim($(e).html())||$(e).html(n.placeholder)}else{var o={};o[n.name]=v.val(),o[n.id]=e.id,$.isFunction(n.submitdata)?$.extend(o,n.submitdata.apply(e,[e.revert,n])):$.extend(o,n.submitdata),"PUT"==n.method&&(o._method="put"),$(e).html(n.indicator);var s={type:"POST",data:o,dataType:"html",url:n.target,success:function(t){"html"==s.dataType&&$(e).html(t),e.editing=!1,u.apply(e,[t,n]),$.trim($(e).html())||$(e).html(n.placeholder)},error:function(t){p.apply(m,[n,e,t])}};$.extend(s,n.ajaxoptions),$.ajax(s)}return $(e).attr("title",n.tooltip),!1})}}),this.reset=function(t){this.editing&&!1!==h.apply(t,[n,e])&&($(e).html(e.revert),e.editing=!1,$.trim($(e).html())||$(e).html(n.placeholder),n.tooltip&&$(e).attr("title",n.tooltip))}})},$.editable={types:{defaults:{element:function(){var e=$('<input type="hidden"></input>');return $(this).append(e),e},content:function(e){$(":input:first",this).val(e)},reset:function(e,t){t.reset(this)},buttons:function(e,t){var n=this;if(e.submit){if(e.submit.match(/>$/))var i=$(e.submit).click(function(){"submit"!=i.attr("type")&&n.submit()});else{var i=$('<button type="submit" />');i.html(e.submit)}$(this).append(i)}if(e.cancel){if(e.cancel.match(/>$/))var r=$(e.cancel);else{var r=$('<button type="cancel" />');r.html(e.cancel)}$(this).append(r),$(r).click(function(){if($.isFunction($.editable.types[e.type].reset))var i=$.editable.types[e.type].reset;else var i=$.editable.types.defaults.reset;return i.apply(n,[e,t]),!1})}}},text:{element:function(e){var t=$("<input />");return"none"!=e.width&&t.width(e.width),"none"!=e.height&&t.height(e.height),t.attr("autocomplete","off"),$(this).append(t),t}},textarea:{element:function(e){var t=$("<textarea />");return e.rows?t.attr("rows",e.rows):"none"!=e.height&&t.height(e.height),e.cols?t.attr("cols",e.cols):"none"!=e.width&&t.width(e.width),$(this).append(t),t}},select:{element:function(){var e=$("<select />");return $(this).append(e),e},content:function(data,settings,original){if(String==data.constructor)eval("var json = "+data);else var json=data;for(var key in json)if(json.hasOwnProperty(key)&&"selected"!=key){var option=$("<option />").val(key).append(json[key]);$("select",this).append(option)}if($("select",this).children().each(function(){($(this).val()==json.selected||$(this).text()==$.trim(original.revert))&&$(this).attr("selected","selected")}),!settings.submit){var form=this;$("select",this).change(function(){form.submit()})}}}},addInputType:function(e,t){$.editable.types[e]=t}},$.fn.editable.defaults={name:"value",id:"id",type:"text",width:"auto",height:"auto",event:"click.editable",onblur:"cancel",loadtype:"GET",loadtext:"Loading...",placeholder:"Click to edit",loaddata:{},submitdata:{},ajaxoptions:{}}}(jQuery)}.apply(root,arguments)})}(this),define("config/markitup",["jquery","aui","underscore","components/drop-target","components/upload-handler","data/current-repo","data/current-user","js/components/aui-dialog","utils/feature-detects/has-file-reader","utils/feature-detects/has-form-data","utils/mustache","utils/preview-content","jquery-plugins/jquery.jeditable"],function(e,t,n,i,r,o,s,a,l,u,c,d){function h(e,t,n){var i=Array(e+1).join(t.header);return{name:"Heading "+e,className:[t.classname,"heading-"+e,n].join(" "),openWith:i+" ",closeWith:" "+i,placeHolder:"Your title here..."}}function p(e){return{name:"Section",className:[e.classname,"heading-single","first","last"].join(" "),placeHolder:"Section",closeWith:function(t){var n=7;t.selection&&t.selection.length&&(n=t.selection.length);var i=Array(n+1).join(e.header);return"\n"+i+"\n"}}}function f(e,t,n){return{name:"Heading "+e,className:[t.classname,"heading-"+e,n].join(" "),openWith:"h"+e+". ",placeHolder:"Your title here..."}}function m(e){return{name:"Bold",className:[e.classname,"bold","first","separator"].join(" "),openWith:e.bold,closeWith:e.bold}}function g(e){return{name:"Italic",className:[e.classname,"italic","last"].join(" "),openWith:e.italic,closeWith:e.italic}}function v(e){return{name:"Bulleted list",className:[e.classname,"bulleted-list","first","separator"].join(" "),openWith:e.ul,multiline:!0}}function y(e){return{name:"Numeric list",className:[e.classname,"numeric-list","last"].join(" "),openWith:e.ol,multiline:!0}}function b(e){return{name:"Code",className:[e.classname,"code","first","last","separator"].join(" "),openBlockWith:e.codeOpenBlock,closeBlockWith:e.codeCloseBlock,openWith:e.codeOpen,closeWith:e.codeClose,multiline:!0}}function w(e,t,n,i){return i.unshift(e.classname),{name:t,className:i.join(" "),replaceWith:n}}function x(e){return{name:"Image",className:[e.classname,"image","last"].join(" "),replaceWith:S(e)}}function _(){return I||(I=C()),I}function k(e){var t=e.originalEvent.dataTransfer;return n.contains(t.types,"Files")}function C(){function t(){p.closest("form").submit()}function i(){g.hide(),p.val(""),s.remove(),d.removeClass("hidden error")}var o=e(c.toHtml("image-upload-template")),s=e("<img>").addClass("preview centered"),u=o.find(".drop-target"),d=u.find("p"),h=o.find(".click-target"),p=o.find(".file-target"),f=p.attr("accept").split(", "),m=r(p,{$dropTarget:u,complete:function(e){200===e.status?(i(),M(e)):e.status>=400&&e.status<500&&d.addClass("error").text(e.response)},canSelect:k,fileSelected:function(e){if(e){if(e.size>1048576)return d.addClass("error").removeClass("hidden").text(gettext("File cannot be larger than 1 MB.")),m.selectFile(null),void s.remove();if(!n.contains(f,e.type))return d.addClass("error").removeClass("hidden").text(gettext("Only images are allowed.")),m.selectFile(null),void s.remove();d.removeClass("error").addClass("hidden"),s.attr("src",window.URL.createObjectURL(e)),u.prepend(s)}}});l||(u.addClass("hidden"),p.removeClass("hidden")),h.on("click",function(e){e.preventDefault(),p.click()});var g=new a({id:"upload-image",width:450,height:"auto"});return g.addHeader("Upload image"),g.addPanel("main",o),g.addButton("Upload",t),g.addLink("Cancel",i,"left"),g.selectFile=m.selectFile,g}function S(e){return function(t){var n=t.textarea,i=n.selectionStart,r=n.selectionEnd,o=n.value.substring(i,r);M=function(t){var s=JSON.parse(t.response),a=e.customImage.replace("url",s.href).replace("name",o||s.filename);if(document.selection){var l=document.selection.createRange();l.text=a}else n.value=n.value.substring(0,i)+a+n.value.substring(r,n.value.length)},_().show()}}function $(){return{name:"Preview",className:"preview first last right no-icon",beforeInsert:function(t){var n=e(t.textarea),i=n.closest(".textarea-preview"),r=i.find(".markItUpHeader .markItUpButton.preview a");r.text(r.attr("aria-pressed")?"Preview":"Edit"),d(r,i)}}}function T(){return{name:"Language",className:"language first last right no-icon hidden",call:function(){e("#dropdown-wiki-lang ul").show()}}}function A(e,t){return{name:"Help",className:[e.classname,"help","first","last","right"].join(" "),call:function(){var e="https://confluence.atlassian.com/x/jIAuEg";t&&(e="https://confluence.atlassian.com/x/FA4zDQ"),window.open(e,"_blank")}}}function E(){return[h(1,N,"first"),h(2,N),h(3,N,"last"),m(N),g(N),v(N),y(N),b(N),w(N,"Link",N.link,["first","link"])]}function j(){return[h(1,O,"first"),h(2,O),h(3,O,"last"),m(O),g(O),v(O),y(O),b(O),w(O,"Link",O.link,["first","link"])]}function D(){return[p(L),m(L),g(L),v(L),y(L),b(L),w(L,"Link",L.link,["first","link"])]}function q(){return[f(1,H,"first"),f(2,H),f(3,H,"last"),m(H),g(H),v(H),y(H),b(H),w(H,"Link",H.link,["first","link"])]}function P(t,n){var r=[];return r=n.isWiki?r.concat(E(),j(),D(),q()):F[n.syntax](),u&&s.isAuthenticated?(r.push(x(N)),n.isWiki&&(r.push(x(O)),r.push(x(L)),r.push(x(H))),t.each(function(t,n){i(e(n),{canDrop:k,onDrop:function(e){var t=e.originalEvent.dataTransfer;_().selectFile(t.files[0]),S(N)({textarea:n})}})})):(r.push(w(N,"Image",N.image,["image","last"])),n.isWiki&&(r.push(w(O,"Image",O.image,["image","last"])),r.push(w(L,"Image",L.image,["image","last"])),r.push(w(H,"Image",H.image,["image","last"])))),r.push($()),n.isWiki&&r.push(T()),r.push(A(N,n.isWiki)),n.isWiki&&(r.push(A(O,!0)),r.push(A(L,!0)),r.push(A(H,!0))),r}e.fn.editable.defaults.placeholder="";var I,R=o.pygmentsLanguage||"python",M=function(){},N={classname:"markdown",header:"#",bold:"**",italic:"*",ul:"(!(* |!|*)!)",ol:"(!(1. |!|1.)!)",codeOpenBlock:"(!(\n```\n#![![Language:!:"+R+"]!]\n\n|!|<pre>)!)",codeCloseBlock:"\n```\n",link:function(e){var t=prompt(gettext("Link Text"),e.selection);if(null!=t){var n=prompt(gettext("Link URL"));if(null!=n)return"["+t+"]("+n+")"}},image:"![[![Image Alt Text]!]]([![Image URL]!])",customImage:"![name](url)"},O={classname:"creole",header:"=",bold:"**",italic:"//",ul:"(!(* |!|*)!)",ol:"(!(# |!|#)!)",codeOpenBlock:"(!({{{\n#![![Language:!:"+R+"]!]\n\n|!|<pre>)!)",codeCloseBlock:"(!(\n}}}|!|</pre>)!)",link:"[[[![Link URL]!]|[![Link Text]!]]]",image:"{{[![Image URL]!]|[![Image Title]!]}}",customImage:"{{url|name}}"},L={classname:"rest",header:"=",bold:"**",italic:"*",ul:"(!(* |!|*)!)",ol:"(!(#. |!|#.)!)",codeOpenBlock:"\n.. sourcecode:: [![Language:!:"+R+"]!]\n\n",codeOpen:"    ",codeCloseBlock:"\n",link:"`[![Link Text]!] <[![Link URL]!]>`_",image:".. image:: [![Image URL]!]\n   :alt: [![Image Alt Text]!]",customImage:".. image:: url\n   :alt: name"},H={classname:"textile",bold:"*",italic:"_",ul:"(!(* |!|*)!)",ol:"(!(# |!|#)!)",codeOpenBlock:"\npre. \n",codeCloseBlock:"\n",link:'"[![Link Text]!]":[![Link URL]!]',image:"![![Image URL]!]([![Image Title:!: ]!])!",customImage:"!url(title)!"},F={markdown:E,creole:j,rest:D,textile:q};return function(e){return e=e||{},e.syntax=e.syntax||"markdown",function(t){return{nameSpace:"markup-type-"+e.syntax,previewParserPath:"",resizeHandle:!1,onShiftEnter:{keepDefault:!1,replaceWith:"\n\n"},markupSet:P(t.element,e)}}}}),function(root){define("jquery-plugins/jquery.markitup",["jquery"],function(){return function(){!function($){$.fn.markItUp=function(settings,extraSettings){var method,params,options,ctrlKey,shiftKey,altKey;return ctrlKey=shiftKey=altKey=!1,"string"==typeof settings&&(method=settings,params=extraSettings),"function"==typeof settings&&(settings=settings({element:this})),options={id:"",nameSpace:"",root:"",previewHandler:!1,previewInWindow:"",previewInElement:"",previewAutoRefresh:!0,previewPosition:"after",previewTemplatePath:"~/templates/preview.html",previewParser:!1,previewParserPath:"",previewParserVar:"data",resizeHandle:!0,beforeInsert:"",afterInsert:"",onEnter:{},onShiftEnter:{},onCtrlEnter:{},onTab:{},preventShiftTab:!1,markupSet:[{}]},$.extend(options,settings,extraSettings),options.root||$("script").each(function(e,t){miuScript=$(t).get(0).src.match(/(.*)jquery\.markitup(\.pack)?\.js$/),null!==miuScript&&(options.root=miuScript[1])}),this.each(function(){function localize(e,t){return t?e.replace(/("|')~\//g,"$1"+options.root):e.replace(/^~\//,options.root)}function init(){id="",nameSpace="",options.id?id='id="'+options.id+'"':$$.attr("id")&&(id='id="markItUp'+$$.attr("id").substr(0,1).toUpperCase()+$$.attr("id").substr(1)+'"'),options.nameSpace&&(nameSpace='class="'+options.nameSpace+'"'),$$.wrap("<div "+nameSpace+"></div>"),$$.wrap("<div "+id+' class="markItUp"></div>'),$$.wrap('<div class="markItUpContainer"></div>'),$$.addClass("markItUpEditor"),header=$('<div class="markItUpHeader"></div>').insertBefore($$),$(dropMenus(options.markupSet)).appendTo(header),footer=$('<div class="markItUpFooter"></div>').insertAfter($$),options.resizeHandle===!0&&$.browser.safari!==!0&&(resizeHandle=$('<div class="markItUpResizeHandle"></div>').insertAfter($$).bind("mousedown.markItUp",function(e){var t,n,i=$$.height(),r=e.clientY;t=function(e){return $$.css("height",Math.max(20,e.clientY+i-r)+"px"),!1},n=function(){return $("html").unbind("mousemove.markItUp",t).unbind("mouseup.markItUp",n),!1},$("html").bind("mousemove.markItUp",t).bind("mouseup.markItUp",n)}),footer.append(resizeHandle)),$$.bind("keydown.markItUp",keyPressed).bind("keyup",keyPressed),$$.bind("insertion.markItUp",function(e,t){t.target!==!1&&get(),textarea===$.markItUp.focused&&markup(t)}),$$.bind("focus.markItUp",function(){$.markItUp.focused=this}),options.previewInElement&&refreshPreview()}function dropMenus(markupSet){var ul=$("<ul></ul>"),i=0;return $("li:hover > ul",ul).css("display","block"),$.each(markupSet,function(){var button=this,t="",title,li,j;if(title=button.key?(button.name||"")+" [Ctrl+"+button.key+"]":button.name||"",key=button.key?'accesskey="'+button.key+'"':"",button.separator)li=$('<li class="markItUpSeparator">'+(button.separator||"")+"</li>").appendTo(ul);else{for(i++,j=levels.length-1;j>=0;j--)t+=levels[j]+"-";li=$('<li class="markItUpButton '+(button.className||"")+'"><a href="" '+key+' title="'+title+'" tabindex="-1">'+(button.name||"")+"</a></li>").bind("contextmenu.markItUp",function(){return!1}).bind("mouseup.markItUp",function(e){e.preventDefault()}).bind("focusin.markItUp",function(){$$.focus()}).bind("click.markItUp",function(e){e.preventDefault(),button.call?eval(button.call)():setTimeout(function(){markup(button)},1)}).bind("mouseenter.markItUp",function(){$("> ul",this).show(),$(document).one("click",function(){$("ul ul",header).hide()})}).bind("mouseleave.markItUp",function(){$("> ul",this).hide()}).appendTo(ul),button.dropMenu&&(levels.push(i),$(li).addClass("markItUpDropMenu").append(dropMenus(button.dropMenu)))}}),levels.pop(),ul}function magicMarkups(e){if(e){e=e.toString(),e=e.replace(/\(\!\(([\s\S]*?)\)\!\)/g,function(e,t){var n=t.split("|!|");return altKey===!0?void 0!==n[1]?n[1]:n[0]:void 0===n[1]?"":n[0]});var t={};return e=e.replace(/\[\!\[([\s\S]*?)\]\!\]/g,function(e,n){var i=n.split(":!:"),r=i[0];return Object.prototype.hasOwnProperty.call(t,r)?t[r]:abort===!0?!1:(value=prompt(i[0],i[1]?i[1]:""),null===value&&(abort=!0),t[r]=value,value)})}return""}function prepare(e){return $.isFunction(e)&&(e=e(hash)),magicMarkups(e)}function build(e){var t=prepare(clicked.openWith),n=prepare(clicked.placeHolder),i=prepare(clicked.replaceWith),r=prepare(clicked.closeWith),o=prepare(clicked.openBlockWith),s=prepare(clicked.closeBlockWith),a=clicked.multiline;if(""!==i)block=t+i+r;else if(""===selection&&""!==n)block=t+n+r;else{e=e||selection;var l=[e],u=[];a===!0&&(l=e.split(/\r?\n/));for(var c=0;c<l.length;c++){line=l[c];var d;u.push((d=line.match(/ *$/))?t+line.replace(/ *$/g,"")+r+d:t+line+r)}block=u.join("\n")}return block=o+block+s,{block:block,openBlockWith:o,openWith:t,replaceWith:i,placeHolder:n,closeWith:r,closeBlockWith:s}}function markup(e){var t,n,i,r,o;if(hash=clicked=e,get(),$.extend(hash,{line:"",root:options.root,textarea:textarea,selection:selection||"",caretPosition:caretPosition,ctrlKey:ctrlKey,shiftKey:shiftKey,altKey:altKey}),prepare(options.beforeInsert),prepare(clicked.beforeInsert),(ctrlKey===!0&&shiftKey===!0||e.multiline===!0)&&prepare(clicked.beforeMultiInsert),$.extend(hash,{line:1}),ctrlKey===!0&&shiftKey===!0){for(lines=selection.split(/\r?\n/),n=0,i=lines.length,r=0;i>r;r++)""!==$.trim(lines[r])?($.extend(hash,{line:++n,selection:lines[r]}),lines[r]=build(lines[r]).block):lines[r]="";string={block:lines.join("\n")},o=caretPosition,t=string.block.length+($.browser.opera?i-1:0)}else ctrlKey===!0?(string=build(selection),o=caretPosition+string.openWith.length,t=string.block.length-string.openWith.length-string.closeWith.length,t-=string.block.match(/ $/)?1:0,t-=fixIeBug(string.block)):shiftKey===!0?(string=build(selection),o=caretPosition,t=string.block.length,t-=fixIeBug(string.block)):(string=build(selection),o=caretPosition+string.block.length,t=0,o-=fixIeBug(string.block));""===selection&&""===string.replaceWith&&(caretOffset+=fixOperaBug(string.block),o=caretPosition+string.openBlockWith.length+string.openWith.length,t=string.block.length-string.openWith.length-string.closeWith.length-string.closeBlockWith.length-string.openBlockWith.length,caretOffset=$$.val().substring(caretPosition,$$.val().length).length,caretOffset-=fixOperaBug($$.val().substring(0,caretPosition))),$.extend(hash,{caretPosition:caretPosition,scrollPosition:scrollPosition}),string.block!==selection&&abort===!1?(insert(string.block),set(o,t)):caretOffset=-1,get(),$.extend(hash,{line:"",selection:selection}),(ctrlKey===!0&&shiftKey===!0||e.multiline===!0)&&prepare(clicked.afterMultiInsert),prepare(clicked.afterInsert),prepare(options.afterInsert),previewWindow&&options.previewAutoRefresh&&refreshPreview(),shiftKey=altKey=ctrlKey=abort=!1}function fixOperaBug(e){return $.browser.opera?e.length-e.replace(/\n*/g,"").length:0}function fixIeBug(e){return $.browser.msie?e.length-e.replace(/\r*/g,"").length:0}function insert(e){if(document.selection){var t=document.selection.createRange();t.text=e}else textarea.value=textarea.value.substring(0,caretPosition)+e+textarea.value.substring(caretPosition+selection.length,textarea.value.length)}function set(e,t){if(textarea.createTextRange){if($.browser.opera&&$.browser.version>=9.5&&0==t)return!1;range=textarea.createTextRange(),range.collapse(!0),range.moveStart("character",e),range.moveEnd("character",t),range.select()}else textarea.setSelectionRange&&textarea.setSelectionRange(e,e+t);textarea.scrollTop=scrollPosition,textarea.focus()}function get(){if(textarea.focus(),scrollPosition=textarea.scrollTop,document.selection)if(selection=document.selection.createRange().text,$.browser.msie){var e=document.selection.createRange(),t=e.duplicate();for(t.moveToElementText(textarea),caretPosition=-1;t.inRange(e);)t.moveStart("character"),caretPosition++}else caretPosition=textarea.selectionStart;else caretPosition=textarea.selectionStart,selection=textarea.value.substring(caretPosition,textarea.selectionEnd);return selection}function preview(){"function"==typeof options.previewHandler?previewWindow=!0:options.previewInElement?previewWindow=$(options.previewInElement):!previewWindow||previewWindow.closed?options.previewInWindow?(previewWindow=window.open("","preview",options.previewInWindow),$(window).unload(function(){previewWindow.close()})):(iFrame=$('<iframe class="markItUpPreviewFrame"></iframe>'),"after"==options.previewPosition?iFrame.insertAfter(footer):iFrame.insertBefore(header),previewWindow=iFrame[iFrame.length-1].contentWindow||frame[iFrame.length-1]):altKey===!0&&(iFrame?iFrame.remove():previewWindow.close(),previewWindow=iFrame=!1),options.previewAutoRefresh||refreshPreview(),options.previewInWindow&&previewWindow.focus()}function refreshPreview(){renderPreview()}function renderPreview(){if(options.previewHandler&&"function"==typeof options.previewHandler)options.previewHandler($$.val());else if(options.previewParser&&"function"==typeof options.previewParser){var e=options.previewParser($$.val());writeInPreview(localize(e,1))}else""!==options.previewParserPath?$.ajax({type:"POST",dataType:"text",global:!1,url:options.previewParserPath,data:options.previewParserVar+"="+encodeURIComponent($$.val()),success:function(e){writeInPreview(localize(e,1))}}):template||$.ajax({url:options.previewTemplatePath,dataType:"text",global:!1,success:function(e){writeInPreview(localize(e,1).replace(/<!-- content -->/g,$$.val()))}});return!1}function writeInPreview(e){if(options.previewInElement)$(options.previewInElement).html(e);else if(previewWindow&&previewWindow.document){try{sp=previewWindow.document.documentElement.scrollTop}catch(t){sp=0}previewWindow.document.open(),previewWindow.document.write(e),previewWindow.document.close(),previewWindow.document.documentElement.scrollTop=sp}}function keyPressed(e){if(shiftKey=e.shiftKey,altKey=e.altKey,ctrlKey=e.altKey&&e.ctrlKey?!1:e.ctrlKey||e.metaKey,"keydown"===e.type){if(ctrlKey===!0&&(li=$('a[accesskey="'+(13==e.keyCode?"\\n":String.fromCharCode(e.keyCode))+'"]',header).parent("li"),0!==li.length))return ctrlKey=!1,setTimeout(function(){li.triggerHandler("mouseup")},1),!1;if(13===e.keyCode||10===e.keyCode)return ctrlKey===!0?(ctrlKey=!1,markup(options.onCtrlEnter),options.onCtrlEnter.keepDefault):shiftKey===!0?(shiftKey=!1,markup(options.onShiftEnter),options.onShiftEnter.keepDefault):(markup(options.onEnter),options.onEnter.keepDefault);if(9===e.keyCode)return!options.preventShiftTab||1!=shiftKey&&1!=ctrlKey&&1!=altKey?-1!==caretOffset?(get(),caretOffset=$$.val().length-caretOffset,console.log("caret offset"),set(caretOffset,0),caretOffset=-1,!1):(markup(options.onTab),options.onTab.keepDefault):!1}}function remove(){$$.unbind(".markItUp").removeClass("markItUpEditor"),$$.parent("div").parent("div.markItUp").parent("div").replaceWith($$),$$.data("markItUp",null)}var $$,textarea,levels,scrollPosition,caretPosition,caretOffset,clicked,hash,header,footer,previewWindow,template,iFrame,abort;if($$=$(this),textarea=this,levels=[],abort=!1,scrollPosition=caretPosition=0,caretOffset=-1,options.previewParserPath=localize(options.previewParserPath),options.previewTemplatePath=localize(options.previewTemplatePath),method)switch(method){case"remove":remove();break;case"insert":markup(params);break;default:$.error("Method "+method+" does not exist on jQuery.markItUp")}else init()})},$.fn.markItUpRemove=function(){return this.each(function(){$(this).markItUp("remove")})},$.markItUp=function(e){var t={target:!1};return $.extend(t,e),t.target?$(t.target).each(function(){$(this).focus(),$(this).trigger("insertion",[t])}):void $("textarea").trigger("insertion",[t])}}(jQuery)}.apply(root,arguments)})}(this),define("components/comments/comment-form",["jquery","data/current-user","config/markitup","utils/edit-content","utils/mustache","jquery-plugins/jquery.markitup"],function(e,t,n,i,r){var o=function(e){this.comment=e,this.$elem=null,this.$editor=null,this.$textarea=null,this.$submit=null,this.$cancel=null,this.$preview=null,this.$error=null,this.$convertMarkupWarning=null};return o.prototype.errorMessages={400:gettext("There was a problem submitting your comment."),403:gettext("You are not permitted to comment."),404:gettext("This comment has been deleted.")},o.prototype.decorate=function(e){return this.$elem=e,this.renderInternal(),this.enterDocument(),this},o.prototype.renderInternal=function(){this.$editor=this.$elem.find("form.editor"),this.$textarea=this.$editor.find("textarea"),this.$submit=this.$editor.find("button[type=submit]"),this.$cancel=this.$editor.find("a.cancel"),this.$preview=this.$editor.find("a.preview"),this.$error=this.$elem.find(".error"),this.$convertMarkupWarning=this.$elem.find(".convert-markup")},o.prototype.createDom=function(){var n=e.extend({user_avatar_url:t.avatarUrl,display_name:t.displayName},this.comment?this.comment.attributes:{});this.$elem=e(r.toHtml("new-comment-template",n))},o.prototype.render=function(e){return this.createDom(),this.renderInternal(),e.prepend(this.$elem),this.enterDocument(),this},o.prototype.enterDocument=function(){this.$textarea.on("focus",e.proxy(this.expandSize,this)),this.$submit.on("click keydown",e.proxy(this.save,this)),this.$cancel.on("click",e.proxy(this.cancel,this)),this.$preview.on("click",e.proxy(this.preview,this))},o.prototype.expandSize=function(){var e=this.$textarea;this.$editor.addClass("focused"),this.$textarea.hasClass("markItUpEditor")||(this.$editor.addClass("textarea-preview"),this.$textarea.markItUp(n()),setTimeout(function(){e.trigger("focus")},0))},o.prototype.shrinkSize=function(){this.$textarea.markItUpRemove(),this.$editor.removeClass("textarea-preview"),this.$editor.removeClass("focused")},o.prototype.cancel=function(t){t&&t.preventDefault(),this.clearContents(),i(this.$preview,this.$editor),this.shrinkSize(),e(this).trigger("comment-form/cancel")},o.prototype.clearContents=function(){this.$textarea.val(""),this.clearError()},o.prototype.showAndFocus=function(){this.$editor.show(),this.$elem.show(),this.$textarea.focus(),this.$convertMarkupWarning.toggle(this.comment.get("convert_markup"))},o.prototype.isSubmitDisabled=function(){return this.$submit.prop("disabled")},o.prototype.disableSubmit=function(){this.$submit.prop("disabled",!0).attr("aria-disabled","true")},o.prototype.enableSubmit=function(){this.$submit.prop("disabled",!1).removeAttr("aria-disabled")},o.prototype.save=function(e){if("keydown"!==e.type||13===e.keyCode){e.preventDefault();var t=this;if(!t.isSubmitDisabled()){var n=setTimeout(function(){t.clearError(),t.$editor.addClass("loading")},300);t.disableSubmit();var r=function(){clearTimeout(n),t.$editor.removeClass("loading"),t.enableSubmit(),i(t.$preview,t.$editor)};t.comment.save({content:t.$textarea.val()},{wait:!0,complete:r,error:function(e,n){t.displayError(t.errorMessages[n.status])}})}}},o.prototype.displayError=function(e){this.$error.text(e)},o.prototype.clearError=function(){this.$error.text("")},o}),function(e,t){if("function"==typeof define&&define.amd)define("marionette-lib",["backbone","underscore"],function(n,i){return e.Marionette=e.Mn=t(e,n,i)});else if("undefined"!=typeof exports){var n=require("backbone"),i=require("underscore");module.exports=t(e,n,i)}else e.Marionette=e.Mn=t(e,e.Backbone,e._)}(this,function(e,t,n){"use strict";!function(e,t){var n=e.ChildViewContainer;return e.ChildViewContainer=function(e,t){var n=function(e){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),t.each(e,this.add,this)};t.extend(n.prototype,{add:function(e,t){var n=e.cid;return this._views[n]=e,e.model&&(this._indexByModel[e.model.cid]=n),t&&(this._indexByCustom[t]=n),this._updateLength(),this},findByModel:function(e){return this.findByModelCid(e.cid)},findByModelCid:function(e){var t=this._indexByModel[e];return this.findByCid(t)},findByCustom:function(e){var t=this._indexByCustom[e];return this.findByCid(t)},findByIndex:function(e){return t.values(this._views)[e]},findByCid:function(e){return this._views[e]},remove:function(e){var n=e.cid;return e.model&&delete this._indexByModel[e.model.cid],t.any(this._indexByCustom,function(e,t){return e===n?(delete this._indexByCustom[t],!0):void 0},this),delete this._views[n],this._updateLength(),this},call:function(e){this.apply(e,t.tail(arguments))},apply:function(e,n){t.each(this._views,function(i){t.isFunction(i[e])&&i[e].apply(i,n||[])})},_updateLength:function(){this.length=t.size(this._views)}});var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck","reduce"];return t.each(i,function(e){n.prototype[e]=function(){var n=t.values(this._views),i=[n].concat(t.toArray(arguments));return t[e].apply(t,i)}}),n}(e,t),e.ChildViewContainer.VERSION="0.1.6",e.ChildViewContainer.noConflict=function(){return e.ChildViewContainer=n,this},e.ChildViewContainer}(t,n),function(e,t){var n=e.Wreqr,i=e.Wreqr={};return e.Wreqr.VERSION="1.3.1",e.Wreqr.noConflict=function(){return e.Wreqr=n,this},i.Handlers=function(e,t){var n=function(e){this.options=e,this._wreqrHandlers={},t.isFunction(this.initialize)&&this.initialize(e)};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events,{setHandlers:function(e){t.each(e,function(e,n){var i=null;t.isObject(e)&&!t.isFunction(e)&&(i=e.context,e=e.callback),this.setHandler(n,e,i)},this)},setHandler:function(e,t,n){var i={callback:t,context:n};this._wreqrHandlers[e]=i,this.trigger("handler:add",e,t,n)},hasHandler:function(e){return!!this._wreqrHandlers[e]},getHandler:function(e){var t=this._wreqrHandlers[e];if(t)return function(){var e=Array.prototype.slice.apply(arguments);return t.callback.apply(t.context,e)}},removeHandler:function(e){delete this._wreqrHandlers[e]},removeAllHandlers:function(){this._wreqrHandlers={}}}),n}(e,t),i.CommandStorage=function(){var n=function(e){this.options=e,this._commands={},t.isFunction(this.initialize)&&this.initialize(e)};return t.extend(n.prototype,e.Events,{getCommands:function(e){var t=this._commands[e];return t||(t={command:e,instances:[]},this._commands[e]=t),t},addCommand:function(e,t){var n=this.getCommands(e);n.instances.push(t)},clearCommands:function(e){var t=this.getCommands(e);t.instances=[]}}),n}(),i.Commands=function(e){return e.Handlers.extend({storageType:e.CommandStorage,constructor:function(t){this.options=t||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var n=Array.prototype.slice.call(arguments);e.Handlers.prototype.constructor.apply(this,n)},execute:function(e,t){e=arguments[0],t=Array.prototype.slice.call(arguments,1),this.hasHandler(e)?this.getHandler(e).apply(this,t):this.storage.addCommand(e,t)},_executeCommands:function(e,n,i){var r=this.storage.getCommands(e);t.each(r.instances,function(e){n.apply(i,e)}),this.storage.clearCommands(e)},_initializeStorage:function(e){var n,i=e.storageType||this.storageType;n=t.isFunction(i)?new i:i,this.storage=n}})}(i),i.RequestResponse=function(e){return e.Handlers.extend({request:function(){var e=arguments[0],t=Array.prototype.slice.call(arguments,1);return this.hasHandler(e)?this.getHandler(e).apply(this,t):void 0}})}(i),i.EventAggregator=function(e,t){var n=function(){};return n.extend=e.Model.extend,t.extend(n.prototype,e.Events),n}(e,t),i.Channel=function(){var n=function(t){this.vent=new e.Wreqr.EventAggregator,this.reqres=new e.Wreqr.RequestResponse,this.commands=new e.Wreqr.Commands,this.channelName=t};return t.extend(n.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this
},connectEvents:function(e,t){return this._connect("vent",e,t),this},connectCommands:function(e,t){return this._connect("commands",e,t),this},connectRequests:function(e,t){return this._connect("reqres",e,t),this},_connect:function(e,n,i){if(n){i=i||this;var r="vent"===e?"on":"setHandler";t.each(n,function(n,o){this[e][r](o,t.bind(n,i))},this)}}}),n}(i),i.radio=function(e){var n=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};t.extend(n.prototype,{channel:function(e){if(!e)throw new Error("Channel must receive a name");return this._getChannel(e)},_getChannel:function(t){var n=this._channels[t];return n||(n=new e.Channel(t),this._channels[t]=n),n},_proxyMethods:function(){t.each(["vent","commands","reqres"],function(e){t.each(i[e],function(t){this[e][t]=r(this,e,t)},this)},this)}});var i={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},r=function(e,t,n){return function(i){var r=e._getChannel(i)[t],o=Array.prototype.slice.call(arguments,1);return r[n].apply(r,o)}};return new n}(i),e.Wreqr}(t,n);var i=e.Marionette,r=e.Mn,o=t.Marionette={};o.VERSION="2.4.1",o.noConflict=function(){return e.Marionette=i,e.Mn=r,this},t.Marionette=o,o.Deferred=t.$.Deferred,o.extend=t.Model.extend,o.isNodeAttached=function(e){return t.$.contains(document.documentElement,e)},o.mergeOptions=function(e,t){e&&n.extend(this,n.pick(e,t))},o.getOption=function(e,t){return e&&t?e.options&&void 0!==e.options[t]?e.options[t]:e[t]:void 0},o.proxyGetOption=function(e){return o.getOption(this,e)},o._getValue=function(e,t,i){return n.isFunction(e)&&(e=i?e.apply(t,i):e.call(t)),e},o.normalizeMethods=function(e){return n.reduce(e,function(e,t,i){return n.isFunction(t)||(t=this[t]),t&&(e[i]=t),e},{},this)},o.normalizeUIString=function(e,t){return e.replace(/@ui\.[a-zA-Z_$0-9]*/g,function(e){return t[e.slice(4)]})},o.normalizeUIKeys=function(e,t){return n.reduce(e,function(e,n,i){var r=o.normalizeUIString(i,t);return e[r]=n,e},{})},o.normalizeUIValues=function(e,t,i){return n.each(e,function(r,s){n.isString(r)?e[s]=o.normalizeUIString(r,t):n.isObject(r)&&n.isArray(i)&&(n.extend(r,o.normalizeUIValues(n.pick(r,i),t)),n.each(i,function(e){var i=r[e];n.isString(i)&&(r[e]=o.normalizeUIString(i,t))}))}),e},o.actAsCollection=function(e,t){var i=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];n.each(i,function(i){e[i]=function(){var e=n.values(n.result(this,t)),r=[e].concat(n.toArray(arguments));return n[i].apply(n,r)}})};var s=o.deprecate=function(e,t){n.isObject(e)&&(e=e.prev+" is going to be removed in the future. Please use "+e.next+" instead."+(e.url?" See: "+e.url:"")),void 0!==t&&t||s._cache[e]||(s._warn("Deprecation warning: "+e),s._cache[e]=!0)};s._warn="undefined"!=typeof console&&(console.warn||console.log)||function(){},s._cache={},o._triggerMethod=function(){function e(e,t,n){return n.toUpperCase()}var t=/(^|:)(\w)/gi;return function(i,r,o){var s=arguments.length<3;s&&(o=r,r=o[0]);var a,l="on"+r.replace(t,e),u=i[l];return n.isFunction(u)&&(a=u.apply(i,s?n.rest(o):o)),n.isFunction(i.trigger)&&(s+o.length>1?i.trigger.apply(i,s?o:[r].concat(n.drop(o,0))):i.trigger(r)),a}}(),o.triggerMethod=function(){return o._triggerMethod(this,arguments)},o.triggerMethodOn=function(e){var t=n.isFunction(e.triggerMethod)?e.triggerMethod:o.triggerMethod;return t.apply(e,n.rest(arguments))},o.MonitorDOMRefresh=function(e){function t(){e._isShown=!0,r()}function i(){e._isRendered=!0,r()}function r(){e._isShown&&e._isRendered&&o.isNodeAttached(e.el)&&n.isFunction(e.triggerMethod)&&e.triggerMethod("dom:refresh")}e.on({show:t,render:i})},function(e){function t(t,i,r,o){var s=o.split(/\s+/);n.each(s,function(n){var o=t[n];if(!o)throw new e.Error('Method "'+n+'" was configured as an event handler, but does not exist.');t.listenTo(i,r,o)})}function i(e,t,n,i){e.listenTo(t,n,i)}function r(e,t,i,r){var o=r.split(/\s+/);n.each(o,function(n){var r=e[n];e.stopListening(t,i,r)})}function o(e,t,n,i){e.stopListening(t,n,i)}function s(t,i,r,o,s){if(i&&r){if(!n.isObject(r))throw new e.Error({message:"Bindings must be an object or function.",url:"marionette.functions.html#marionettebindentityevents"});r=e._getValue(r,t),n.each(r,function(e,r){n.isFunction(e)?o(t,i,r,e):s(t,i,r,e)})}}e.bindEntityEvents=function(e,n,r){s(e,n,r,i,t)},e.unbindEntityEvents=function(e,t,n){s(e,t,n,o,r)},e.proxyBindEntityEvents=function(t,n){return e.bindEntityEvents(this,t,n)},e.proxyUnbindEntityEvents=function(t,n){return e.unbindEntityEvents(this,t,n)}}(o);var a=["description","fileName","lineNumber","name","message","number"];return o.Error=o.extend.call(Error,{urlRoot:"http://marionettejs.com/docs/v"+o.VERSION+"/",constructor:function(e,t){n.isObject(e)?(t=e,e=t.message):t||(t={});var i=Error.call(this,e);n.extend(this,n.pick(i,a),n.pick(t,a)),this.captureStackTrace(),t.url&&(this.url=this.urlRoot+t.url)},captureStackTrace:function(){Error.captureStackTrace&&Error.captureStackTrace(this,o.Error)},toString:function(){return this.name+": "+this.message+(this.url?" See: "+this.url:"")}}),o.Error.extend=o.extend,o.Callbacks=function(){this._deferred=o.Deferred(),this._callbacks=[]},n.extend(o.Callbacks.prototype,{add:function(e,t){var i=n.result(this._deferred,"promise");this._callbacks.push({cb:e,ctx:t}),i.then(function(n){t&&(n.context=t),e.call(n.context,n.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var e=this._callbacks;this._deferred=o.Deferred(),this._callbacks=[],n.each(e,function(e){this.add(e.cb,e.ctx)},this)}}),o.Controller=function(e){this.options=e||{},n.isFunction(this.initialize)&&this.initialize(this.options)},o.Controller.extend=o.extend,n.extend(o.Controller.prototype,t.Events,{destroy:function(){return o._triggerMethod(this,"before:destroy",arguments),o._triggerMethod(this,"destroy",arguments),this.stopListening(),this.off(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption}),o.Object=function(e){this.options=n.extend({},n.result(this,"options"),e),this.initialize.apply(this,arguments)},o.Object.extend=o.extend,n.extend(o.Object.prototype,t.Events,{initialize:function(){},destroy:function(){return this.triggerMethod("before:destroy"),this.triggerMethod("destroy"),this.stopListening(),this},triggerMethod:o.triggerMethod,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Region=o.Object.extend({constructor:function(e){if(this.options=e||{},this.el=this.getOption("el"),this.el=this.el instanceof t.$?this.el[0]:this.el,!this.el)throw new o.Error({name:"NoElError",message:'An "el" must be specified for a region.'});this.$el=this.getEl(this.el),o.Object.call(this,e)},show:function(e,t){if(this._ensureElement()){this._ensureViewIsIntact(e);var n=t||{},i=e!==this.currentView,r=!!n.preventDestroy,s=!!n.forceShow,a=!!this.currentView,l=i&&!r,u=i||s;if(a&&this.triggerMethod("before:swapOut",this.currentView,this,t),this.currentView&&delete this.currentView._parent,l?this.empty():a&&u&&this.currentView.off("destroy",this.empty,this),u){e.once("destroy",this.empty,this),e.render(),e._parent=this,a&&this.triggerMethod("before:swap",e,this,t),this.triggerMethod("before:show",e,this,t),o.triggerMethodOn(e,"before:show",e,this,t),a&&this.triggerMethod("swapOut",this.currentView,this,t);var c=o.isNodeAttached(this.el),d=[],h=n.triggerBeforeAttach||this.triggerBeforeAttach,p=n.triggerAttach||this.triggerAttach;return c&&h&&(d=this._displayedViews(e),this._triggerAttach(d,"before:")),this.attachHtml(e),this.currentView=e,c&&p&&(d=this._displayedViews(e),this._triggerAttach(d)),a&&this.triggerMethod("swap",e,this,t),this.triggerMethod("show",e,this,t),o.triggerMethodOn(e,"show",e,this,t),this}return this}},triggerBeforeAttach:!0,triggerAttach:!0,_triggerAttach:function(e,t){var i=(t||"")+"attach";n.each(e,function(e){o.triggerMethodOn(e,i,e,this)},this)},_displayedViews:function(e){return n.union([e],n.result(e,"_getNestedViews")||[])},_ensureElement:function(){if(n.isObject(this.el)||(this.$el=this.getEl(this.el),this.el=this.$el[0]),!this.$el||0===this.$el.length){if(this.getOption("allowMissingEl"))return!1;throw new o.Error('An "el" '+this.$el.selector+" must exist in DOM")}return!0},_ensureViewIsIntact:function(e){if(!e)throw new o.Error({name:"ViewNotValid",message:"The view passed is undefined and therefore invalid. You must pass a view instance to show."});if(e.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+e.cid+'") has already been destroyed and cannot be used.'})},getEl:function(e){return t.$(e,o._getValue(this.options.parentEl,this))},attachHtml:function(e){this.$el.contents().detach(),this.el.appendChild(e.el)},empty:function(e){var t=this.currentView,n=o._getValue(e,"preventDestroy",this);return t?(t.off("destroy",this.empty,this),this.triggerMethod("before:empty",t),n||this._destroyView(),this.triggerMethod("empty",t),delete this.currentView,n&&this.$el.contents().detach(),this):void 0},_destroyView:function(){var e=this.currentView;e.destroy&&!e.isDestroyed?e.destroy():e.remove&&(e.remove(),e.isDestroyed=!0)},attachView:function(e){return this.currentView=e,this},hasView:function(){return!!this.currentView},reset:function(){return this.empty(),this.$el&&(this.el=this.$el.selector),delete this.$el,this}},{buildRegion:function(e,t){if(n.isString(e))return this._buildRegionFromSelector(e,t);if(e.selector||e.el||e.regionClass)return this._buildRegionFromObject(e,t);if(n.isFunction(e))return this._buildRegionFromRegionClass(e);throw new o.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(e,t){var i=e.regionClass||t,r=n.omit(e,"selector","regionClass");return e.selector&&!r.el&&(r.el=e.selector),new i(r)},_buildRegionFromRegionClass:function(e){return new e}}),o.RegionManager=o.Controller.extend({constructor:function(e){this._regions={},this.length=0,o.Controller.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(e,t){return e=o._getValue(e,this,arguments),n.reduce(e,function(e,i,r){return n.isString(i)&&(i={selector:i}),i.selector&&(i=n.defaults({},i,t)),e[r]=this.addRegion(r,i),e},{},this)},addRegion:function(e,t){var n;return n=t instanceof o.Region?t:o.Region.buildRegion(t,o.Region),this.triggerMethod("before:add:region",e,n),n._parent=this,this._store(e,n),this.triggerMethod("add:region",e,n),n},get:function(e){return this._regions[e]},getRegions:function(){return n.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var e=this.getRegions();return n.each(this._regions,function(e,t){this._remove(t,e)},this),e},emptyRegions:function(){var e=this.getRegions();return n.invoke(e,"empty"),e},destroy:function(){return this.removeRegions(),o.Controller.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}}),o.actAsCollection(o.RegionManager.prototype,"_regions"),o.TemplateCache=function(e){this.templateId=e},n.extend(o.TemplateCache,{templateCaches:{},get:function(e,t){var n=this.templateCaches[e];return n||(n=new o.TemplateCache(e),this.templateCaches[e]=n),n.load(t)},clear:function(){var e,t=n.toArray(arguments),i=t.length;if(i>0)for(e=0;i>e;e++)delete this.templateCaches[t[e]];else this.templateCaches={}}}),n.extend(o.TemplateCache.prototype,{load:function(e){if(this.compiledTemplate)return this.compiledTemplate;var t=this.loadTemplate(this.templateId,e);return this.compiledTemplate=this.compileTemplate(t,e),this.compiledTemplate},loadTemplate:function(e){var n=t.$(e).html();if(!n||0===n.length)throw new o.Error({name:"NoTemplateError",message:'Could not find template: "'+e+'"'});return n},compileTemplate:function(e,t){return n.template(e,t)}}),o.Renderer={render:function(e,t){if(!e)throw new o.Error({name:"TemplateNotFoundError",message:"Cannot render the template since its false, null or undefined."});var i=n.isFunction(e)?e:o.TemplateCache.get(e);return i(t)}},o.View=t.View.extend({isDestroyed:!1,constructor:function(e){n.bindAll(this,"render"),e=o._getValue(e,this),this.options=n.extend({},n.result(this,"options"),e),this._behaviors=o.Behaviors(this),t.View.call(this,this.options),o.MonitorDOMRefresh(this)},getTemplate:function(){return this.getOption("template")},serializeModel:function(e){return e.toJSON.apply(e,n.rest(arguments))},mixinTemplateHelpers:function(e){e=e||{};var t=this.getOption("templateHelpers");return t=o._getValue(t,this),n.extend(e,t)},normalizeUIKeys:function(e){var t=n.result(this,"_uiBindings");return o.normalizeUIKeys(e,t||n.result(this,"ui"))},normalizeUIValues:function(e,t){var i=n.result(this,"ui"),r=n.result(this,"_uiBindings");return o.normalizeUIValues(e,r||i,t)},configureTriggers:function(){if(this.triggers){var e=this.normalizeUIKeys(n.result(this,"triggers"));return n.reduce(e,function(e,t,n){return e[n]=this._buildViewTrigger(t),e},{},this)}},delegateEvents:function(e){return this._delegateDOMEvents(e),this.bindEntityEvents(this.model,this.getOption("modelEvents")),this.bindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.bindEntityEvents(this.model,e.getOption("modelEvents")),e.bindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_delegateDOMEvents:function(e){var i=o._getValue(e||this.events,this);i=this.normalizeUIKeys(i),n.isUndefined(e)&&(this.events=i);var r={},s=n.result(this,"behaviorEvents")||{},a=this.configureTriggers(),l=n.result(this,"behaviorTriggers")||{};n.extend(r,s,i,a,l),t.View.prototype.delegateEvents.call(this,r)},undelegateEvents:function(){return t.View.prototype.undelegateEvents.apply(this,arguments),this.unbindEntityEvents(this.model,this.getOption("modelEvents")),this.unbindEntityEvents(this.collection,this.getOption("collectionEvents")),n.each(this._behaviors,function(e){e.unbindEntityEvents(this.model,e.getOption("modelEvents")),e.unbindEntityEvents(this.collection,e.getOption("collectionEvents"))},this),this},_ensureViewIsIntact:function(){if(this.isDestroyed)throw new o.Error({name:"ViewDestroyedError",message:'View (cid: "'+this.cid+'") has already been destroyed and cannot be used.'})},destroy:function(){if(this.isDestroyed)return this;var e=n.toArray(arguments);return this.triggerMethod.apply(this,["before:destroy"].concat(e)),this.isDestroyed=!0,this.triggerMethod.apply(this,["destroy"].concat(e)),this.unbindUIElements(),this.isRendered=!1,this.remove(),n.invoke(this._behaviors,"destroy",e),this},bindUIElements:function(){this._bindUIElements(),n.invoke(this._behaviors,this._bindUIElements)},_bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var e=n.result(this,"_uiBindings");this.ui={},n.each(e,function(e,t){this.ui[t]=this.$(e)},this)}},unbindUIElements:function(){this._unbindUIElements(),n.invoke(this._behaviors,this._unbindUIElements)},_unbindUIElements:function(){this.ui&&this._uiBindings&&(n.each(this.ui,function(e,t){delete this.ui[t]},this),this.ui=this._uiBindings,delete this._uiBindings)},_buildViewTrigger:function(e){var t=n.isObject(e),i=n.defaults({},t?e:{},{preventDefault:!0,stopPropagation:!0}),r=t?i.event:e;return function(e){e&&(e.preventDefault&&i.preventDefault&&e.preventDefault(),e.stopPropagation&&i.stopPropagation&&e.stopPropagation());var t={view:this,model:this.model,collection:this.collection};this.triggerMethod(r,t)}},setElement:function(){var e=t.View.prototype.setElement.apply(this,arguments);return n.invoke(this._behaviors,"proxyViewProperties",this),e},triggerMethod:function(){var e=o._triggerMethod(this,arguments);return this._triggerEventOnBehaviors(arguments),this._triggerEventOnParentLayout(arguments[0],n.rest(arguments)),e},_triggerEventOnBehaviors:function(e){for(var t=o._triggerMethod,n=this._behaviors,i=0,r=n&&n.length;r>i;i++)t(n[i],e)},_triggerEventOnParentLayout:function(e,t){var i=this._parentLayoutView();if(i){var r=o.getOption(i,"childViewEventPrefix"),s=r+":"+e;o._triggerMethod(i,[s,this].concat(t));var a=o.getOption(i,"childEvents"),l=i.normalizeMethods(a);l&&n.isFunction(l[e])&&l[e].apply(i,[this].concat(t))}},_getImmediateChildren:function(){return[]},_getNestedViews:function(){var e=this._getImmediateChildren();return e.length?n.reduce(e,function(e,t){return t._getNestedViews?e.concat(t._getNestedViews()):e},e):e},_getAncestors:function(){for(var e=[],t=this._parent;t;)e.push(t),t=t._parent;return e},_parentLayoutView:function(){var e=this._getAncestors();return n.find(e,function(e){return e instanceof o.LayoutView})},normalizeMethods:o.normalizeMethods,mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.ItemView=o.View.extend({constructor:function(){o.View.apply(this,arguments)},serializeData:function(){if(!this.model&&!this.collection)return{};var e=[this.model||this.collection];return arguments.length&&e.push.apply(e,arguments),this.model?this.serializeModel.apply(this,e):{items:this.serializeCollection.apply(this,e)}},serializeCollection:function(e){return e.toJSON.apply(e,n.rest(arguments))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderTemplate(),this.isRendered=!0,this.bindUIElements(),this.triggerMethod("render",this),this},_renderTemplate:function(){var e=this.getTemplate();if(e!==!1){if(!e)throw new o.Error({name:"UndefinedTemplateError",message:"Cannot render the template since it is null or undefined."});var t=this.mixinTemplateHelpers(this.serializeData()),n=o.Renderer.render(e,t,this);return this.attachElContent(n),this}},attachElContent:function(e){return this.$el.html(e),this}}),o.CollectionView=o.View.extend({childViewEventPrefix:"childview",sort:!0,constructor:function(){this.once("render",this._initialEvents),this._initChildViewStorage(),o.View.apply(this,arguments),this.on("show",this._onShowCalled),this.initRenderBuffer()},initRenderBuffer:function(){this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this._triggerBeforeShowBufferedChildren(),this.attachBuffer(this),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerBeforeShowBufferedChildren:function(){this._isShown&&n.each(this._bufferedChildren,n.partial(this._triggerMethodOnChild,"before:show"))},_triggerShowBufferedChildren:function(){this._isShown&&(n.each(this._bufferedChildren,n.partial(this._triggerMethodOnChild,"show")),this._bufferedChildren=[])},_triggerMethodOnChild:function(e,t){o.triggerMethodOn(t,e)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this.render),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},_onCollectionAdd:function(e,t,i){var r;if(r=void 0!==i.at?i.at:n.indexOf(this._filteredSortedModels(),e),this._shouldAddChild(e,r)){this.destroyEmptyView();var o=this.getChildView(e);this.addChild(e,o,r)}},_onCollectionRemove:function(e){var t=this.children.findByModel(e);this.removeChildView(t),this.checkEmpty()},_onShowCalled:function(){this.children.each(n.partial(this._triggerMethodOnChild,"show"))},render:function(){return this._ensureViewIsIntact(),this.triggerMethod("before:render",this),this._renderChildren(),this.isRendered=!0,this.triggerMethod("render",this),this},reorder:function(){var e=this.children,t=this._filteredSortedModels(),i=n.find(t,function(t){return!e.findByModel(t)});if(i)this.render();else{var r=n.map(t,function(t){return e.findByModel(t).el});this.triggerMethod("before:reorder"),this._appendReorderedChildren(r),this.triggerMethod("reorder")}},resortView:function(){o.getOption(this,"reorderOnSort")?this.reorder():this.render()},_sortViews:function(){var e=this._filteredSortedModels(),t=n.find(e,function(e,t){var n=this.children.findByModel(e);return!n||n._index!==t},this);t&&this.resortView()},_emptyViewIndex:-1,_appendReorderedChildren:function(e){this.$el.append(e)},_renderChildren:function(){this.destroyEmptyView(),this.destroyChildren(),this.isEmpty(this.collection)?this.showEmptyView():(this.triggerMethod("before:render:collection",this),this.startBuffering(),this.showCollection(),this.endBuffering(),this.triggerMethod("render:collection",this),this.children.isEmpty()&&this.showEmptyView())},showCollection:function(){var e,t=this._filteredSortedModels();n.each(t,function(t,n){e=this.getChildView(t),this.addChild(t,e,n)},this)},_filteredSortedModels:function(){var e,t=this.getViewComparator();return e=t?n.isString(t)||1===t.length?this.collection.sortBy(t,this):n.clone(this.collection.models).sort(n.bind(t,this)):this.collection.models,this.getOption("filter")&&(e=n.filter(e,function(e,t){return this._shouldAddChild(e,t)},this)),e},showEmptyView:function(){var e=this.getEmptyView();if(e&&!this._showingEmptyView){this.triggerMethod("before:render:empty"),this._showingEmptyView=!0;var n=new t.Model;this.addEmptyView(n,e),this.triggerMethod("render:empty")}},destroyEmptyView:function(){this._showingEmptyView&&(this.triggerMethod("before:remove:empty"),this.destroyChildren(),delete this._showingEmptyView,this.triggerMethod("remove:empty"))},getEmptyView:function(){return this.getOption("emptyView")},addEmptyView:function(e,t){var i=this.getOption("emptyViewOptions")||this.getOption("childViewOptions");n.isFunction(i)&&(i=i.call(this,e,this._emptyViewIndex));var r=this.buildChildView(e,t,i);r._parent=this,this.proxyChildEvents(r),this._isShown&&o.triggerMethodOn(r,"before:show"),this.children.add(r),this.renderChildView(r,this._emptyViewIndex),this._isShown&&o.triggerMethodOn(r,"show")},getChildView:function(){var e=this.getOption("childView");if(!e)throw new o.Error({name:"NoChildViewError",message:'A "childView" must be specified'});return e},addChild:function(e,t,n){var i=this.getOption("childViewOptions");i=o._getValue(i,this,[e,n]);var r=this.buildChildView(e,t,i);return this._updateIndices(r,!0,n),this._addChildView(r,n),r._parent=this,r},_updateIndices:function(e,t,n){this.getOption("sort")&&(t&&(e._index=n),this.children.each(function(n){n._index>=e._index&&(n._index+=t?1:-1)}))},_addChildView:function(e,t){this.proxyChildEvents(e),this.triggerMethod("before:add:child",e),this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"before:show"),this.children.add(e),this.renderChildView(e,t),this._isShown&&!this.isBuffering&&o.triggerMethodOn(e,"show"),this.triggerMethod("add:child",e)},renderChildView:function(e,t){return e.render(),this.attachHtml(this,e,t),e},buildChildView:function(e,t,i){var r=n.extend({model:e},i);return new t(r)},removeChildView:function(e){return e&&(this.triggerMethod("before:remove:child",e),e.destroy?e.destroy():e.remove&&e.remove(),delete e._parent,this.stopListening(e),this.children.remove(e),this.triggerMethod("remove:child",e),this._updateIndices(e,!1)),e},isEmpty:function(){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},attachBuffer:function(e){e.$el.append(this._createBuffer(e))},_createBuffer:function(e){var t=document.createDocumentFragment();return n.each(e._bufferedChildren,function(e){t.appendChild(e.el)}),t},attachHtml:function(e,t,n){e.isBuffering?e._bufferedChildren.splice(n,0,t):e._insertBefore(t,n)||e._insertAfter(t)},_insertBefore:function(e,t){var n,i=this.getOption("sort")&&t<this.children.length-1;return i&&(n=this.children.find(function(e){return e._index===t+1})),n?(n.$el.before(e.el),!0):!1},_insertAfter:function(e){this.$el.append(e.el)},_initChildViewStorage:function(){this.children=new t.ChildViewContainer},destroy:function(){return this.isDestroyed?this:(this.triggerMethod("before:destroy:collection"),this.destroyChildren(),this.triggerMethod("destroy:collection"),o.View.prototype.destroy.apply(this,arguments))},destroyChildren:function(){var e=this.children.map(n.identity);return this.children.each(this.removeChildView,this),this.checkEmpty(),e},_shouldAddChild:function(e,t){var i=this.getOption("filter");return!n.isFunction(i)||i.call(this,e,t,this.collection)},proxyChildEvents:function(e){var t=this.getOption("childViewEventPrefix");this.listenTo(e,"all",function(){var i=n.toArray(arguments),r=i[0],o=this.normalizeMethods(n.result(this,"childEvents"));i[0]=t+":"+r,i.splice(1,0,e),"undefined"!=typeof o&&n.isFunction(o[r])&&o[r].apply(this,i.slice(1)),this.triggerMethod.apply(this,i)})},_getImmediateChildren:function(){return n.values(this.children._views)},getViewComparator:function(){return this.getOption("viewComparator")}}),o.CompositeView=o.CollectionView.extend({constructor:function(){o.CollectionView.apply(this,arguments)},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this._onCollectionAdd),this.listenTo(this.collection,"remove",this._onCollectionRemove),this.listenTo(this.collection,"reset",this._renderChildren),this.getOption("sort")&&this.listenTo(this.collection,"sort",this._sortViews))},getChildView:function(){var e=this.getOption("childView")||this.constructor;return e},serializeData:function(){var e={};return this.model&&(e=n.partial(this.serializeModel,this.model).apply(this,arguments)),e},render:function(){return this._ensureViewIsIntact(),this._isRendering=!0,this.resetChildViewContainer(),this.triggerMethod("before:render",this),this._renderTemplate(),this._renderChildren(),this._isRendering=!1,this.isRendered=!0,this.triggerMethod("render",this),this},_renderChildren:function(){(this.isRendered||this._isRendering)&&o.CollectionView.prototype._renderChildren.call(this)},_renderTemplate:function(){var e={};e=this.serializeData(),e=this.mixinTemplateHelpers(e),this.triggerMethod("before:render:template");var t=this.getTemplate(),n=o.Renderer.render(t,e,this);this.attachElContent(n),this.bindUIElements(),this.triggerMethod("render:template")},attachElContent:function(e){return this.$el.html(e),this},attachBuffer:function(e){var t=this.getChildViewContainer(e);t.append(this._createBuffer(e))},_insertAfter:function(e){var t=this.getChildViewContainer(this,e);t.append(e.el)},_appendReorderedChildren:function(e){var t=this.getChildViewContainer(this);t.append(e)},getChildViewContainer:function(e){if("$childViewContainer"in e)return e.$childViewContainer;var t,n=o.getOption(e,"childViewContainer");if(n){var i=o._getValue(n,e);if(t="@"===i.charAt(0)&&e.ui?e.ui[i.substr(4)]:e.$(i),t.length<=0)throw new o.Error({name:"ChildViewContainerMissingError",message:'The specified "childViewContainer" was not found: '+e.childViewContainer})}else t=e.$el;return e.$childViewContainer=t,t},resetChildViewContainer:function(){this.$childViewContainer&&delete this.$childViewContainer}}),o.LayoutView=o.ItemView.extend({regionClass:o.Region,options:{destroyImmediate:!1},childViewEventPrefix:"childview",constructor:function(e){e=e||{},this._firstRender=!0,this._initializeRegions(e),o.ItemView.call(this,e)},render:function(){return this._ensureViewIsIntact(),this._firstRender?this._firstRender=!1:this._reInitializeRegions(),o.ItemView.prototype.render.apply(this,arguments)},destroy:function(){return this.isDestroyed?this:(this.getOption("destroyImmediate")===!0&&this.$el.remove(),this.regionManager.destroy(),o.ItemView.prototype.destroy.apply(this,arguments))},showChildView:function(e,t){return this.getRegion(e).show(t)},getChildView:function(e){return this.getRegion(e).currentView},addRegion:function(e,t){var n={};return n[e]=t,this._buildRegions(n)[e]},addRegions:function(e){return this.regions=n.extend({},this.regions,e),this._buildRegions(e)},removeRegion:function(e){return delete this.regions[e],this.regionManager.removeRegion(e)},getRegion:function(e){return this.regionManager.get(e)},getRegions:function(){return this.regionManager.getRegions()},_buildRegions:function(e){var t={regionClass:this.getOption("regionClass"),parentEl:n.partial(n.result,this,"el")};return this.regionManager.addRegions(e,t)},_initializeRegions:function(e){var t;this._initRegionManager(),t=o._getValue(this.regions,this,[e])||{};var i=this.getOption.call(e,"regions");i=o._getValue(i,this,[e]),n.extend(t,i),t=this.normalizeUIValues(t,["selector","el"]),this.addRegions(t)},_reInitializeRegions:function(){this.regionManager.invoke("reset")},getRegionManager:function(){return new o.RegionManager},_initRegionManager:function(){this.regionManager=this.getRegionManager(),this.regionManager._parent=this,this.listenTo(this.regionManager,"before:add:region",function(e){this.triggerMethod("before:add:region",e)}),this.listenTo(this.regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this.regionManager,"before:remove:region",function(e){this.triggerMethod("before:remove:region",e)}),this.listenTo(this.regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})},_getImmediateChildren:function(){return n.chain(this.regionManager.getRegions()).pluck("currentView").compact().value()}}),o.Behavior=o.Object.extend({constructor:function(e,t){this.view=t,this.defaults=n.result(this,"defaults")||{},this.options=n.extend({},this.defaults,e),this.ui=n.extend({},n.result(t,"ui"),n.result(this,"ui")),o.Object.apply(this,arguments)},$:function(){return this.view.$.apply(this.view,arguments)},destroy:function(){return this.stopListening(),this},proxyViewProperties:function(e){this.$el=e.$el,this.el=e.el}}),o.Behaviors=function(e,t){function n(e,i){return t.isObject(e.behaviors)?(i=n.parseBehaviors(e,i||t.result(e,"behaviors")),n.wrap(e,i,t.keys(s)),i):{}}function i(e,t){this._view=e,this._behaviors=t,this._triggers={}}function r(e){return e._uiBindings||e.ui}var o=/^(\S+)\s*(.*)$/,s={behaviorTriggers:function(e,t){var n=new i(this,t);return n.buildBehaviorTriggers()},behaviorEvents:function(n,i){var s={};return t.each(i,function(n,i){var a={},l=t.clone(t.result(n,"events"))||{};l=e.normalizeUIKeys(l,r(n));var u=0;t.each(l,function(e,r){var s=r.match(o),l=s[1]+"."+[this.cid,i,u++," "].join(""),c=s[2],d=l+c,h=t.isFunction(e)?e:n[e];a[d]=t.bind(h,n)},this),s=t.extend(s,a)},this),s}};return t.extend(n,{behaviorsLookup:function(){throw new e.Error({message:"You must define where your behaviors are stored.",url:"marionette.behaviors.html#behaviorslookup"})},getBehaviorClass:function(t,i){return t.behaviorClass?t.behaviorClass:e._getValue(n.behaviorsLookup,this,[t,i])[i]},parseBehaviors:function(e,i){return t.chain(i).map(function(i,r){var o=n.getBehaviorClass(i,r),s=new o(i,e),a=n.parseBehaviors(e,t.result(s,"behaviors"));return[s].concat(a)}).flatten().value()},wrap:function(e,n,i){t.each(i,function(i){e[i]=t.partial(s[i],e[i],n)})}}),t.extend(i.prototype,{buildBehaviorTriggers:function(){return t.each(this._behaviors,this._buildTriggerHandlersForBehavior,this),this._triggers},_buildTriggerHandlersForBehavior:function(n,i){var o=t.clone(t.result(n,"triggers"))||{};o=e.normalizeUIKeys(o,r(n)),t.each(o,t.bind(this._setHandlerForBehavior,this,n,i))},_setHandlerForBehavior:function(e,t,n,i){var r=i.replace(/^\S+/,function(e){return e+".behaviortriggers"+t});this._triggers[r]=this._view._buildViewTrigger(n)
}}),n}(o,n),o.AppRouter=t.Router.extend({constructor:function(e){this.options=e||{},t.Router.apply(this,arguments);var n=this.getOption("appRoutes"),i=this._getController();this.processAppRoutes(i,n),this.on("route",this._processOnRoute,this)},appRoute:function(e,t){var n=this._getController();this._addAppRoute(n,e,t)},_processOnRoute:function(e,t){if(n.isFunction(this.onRoute)){var i=n.invert(this.getOption("appRoutes"))[e];this.onRoute(e,i,t)}},processAppRoutes:function(e,t){if(t){var i=n.keys(t).reverse();n.each(i,function(n){this._addAppRoute(e,n,t[n])},this)}},_getController:function(){return this.getOption("controller")},_addAppRoute:function(e,t,i){var r=e[i];if(!r)throw new o.Error('Method "'+i+'" was not found on the controller');this.route(t,i,n.bind(r,e))},mergeOptions:o.mergeOptions,getOption:o.proxyGetOption,triggerMethod:o.triggerMethod,bindEntityEvents:o.proxyBindEntityEvents,unbindEntityEvents:o.proxyUnbindEntityEvents}),o.Application=o.Object.extend({constructor:function(e){this._initializeRegions(e),this._initCallbacks=new o.Callbacks,this.submodules={},n.extend(this,e),this._initChannel(),o.Object.call(this,e)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(e){this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return this._regionManager.get(e)},getRegions:function(){return this._regionManager.getRegions()},module:function(e,t){var i=o.Module.getClass(t),r=n.toArray(arguments);return r.unshift(this),i.create.apply(i,r)},getRegionManager:function(){return new o.RegionManager},_initializeRegions:function(e){var t=n.isFunction(this.regions)?this.regions(e):this.regions||{};this._initRegionManager();var i=o.getOption(e,"regions");return n.isFunction(i)&&(i=i.call(this,e)),n.extend(t,i),this.addRegions(t),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(){o._triggerMethod(this,"before:add:region",arguments)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,o._triggerMethod(this,"add:region",arguments)}),this.listenTo(this._regionManager,"before:remove:region",function(){o._triggerMethod(this,"before:remove:region",arguments)}),this.listenTo(this._regionManager,"remove:region",function(e){delete this[e],o._triggerMethod(this,"remove:region",arguments)})},_initChannel:function(){this.channelName=n.result(this,"channelName")||"global",this.channel=n.result(this,"channel")||t.Wreqr.radio.channel(this.channelName),this.vent=n.result(this,"vent")||this.channel.vent,this.commands=n.result(this,"commands")||this.channel.commands,this.reqres=n.result(this,"reqres")||this.channel.reqres}}),o.Module=function(e,t,i){this.moduleName=e,this.options=n.extend({},this.options,i),this.initialize=i.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=t,n.isFunction(this.initialize)&&this.initialize(e,t,this.options)},o.Module.extend=o.extend,n.extend(o.Module.prototype,t.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(e){this._isInitialized||(n.each(this.submodules,function(t){t.startWithParent&&t.start(e)}),this.triggerMethod("before:start",e),this._initializerCallbacks.run(e,this),this._isInitialized=!0,this.triggerMethod("start",e))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),n.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(e,i){if(e){var r=n.flatten([this,this.app,t,o,t.$,n,i]);e.apply(this,r)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new o.Callbacks,this._finalizerCallbacks=new o.Callbacks},triggerMethod:o.triggerMethod}),n.extend(o.Module,{create:function(e,t,i){var r=e,o=n.drop(arguments,3);t=t.split(".");var s=t.length,a=[];return a[s-1]=i,n.each(t,function(t,n){var s=r;r=this._getModule(s,t,e,i),this._addModuleDefinition(s,r,a[n],o)},this),r},_getModule:function(e,t,i,r){var o=n.extend({},r),s=this.getClass(r),a=e[t];return a||(a=new s(t,i,o),e[t]=a,e.submodules[t]=a),a},getClass:function(e){var t=o.Module;return e?e.prototype instanceof t?e:e.moduleClass||t:t},_addModuleDefinition:function(e,t,n,i){var r=this._getDefine(n),o=this._getStartWithParent(n,t);r&&t.addDefinition(r,i),this._addStartWithParent(e,t,o)},_getStartWithParent:function(e,t){var i;return n.isFunction(e)&&e.prototype instanceof o.Module?(i=t.constructor.prototype.startWithParent,n.isUndefined(i)?!0:i):n.isObject(e)?(i=e.startWithParent,n.isUndefined(i)?!0:i):!0},_getDefine:function(e){return!n.isFunction(e)||e.prototype instanceof o.Module?n.isObject(e)?e.define:null:e},_addStartWithParent:function(e,t,n){t.startWithParent=t.startWithParent&&n,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}}),o}),define("marionette",["marionette-lib","mustache"],function(e,t){return e.TemplateCache.prototype.compileTemplate=function(e){return t.compile(e)},e}),define("js/pullrequests/app",["marionette"],function(e){return new e.Application}),define("js/pullrequests/collections/tasks",["backbone","js/pullrequests/models/task","data/current-repo"],function(e,t,n){return e.Collection.extend({model:t,initialize:function(e,t){t=t||{},this.pullrequest=t.pullrequest},parse:function(e){return e.values},getUnsaved:function(){return this.findWhere({id:void 0})},url:function(){return"/!api/internal/repositories/{owner}/{slug}/pullrequests/{pullRequestId}/tasks/".format({owner:n.owner.username,slug:n.slug,pullRequestId:this.pullrequest.id})}})}),define("js/pullrequests/events",["backbone.wreqr"],function(e){return e.radio.channel("pullrequests")}),define("js/pullrequests/data/can-manage-tasks",["jquery"],function(e){var t="admin"===e("#user-repo-privilege-data").attr("data-priv"),n=e("#pullrequest-author").data("currentUserIsAuthor");return t||n}),define("js/pullrequests/views/task",["underscore","marionette","data/current-user","js/pullrequests/events","js/pullrequests/data/can-manage-tasks"],function(e,t,n,i,r){return t.ItemView.extend({tagName:"li",template:"#task-template",className:function(){var e=["task","iterable-item"];return e=e.concat(this.getClassNames()),e.join(" ")},getClassNames:function(){var e=[];return this.model.get("completed")&&e.push("completed"),e},initialize:function(){this.listenTo(i.vent,"keypress:32",this.toggleStatusWithSpacebar),this.listenTo(i.vent,"keypress:111",this.goToContextWithOKey)},events:{"click @ui.contextLink":"goToTaskContext","click @ui.deleteLink":"deleteTask","click @ui.editLink":"editTask","click @ui.saveLink":"saveTask","click @ui.cancelLink":"cancelEdit","click @ui.status":"changeCompleted","input @ui.input":"setInputHeight","keydown @ui.input":"keyInput"},modelEvents:{"change:completed":"onChangeCompleted","change:content":"render",edit:"editTask"},editing:!1,ui:{status:".task-status",contextLink:".context-link",deleteLink:".delete-task",editLink:".edit-task",saveLink:".save-task",cancelLink:".cancel-edit",input:".edit-description"},templateHelpers:function(){var e=this.model.get("creator");return{editing:this.editing,isAuthenticated:n.isAuthenticated,isEditable:e&&n.username===e.username||r,hasReadAccess:"None"!==$("#user-repo-privilege-data").data("priv")}},goToTaskContext:function(){var e="task-{}".format(this.model.id);window.location.hash.substr(1)!==e&&(window.location.hash=e),i.vent.trigger("taskContextLinkClicked",this.model)},deleteTask:function(){this.model.destroy()},editTask:function(){this.editing||(this.editing=!0,this.$el.toggleClass("editing",!0),this.render()),this.focusDescription()},stopEditing:function(){this.editing=!1,this.$el.toggleClass("editing",!1),this.render()},saveTask:function(){return this.ui.input.val()?(this.model.set("content",this.ui.input.val()),this.model.hasChanged("content")&&(this.model.get("creator")||this.model.set("creator",{username:n.username}),this.model.save({},{wait:!0})),void this.stopEditing()):void this.model.destroy()},cancelEdit:function(){return this.model.get("content")?void this.stopEditing():void this.model.destroy()},setInputHeight:e.debounce(function(){var e=this.ui.input[0];e.clientHeight===e.scrollHeight&&(e.style.height=""),e.scrollHeight>e.clientHeight&&(e.style.height=e.scrollHeight+"px")},50),focusDescription:function(){this.editing&&(this.setInputHeight(),this.ui.input.focus())},changeCompleted:function(e){return this.editing?void e.preventDefault():void this.model.save("completed",this.ui.status.is(":checked"))},onChangeCompleted:function(){var e=this.model.get("completed");this.$el.toggleClass("completed",e),this.ui.status.prop("checked",e)},keyInput:function(e){13===e.which&&this.saveTask()},isFocusedForKBShortcuts:function(){return this.$el.hasClass("focused")},toggleStatusWithSpacebar:function(e){!this.editing&&this.isFocusedForKBShortcuts()&&(this.model.save("completed",!this.ui.status.is(":checked")),e.preventDefault())},goToContextWithOKey:function(){!this.editing&&this.isFocusedForKBShortcuts()&&this.goToTaskContext()}})}),define("js/pullrequests/views/linkable-task",["js/pullrequests/views/task"],function(e){return e.extend({id:function(){return this.model.id?"task-{}".format(this.model.id):void 0},initialize:function(){e.prototype.initialize.call(this,arguments),this.listenTo(this.model,"sync",function(){this.$el.attr("id",this.id())})}})}),define("js/pullrequests/views/task-list",["marionette","js/pullrequests/views/task"],function(e,t){return e.CollectionView.extend({tagName:"ul",className:"task-list",childView:t,onAddChild:function(e){e.model.get("content")||e.editTask()},attachHtml:function(e,t){t.model.id?e.$el.append(t.el):e.$el.prepend(t.el)}})}),define("js/pullrequests/views/comment-task-list",["js/pullrequests/views/linkable-task","js/pullrequests/views/task-list"],function(e,t){return t.extend({childView:e,initialize:function(e){this.comment=e.comment},shouldCreateChild:function(e){return e.get("comment").id===this.comment.id},getChildElement:function(e){return this.$("#task-{}".format(e.id))},addChild:function(e){if(this.shouldCreateChild(e)){var n=this.getChildElement(e);if(n.length){var i=new this.childView({el:n,model:e});this.proxyChildEvents(i),this.children.add(i),i.bindUIElements()}else t.prototype.addChild.apply(this,arguments)}}})}),define("js/pullrequests/views/comment",["jquery","marionette","js/pullrequests/views/comment-task-list"],function(e,t,n){return t.ItemView.extend({template:!1,tagName:"li",className:"comment",events:{"click @ui.createTask":"createTask"},ui:{createTask:"> article .task-link"},initialize:function(){new n({el:this.$("> .task-list"),comment:this.model,collection:this.model.pullrequest.tasks}).render()},_getSelectedText:function(){var t=window.getSelection();if(t.isCollapsed)return"";var n=e(t.anchorNode),i=!!n.closest(".comment-content").length,r=this.$el.is(n.closest(".comment"));return i&&r?t.toString():""},createTask:function(e){e&&e.preventDefault(),this.model.pullrequest.createTask({content:this._getSelectedText(),comment:this.model})}})}),function(e){"function"==typeof define&&define.amd?define("jquery-plugins/jquery.scrollTo",["jquery"],e):e(jQuery)}(function(e){function t(t){return e.isFunction(t)||"object"==typeof t?t:{top:t,left:t}}var n=e.scrollTo=function(t,n,i){return e(window).scrollTo(t,n,i)};return n.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},n.window=function(){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this,n=!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!n)return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(i,r,o){return"object"==typeof r&&(o=r,r=0),"function"==typeof o&&(o={onAfter:o}),"max"==i&&(i=9e9),o=e.extend({},n.defaults,o),r=r||o.duration,o.queue=o.queue&&o.axis.length>1,o.queue&&(r/=2),o.offset=t(o.offset),o.over=t(o.over),this._scrollable().each(function(){function s(e){u.animate(d,r,o.easing,e&&function(){e.call(this,c,o)})}if(null!=i){var a,l=this,u=e(l),c=i,d={},h=u.is("html,body");switch(typeof c){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(c)){c=t(c);break}if(c=h?e(c):e(c,this),!c.length)return;case"object":(c.is||c.style)&&(a=(c=e(c)).offset())}var p=e.isFunction(o.offset)&&o.offset(l,c)||o.offset;e.each(o.axis.split(""),function(e,t){var i="x"==t?"Left":"Top",r=i.toLowerCase(),f="scroll"+i,m=l[f],g=n.max(l,t);if(a)d[f]=a[r]+(h?0:m-u.offset()[r]),o.margin&&(d[f]-=parseInt(c.css("margin"+i))||0,d[f]-=parseInt(c.css("border"+i+"Width"))||0),d[f]+=p[r]||0,o.over[r]&&(d[f]+=c["x"==t?"width":"height"]()*o.over[r]);else{var v=c[r];d[f]=v.slice&&"%"==v.slice(-1)?parseFloat(v)/100*g:v}o.limit&&/^\d+$/.test(d[f])&&(d[f]=d[f]<=0?0:Math.min(d[f],g)),!e&&o.queue&&(m!=d[f]&&s(o.onAfterFirst),delete d[f])}),s(o.onAfter)}}).end()},n.max=function(t,n){var i="x"==n?"Width":"Height",r="scroll"+i;if(!e(t).is("html,body"))return t[r]-e(t)[i.toLowerCase()]();var o="client"+i,s=t.ownerDocument.documentElement,a=t.ownerDocument.body;return Math.max(s[r],a[r])-Math.min(s[o],a[o])},n}),define("components/comments/line-comment",["jquery","underscore","components/comments/comment","components/comments/comment-form","components/confirm-dialog","utils/localize","utils/mustache","js/pullrequests/app","js/pullrequests/collections/tasks","js/pullrequests/views/comment","jquery-plugins/jquery.scrollTo"],function(e,t,n,i,r,o,s,a,l,u){function c(t,n){a.addInitializer(function(i){var r=i.pullrequest;t.children(".task-list").find(".task").each(function(){var t=e(this);r.tasks.add({id:t.data("taskId"),content:t.find(".description").text().trim(),completed:t.find(".task-status").prop("checked"),comment:n,creator:{username:t.attr("data-creator-username")}})}),n.pullrequest=r,new u({el:t,model:n}).bindUIElements()})}var d=function(e){this.comment=e,this.editCommentForm=new i(e),this.replyCommentForm=new i,this.children=[],this.$elem=null,this.$comment=null,this.$content=null,this.$replies=null,this.$edit=null,this.$reply=null,this.$delete=null};return d.decorateThreads=function(t,i,r){for(var o=[],s=0;s<i.length;s++){var a=i[s],l=e("#comment-{}".format(a));if(l.length){var u={comment_id:l.data("comment-id"),content:l.data("content"),convert_markup:"True"===l.data("convert-markup")};r&&(u.filename=r);var c=new n(u,{urlRoot:t});o.push(new d(c).decorate(l,r,t))}}return o},d.prototype.decorate=function(t,i,r){this.$elem=t.parent(".comment"),this.$elem.data("modelobj",this),this.findInternal(),this.enterDocument();var o=t.parent("li.comment").children(".child-comments").children("li.comment").children("article, .deleted-comment-message"),s=this;return o.each(function(){var t=e(this),o={comment_id:t.data("comment-id"),content:t.data("content"),convert_markup:"True"===t.data("convert-markup")};i&&(o.filename=i);var a=new n(o,{urlRoot:r}),l=new d(a).decorate(t,i,r);s.children.push(l),e(l).bind("line-comment/thread-deleted",e.proxy(s.cleanUpThread,s))}),c(this.$elem,this.comment),this},d.prototype.scrollTo=function(t){var n=e.extend({axis:"y",offset:0-(e(window).height()/2-this.$elem.height()/2)},t);return e.scrollTo(this.$elem,500,n),this},d.prototype.createDom=function(){this.$elem=e('<li class="comment">').html(s.toHtml("comment-template",this.comment.attributes)),this.$elem.data("modelobj",this),this.findInternal()},d.prototype.hasReplies=function(){return!!this.$elem.closest(".child-comments").length},d.prototype.findInternal=function(){this.$comment=this.$elem.children("article"),this.$replies=this.$elem.children(".child-comments"),this.$content=this.$comment.find(".comment-content"),this.$edit=this.$comment.find(".edit-link"),this.$reply=this.$comment.find(".reply-link"),this.$delete=this.$comment.find(".delete-link"),this.$time=this.$comment.find("time")},d.prototype.render=function(e,t){return this.createDom(),"before"===t?this.$elem.insertBefore(e):"after"===t?this.$elem.insertAfter(e):this.$elem.appendTo(e),this.enterDocument(),this.$elem.trigger("comment-count/create"),c(this.$elem,this.comment),this},d.prototype.enterDocument=function(){this.comment.on("change",this.updateContent,this),this.comment.on("destroy",this.removeComment,this),this.$edit.on("click",e.proxy(this.edit,this)),this.$reply.on("click",e.proxy(this.reply,this)),this.$delete.on("click",e.proxy(this.deleteComment,this)),e(this.editCommentForm).bind("comment-form/cancel",e.proxy(this.cancelEdit,this)),e(this.replyCommentForm).bind("comment-form/cancel",e.proxy(this.cancelReply,this)),this.$elem.removeClass("highlight"),o(this.$time)},d.prototype.edit=function(e){e.preventDefault(),this.$comment.addClass("editing"),this.editCommentForm.$elem||this.editCommentForm.render(this.$elem),this.editCommentForm.$textarea.val(this.comment.get("content")),this.editCommentForm.$elem.insertAfter(this.$content),this.editCommentForm.showAndFocus()},d.prototype.reply=function(e){e.preventDefault();var i=new n({parent_id:this.comment.get("comment_id"),filename:this.comment.get("filename"),content:""},{urlRoot:this.comment.urlRoot});this.replyCommentForm.comment=i,this.replyCommentForm.$elem?this.replyCommentForm.$elem.prependTo(this.$replies):this.replyCommentForm.render(this.$replies),this.replyCommentForm.showAndFocus(),i.on("sync",t.once(this.insertReply),this)},d.prototype.insertReply=function(t){this.replyCommentForm.$elem.detach();var n=new d(t).render(this.$replies).scrollTo();e(n).bind("line-comment/deleted",e.proxy(this.cleanUpThread,this)),this.replyCommentForm.clearContents(),this.$elem.trigger("comment-count/create"),e(document).trigger("comment-added")},d.prototype.deleteErrorMessages={404:gettext("Comment has been deleted already."),403:gettext("You do not have permission to delete this message.")},d.prototype.deleteComment=function(e){e.preventDefault(),r({title:gettext("Delete comment"),content:gettext("Are you sure you want to delete this comment?"),buttonText:gettext("Delete")}).done(function(){this.comment.destroy({wait:!0,error:function(e,t){var n=this.deleteErrorMessages[t.status];alert(n||gettext("A problem occurred processing your request."))}.bind(this)})}.bind(this))},d.prototype.cleanUpThread=function(){var t;this.$elem.find("article:not(:has(div.deleted-comment-message))").length||(this.$elem.remove(),e(this).trigger("line-comment/thread-deleted")),this.hasReplies()||(t=this.$elem.closest("#comments-list > li.comment:has(.bb-udiff)"),t.find(".bb-udiff .comment").length||t.remove())},d.prototype.removeComment=function(){this.$comment.replaceWith(s.toHtml("comment-template",{deleted:!0,comment_id:this.comment.comment_id})),this.$elem.addClass("deleted"),this.$edit.unbind(),this.$delete.unbind(),this.$reply.unbind(),this.$edit=null,this.$delete=null,this.$reply=null,e(this).trigger("line-comment/deleted"),this.$elem.trigger("comment-count/delete"),this.cleanUpThread()},d.prototype.cancelEdit=function(){this.editCommentForm.$elem.detach(),this.$comment.removeClass("editing")},d.prototype.cancelReply=function(){this.replyCommentForm.$elem.detach()},d.prototype.updateContent=function(e){this.$content.html(e.get("content_rendered")),this.cancelEdit()},d}),define("components/diff/context-expander",["aui","jquery","underscore","utils/query-params","components/comments/line-comment"],function(e,t,n,i,r){var o=function(e,t,n,i,r){this.url=e,this.diff=i,this.identifier=t,this.showComments=!!n,this.commentUrlRoot=r,this.$elem=null};return o.prototype.tipsySettings_={title:function(){return gettext("Show more lines")},delayIn:500,gravity:"s",offset:-3,live:!0},o.prototype.decorate=function(e){this.$elem=e,this.enterDocument(),this.loadHiddenContextComments()},o.prototype.enterDocument=function(){this.$elem.on("click",".skipped-container .ellipsis",t.proxy(this.expand,this)),this.$elem.find(".skipped-container .ellipsis").tooltip(this.tipsySettings_)},o.prototype.loadHiddenContextComments=function(){var e=this.$elem.data("linecommentroots")||{},i=this;n.each(n.keys(e),function(r){if(!t("#comment-{}".format(r)).length){var o=e[r],s=i.$elem.find(".skipped-container"),a=n.find(s,function(e){var n,r=t(e),s=i.data(r);return n=o.line_from?s.above_fnum>o.line_from||!s.above_fnum:s.above_tnum>o.line_to||!s.above_tnum});t(a).find(".ellipsis").trigger("click",o)}})},o.prototype.expand=function(e,n){e.preventDefault(),this.$elem.find(".skipped-container .ellipsis").tooltip("hide");var i=t(e.target).closest(".skipped-container");if(!i.hasClass("disabled")){i.addClass("disabled");var o=setTimeout(function(){i.addClass("loading")},300),s=function(){clearTimeout(o),i.removeClass("disabled loading")},a=this;t.ajax({url:a.url,data:a.data(i,n),dataType:"json",complete:s,statusCode:{200:function(e){var n=i.closest(".bb-udiff"),o=n.attr("data-filename"),s=t(e.lines);if(t(".tipsy").remove(),a.setPermalinks(s),i.replaceWith(s),e.thread_ids){var l=r.decorateThreads(a.commentUrlRoot,e.thread_ids,o);a.diff&&a.diff.acceptLineComments(l)}n.trigger("context-expander/load",e)},204:function(){i.remove()}}})}},o.prototype.data=function(e,t){var n=e.prev().find(".line-numbers"),r=e.next().find(".line-numbers"),o={};return n.length&&(o.below_fnum=n.data("fnum"),o.below_tnum=n.data("tnum")),r.length&&(o.above_fnum=r.data("fnum"),o.above_tnum=r.data("tnum")),t&&(t.line_from&&(o.include_fnum=t.line_from),t.line_to&&(o.include_tnum=t.line_to)),this.showComments||(o.nocomments=!0),o.w=i.get("w"),o},o.prototype.setPermalinks=function(e){var n=/(F\d+)?(T\d+)?$/,i=this.identifier;e.find(".line-numbers").each(function(){var e=t(this).closest(".gutter"),r=e.attr("id"),o=r.match(n);if(o[1]||o[2]){var s="L"+i;o[1]&&(s+=o[1]),o[2]&&(s+=o[2]),e.attr({id:s,href:"#"+s})}})},o}),function(e){define("diff-match-patch",[],function(){return function(){return function(){function e(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32}e.prototype.diff_main=function(e,t,n,i){if("undefined"==typeof i&&(i=0>=this.Diff_Timeout?Number.MAX_VALUE:(new Date).getTime()+1e3*this.Diff_Timeout),null==e||null==t)throw Error("Null input. (diff_main)");if(e==t)return e?[[0,e]]:[];"undefined"==typeof n&&(n=!0);var r=n,o=this.diff_commonPrefix(e,t);n=e.substring(0,o),e=e.substring(o),t=t.substring(o);var o=this.diff_commonSuffix(e,t),s=e.substring(e.length-o);return e=e.substring(0,e.length-o),t=t.substring(0,t.length-o),e=this.diff_compute_(e,t,r,i),n&&e.unshift([0,n]),s&&e.push([0,s]),this.diff_cleanupMerge(e),e},e.prototype.diff_compute_=function(e,t,n,i){if(!e)return[[1,t]];if(!t)return[[-1,e]];var r=e.length>t.length?e:t,o=e.length>t.length?t:e,s=r.indexOf(o);return-1!=s?(n=[[1,r.substring(0,s)],[0,o],[1,r.substring(s+o.length)]],e.length>t.length&&(n[0][0]=n[2][0]=-1),n):1==o.length?[[-1,e],[1,t]]:(r=this.diff_halfMatch_(e,t))?(o=r[0],e=r[1],s=r[2],t=r[3],r=r[4],o=this.diff_main(o,s,n,i),n=this.diff_main(e,t,n,i),o.concat([[0,r]],n)):n&&100<e.length&&100<t.length?this.diff_lineMode_(e,t,i):this.diff_bisect_(e,t,i)},e.prototype.diff_lineMode_=function(e,t,n){var i=this.diff_linesToChars_(e,t);e=i.chars1,t=i.chars2,i=i.lineArray,e=this.diff_main(e,t,!1,n),this.diff_charsToLines_(e,i),this.diff_cleanupSemantic(e),e.push([0,""]);for(var r=i=t=0,o="",s="";t<e.length;){switch(e[t][0]){case 1:r++,s+=e[t][1];break;case-1:i++,o+=e[t][1];break;case 0:if(i>=1&&r>=1){for(e.splice(t-i-r,i+r),t=t-i-r,i=this.diff_main(o,s,!1,n),r=i.length-1;r>=0;r--)e.splice(t,0,i[r]);t+=i.length}i=r=0,s=o=""}t++}return e.pop(),e},e.prototype.diff_bisect_=function(e,t,n){for(var i=e.length,r=t.length,o=Math.ceil((i+r)/2),s=o,a=2*o,l=Array(a),u=Array(a),c=0;a>c;c++)l[c]=-1,u[c]=-1;l[s+1]=0,u[s+1]=0;for(var c=i-r,d=0!=c%2,h=0,p=0,f=0,m=0,g=0;o>g&&!((new Date).getTime()>n);g++){for(var v=-g+h;g-p>=v;v+=2){var y,b=s+v;y=v==-g||v!=g&&l[b-1]<l[b+1]?l[b+1]:l[b-1]+1;for(var w=y-v;i>y&&r>w&&e.charAt(y)==t.charAt(w);)y++,w++;if(l[b]=y,y>i)p+=2;else if(w>r)h+=2;else if(d&&(b=s+c-v,b>=0&&a>b&&-1!=u[b])){var x=i-u[b];if(y>=x)return this.diff_bisectSplit_(e,t,y,w,n)}}for(v=-g+f;g-m>=v;v+=2){for(b=s+v,x=v==-g||v!=g&&u[b-1]<u[b+1]?u[b+1]:u[b-1]+1,y=x-v;i>x&&r>y&&e.charAt(i-x-1)==t.charAt(r-y-1);)x++,y++;if(u[b]=x,x>i)m+=2;else if(y>r)f+=2;else if(!d&&(b=s+c-v,b>=0&&a>b&&-1!=l[b]&&(y=l[b],w=s+y-b,x=i-x,y>=x)))return this.diff_bisectSplit_(e,t,y,w,n)}}return[[-1,e],[1,t]]},e.prototype.diff_bisectSplit_=function(e,t,n,i,r){var o=e.substring(0,n),s=t.substring(0,i);return e=e.substring(n),t=t.substring(i),o=this.diff_main(o,s,!1,r),r=this.diff_main(e,t,!1,r),o.concat(r)},e.prototype.diff_linesToChars_=function(e,t){function n(e){for(var t="",n=0,o=-1,s=i.length;o<e.length-1;){o=e.indexOf("\n",n),-1==o&&(o=e.length-1);var a=e.substring(n,o+1),n=o+1;(r.hasOwnProperty?r.hasOwnProperty(a):void 0!==r[a])?t+=String.fromCharCode(r[a]):(t+=String.fromCharCode(s),r[a]=s,i[s++]=a)}return t}var i=[],r={};i[0]="";var o=n(e),s=n(t);return{chars1:o,chars2:s,lineArray:i}},e.prototype.diff_charsToLines_=function(e,t){for(var n=0;n<e.length;n++){for(var i=e[n][1],r=[],o=0;o<i.length;o++)r[o]=t[i.charCodeAt(o)];e[n][1]=r.join("")}},e.prototype.diff_commonPrefix=function(e,t){if(!e||!t||e.charAt(0)!=t.charAt(0))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;r>n;)e.substring(o,r)==t.substring(o,r)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonSuffix=function(e,t){if(!e||!t||e.charAt(e.length-1)!=t.charAt(t.length-1))return 0;for(var n=0,i=Math.min(e.length,t.length),r=i,o=0;r>n;)e.substring(e.length-r,e.length-o)==t.substring(t.length-r,t.length-o)?o=n=r:i=r,r=Math.floor((i-n)/2+n);return r},e.prototype.diff_commonOverlap_=function(e,t){var n=e.length,i=t.length;if(0==n||0==i)return 0;if(n>i?e=e.substring(n-i):i>n&&(t=t.substring(0,n)),n=Math.min(n,i),e==t)return n;for(var i=0,r=1;;){var o=e.substring(n-r),o=t.indexOf(o);if(-1==o)return i;r+=o,(0==o||e.substring(n-r)==t.substring(0,r))&&(i=r,r++)}},e.prototype.diff_halfMatch_=function(e,t){function n(e,t,n){for(var i,r,o,a,l=e.substring(n,n+Math.floor(e.length/4)),u=-1,c="";-1!=(u=t.indexOf(l,u+1));){var d=s.diff_commonPrefix(e.substring(n),t.substring(u)),h=s.diff_commonSuffix(e.substring(0,n),t.substring(0,u));c.length<h+d&&(c=t.substring(u-h,u)+t.substring(u,u+d),i=e.substring(0,n-h),r=e.substring(n+d),o=t.substring(0,u-h),a=t.substring(u+d))}return 2*c.length>=e.length?[i,r,o,a,c]:null}if(0>=this.Diff_Timeout)return null;var i=e.length>t.length?e:t,r=e.length>t.length?t:e;if(4>i.length||2*r.length<i.length)return null;var o,s=this,a=n(i,r,Math.ceil(i.length/4)),i=n(i,r,Math.ceil(i.length/2));if(!a&&!i)return null;o=i?a&&a[4].length>i[4].length?a:i:a;var l;return e.length>t.length?(a=o[0],i=o[1],r=o[2],l=o[3]):(r=o[0],l=o[1],a=o[2],i=o[3]),o=o[4],[a,i,r,l,o]},e.prototype.diff_cleanupSemantic=function(e){for(var t=!1,n=[],i=0,r=null,o=0,s=0,a=0,l=0,u=0;o<e.length;)0==e[o][0]?(n[i++]=o,s=l,a=u,u=l=0,r=e[o][1]):(1==e[o][0]?l+=e[o][1].length:u+=e[o][1].length,r&&r.length<=Math.max(s,a)&&r.length<=Math.max(l,u)&&(e.splice(n[i-1],0,[-1,r]),e[n[i-1]+1][0]=1,i--,i--,o=i>0?n[i-1]:-1,u=l=a=s=0,r=null,t=!0)),o++;for(t&&this.diff_cleanupMerge(e),this.diff_cleanupSemanticLossless(e),o=1;o<e.length;)-1==e[o-1][0]&&1==e[o][0]&&(t=e[o-1][1],n=e[o][1],i=this.diff_commonOverlap_(t,n),r=this.diff_commonOverlap_(n,t),i>=r?(i>=t.length/2||i>=n.length/2)&&(e.splice(o,0,[0,n.substring(0,i)]),e[o-1][1]=t.substring(0,t.length-i),e[o+1][1]=n.substring(i),o++):(r>=t.length/2||r>=n.length/2)&&(e.splice(o,0,[0,t.substring(0,r)]),e[o-1][0]=1,e[o-1][1]=n.substring(0,n.length-r),e[o+1][0]=-1,e[o+1][1]=t.substring(r),o++),o++),o++},e.prototype.diff_cleanupSemanticLossless=function(t){function n(t,n){if(!t||!n)return 6;var i=t.charAt(t.length-1),r=n.charAt(0),o=i.match(e.nonAlphaNumericRegex_),s=r.match(e.nonAlphaNumericRegex_),a=o&&i.match(e.whitespaceRegex_),l=s&&r.match(e.whitespaceRegex_),i=a&&i.match(e.linebreakRegex_),r=l&&r.match(e.linebreakRegex_),u=i&&t.match(e.blanklineEndRegex_),c=r&&n.match(e.blanklineStartRegex_);return u||c?5:i||r?4:o&&!a&&l?3:a||l?2:o||s?1:0}for(var i=1;i<t.length-1;){if(0==t[i-1][0]&&0==t[i+1][0]){var r=t[i-1][1],o=t[i][1],s=t[i+1][1],a=this.diff_commonSuffix(r,o);if(a)var l=o.substring(o.length-a),r=r.substring(0,r.length-a),o=l+o.substring(0,o.length-a),s=l+s;for(var a=r,l=o,u=s,c=n(r,o)+n(o,s);o.charAt(0)===s.charAt(0);){var r=r+o.charAt(0),o=o.substring(1)+s.charAt(0),s=s.substring(1),d=n(r,o)+n(o,s);d>=c&&(c=d,a=r,l=o,u=s)}t[i-1][1]!=a&&(a?t[i-1][1]=a:(t.splice(i-1,1),i--),t[i][1]=l,u?t[i+1][1]=u:(t.splice(i+1,1),i--))}i++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\s/,e.linebreakRegex_=/[\r\n]/,e.blanklineEndRegex_=/\n\r?\n$/,e.blanklineStartRegex_=/^\r?\n\r?\n/,e.prototype.diff_cleanupEfficiency=function(e){for(var t=!1,n=[],i=0,r=null,o=0,s=!1,a=!1,l=!1,u=!1;o<e.length;)0==e[o][0]?(e[o][1].length<this.Diff_EditCost&&(l||u)?(n[i++]=o,s=l,a=u,r=e[o][1]):(i=0,r=null),l=u=!1):(-1==e[o][0]?u=!0:l=!0,r&&(s&&a&&l&&u||r.length<this.Diff_EditCost/2&&3==s+a+l+u)&&(e.splice(n[i-1],0,[-1,r]),e[n[i-1]+1][0]=1,i--,r=null,s&&a?(l=u=!0,i=0):(i--,o=i>0?n[i-1]:-1,l=u=!1),t=!0)),o++;t&&this.diff_cleanupMerge(e)},e.prototype.diff_cleanupMerge=function(e){e.push([0,""]);for(var t,n=0,i=0,r=0,o="",s="";n<e.length;)switch(e[n][0]){case 1:r++,s+=e[n][1],n++;break;case-1:i++,o+=e[n][1],n++;break;case 0:i+r>1?(0!==i&&0!==r&&(t=this.diff_commonPrefix(s,o),0!==t&&(n-i-r>0&&0==e[n-i-r-1][0]?e[n-i-r-1][1]+=s.substring(0,t):(e.splice(0,0,[0,s.substring(0,t)]),n++),s=s.substring(t),o=o.substring(t)),t=this.diff_commonSuffix(s,o),0!==t&&(e[n][1]=s.substring(s.length-t)+e[n][1],s=s.substring(0,s.length-t),o=o.substring(0,o.length-t))),0===i?e.splice(n-r,i+r,[1,s]):0===r?e.splice(n-i,i+r,[-1,o]):e.splice(n-i-r,i+r,[-1,o],[1,s]),n=n-i-r+(i?1:0)+(r?1:0)+1):0!==n&&0==e[n-1][0]?(e[n-1][1]+=e[n][1],e.splice(n,1)):n++,i=r=0,s=o=""}for(""===e[e.length-1][1]&&e.pop(),i=!1,n=1;n<e.length-1;)0==e[n-1][0]&&0==e[n+1][0]&&(e[n][1].substring(e[n][1].length-e[n-1][1].length)==e[n-1][1]?(e[n][1]=e[n-1][1]+e[n][1].substring(0,e[n][1].length-e[n-1][1].length),e[n+1][1]=e[n-1][1]+e[n+1][1],e.splice(n-1,1),i=!0):e[n][1].substring(0,e[n+1][1].length)==e[n+1][1]&&(e[n-1][1]+=e[n+1][1],e[n][1]=e[n][1].substring(e[n+1][1].length)+e[n+1][1],e.splice(n+1,1),i=!0)),n++;i&&this.diff_cleanupMerge(e)},e.prototype.diff_xIndex=function(e,t){var n,i=0,r=0,o=0,s=0;for(n=0;n<e.length&&(1!==e[n][0]&&(i+=e[n][1].length),-1!==e[n][0]&&(r+=e[n][1].length),!(i>t));n++)o=i,s=r;return e.length!=n&&-1===e[n][0]?s:s+(t-o)},e.prototype.diff_prettyHtml=function(e){for(var t=[],n=/&/g,i=/</g,r=/>/g,o=/\n/g,s=0;s<e.length;s++){var a=e[s][0],l=e[s][1],l=l.replace(n,"&amp;").replace(i,"&lt;").replace(r,"&gt;").replace(o,"&para;<br>");switch(a){case 1:t[s]='<ins style="background:#e6ffe6;">'+l+"</ins>";break;case-1:t[s]='<del style="background:#ffe6e6;">'+l+"</del>";break;case 0:t[s]="<span>"+l+"</span>"}}return t.join("")},e.prototype.diff_text1=function(e){for(var t=[],n=0;n<e.length;n++)1!==e[n][0]&&(t[n]=e[n][1]);return t.join("")},e.prototype.diff_text2=function(e){for(var t=[],n=0;n<e.length;n++)-1!==e[n][0]&&(t[n]=e[n][1]);
return t.join("")},e.prototype.diff_levenshtein=function(e){for(var t=0,n=0,i=0,r=0;r<e.length;r++){var o=e[r][0],s=e[r][1];switch(o){case 1:n+=s.length;break;case-1:i+=s.length;break;case 0:t+=Math.max(n,i),i=n=0}}return t+=Math.max(n,i)},e.prototype.diff_toDelta=function(e){for(var t=[],n=0;n<e.length;n++)switch(e[n][0]){case 1:t[n]="+"+encodeURI(e[n][1]);break;case-1:t[n]="-"+e[n][1].length;break;case 0:t[n]="="+e[n][1].length}return t.join("	").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(e,t){for(var n=[],i=0,r=0,o=t.split(/\t/g),s=0;s<o.length;s++){var a=o[s].substring(1);switch(o[s].charAt(0)){case"+":try{n[i++]=[1,decodeURI(a)]}catch(l){throw Error("Illegal escape in diff_fromDelta: "+a)}break;case"-":case"=":var u=parseInt(a,10);if(isNaN(u)||0>u)throw Error("Invalid number in diff_fromDelta: "+a);a=e.substring(r,r+=u),n[i++]="="==o[s].charAt(0)?[0,a]:[-1,a];break;default:if(o[s])throw Error("Invalid diff operation in diff_fromDelta: "+o[s])}}if(r!=e.length)throw Error("Delta length ("+r+") does not equal source text length ("+e.length+").");return n},e.prototype.match_main=function(e,t,n){if(null==e||null==t||null==n)throw Error("Null input. (match_main)");return n=Math.max(0,Math.min(n,e.length)),e==t?0:e.length?e.substring(n,n+t.length)==t?n:this.match_bitap_(e,t,n):-1},e.prototype.match_bitap_=function(e,t,n){function i(e,i){var r=e/t.length,s=Math.abs(n-i);return o.Match_Distance?r+s/o.Match_Distance:s?1:r}if(t.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var r=this.match_alphabet_(t),o=this,s=this.Match_Threshold,a=e.indexOf(t,n);-1!=a&&(s=Math.min(i(0,a),s),a=e.lastIndexOf(t,n+t.length),-1!=a&&(s=Math.min(i(0,a),s)));for(var l,u,c,d=1<<t.length-1,a=-1,h=t.length+e.length,p=0;p<t.length;p++){for(l=0,u=h;u>l;)i(p,n+u)<=s?l=u:h=u,u=Math.floor((h-l)/2+l);h=u,l=Math.max(1,n-u+1);var f=Math.min(n+u,e.length)+t.length;for(u=Array(f+2),u[f+1]=(1<<p)-1;f>=l;f--){var m=r[e.charAt(f-1)];if(u[f]=0===p?(u[f+1]<<1|1)&m:(u[f+1]<<1|1)&m|((c[f+1]|c[f])<<1|1)|c[f+1],u[f]&d&&(m=i(p,f-1),s>=m)){if(s=m,a=f-1,!(a>n))break;l=Math.max(1,2*n-a)}}if(i(p+1,n)>s)break;c=u}return a},e.prototype.match_alphabet_=function(e){for(var t={},n=0;n<e.length;n++)t[e.charAt(n)]=0;for(n=0;n<e.length;n++)t[e.charAt(n)]|=1<<e.length-n-1;return t},e.prototype.patch_addContext_=function(e,t){if(0!=t.length){for(var n=t.substring(e.start2,e.start2+e.length1),i=0;t.indexOf(n)!=t.lastIndexOf(n)&&n.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)i+=this.Patch_Margin,n=t.substring(e.start2-i,e.start2+e.length1+i);i+=this.Patch_Margin,(n=t.substring(e.start2-i,e.start2))&&e.diffs.unshift([0,n]),(i=t.substring(e.start2+e.length1,e.start2+e.length1+i))&&e.diffs.push([0,i]),e.start1-=n.length,e.start2-=n.length,e.length1+=n.length+i.length,e.length2+=n.length+i.length}},e.prototype.patch_make=function(t,n,i){var r;if("string"==typeof t&&"string"==typeof n&&"undefined"==typeof i)r=t,n=this.diff_main(r,n,!0),2<n.length&&(this.diff_cleanupSemantic(n),this.diff_cleanupEfficiency(n));else if(t&&"object"==typeof t&&"undefined"==typeof n&&"undefined"==typeof i)n=t,r=this.diff_text1(n);else if("string"==typeof t&&n&&"object"==typeof n&&"undefined"==typeof i)r=t;else{if("string"!=typeof t||"string"!=typeof n||!i||"object"!=typeof i)throw Error("Unknown call format to patch_make.");r=t,n=i}if(0===n.length)return[];i=[],t=new e.patch_obj;for(var o=0,s=0,a=0,l=r,u=0;u<n.length;u++){var c=n[u][0],d=n[u][1];switch(!o&&0!==c&&(t.start1=s,t.start2=a),c){case 1:t.diffs[o++]=n[u],t.length2+=d.length,r=r.substring(0,a)+d+r.substring(a);break;case-1:t.length1+=d.length,t.diffs[o++]=n[u],r=r.substring(0,a)+r.substring(a+d.length);break;case 0:d.length<=2*this.Patch_Margin&&o&&n.length!=u+1?(t.diffs[o++]=n[u],t.length1+=d.length,t.length2+=d.length):d.length>=2*this.Patch_Margin&&o&&(this.patch_addContext_(t,l),i.push(t),t=new e.patch_obj,o=0,l=r,s=a)}1!==c&&(s+=d.length),-1!==c&&(a+=d.length)}return o&&(this.patch_addContext_(t,l),i.push(t)),i},e.prototype.patch_deepCopy=function(t){for(var n=[],i=0;i<t.length;i++){var r=t[i],o=new e.patch_obj;o.diffs=[];for(var s=0;s<r.diffs.length;s++)o.diffs[s]=r.diffs[s].slice();o.start1=r.start1,o.start2=r.start2,o.length1=r.length1,o.length2=r.length2,n[i]=o}return n},e.prototype.patch_apply=function(e,t){if(0==e.length)return[t,[]];e=this.patch_deepCopy(e);var n=this.patch_addPadding(e);t=n+t+n,this.patch_splitMax(e);for(var i=0,r=[],o=0;o<e.length;o++){var s,a=e[o].start2+i,l=this.diff_text1(e[o].diffs),u=-1;if(l.length>this.Match_MaxBits?(s=this.match_main(t,l.substring(0,this.Match_MaxBits),a),-1!=s&&(u=this.match_main(t,l.substring(l.length-this.Match_MaxBits),a+l.length-this.Match_MaxBits),-1==u||s>=u)&&(s=-1)):s=this.match_main(t,l,a),-1==s)r[o]=!1,i-=e[o].length2-e[o].length1;else if(r[o]=!0,i=s-a,a=-1==u?t.substring(s,s+l.length):t.substring(s,u+this.Match_MaxBits),l==a)t=t.substring(0,s)+this.diff_text2(e[o].diffs)+t.substring(s+l.length);else if(a=this.diff_main(l,a,!1),l.length>this.Match_MaxBits&&this.diff_levenshtein(a)/l.length>this.Patch_DeleteThreshold)r[o]=!1;else{this.diff_cleanupSemanticLossless(a);for(var c,l=0,u=0;u<e[o].diffs.length;u++){var d=e[o].diffs[u];0!==d[0]&&(c=this.diff_xIndex(a,l)),1===d[0]?t=t.substring(0,s+c)+d[1]+t.substring(s+c):-1===d[0]&&(t=t.substring(0,s+c)+t.substring(s+this.diff_xIndex(a,l+d[1].length))),-1!==d[0]&&(l+=d[1].length)}}}return t=t.substring(n.length,t.length-n.length),[t,r]},e.prototype.patch_addPadding=function(e){for(var t=this.Patch_Margin,n="",i=1;t>=i;i++)n+=String.fromCharCode(i);for(i=0;i<e.length;i++)e[i].start1+=t,e[i].start2+=t;var i=e[0],r=i.diffs;if(0==r.length||0!=r[0][0])r.unshift([0,n]),i.start1-=t,i.start2-=t,i.length1+=t,i.length2+=t;else if(t>r[0][1].length){var o=t-r[0][1].length;r[0][1]=n.substring(r[0][1].length)+r[0][1],i.start1-=o,i.start2-=o,i.length1+=o,i.length2+=o}return i=e[e.length-1],r=i.diffs,0==r.length||0!=r[r.length-1][0]?(r.push([0,n]),i.length1+=t,i.length2+=t):t>r[r.length-1][1].length&&(o=t-r[r.length-1][1].length,r[r.length-1][1]+=n.substring(0,o),i.length1+=o,i.length2+=o),n},e.prototype.patch_splitMax=function(t){for(var n=this.Match_MaxBits,i=0;i<t.length;i++)if(!(t[i].length1<=n)){var r=t[i];t.splice(i--,1);for(var o=r.start1,s=r.start2,a="";0!==r.diffs.length;){var l=new e.patch_obj,u=!0;for(l.start1=o-a.length,l.start2=s-a.length,""!==a&&(l.length1=l.length2=a.length,l.diffs.push([0,a]));0!==r.diffs.length&&l.length1<n-this.Patch_Margin;){var a=r.diffs[0][0],c=r.diffs[0][1];1===a?(l.length2+=c.length,s+=c.length,l.diffs.push(r.diffs.shift()),u=!1):-1===a&&1==l.diffs.length&&0==l.diffs[0][0]&&c.length>2*n?(l.length1+=c.length,o+=c.length,u=!1,l.diffs.push([a,c]),r.diffs.shift()):(c=c.substring(0,n-l.length1-this.Patch_Margin),l.length1+=c.length,o+=c.length,0===a?(l.length2+=c.length,s+=c.length):u=!1,l.diffs.push([a,c]),c==r.diffs[0][1]?r.diffs.shift():r.diffs[0][1]=r.diffs[0][1].substring(c.length))}a=this.diff_text2(l.diffs),a=a.substring(a.length-this.Patch_Margin),c=this.diff_text1(r.diffs).substring(0,this.Patch_Margin),""!==c&&(l.length1+=c.length,l.length2+=c.length,0!==l.diffs.length&&0===l.diffs[l.diffs.length-1][0]?l.diffs[l.diffs.length-1][1]+=c:l.diffs.push([0,c])),u||t.splice(++i,0,l)}}},e.prototype.patch_toText=function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e[n];return t.join("")},e.prototype.patch_fromText=function(t){var n=[];if(!t)return n;t=t.split("\n");for(var i=0,r=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;i<t.length;){var o=t[i].match(r);if(!o)throw Error("Invalid patch string: "+t[i]);var s=new e.patch_obj;for(n.push(s),s.start1=parseInt(o[1],10),""===o[2]?(s.start1--,s.length1=1):"0"==o[2]?s.length1=0:(s.start1--,s.length1=parseInt(o[2],10)),s.start2=parseInt(o[3],10),""===o[4]?(s.start2--,s.length2=1):"0"==o[4]?s.length2=0:(s.start2--,s.length2=parseInt(o[4],10)),i++;i<t.length;){o=t[i].charAt(0);try{var a=decodeURI(t[i].substring(1))}catch(l){throw Error("Illegal escape in patch_fromText: "+a)}if("-"==o)s.diffs.push([-1,a]);else if("+"==o)s.diffs.push([1,a]);else if(" "==o)s.diffs.push([0,a]);else{if("@"==o)break;if(""!==o)throw Error('Invalid patch mode "'+o+'" in: '+a)}i++}}return n},e.patch_obj=function(){this.diffs=[],this.start2=this.start1=null,this.length2=this.length1=0},e.patch_obj.prototype.toString=function(){var e,t;e=0===this.length1?this.start1+",0":1==this.length1?this.start1+1:this.start1+1+","+this.length1,t=0===this.length2?this.start2+",0":1==this.length2?this.start2+1:this.start2+1+","+this.length2,e=["@@ -"+e+" +"+t+" @@\n"];var n;for(t=0;t<this.diffs.length;t++){switch(this.diffs[t][0]){case 1:n="+";break;case-1:n="-";break;case 0:n=" "}e[t+1]=n+encodeURI(this.diffs[t][1])+"\n"}return e.join("").replace(/%20/g," ")},this.diff_match_patch=e,this.DIFF_DELETE=-1,this.DIFF_INSERT=1,this.DIFF_EQUAL=0}(),e.diff_match_patch=diff_match_patch}.apply(e,arguments)})}(this),define("data/current-cset",["jquery"],function(e){var t=e(document.body).attr("data-current-cset");return t}),define("components/diff/block-loader",["jquery","data/current-cset","data/current-repo","utils/api-helper"],function(e,t,n,i){function r(o,s,a){if(!(this instanceof r))return new r(o,s,a);this.pagesPerBlock_=s,this.linesPerPage_=a,this.blocks_={from:[],to:[]},this.filename_={from:"",to:""},this.incremental_=[];var l=i.concat("repositories",n.owner.username,n.slug,"changesets",t,"diff");return e("#compare")&&e("#compare").data("compare-files-url")&&(l=e("#compare").data("compare-files-url")),this.url_=o||l.toString(),this}return r.prototype=function(){var t=r.prototype;return t.queueBlocks_=function(t,n){for(var i=0;i<n.length;i++){var r=n[i],o=this.blocks_[t];e.inArray(r,o)<0&&o.push(r)}},t.from=function(e,t){return this.queueBlocks_("from",e),this.filename_.from=t,this},t.to=function(e,t){return this.queueBlocks_("to",e),this.filename_.to=t,this},t.incremental=function(e){return this.incremental_.push(e),this},t.load=function(t){if(this.complete_=t,0===this.blocks_.from.length&&0===this.blocks_.to.length)t&&t();else{var n=this.filename_.from||this.filename_.to;e(document).trigger("diff-load-start",[n]),e.ajax({type:"GET",url:this.url_,data:{linesPerPage:this.linesPerPage_,fromBlock:this.blocks_.from.shift(),toBlock:this.blocks_.to.shift(),filename:n},dataType:"json",success:e.proxy(this.success_,this)})}},t.success_=function(t){var n=this.filename_.from||this.filename_.to;e(document).trigger("diff-load-end",[n]);for(var i=t[0],r=i.from_file,o=i.to_file,s=0;s<this.incremental_.length;s++)this.incremental_[s](r,o);this.load(this.complete_)},t}(),r}),define("components/diff/permalinker",[],function(){var e=function(){this.baseUrl_=window.top.location.href.replace(location.hash,"")};return e.prototype.regex_=/^#chg_(.*)_(newline|oldline)(\d+)$/,e.prototype.parse=function(e){var t=this.regex_.exec(e);return t?{path:t[1],file:"oldline"===t[2]?"from":"to",line:parseInt(t[3],10)}:void 0},e.prototype.url=function(e,t,n){return this.baseUrl_+"#chg_"+encodeURIComponent(t)+"_"+("from"===e?"oldline":"newline")+n},e}),define("components/diff/range",[],function(){var e=function(t,n){return this instanceof e?(this.low=t,this.high=n,this.length=n-t+1,this):new e(t,n)};return e.ofLength=function(t,n){return new e(t,t+n-1)},e.ofLine=function(t){return e.ofLength(t,1)},e.ofLines=function(t,n){return new e(t,n)},e.pointAfterLine=function(t){return new e(t,t-1)},e.pointBeforeLine=function(t){return e.pointAfterLine(t-1)},e.prototype={constructor:e,isPoint:function(){return this.low-1===this.high},before:function(e){return this.isPoint()&&e.isPoint()?this.high<e.low:this.isPoint()?this.low<=e.low-1:e.isPoint()?this.high<=e.low:this.high<e.low},after:function(e){return e.before(this)},overlaps:function(e){return this.isPoint()&&e.isPoint()?this.equals(e):this.isPoint()?e.overlaps(this):e.isPoint()?this.low-1<=e.low&&e.low<=this.high:this.low<=e.high&&e.low<=this.high},adjacent:function(e){return this.isPoint()&&e.isPoint()?this.equals(e):this.isPoint()?this.low+1===e.low||this.low===e.high:e.isPoint()?e.adjacent(this):this.high+1===e.low||e.low+1===this.high},expand:function(t){if(0===t)return this;var n,i;return this.isPoint()?(n=Math.max(1,this.low-(t-1)),i=this.low+t):(n=Math.max(1,this.low-t),i=this.high+t),new e(n,i)},merge:function(t){if(this.isPoint()&&t.isPoint())return this.equals(t)?this:null;if(this.isPoint())return t.merge(this);if(t.isPoint())return this.overlaps(t)||this.adjacent(t)?this:null;if(this.overlaps(t)||this.adjacent(t)){var n=Math.min(this.low,t.low),i=Math.max(this.high,t.high);return new e(n,i)}return null},equals:function(e){return this.low===e.low&&this.high==e.high},toString:function(){return"["+this.low+", "+this.high+"]"}},e}),define("components/diff/file",["jquery","components/diff/permalinker","components/diff/range","data/client"],function(e,t,n,i){function r(t){"undefined"==typeof s&&(s=e(".gutter-box"));for(var n=0,i=s.length;i>n;++n)t(n,s.eq(n))}function o(e,t,n,i){if(!(this instanceof o))return new o(e,t,rawFileData,i);var r=n.meta;return this.numLines||(this.numLines=0),r?(this.name=r.name,this.filename=r.filename,this.position=r.position,this.numLines=r.numLines,this.maxLineNum=r.numLines,this.longestLine=r.longestLine,this.longestRevisionBlameLength=r.longestRevisionBlameLength,this.longestAuthorBlameLength=r.longestAuthorBlameLength,this.pagesPerBlock=e,this.linesPerPage=t,this.gutterWidths=r.gutterWidths,this.zeroContextRanges_=i,this.blocks={},this.blocksRendered={},this.merge(n),this.scrollBoxDom=null,this.numbersBoxDom=null,this.revisionBlameBoxDom=null,this.lineHeightPx=null,this):null}var s;return o.DELIMITER=">",o.prototype=function(){function s(t){return t.scrollBoxDom||(t.scrollBoxDom=e("#"+t.name+"-box")[0]),t.scrollBoxDom}function a(t){return t.numbersBoxDom||(t.numbersBoxDom=e("#"+t.name+"-numbers-box")[0]),t.numbersBoxDom}function l(t){return t.revisionBlameBoxDom||(t.revisionBlameBoxDom=e("#"+t.name+"-revision-blame-box")[0]),t.revisionBlameBoxDom}function u(t){return t.authorBlameBoxDom||(t.authorBlameBoxDom=e("#"+t.name+"-auth-blame-box")[0]),t.authorBlameBoxDom}function c(e,t,n,i,r){e.id=t.name+"-"+r+"-"+n+"-"+i}function d(e,t,n){return e.pageDom_(t,n),e.blocks[t][n].numbersDom}function h(e,t,n){return e.pageDom_(t,n),e.blocks[t][n].revBlameDom}function p(e,t,n){return e.pageDom_(t,n),e.blocks[t][n].authBlameDom}function f(e,t,n,i){return e.pageDom_(t,n),e.blocks[t][n].gutterDom[i]}var m=o.prototype;m.isUnified=function(){return!1},m.numContext=function(){return-1},m.exists=function(){return!!this.blocks},m.merge=function(e){var t=e.block_num;t>=0&&(this.blocks[t]=e.pages)},m.queueBlocks=function(e,t){var n=this;e[n.name](n.blocksToFetch(t),n.filename).incremental(function(e,t){n.merge("from"===n.name?e:t)})},m.ensureVisible=function(e){if(this.numLines>0)for(var t=this.pagesPerBlock*this.linesPerPage,n=Math.floor((e.low-1)/t),i=Math.floor((e.high-1)/t),r=n;i>=r;r++)for(var o=r*t,s=e.low-1-o,a=Math.min(e.high-1-o,(r+1)*t-1),l=Math.floor(s/this.linesPerPage),u=Math.floor(a/this.linesPerPage),c=l;u>=c;c++)(this.isNotInDom_(r,c)||!this.pageDom_(r,c).parentNode)&&this.insertPage_(r,c)},m.blocksToFetch=function(e){for(var t=this.linesPerPage*this.pagesPerBlock,n=Math.floor(e.low/t),i=Math.floor(e.high/t),r=[],o=n;i>=o;o++)this.blocks[o]||(this.blocks[o]=this.blocksToFetch.loadingSentinel,r.push(o));return r},m.blocksToFetch.loadingSentinel={loading:!0},m.isNotInDom_=function(e,t){return this.blocks[e]&&this.blocks[e][t]&&(!this.blocksRendered[e]||!this.blocksRendered[e][t])},m.zeroContextRanges=function(){return this.zeroContextRanges_},m.coords_=function(e){var t=e-1,n=this.pagesPerBlock*this.linesPerPage,i=Math.floor(t/n),r=t%n,o=Math.floor(r/this.linesPerPage),s=r%this.linesPerPage;return{block:i,page:o,lineIndex:s}},m.insertPage_=function(t,n){var i=e(s(this)),o=e(a(this)),c=e(l(this)),m=e(u(this)),g=(t*this.pagesPerBlock+n)*this.linesPerPage*this.lineHeightPx;i[0].appendChild(e(this.pageDom_(t,n)).css("top",g).css("width",i.data("width"))[0]),o[0].appendChild(e(d(this,t,n)).css("top",g)[0]),0!==c.length&&c.children(".content-box")[0].appendChild(e(h(this,t,n)).css("top",g)[0]),0!==m.length&&m.children(".content-box")[0].appendChild(e(p(this,t,n)).css("top",g)[0]),r(function(i,r){r.children(".content-box")[0].appendChild(e(f(this,t,n,i)).css("top",g)[0])})},m.pageDom_=function(e,t){var n=this.blocks[e];if(this.isNotInDom_(e,t)){var i=this.evalPage_(e,t),r=this.createPageDom_(i),o=g(this,e,t,i),s=e*this.pagesPerBlock+t;r.className+=0===s?" page-first ":"",o.className+=0===s?" page-first ":"",c(r,this,e,s,"page"),c(o,this,e,s,"numbers");var a;l(this)?(a=v(this,e,t,i),c(a,this,e,s,"revision-blame")):a=document.createElement("div");var d;u(this)?(d=y(this,e,t,i),c(d,this,e,s,"auth-blame")):d=document.createElement("div");var h=b(this,e,t,i);n[t]={pageDom:r,numbersDom:o,revBlameDom:a,authBlameDom:d,gutterDom:h}}return n[t].pageDom},m.evalPage_=function(t,i){for(var r=(t*this.pagesPerBlock+i)*this.linesPerPage+1,o=n.ofLength(r,this.linesPerPage),s=e.grep(this.zeroContextRanges(),function(e){return o.overlaps(e)}),a=this.blocks[t][i],l=0;l<s.length;l++){var u=s[l];if(u.linesHtml)for(var c=0;c<u.length;c++){var d=u.low+c,h=d-r;h>=0&&h<this.linesPerPage&&(a[d-r].html=u.linesHtml[c])}}return this.blocksRendered[t]=this.blocksRendered[t]||{},this.blocksRendered[t][i]=!0,a},m.createPageDom_=function(e){var t=document.createElement("div");t.className="page";for(var n=0,i=e.length;i>n;n++)t.appendChild(w(e[n]));return t},m.permalinker_=new t;var g=function(e,t,n,i){var r=document.createElement("div"),o=(t*e.pagesPerBlock+n)*e.linesPerPage+1;r.className="page line-numbers";for(var s=0,a=i.length;a>s;s++){var l=o+s,u=e.permalinker_.url(e.name,e.filename,l),c=w(i[s],'<a href="'+u+'">'+l+"</a>");r.appendChild(c)}return r},v=function(){return function(e,t,n,i){var r=document.createElement("div");r.className="page revision-blame";for(var o=0,s=i.length;s>o;o++){var a=w(i[o],"<span>"+(i[o].start?i[o].revision:"&nbsp;")+"</span>",[i[o].blameclass]);r.appendChild(a)}return r}}(),y=function(){return function(e,t,n,i){var r=document.createElement("div");r.className="page author-blame";for(var o=0,s=i.length;s>o;o++){var a=w(i[o],"<span>"+(i[o].start?i[o].author:"&nbsp;")+"</span>");r.appendChild(a)}return r}}(),b=function(){return function(e,t,n,i){for(var r=[],o=0;o<i[0].gutters.length;++o){r[o]=document.createElement("div");for(var s=0,a=i.length;a>s;s++){var l=w(i[s],i[s].gutters[o]);r[o].appendChild(l)}}return r}}(),w=function(){var e=["addition","change","deletion","conflict","start","end"],t=null,n=null;if(t=function(){var e=document.createElement("div");return"undefined"!=typeof e.innerText?"innerText":"textContent"}(),"Explorer"===i.browser){var r=document.createElement("div");n=function(e){var t=r;return t.innerHTML="<pre>"+e+"</pre>",t.removeChild(t.firstChild)}}else n=function(e){var t=document.createElement("pre");return t.innerHTML=e,t};return function(t,i,r){for(var o=n((i||t.html)+"\n"),s=[],a=0,l=e.length;l>a;a++){var u=e[a];t[u]&&s.push(u)}for(r=r||[],a=0,l=r.length;l>a;a++)s.push(r[a]);var c=s.join(" ");return c&&(o.className=c),o}}();return m.longestLineDom=function(){return w(this.longestLine)},m}(),o}),define("components/diff/hidden-file",[],function(){function e(t){return this instanceof e?(this.file_=t,this.name=this.file_.name,this.filename=this.file_.filename,this.position=this.file_.position,this.numLines=this.file_.numLines,this.maxLineNum=this.file_.maxLineNum,this.pagesPerBlock=this.file_.pagesPerBlock,this.linesPerPage=this.file_.linesPerPage,this.blocks=this.file_.blocks,this.lineHeightPx=this.file_.lineHeightPx,this):new e(t)}return e.of=function(t){return t instanceof e?t:new e(t)},e.prototype=function(){var t=e.prototype;return t.isUnified=function(){return this.file_.isUnified()},t.numContext=function(){return this.file_.numContext()},t.exists=function(){return!1},t.merge=function(e){return this.file_.merge(e)},t.queueBlocks=function(e,t){return this.file_.queueBlocks(e,t)},t.ensureVisible=function(){},t.pageDom_=function(e,t){return this.file_.pageDom_(e,t)},t.coords_=function(e){return this.file_.coords_(e)},t.blocksToFetch=function(e){return this.file_.blocksToFetch(e)},t.longestLineDom=function(){return this.file_.longestLineDom()},t.zeroContextRanges=function(){return this.file_.zeroContextRanges()},t}(),e}),define("components/diff/ranges",["components/diff/range"],function(e){var t={unzip:function(e){for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i];t.push(r.fromRange),n.push(r.toRange)}return[t,n]},nonEmpty:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n];i.length>0&&t.push(i)}return t},expand:function(e,n){for(var i=[],r=0;r<e.length;r++)i.push(e[r].expand(n));return t.merge(i)},mergeAdjacent:function(t,n,i){var r,o,s,a;return t[0].low>1?0===n?(r=[new e(1,t[0].high)],r.concat(t.slice(1))):n===t.length?(o=t[t.length-1],r=t.slice(0,t.length-1),r.push(new e(o.low,i)),r):(r=t.slice(0,n-1),s=t[n-1],a=t[n],r.push(new e(s.low,a.high)),r.concat(t.slice(n+1))):n===t.length-1?(o=t[t.length-1],r=t.slice(0,t.length-1),r.push(new e(o.low,i)),r):(r=t.slice(0,n),s=t[n],a=t[n+1],r.push(new e(s.low,a.high)),r.concat(t.slice(n+2)))},expandAtIndex:function(n,i,r,o){var s,a,l,u,c;return n[0].low>1?0===i?(a=new e(Math.max(1,n[0].low-r),n[0].high),[a].concat(n.slice(1))):i===n.length?(l=n[n.length-1],s=n.slice(0,n.length-1),s.push(new e(l.low,Math.min(l.high+r,o))),s):(s=n.slice(0,i-1),u=n[i-1],c=n[i],s.push(new e(u.low,Math.min(u.high+r,o))),s.push(new e(Math.max(c.low-r,Math.min(u.high+r,o)),c.high)),t.merge(s.concat(n.slice(i)))):i===n.length-1?(l=n[n.length-1],s=n.slice(0,n.length-1),s.push(new e(l.low,Math.min(l.high+r,o))),s):(s=n.slice(0,i),u=n[i],c=n[i+1],s.push(new e(u.low,Math.min(u.high+r,o))),s.push(new e(Math.max(c.low-r,Math.min(u.high+r,o)),c.high)),t.merge(s.concat(n.slice(i+2))))},merge:function(e){var t,n=[];if(e.length>0){for(var i=e[0],r=1;r<e.length;r++){var o=e[r];null!==(t=i.merge(o))?i=t:(n.push(i),i=o)}n.push(i)}return n}};return t}),define("components/diff/context-file",["jquery","components/diff/file","components/diff/hidden-file","components/diff/range","components/diff/ranges"],function(e,t,n,i,r){function o(e,t){if(!(this instanceof o))return new o(e,i);if("number"==typeof t){var i=Math.max(0,t);this.rangesWithContext_=r.expand(e.zeroContextRanges(),i)}else this.rangesWithContext_=t;return this.file_=n.of(e),this.viewport2file=this.calculateViewport2File(),this.file2viewport=this.calculateFile2Viewport(this.viewport2file),this.name=e.name,this.filename=e.filename,this.position=null,this.pagesPerBlock=e.pagesPerBlock,this.linesPerPage=e.linesPerPage,this.numLines=this.viewport2file.length-1,this.maxLineNum=this.viewport2file[this.viewport2file.length-1],"number"!=typeof this.maxLineNum&&(this.maxLineNum=this.viewport2file[this.viewport2file.length-2]),this.lineHeightPx=this.file_.lineHeightPx,this.blocks={},this}return o.prototype=function(){function n(e,t,n,i,r){e.id=t.name+"-"+r+"-"+n+"-"+i}var r=o.prototype;return r.isUnified=function(){return this.file_.isUnified()},r.numContext=function(){return this.context},r.calculateViewport2File=function(){for(var e=this.rangesWithContext_,t=[0],n=0,i=0;i<e.length;i++){var r=e[i];0===i&&r.low>1&&t.push({type:"top",index:n++});for(var o=0;o<r.length;o++)r.low+o<=this.file_.numLines&&t.push(r.low+o);i===e.length-1?r.high<this.file_.numLines&&t.push({type:"bottom",index:n++}):e.length>1&&t.push({type:"skipped",index:n++})}return t},r.calculateFile2Viewport=function(e){var t,n,i,r,o=[0];for(i=1;i<e.length;i++){var s=e[i];if("number"==typeof s)o[s]=i;else if("top"===s.type)for(n=e[i+1],r=1;n>r;r++)o[r]=1;else if("skipped"===s.type)for(t=e[i-1],n=e[i+1],r=t+1;n>r;r++)o[r]=i;else if("bottom"===s.type)for(t=e[i-1],r=t+1;r<=this.file_.numLines;r++)o[r]=i}return o},r.exists=function(){return this.file_.file_.exists()},r.merge=function(e){return this.file_.merge(e)},r.fileRange_=function(e){var t=this.viewport2file[e];"number"!=typeof t&&(t=this.viewport2file[e.low+1]);var n=this.viewport2file[Math.min(e.high,this.numLines)];return"number"!=typeof n&&(n=this.viewport2file[Math.min(e.high-1,this.numLines-1)]),new i(t,n)},r.queueBlocks=function(e,t){var n=Math.max(1,Math.floor(t.low/this.linesPerPage)*this.linesPerPage),r=Math.ceil(t.high/this.linesPerPage)*this.linesPerPage,o=this.fileRange_(new i(n,r));return this.file_.queueBlocks(e,o)},r.ensureVisible=function(e){try{return t.prototype.ensureVisible.call(this,e)}catch(n){}},r.insertPage_=function(e,n){return t.prototype.insertPage_.call(this,e,n)},r.isNotInDom_=function(e,t){return!this.blocks[e]||!this.blocks[e][t]},r.zeroContextRanges=function(){return this.file_.zeroContextRanges()},r.pageDom_=function(t,i){this.blocks[t]=this.blocks[t]||[];var r=this.blocks[t],o=(t*this.pagesPerBlock+i)*this.linesPerPage+1,s=Math.min(o+this.linesPerPage-1,this.numLines);if(this.isNotInDom_(t,i)){var a=document.createElement("div"),l=document.createElement("div"),u=t*this.pagesPerBlock+i;n(a,this,t,u,"page"),n(l,this,t,u,"numbers"),a.className="page"+(0===u?" page-first ":""),l.className="page line-numbers"+(0===u?" page-first ":"");for(var c=o;s>=c;c++){var d=this.viewport2file[c];if("number"==typeof d){var h=this.file_.coords_(d),p=e(this.file_.pageDom_(h.block,h.page)),f=p.children()[h.lineIndex].cloneNode(!0);a.appendChild(f);var m=e(this.file_.blocks[h.block][h.page].numbersDom),g=m.children()[h.lineIndex].cloneNode(!0);l.appendChild(g)}else"top"===d.type?(a.appendChild(e('<div class="skipped-container skipped-top"><span> </span></div>')[0]),l.appendChild(e('<div class="skipped-container skipped-top"><span class="ellipsis skipped" data-skipped-index="'+d.index+'" data-page-index="'+(c-o)+'"> </span></div>')[0])):"skipped"===d.type?(a.appendChild(e('<div class="skipped-container skipped-middle"><span> </span></div>')[0]),l.appendChild(e('<div class="skipped-container skipped-middle"><span class="ellipsis skipped" data-skipped-index="'+d.index+'" data-page-index="'+(c-o)+'"> </span></div>')[0])):"bottom"===d.type&&(a.appendChild(e('<div class="skipped-container skipped-bottom"><span> </span></div>')[0]),l.appendChild(e('<div class="skipped-container skipped-bottom"><span class="ellipsis skipped" data-skipped-index="'+d.index+'" data-page-index="'+(c-o)+'"> </span></div>')[0]))}r[i]={pageDom:a,numbersDom:l,revBlameDom:document.createElement("div"),authBlameDom:document.createElement("div"),gutterDom:document.createElement("div")}}return r[i].pageDom},r.coords_=function(e){return t.prototype.coords_.call(this,e)},r.longestLineDom=function(){return this.file_.longestLineDom()},r}(),o}),define("components/diff/hunk",["components/diff/range"],function(e){var t=function(e,n,i,r){return this instanceof t?(this.fromRange=e,this.toRange=n,this.fromLines=i,this.toLines=r,this.conflict_=!1,this):new t(e,n)};return t.ofLengths=function(n,i,r,o,s,a){return new t(e.ofLength(n,i),e.ofLength(r,o),s,a)},t.addition=function(n,i,r){return new t(e.pointAfterLine(n),i,[],r)},t.change=function(e,n,i,r){return new t(e,n,i,r)},t.deletion=function(n,i,r){return new t(n,e.pointAfterLine(i),r,[])},t.prototype=function(){function e(e,t){for(var n=0,i=e.length-1;i>=n;){var r=Math.floor((n+i)/2),o=e[r];if(t.overlaps(o))return r;if(t.before(o))i=r-1;else{if(!t.after(o))return-1;n=r+1}}return-1}var n=t.prototype;return n.isAddition=function(){return 0===this.fromRange.length},n.isChange=function(){return this.fromRange.length>0&&this.toRange.length>0},n.isDeletion=function(){return 0===this.toRange.length},n.conflict=function(){return this.conflict_=!0,this},n.isConflict=function(){return this.conflict_},n.before=function(e){return this.fromRange.before(e.fromRange)&&this.toRange.before(e.toRange)},n.after=function(e){return this.fromRange.after(e.fromRange)&&this.toRange.after(e.toRange)},n.overlaps=function(e){return this.fromRange.overlaps(e.fromRange)||this.toRange.overlaps(e.toRange)},n.overlapping=function(t){var n=[],i=e(t,this);if(i>=0){var r,o,s;for(o=i-1;o>=0&&(r=t[o]).overlaps(this);o-=1)n.push(r);for(n.push(t[i]),o=i+1,s=t.length;s>o&&(r=t[o]).overlaps(this);o++)n.push(r)}return n},n.equals=function(e){return this.fromRange.equals(e.fromRange)&&this.toRange.equals(e.toRange)},n.toString=function(){function e(e){return 1===e.length?e.low+"":e.low+","+e.length}return function(){return"-"+e(this.fromRange)+" +"+e(this.toRange)}}(),n}(),t}),define("components/diff/unified-file",["jquery","components/diff/file","components/diff/hidden-file","components/diff/hunk","components/diff/range"],function(e,t,n,i,r){function o(e,t,i,r,s){return this instanceof o?(this.diffHunks_=e,this.unifiedMap=t,this.from2unified_=this.calculateLineMappings_(t,0),this.to2unified_=this.calculateLineMappings_(t,1),this.zeroContextRanges_=null,this.from_=n.of(i),this.to_=n.of(r),this.renderFile_=this.from_.name===s?this.from_:this.to_,this.name=this.renderFile_.name,this.filename=this.renderFile_.filename,this.position=this.renderFile_.position,this.pagesPerBlock=this.renderFile_.pagesPerBlock,this.linesPerPage=this.renderFile_.linesPerPage,this.numLines=this.unifiedMap.length-1,this.maxLineNum=Math.max(this.from_.maxLineNum,this.to_.maxLineNum),this.lineHeightPx=this.to_.lineHeightPx,this.blocks={},this):new o(e,t,i,r,s)}return o.prototype=function(){var n=o.prototype;return n.isUnified=function(){return!0},n.numContext=function(){return this.renderFile_.numContext()},n.calculateLineMappings_=function(e,t){for(var n=[0],i=1;i<e.length;i++){var r=e[i][t];r&&(n[r]=i)}return n},n.exists=function(){return!0},n.merge=function(){},n.queueBlocks=function(e,t){var n=this,i=Math.max(1,Math.floor(t.low/this.linesPerPage)*this.linesPerPage),o=Math.ceil(t.high/this.linesPerPage)*this.linesPerPage,s=n.diffHunk_(new r(i,o));e.from(n.from_.blocksToFetch(s.fromRange),n.from_.filename).to(n.to_.blocksToFetch(s.toRange),n.to_.filename).incremental(function(e,t){n.from_.merge(e),n.to_.merge(t)})},n.diffHunk_=function(e){for(var t=Number.MAX_VALUE,n=Number.MIN_VALUE,o=Number.MAX_VALUE,s=Number.MIN_VALUE,a=Math.min(this.renderFile_.numLines,e.high),l=e.low;a>=l;l++){var u=this.unifiedMap[l],c=u[0],d=u[1];c&&(t=t>c?c:t,n=c>n?c:n),d&&(o=o>d?d:o,s=d>s?d:s)}return t===Number.MAX_VALUE&&(t=0,n=0),o===Number.MAX_VALUE&&(o=0,s=0),new i(new r(t,n),new r(o,s))},n.ensureVisible=function(e){try{return t.prototype.ensureVisible.call(this,e)}catch(n){}},n.insertPage_=function(e,n){return t.prototype.insertPage_.call(this,e,n)},n.isNotInDom_=function(e,t){return!this.blocks[e]||!this.blocks[e][t]},n.zeroContextRanges=function(){if(null===this.zeroContextRanges_){for(var e=[],t=0;t<this.diffHunks_.length;t++){var n,i=this.diffHunks_[t],o=i.fromRange,s=i.toRange;i.isDeletion()?n=new r(this.from2unified_[o.low],this.from2unified_[o.high]):i.isChange()?n=new r(this.from2unified_[o.low],this.to2unified_[s.high]):i.isAddition()&&(n=new r(this.to2unified_[s.low],this.to2unified_[s.high])),e.push(n)}this.zeroContextRanges_=e}return this.zeroContextRanges_},n.pageDom_=function(t,n){this.blocks[t]=this.blocks[t]||[];var i=this.blocks[t],r=(t*this.pagesPerBlock+n)*this.linesPerPage+1,o=r+this.linesPerPage-1;if(this.isNotInDom_(t,n)){var s=document.createElement("div"),a=document.createElement("div"),l=t*this.pagesPerBlock+n;s.className+="page"+(0===l?" page-first ":""),a.className+="page line-numbers"+(0===l?" page-first ":"");for(var u=r;o>=u;u++){var c=this.unifiedMap[u];if(c){var d=null,h=null;(h=c[0])?d=this.from_:(h=c[1])&&(d=this.to_);var p=d.coords_(h),f=e(d.pageDom_(p.block,p.page)),m=f.children()[p.lineIndex].cloneNode(!0);/\bchange\b/.test(m.className)&&(m.className+=" "+d.name),s.appendChild(m);var g=c["from"===this.renderFile_.name?0:1];if(g){var v=this.renderFile_.coords_(g);this.renderFile_.pageDom_(v.block,v.page);var y=e(this.renderFile_.blocks[v.block][v.page].numbersDom),b=y.children()[v.lineIndex].cloneNode(!0);/\bchange\b/.test(b.className)&&(b.className+=" "+this.renderFile_.name),1!==u&&1===g&&e(b).removeClass("start"),a.appendChild(b)
}else{var w="from"===this.renderFile_.name?this.to_:this.from_,x=c["from"===this.renderFile_.name?1:0],_=w.coords_(x);w.pageDom_(_.block,_.page);var k=e(w.blocks[_.block][_.page].numbersDom),C=k.children()[_.lineIndex].cloneNode(!0);C.innerHTML=" ",/\bchange\b/.test(C.className)&&(C.className+=" "+w.name),1!==u&&1===x&&e(C).removeClass("start"),a.appendChild(C)}}}i[n]={pageDom:s,numbersDom:a,revBlameDom:document.createElement("div"),authBlameDom:document.createElement("div"),gutterDom:document.createElement("div")}}return i[n].pageDom},n.coords_=function(e){return t.prototype.coords_.call(this,e)},n.longestLineDom=function(){var t=e(this.from_.longestLineDom()),n=e(this.to_.longestLineDom());return t.text().length>n.text().length?t[0]:n[0]},n}(),o}),define("components/diff/diff",["jquery","diff-match-patch","components/diff/block-loader","components/diff/context-file","components/diff/file","components/diff/hunk","components/diff/range","components/diff/ranges","components/diff/unified-file"],function(e,t,n,i,r,o,s,a,l){var u=function(e,n,i,r,o,s,a,l){if(!(this instanceof u))return new u(e,n,i,r,o,s,a,l);this.hunks=e,this.pagesPerBlock=n,this.linesPerPage=i,this.from=r,this.to=o,this.unifiedMap=s,this.note=a,this.url=l,this.elem_=null;try{this.diffHighlighting_(new t,e)}catch(c){}return this};return u.sideBySideFromData=function(e){for(var t=[],n=0,i=e.hunks.length;i>n;n++){var l,c=e.hunks[n];l="add"===c.type?new o(s.pointBeforeLine(c.from_start),s.ofLength(c.to_start,c.to_count),c.from_lines,c.to_lines):"mod"===c.type?o.ofLengths(c.from_start,c.from_count,c.to_start,c.to_count,c.from_lines,c.to_lines):new o(s.ofLength(c.from_start,c.from_count),s.pointBeforeLine(c.to_start),c.from_lines,c.to_lines),c.conflict&&l.conflict(),t[n]=l}var d=e.from_pages_per_block,h=e.from_lines_per_page,p=a.unzip(t),f=new r(d,h,e.from_file,p[0]),m=new r(d,h,e.to_file,p[1]),g=e.unified_map,v=e.note;return new u(t,d,h,f,m,g,v)},u.unified=function(e){return new u(e.hunks,e.pagesPerBlock,e.linesPerPage,new l(e.hunks,e.unifiedMap,e.from,e.to,"from"),new l(e.hunks,e.unifiedMap,e.from,e.to,"to"),e.unifiedMap,e.note,e.url)},u.ofContext=function(e,t){t=Math.max(0,t);var n=new i(e.to,t);if(e.from.exists()){var r=new i(e.from,t),o=e.contextScrollPositions_(r,n);r.position=o[0],n.position=o[1]}var s=e.hunks,a=new u(e.from.exists()?e.hunksWithContext_(s,r,n):e.hunks,e.pagesPerBlock,e.linesPerPage,e.from.exists()?r:{exists:function(){return!1}},n,e.unifiedMap,e.note,e.url);return a.zeroContextHunks=s,a},u.expandSkippedSection=function(e,t){var n=e.from,r=e.to,o=new i(n.file_,a.expandAtIndex(n.rangesWithContext_,t,10,e.isUnified()?e.unifiedMap.length:n.maxLineNum)),s=new i(r.file_,a.expandAtIndex(r.rangesWithContext_,t,10,e.isUnified()?e.unifiedMap.length:r.maxLineNum)),l=e.contextScrollPositions_(o,s);o.position=l[0],s.position=l[1];var c=e.zeroContextHunks,d=new u(e.hunksWithContext_(c,o,s),e.pagesPerBlock,e.linesPerPage,o,s,e.unifiedMap,e.note,e.url);return d.zeroContextHunks=c,d},u.expandToInclude=function(t,n,i){function r(e){return e.overlaps(s.ofLine(l))}var o=t.to.file_.file_,a="from"===n?o.from2unified_:o.to2unified_,l=a[i],c=t[n].rangesWithContext_;if(e.grep(c,r).length>0)return t;for(var d=0,h=0;h<c.length;h++){var p=c[h];if(l<p.low)break;d+=1}return u.expandToInclude(u.expandSkippedSection(t,d),n,i)},u.CONTEXT_LOW=3,u.CONTEXT_MED=20,u.CONTEXT_FULL=-1,u.prototype=function(){var t=u.prototype;return t.setElement=function(e){this.elem_=e},t.getElement=function(){return this.elem_},t.ensureVisible=function(e,t){var i=this,r=new n(i.url,i.pagesPerBlock,i.linesPerPage);i.from.exists()&&i.from.queueBlocks(r,e.fromRange),i.to.queueBlocks(r,e.toRange),r.load(function(){i.from.exists()&&i.from.ensureVisible(e.fromRange),i.to.ensureVisible(e.toRange),t&&t()})},t.isUnified=function(){return this.to.isUnified()},t.filename=function(){return this.from.filename||this.to.filename},t.hasConflicts=function(){for(var e=this.zeroContextHunks||this.hunks,t=0;t<e.length;t++)if(e[t].isConflict())return!0;return!1},t.hasNote=function(){return!!this.note},t.hasDiffContent=function(){return this.hunks.length>0},t.numContext=function(){return this.from.numContext()},t.contextScrollPositions_=function(e,t){var n,i,r=[0],o=[0];for(n=1;n<=e.numLines;n++)if(i=e.viewport2file[n],"number"==typeof i){var s=e.file_.position[i];r[n]=t.file2viewport[s]}else r[n]=r[n-1]+1;for(n=1;n<=t.numLines;n++)if(i=t.viewport2file[n],"number"==typeof i){var a=t.file_.position[i];o[n]=e.file2viewport[a]}else o[n]=o[n-1]+1;return[r,o]},t.hunksWithContext_=function(e,t,n){for(var i=t.file2viewport,r=n.file2viewport,a=[],l=0;l<e.length;l++){var u=e[l],c=u.fromRange,d=u.toRange;a.push(new o(new s(i[c.low],i[c.high]),new s(r[d.low],r[d.high])))}return a},t.diffHighlighting_=function(t,n){function i(e){return r.html(e),r.text()}for(var r=e("<div>"),o=0;o<n.length;o++){var s=n[o];if(s.fromLines&&s.toLines&&s.isChange()&&!s.isConflict()){var a=t.diff_main(i(s.fromLines.join("\n")),i(s.toLines.join("\n")));t.diff_cleanupSemantic(a),s.fromRange.linesHtml=e.map(e.grep(a,e.proxy(this.isFrom_,this)),e.proxy(this.markup_,this)).join("").split("\n"),s.toRange.linesHtml=e.map(e.grep(a,e.proxy(this.isTo_,this)),e.proxy(this.markup_,this)).join("").split("\n")}}},t.isFrom_=function(e){var t=e[0];return t===DIFF_DELETE||t===DIFF_EQUAL},t.isTo_=function(e){var t=e[0];return t===DIFF_EQUAL||t===DIFF_INSERT},t.markup_=function(t){var n=t[0];return n===DIFF_EQUAL?_.escape(t[1]):e.map(t[1].split("\n"),n===DIFF_DELETE?e.proxy(this.markupRemoved_,this):e.proxy(this.markupAdded_,this)).join("\n")},t.markupRemoved_=function(e){return"<del>"+_.escape(e)+"</del>"},t.markupAdded_=function(e){return"<ins>"+_.escape(e)+"</ins>"},t.hunkBefore=function(t){var n=e.inArray(t,this.hunks);return 0>=n?null:this.hunks[n-1]},t.hunkAfter=function(t){var n=e.inArray(t,this.hunks);return 0>n||n===this.hunks.length-1?null:this.hunks[n+1]},t.hunkAfterFromLine=function(e){return this.searchHunksAfter_(function(t){return e<t.fromRange.low})},t.hunkBeforeFromLine=function(e){return this.searchHunksBefore_(function(t){return t.fromRange.low<e})},t.hunkAfterToLine=function(e){return this.searchHunksAfter_(function(t){return e<t.toRange.low})},t.hunkBeforeToLine=function(e){return this.searchHunksBefore_(function(t){return t.toRange.low<e})},t.searchHunksAfter_=function(e){for(var t=this.zeroContextHunks||this.hunks,n=0,i=t.length-1,r=null;i>=n;){var o=Math.floor((n+i)/2),s=t[o];e(s)?(r=s,i=o-1):n=o+1}return r},t.searchHunksBefore_=function(e){for(var t=this.zeroContextHunks||this.hunks,n=0,i=t.length-1,r=null;i>=n;){var o=Math.floor((n+i)/2),s=t[o];e(s)?(r=s,n=o+1):i=o-1}return r},t}(),u}),define("components/diff/heading-renderer",["jquery"],function(e){var t=function(e,t){this.filename_=e,this.conflicts_=t};return t.prototype.createDom=function(){var t=this.filename_.split("/");t=t.join('<span class="slash">/</span>'),this.$elem_=e(['<div class="heading">',"<h1></h1>","</div>"].join("")),this.$elem_.attr("id","chg-"+this.filename_).toggleClass("conflicts",this.conflicts_).find("h1").html(t)},t.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t}),define("components/diff/note-renderer",["jquery"],function(e){var t=function(e){this.note_=e,this.$elem_=null};return t.prototype.createDom=function(){this.$elem_=e(['<div class="message">',"<p></p>","</div>"].join("")),this.setNote(this.note_)},t.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t.prototype.setNote=function(e){this.note_=e,this.$elem_&&this.$elem_.find("p").text(e)},t}),function(e){define("jquery-plugins/jquery.getscrollbarwidth",["jquery"],function(){return function(){!function(e){var t=0;e.getScrollbarWidth=function(){if(!t)if(e.browser.msie){var n=e('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body"),i=e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body");t=n.width()-i.width(),n.add(i).remove()}else{var r=e("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:-1e3}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});t=100-r.width(),r.parent().remove()}return t}}(jQuery)}.apply(e,arguments)})}(this),define("components/diff/hunk-map",["jquery","underscore","jquery-plugins/jquery.getscrollbarwidth"],function(e,t){var n=function(e,n,i,r){this.hunks=t.filter(e,function(e){return"from"===n?e.isDeletion()||e.isChange():e.isAddition()||e.isChange()}),this.numLines=i,this.lineHeight=r,this.side=n,this.$window_=null,this.$elem_=null};return n.prototype.createDom=function(){this.$window_=e(window),this.$elem_=e('<div class="hunk-map">');for(var t="from"===this.side,n=t?"<del>":"<ins>",i=0;i<this.hunks.length;i++){var r=this.hunks[i],o=t?r.fromRange:r.toRange,s=e(n).toggleClass("change",r.isChange()).toggleClass("conflict",r.isConflict()).css({top:this.percent(o.low-1)+"%",height:this.percent(o.length)+"%"});this.$elem_.append(s)}},n.prototype.percent=function(e){return e/this.numLines*100},n.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.enterDocument()},n.prototype.enterDocument=function(){this.$elem_.bind("click.hunk-map",e.proxy(this.onClick_,this))},n.prototype.exitDocument=function(){this.$elem_.unbind("click.hunk-map")},n.prototype.onClick_=function(t){var n=t.clientY-(this.$elem_.offset().top-this.$window_.scrollTop()),i=Math.round(n/this.$elem_.height()*this.numLines);i=Math.min(Math.max(1,i),this.numLines),e(this).trigger("hunk-map/click",[i])},n.prototype.scrollbars=function(t,n){var i=this.$elem_.parent().height(),r=e.getScrollbarWidth(),o=n?r:0,s=o+(t?r:0);this.$elem_.css({marginTop:o,height:Math.min(this.numLines*this.lineHeight,i-o-s)})},n}),define("components/diff/pane",["jquery","components/diff/range"],function(e,t){var n=function(e,t){this.contentWidth=e,this.contentHeight=t,this.scrollLeft_=0,this.scrollTop_=0,this.maxScrollLeft_=0,this.maxScrollTop_=0,this.ignoreHorizontalScrolls_=0,this.ignoreVerticalScrolls_=0,this.$elem_=null,this.$scroller_=null,this.$content_=null};return n.template_=['<div class="aperture-pane">','<div class="aperture-pane-scroller">','<div class="aperture-pane-content"></div>',"</div>","</div>"].join(""),n.prototype.createDom=function(){this.$elem_=e(n.template_),this.$scroller_=this.$elem_.find(".aperture-pane-scroller"),this.$content_=this.$scroller_.find(".aperture-pane-content")},n.prototype.render=function(e){this.createDom(),e.append(this.$elem_),"number"!=typeof this.contentWidth&&(this.$content().append(this.contentWidth),this.contentWidth=this.$elem_.width(),this.$content().empty()),this.$content().width(this.contentWidth),"number"!=typeof this.contentHeight&&(this.$content().append(this.contentHeight),this.contentHeight=this.$elem_.height(),this.$content().empty()),this.$content().height(this.contentHeight),this.setScrollBounds_(),this.enterDocument()},n.prototype.setPaneWidth=function(e){this.$elem_.width(e),this.contentWidth=this.$elem_.width(),this.setScrollBounds_()},n.prototype.setPaneHeight=function(e){this.$elem_.height(e),this.contentHeight=this.$elem_.height(),this.setScrollBounds_()},n.prototype.scrollx=function(){return this.maxScrollLeft_>0},n.prototype.scrolly=function(){return this.maxScrollTop_>0},n.prototype.setScrollBounds_=function(){var e=this.$scroller_.scrollLeft()||0,t=this.$scroller_.scrollTop()||0;this.$scroller_.scrollLeft(this.contentWidth).scrollTop(this.contentHeight),this.maxScrollLeft_=this.$scroller_.scrollLeft(),this.maxScrollTop_=this.$scroller_.scrollTop(),this.$scroller_.scrollLeft(e).scrollTop(t)},n.prototype.enterDocument=function(){this.$scroller_.bind("scroll.pane",e.proxy(this.onScroll_,this))},n.prototype.exitDocument=function(){this.$scroller_.unbind("scroll.pane")},n.prototype.$content=function(){return this.$content_},n.prototype.onScroll_=function(){var t=this.$scroller_.scrollLeft(),n=this.$scroller_.scrollTop(),i=t!==this.scrollLeft_,r=n!==this.scrollTop_;this.scrollLeft_=t,this.scrollTop_=n,this.ignoreHorizontalScrolls_||this.ignoreVerticalScrolls_?(this.ignoreHorizontalScrolls_&&i&&(this.ignoreHorizontalScrolls_-=1),this.ignoreVerticalScrolls_&&r&&(this.ignoreVerticalScrolls_-=1)):e(this).trigger("aperture-pane/scroll",[t,n])},n.prototype.setScrollLeftNoEvent=function(e){return e=Math.max(0,Math.min(this.maxScrollLeft_,e)),this.scrollLeft_!==e&&(this.ignoreHorizontalScrolls_+=1,this.$scroller_.scrollLeft(e)),e},n.prototype.setScrollTopNoEvent=function(e){return e=Math.max(0,Math.min(this.maxScrollTop_,e)),this.scrollTop_!==e&&(this.ignoreVerticalScrolls_+=1,this.$scroller_.scrollTop(e)),e},n.prototype.isVisible=function(){return!0},n.prototype.visibleRange=function(){return t.ofLength(this.$scroller_.scrollTop(),this.$elem_.height())},n}),define("components/diff/lined-pane",["jquery","components/diff/pane","components/diff/range"],function(e,t,n){var i=function(e,t,n,i){this.numLines=t,this.lineHeight=i,this.pane_=new e(n,t*i)};return i.window=function(e,t,n){return new i(WindowPane,e,t,n)},i.scrollable=function(e,n,r){return new i(t,e,n,r)},i.prototype.createDom=function(){},i.prototype.render=function(e){this.createDom(),this.pane_.render(e),this.$elem_=this.pane_.$elem_,this.enterDocument()},i.prototype.enterDocument=function(){e(this.pane_).bind("aperture-pane/scroll",e.proxy(this.onScroll_,this))},i.prototype.exitDocument=function(){e(this.pane_).unbind("aperture-pane/scroll"),this.pane_.exitDocument()},i.prototype.$content=function(){return this.pane_.$content()},i.prototype.onScroll_=function(t,n,i){var r=Math.floor(i/this.lineHeight)+1,o=i-this.lineTopPx(r);e(this).trigger("aperture-lined-pane/scroll",[r,n,o])},i.prototype.setPaneWidth=function(e){this.pane_.setPaneWidth(e)},i.prototype.scrollx=function(){return this.pane_.scrollx()},i.prototype.scrolly=function(){return this.pane_.scrolly()},i.prototype.lineTopPx=function(e){return(e-1)*this.lineHeight},i.prototype.scrollToLine=function(e,t,n){var i=this.pane_.setScrollLeftNoEvent(t),r=this.pane_.setScrollTopNoEvent(this.lineTopPx(e)+n);return[Math.floor(r/this.lineHeight)+1,i,r%this.lineHeight]},i.prototype.isVisible=function(){return this.pane_.isVisible()},i.prototype.visibleRange=function(){var e=this.pane_.visibleRange();if(null===e)return null;var t=Math.floor(e.low/this.lineHeight)+1,i=Math.min(this.numLines,Math.ceil(e.high/this.lineHeight));return new n(t,i)},i}),define("components/diff/scrollable-file-pane",["jquery","components/diff/lined-pane"],function(e,t){var n=function(e,n){this.file_=e,this.lineHeight=n,this.numLines=e.numLines;var i=35;this.numbers_=t.scrollable(e.numLines,i,n),this.lines_=t.scrollable(e.numLines,this.file_.longestLineDom(),n),this.$elem_=null};return n.prototype.createDom=function(){this.$elem_=e('<div class="scrollable-file-pane">')},n.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.numbers_.render(this.$elem_),this.lines_.render(this.$elem_),this.numbers_.$elem_.addClass("scrollable-file-pane-numbers"),this.numbers_.$content().addClass("file-numbers"),this.lines_.$elem_.addClass("scrollable-file-pane-lines"),this.lines_.$content().addClass("file-lines"),this.file_.lineHeightPx=this.lineHeight,this.file_.numbersBoxDom=this.numbers_.$content()[0],this.file_.scrollBoxDom=this.lines_.$content()[0],this.enterDocument()},n.prototype.setPaneWidth=function(e){var t=35;this.numbers_.setPaneWidth(t),this.lines_.setPaneWidth(e-t)},n.prototype.scrollx=function(){return this.lines_.scrollx()},n.prototype.scrolly=function(){return this.lines_.scrolly()},n.prototype.enterDocument=function(){e(this.lines_).bind("aperture-lined-pane/scroll",e.proxy(this.onScroll_,this))},n.prototype.exitDocument=function(){e(this.lines_).unbind("aperture-lined-pane/scroll"),this.numbers_.exitDocument(),this.lines_.exitDocument()},n.prototype.onScroll_=function(t,n,i,r){this.numbers_.scrollToLine(n,i,r),e(this).trigger("scrollable-file-pane/scroll",[n,i,r])},n.prototype.scrollToLine=function(e,t,n){var i=this.lines_.scrollToLine(e,t,n);return this.numbers_.scrollToLine(i[0],i[1],i[2]),i},n.prototype.scrollToLineAndFire=function(t,n,i){var r=this.scrollToLine(t,n,i);e(this).trigger("scrollable-file-pane/scroll",r)},n.prototype.visibleRange=function(){return this.lines_.visibleRange()},n}),define("components/diff/segment-pane",["jquery"],function(e){var t=window.SegmentPane=function(e,t){this.sbsdiff=e,this.lineHeight=t,this.width=null,this.$elem_=null,this.canvas_=null,this.visiblePaths_=[]};return t.prototype.createDom=function(){this.$elem_=e('<div class="segment-pane">');var t=document.createElement("canvas");this.$elem_.append(t),this.canvas_=t,null!==this.width&&this.setPaneWidth(this.width)},t.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t.prototype.setPaneWidth=function(e){this.width!==e&&(this.width=e,null!==this.$elem_&&(this.$elem_.width(e),this.height=this.$elem_.height(),this.canvas_.width=e,this.canvas_.height=this.$elem_.height()))},t.STROKE="#ccc",t.prototype.add_={stroke:"#ddffdd",fill:"#ddffdd"},t.prototype.del_={stroke:"#fee8e9",fill:"#fee8e9"},t.prototype.mod_={stroke:"#f5f5f5",fill:"#f5f5f5"},t.prototype.con_={stroke:"#ffffdf",fill:"#ffffdf"},t.prototype.border_={stroke:"#ccc",fill:"#ccc"},t.prototype.rangeY=function(e,t,n){var i=this.lineHeight,r=(e.low-t)*i-n+1,o=(e.high-t)*i-n+1+i;return r===o&&(r+=i,o=r),[r,o]},t.prototype.draw=function(e,t,n,i,r){var o,s,a=this.canvas_.getContext("2d"),l=this.width,u=this.height;for(a.clearRect(0,0,l+1,u+1),a.setTransform(1,0,0,1,-.5,-.5),o=0,s=e.length;s>o;o++){var c=e[o],d=(c.fromRange,c.toRange,this.rangeY(c.fromRange,t,n)),h=this.rangeY(c.toRange,i,r);if(c.isConflict()){var p=this.sbsdiff.hunkBefore(c),f=this.sbsdiff.hunkAfter(c);if(c.isConflictStart=f&&f.isConflict()&&f.isChange(),c.isEntireConflict=!(p&&p.isConflict()&&p.isChange()||f&&f.isConflict()&&f.isChange()),c.isConflictStart){var m=this.rangeY(f.fromRange,t,n),g=this.rangeY(f.toRange,i,r);d[1]=m[1],h[1]=g[1]}else if(!c.isEntireConflict)continue}a.fillStyle=c.isConflict()?this.con_.fill:c.isAddition()?this.add_.fill:c.isDeletion()?this.del_.fill:this.mod_.fill,a.strokeStyle=this.border_.stroke,a.beginPath(),a.moveTo(0,d[0]),a.bezierCurveTo(l/2,d[0],l/2,h[0],l+1,h[0]),a.lineTo(l+1,h[1]),a.bezierCurveTo(l/2,h[1],l/2,d[1],0,d[1]),a.lineTo(0,d[0]),a.fill(),a.beginPath(),a.moveTo(0,d[0]),a.bezierCurveTo(l/2,d[0],l/2,h[0],l+1,h[0]),a.moveTo(l+1,h[1]),a.bezierCurveTo(l/2,h[1],l/2,d[1],0,d[1]),a.stroke()}},t}),define("components/diff/side-by-side-diff",["jquery","components/diff/hunk","components/diff/hunk-map","components/diff/scrollable-file-pane","components/diff/segment-pane"],function(e,t,n,i,r){var o=function(e,t){this.sbsdiff_=e,this.lineHeight=t,this.focusOffset=5,this.width_=null,this.height_=null,this.fromHunkMap_=new n(this.sbsdiff_.hunks,"from",this.sbsdiff_.from.numLines,t),this.fromFile_=new i(this.sbsdiff_.from,t),this.segments_=new r(e,t),this.toFile_=new i(this.sbsdiff_.to,t),this.toHunkMap_=new n(this.sbsdiff_.hunks,"to",this.sbsdiff_.to.numLines,t),this.$elem_=null};return o.prototype.createDom=function(){this.$elem_=e('<div class="diffract diffract-sbsdiff">'),null!==this.height_&&this.setHeight(this.height_)},o.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.fromHunkMap_.render(this.$elem_),this.fromFile_.render(this.$elem_),this.segments_.render(this.$elem_),this.toFile_.render(this.$elem_),this.toHunkMap_.render(this.$elem_),this.setWidth(this.width_),this.enterDocument()},o.prototype.setWidth=function(e){if(this.width_=e,this.$elem_){var t=30,n=18,i=e-t-n;this.fromFile_.setPaneWidth(Math.floor(i/2)-1),this.segments_.setPaneWidth(t),this.toFile_.setPaneWidth(Math.ceil(i/2)-1),1===this.$elem_.parent().length&&this.scrollbars()}},o.prototype.setHeight=function(e){this.height_=e,this.$elem_&&(this.$elem_.height(e),1===this.$elem_.parent().length&&this.scrollbars())},o.prototype.scrollbars=function(){this.fromHunkMap_.scrollbars(this.fromFile_.scrollx(),this.fromFile_.scrolly()),this.toHunkMap_.scrollbars(this.toFile_.scrollx(),this.toFile_.scrolly()),this.fromFile_.$elem_.toggleClass("all-lines-visible",!this.fromFile_.scrolly()),this.toFile_.$elem_.toggleClass("all-lines-visible",!this.toFile_.scrolly())},o.prototype.enterDocument=function(){e([this.fromFile_,this.toFile_]).bind("scrollable-file-pane/scroll",e.proxy(this.onScroll_,this)),e([this.fromHunkMap_,this.toHunkMap_]).bind("hunk-map/click",e.proxy(this.onHunkMapClick_,this))},o.prototype.exitDocument=function(){e([this.fromFile_,this.toFile_]).unbind("scrollable-file-pane/scroll"),e([this.fromHunkMap_,this.toHunkMap_]).unbind("hunk-map/click"),this.fromHunkMap_.exitDocument(),this.fromFile_.exitDocument(),this.segments_.exitDocument(),this.toFile_.exitDocument(),this.toHunkMap_.exitDocument()},o.prototype.onScroll_=function(e,n,i,r){var o=e.target,s=o===this.fromFile_?this.toFile_:this.fromFile_,a=o.file_.position,l=Math.min(n+this.focusOffset,o.numLines),u=a[l],c=a[l-1]===u,d=c?this.lineHeight:r,h=Math.max(c?0:1,u-this.focusOffset),p=s.scrollToLine(h,i,d);h=p[0],d=p[2];var f=new t(this.fromFile_.visibleRange(),this.toFile_.visibleRange());this.sbsdiff_.ensureVisible(f);var m=o===this.fromFile_;this.segments_.draw(f.overlapping(this.sbsdiff_.hunks),m?n:h,m?r:d,m?h:n,m?d:r)},o.prototype.onHunkMapClick_=function(e,t){var n=e.target===this.fromHunkMap_?this.fromFile_:this.toFile_;n.scrollToLineAndFire(t-this.focusOffset,0,0)},o.prototype.scrollToFirstHunk=function(){var e=this.sbsdiff_.hunks[0];e.isAddition()?this.toFile_.scrollToLineAndFire(e.toRange.low-this.focusOffset,0,0):this.fromFile_.scrollToLineAndFire(e.fromRange.low-this.focusOffset,0,0)},o}),define("components/diff/bitbucket-side-by-side-diff",["jquery","components/diff/heading-renderer","components/diff/note-renderer","components/diff/side-by-side-diff"],function(e,t,n,i){var r=function(e){this.diff_=e,this.heading_=new t(e.filename(),e.hasConflicts()),this.note_=e.hasNote()?new n(e.note):null,this.sbsDiff_=new i(e,18),this.$elem_=null};return r.prototype.createDom=function(){this.$elem_=e('<section class="bb-sbs-diff"></section>')},r.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.heading_.render(this.$elem_),this.note_&&this.note_.render(this.$elem_),this.sbsDiff_.render(this.$elem_),this.enterDocument()},r.prototype.enterDocument=function(){e(document).bind("diff-load-start",e.proxy(this.loadingStart_,this)).bind("diff-load-end",e.proxy(this.loadingEnd_,this))},r.prototype.exitDocument=function(){},r.prototype.loadingStart_=function(e,t){t===this.diff_.filename()&&this.$elem_.addClass("loading-diff")},r.prototype.loadingStart_=function(e,t){t===this.diff_.filename()&&this.$elem_.removeClass("loading-diff")},r.prototype.setWidth=function(e){this.sbsDiff_.setWidth(e)},r.prototype.setHeight=function(e){this.sbsDiff_.setHeight(e)},r.prototype.scrollToFirstHunk=function(){this.sbsDiff_.scrollToFirstHunk()},r}),function(e){define("jquery-plugins/jquery.fancybox",["jquery"],function(){return function(){!function(e,t,n,i){"use strict";var r=n("html"),o=n(e),s=n(t),a=n.fancybox=function(){a.open.apply(this,arguments)},l=navigator.userAgent.match(/msie/i),u=null,c=t.createTouch!==i,d=function(e){return e&&e.hasOwnProperty&&e instanceof n},h=function(e){return e&&"string"===n.type(e)},p=function(e){return h(e)&&e.indexOf("%")>0},f=function(e){return e&&!(e.style.overflow&&"hidden"===e.style.overflow)&&(e.clientWidth&&e.scrollWidth>e.clientWidth||e.clientHeight&&e.scrollHeight>e.clientHeight)},m=function(e,t){var n=parseInt(e,10)||0;return t&&p(e)&&(n=a.getViewport()[t]/100*n),Math.ceil(n)},g=function(e,t){return m(e,t)+"px"};n.extend(a,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!c,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(l?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>',loading:'<div id="fancybox-loading"><div></div></div>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:n.noop,beforeLoad:n.noop,afterLoad:n.noop,beforeShow:n.noop,afterShow:n.noop,beforeChange:n.noop,beforeClose:n.noop,afterClose:n.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(e,t){return e&&(n.isPlainObject(t)||(t={}),!1!==a.close(!0))?(n.isArray(e)||(e=d(e)?n(e).get():[e]),n.each(e,function(r,o){var s,l,u,c,p,f,m,g={};"object"===n.type(o)&&(o.nodeType&&(o=n(o)),d(o)?(g={href:o.data("fancybox-href")||o.attr("href"),title:n("<div/>").text(o.data("fancybox-title")||o.attr("title")||"").html(),isDom:!0,element:o},n.metadata&&n.extend(!0,g,o.metadata())):g=o),s=t.href||g.href||(h(o)?o:null),l=t.title!==i?t.title:g.title||"",u=t.content||g.content,c=u?"html":t.type||g.type,!c&&g.isDom&&(c=o.data("fancybox-type"),c||(p=o.prop("class").match(/fancybox\.(\w+)/),c=p?p[1]:null)),h(s)&&(c||(a.isImage(s)?c="image":a.isSWF(s)?c="swf":"#"===s.charAt(0)?c="inline":h(o)&&(c="html",u=o)),"ajax"===c&&(f=s.split(/\s+/,2),s=f.shift(),m=f.shift())),u||("inline"===c?s?u=n(h(s)?s.replace(/.*(?=#[^\s]+$)/,""):s):g.isDom&&(u=o):"html"===c?u=s:c||s||!g.isDom||(c="inline",u=o)),n.extend(g,{href:s,type:c,content:u,title:l,selector:m}),e[r]=g}),a.opts=n.extend(!0,{},a.defaults,t),t.keys!==i&&(a.opts.keys=t.keys?n.extend({},a.defaults.keys,t.keys):!1),a.group=e,a._start(a.opts.index)):void 0},cancel:function(){var e=a.coming;e&&!1===a.trigger("onCancel")||(a.hideLoading(),e&&(a.ajaxLoad&&a.ajaxLoad.abort(),a.ajaxLoad=null,a.imgPreload&&(a.imgPreload.onload=a.imgPreload.onerror=null),e.wrap&&e.wrap.stop(!0,!0).trigger("onReset").remove(),a.coming=null,a.current||a._afterZoomOut(e)))},close:function(e){a.cancel(),!1!==a.trigger("beforeClose")&&(a.unbindEvents(),a.isActive&&(a.isOpen&&e!==!0?(a.isOpen=a.isOpened=!1,a.isClosing=!0,n(".fancybox-item, .fancybox-nav").remove(),a.wrap.stop(!0,!0).removeClass("fancybox-opened"),a.transitions[a.current.closeMethod]()):(n(".fancybox-wrap").stop(!0).trigger("onReset").remove(),a._afterZoomOut())))},play:function(e){var t=function(){clearTimeout(a.player.timer)},n=function(){t(),a.current&&a.player.isActive&&(a.player.timer=setTimeout(a.next,a.current.playSpeed))},i=function(){t(),s.unbind(".player"),a.player.isActive=!1,a.trigger("onPlayEnd")},r=function(){a.current&&(a.current.loop||a.current.index<a.group.length-1)&&(a.player.isActive=!0,s.bind({"onCancel.player beforeClose.player":i,"onUpdate.player":n,"beforeLoad.player":t}),n(),a.trigger("onPlayStart"))};e===!0||!a.player.isActive&&e!==!1?r():i()},next:function(e){var t=a.current;t&&(h(e)||(e=t.direction.next),a.jumpto(t.index+1,e,"next"))},prev:function(e){var t=a.current;t&&(h(e)||(e=t.direction.prev),a.jumpto(t.index-1,e,"prev"))},jumpto:function(e,t,n){var r=a.current;r&&(e=m(e),a.direction=t||r.direction[e>=r.index?"next":"prev"],a.router=n||"jumpto",r.loop&&(0>e&&(e=r.group.length+e%r.group.length),e%=r.group.length),r.group[e]!==i&&(a.cancel(),a._start(e)))},reposition:function(e,t){var i,r=a.current,o=r?r.wrap:null;o&&(i=a._getPosition(t),e&&"scroll"===e.type?(delete i.position,o.stop(!0,!0).animate(i,200)):(o.css(i),r.pos=n.extend({},r.dim,i)))},update:function(e){var t=e&&e.originalEvent&&e.originalEvent.type,n=!t||"orientationchange"===t;n&&(clearTimeout(u),u=null),a.isOpen&&!u&&(u=setTimeout(function(){var i=a.current;i&&!a.isClosing&&(a.wrap.removeClass("fancybox-tmp"),(n||"load"===t||"resize"===t&&i.autoResize)&&a._setDimension(),"scroll"===t&&i.canShrink||a.reposition(e),a.trigger("onUpdate"),u=null)},n&&!c?0:300))},toggle:function(e){a.isOpen&&(a.current.fitToView="boolean"===n.type(e)?e:!a.current.fitToView,c&&(a.wrap.removeAttr("style").addClass("fancybox-tmp"),a.trigger("onUpdate")),a.update())},hideLoading:function(){s.unbind(".loading"),n("#fancybox-loading").remove()},showLoading:function(){var e,t;a.hideLoading(),e=n(a.opts.tpl.loading).click(a.cancel).appendTo("body"),s.bind("keydown.loading",function(e){27===(e.which||e.keyCode)&&(e.preventDefault(),a.cancel())}),a.defaults.fixed||(t=a.getViewport(),e.css({position:"absolute",top:.5*t.h+t.y,left:.5*t.w+t.x})),a.trigger("onLoading")},getViewport:function(){var t=a.current&&a.current.locked||!1,n={x:o.scrollLeft(),y:o.scrollTop()};return t&&t.length?(n.w=t[0].clientWidth,n.h=t[0].clientHeight):(n.w=c&&e.innerWidth?e.innerWidth:o.width(),n.h=c&&e.innerHeight?e.innerHeight:o.height()),n},unbindEvents:function(){a.wrap&&d(a.wrap)&&a.wrap.unbind(".fb"),s.unbind(".fb"),o.unbind(".fb")},bindEvents:function(){var e,t=a.current;t&&(o.bind("orientationchange.fb"+(c?"":" resize.fb")+(t.autoCenter&&!t.locked?" scroll.fb":""),a.update),e=t.keys,e&&s.bind("keydown.fb",function(r){var o=r.which||r.keyCode,s=r.target||r.srcElement;return 27===o&&a.coming?!1:void(r.ctrlKey||r.altKey||r.shiftKey||r.metaKey||s&&(s.type||n(s).is("[contenteditable]"))||n.each(e,function(e,s){return t.group.length>1&&s[o]!==i?(a[e](s[o]),r.preventDefault(),!1):n.inArray(o,s)>-1?(a[e](),r.preventDefault(),!1):void 0}))}),n.fn.mousewheel&&t.mouseWheel&&a.wrap.bind("mousewheel.fb",function(e,i,r,o){for(var s=e.target||null,l=n(s),u=!1;l.length&&!(u||l.is(".fancybox-skin")||l.is(".fancybox-wrap"));)u=f(l[0]),l=n(l).parent();0===i||u||a.group.length>1&&!t.canShrink&&(o>0||r>0?a.prev(o>0?"down":"left"):(0>o||0>r)&&a.next(0>o?"up":"right"),e.preventDefault())}))},trigger:function(e,t){var i,r=t||a.coming||a.current;if(r){if(n.isFunction(r[e])&&(i=r[e].apply(r,Array.prototype.slice.call(arguments,1))),i===!1)return!1;r.helpers&&n.each(r.helpers,function(t,i){i&&a.helpers[t]&&n.isFunction(a.helpers[t][e])&&a.helpers[t][e](n.extend(!0,{},a.helpers[t].defaults,i),r)})}s.trigger(e)},isImage:function(e){return h(e)&&e.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)
},isSWF:function(e){return h(e)&&e.match(/\.(swf)((\?|#).*)?$/i)},_start:function(e){var t,i,r,o,s,l={};if(e=m(e),t=a.group[e]||null,!t)return!1;if(l=n.extend(!0,{},a.opts,t),o=l.margin,s=l.padding,"number"===n.type(o)&&(l.margin=[o,o,o,o]),"number"===n.type(s)&&(l.padding=[s,s,s,s]),l.modal&&n.extend(!0,l,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),l.autoSize&&(l.autoWidth=l.autoHeight=!0),"auto"===l.width&&(l.autoWidth=!0),"auto"===l.height&&(l.autoHeight=!0),l.group=a.group,l.index=e,a.coming=l,!1===a.trigger("beforeLoad"))return void(a.coming=null);if(r=l.type,i=l.href,!r)return a.coming=null,a.current&&a.router&&"jumpto"!==a.router?(a.current.index=e,a[a.router](a.direction)):!1;if(a.isActive=!0,("image"===r||"swf"===r)&&(l.autoHeight=l.autoWidth=!1,l.scrolling="visible"),"image"===r&&(l.aspectRatio=!0),"iframe"===r&&c&&(l.scrolling="scroll"),l.wrap=n(l.tpl.wrap).addClass("fancybox-"+(c?"mobile":"desktop")+" fancybox-type-"+r+" fancybox-tmp "+l.wrapCSS).appendTo(l.parent||"body"),n.extend(l,{skin:n(".fancybox-skin",l.wrap),outer:n(".fancybox-outer",l.wrap),inner:n(".fancybox-inner",l.wrap)}),n.each(["Top","Right","Bottom","Left"],function(e,t){l.skin.css("padding"+t,g(l.padding[e]))}),a.trigger("onReady"),"inline"===r||"html"===r){if(!l.content||!l.content.length)return a._error("content")}else if(!i)return a._error("href");"image"===r?a._loadImage():"ajax"===r?a._loadAjax():"iframe"===r?a._loadIframe():a._afterLoad()},_error:function(e){n.extend(a.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:e,content:a.coming.tpl.error}),a._afterLoad()},_loadImage:function(){var e=a.imgPreload=new Image;e.onload=function(){this.onload=this.onerror=null,a.coming.width=this.width/a.opts.pixelRatio,a.coming.height=this.height/a.opts.pixelRatio,a._afterLoad()},e.onerror=function(){this.onload=this.onerror=null,a._error("image")},e.src=a.coming.href,e.complete!==!0&&a.showLoading()},_loadAjax:function(){var e=a.coming;a.showLoading(),a.ajaxLoad=n.ajax(n.extend({},e.ajax,{url:e.href,error:function(e,t){a.coming&&"abort"!==t?a._error("ajax",e):a.hideLoading()},success:function(t,n){"success"===n&&(e.content=t,a._afterLoad())}}))},_loadIframe:function(){var e=a.coming,t=n(e.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",c?"auto":e.iframe.scrolling).attr("src",e.href);n(e.wrap).bind("onReset",function(){try{n(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(e){}}),e.iframe.preload&&(a.showLoading(),t.one("load",function(){n(this).data("ready",1),c||n(this).bind("load.fb",a.update),n(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),a._afterLoad()})),e.content=t.appendTo(e.inner),e.iframe.preload||a._afterLoad()},_preloadImages:function(){var e,t,n=a.group,i=a.current,r=n.length,o=i.preload?Math.min(i.preload,r-1):0;for(t=1;o>=t;t+=1)e=n[(i.index+t)%r],"image"===e.type&&e.href&&((new Image).src=e.href)},_afterLoad:function(){var e,t,i,r,o,s,l=a.coming,u=a.current,c="fancybox-placeholder";if(a.hideLoading(),l&&a.isActive!==!1){if(!1===a.trigger("afterLoad",l,u))return l.wrap.stop(!0).trigger("onReset").remove(),void(a.coming=null);switch(u&&(a.trigger("beforeChange",u),u.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),a.unbindEvents(),e=l,t=l.content,i=l.type,r=l.scrolling,n.extend(a,{wrap:e.wrap,skin:e.skin,outer:e.outer,inner:e.inner,current:e,previous:u}),o=e.href,i){case"inline":case"ajax":case"html":e.selector?t=n("<div>").html(t).find(e.selector):d(t)&&(t.data(c)||t.data(c,n('<div class="'+c+'"></div>').insertAfter(t).hide()),t=t.show().detach(),e.wrap.bind("onReset",function(){n(this).find(t).length&&t.hide().replaceAll(t.data(c)).data(c,!1)}));break;case"image":t=e.tpl.image.replace(/\{href\}/g,o);break;case"swf":t='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+o+'"></param>',s="",n.each(e.swf,function(e,n){t+='<param name="'+e+'" value="'+n+'"></param>',s+=" "+e+'="'+n+'"'}),t+='<embed src="'+o+'" type="application/x-shockwave-flash" width="100%" height="100%"'+s+"></embed></object>"}d(t)&&t.parent().is(e.inner)||e.inner.append(t),a.trigger("beforeShow"),e.inner.css("overflow","yes"===r?"scroll":"no"===r?"hidden":r),a._setDimension(),a.reposition(),a.isOpen=!1,a.coming=null,a.bindEvents(),a.isOpened?u.prevMethod&&a.transitions[u.prevMethod]():n(".fancybox-wrap").not(e.wrap).stop(!0).trigger("onReset").remove(),a.transitions[a.isOpened?e.nextMethod:e.openMethod](),a._preloadImages()}},_setDimension:function(){var e,t,i,r,o,s,l,u,c,d,h,f,v,y,b,w=a.getViewport(),x=0,_=!1,k=!1,C=a.wrap,S=a.skin,$=a.inner,T=a.current,A=T.width,E=T.height,j=T.minWidth,D=T.minHeight,q=T.maxWidth,P=T.maxHeight,I=T.scrolling,R=T.scrollOutside?T.scrollbarWidth:0,M=T.margin,N=m(M[1]+M[3]),O=m(M[0]+M[2]);if(C.add(S).add($).width("auto").height("auto").removeClass("fancybox-tmp"),e=m(S.outerWidth(!0)-S.width()),t=m(S.outerHeight(!0)-S.height()),i=N+e,r=O+t,o=p(A)?(w.w-i)*m(A)/100:A,s=p(E)?(w.h-r)*m(E)/100:E,"iframe"===T.type){if(y=T.content,T.autoHeight&&1===y.data("ready"))try{y[0].contentWindow.document.location&&($.width(o).height(9999),b=y.contents().find("body"),R&&b.css("overflow-x","hidden"),s=b.outerHeight(!0))}catch(L){}}else(T.autoWidth||T.autoHeight)&&($.addClass("fancybox-tmp"),T.autoWidth||$.width(o),T.autoHeight||$.height(s),T.autoWidth&&(o=$.width()),T.autoHeight&&(s=$.height()),$.removeClass("fancybox-tmp"));if(A=m(o),E=m(s),c=o/s,j=m(p(j)?m(j,"w")-i:j),q=m(p(q)?m(q,"w")-i:q),D=m(p(D)?m(D,"h")-r:D),P=m(p(P)?m(P,"h")-r:P),l=q,u=P,T.fitToView&&(q=Math.min(w.w-i,q),P=Math.min(w.h-r,P)),f=w.w-N,v=w.h-O,T.aspectRatio?(A>q&&(A=q,E=m(A/c)),E>P&&(E=P,A=m(E*c)),j>A&&(A=j,E=m(A/c)),D>E&&(E=D,A=m(E*c))):(A=Math.max(j,Math.min(A,q)),T.autoHeight&&"iframe"!==T.type&&($.width(A),E=$.height()),E=Math.max(D,Math.min(E,P))),T.fitToView)if($.width(A).height(E),C.width(A+e),d=C.width(),h=C.height(),T.aspectRatio)for(;(d>f||h>v)&&A>j&&E>D&&!(x++>19);)E=Math.max(D,Math.min(P,E-10)),A=m(E*c),j>A&&(A=j,E=m(A/c)),A>q&&(A=q,E=m(A/c)),$.width(A).height(E),C.width(A+e),d=C.width(),h=C.height();else A=Math.max(j,Math.min(A,A-(d-f))),E=Math.max(D,Math.min(E,E-(h-v)));R&&"auto"===I&&s>E&&f>A+e+R&&(A+=R),$.width(A).height(E),C.width(A+e),d=C.width(),h=C.height(),_=(d>f||h>v)&&A>j&&E>D,k=T.aspectRatio?l>A&&u>E&&o>A&&s>E:(l>A||u>E)&&(o>A||s>E),n.extend(T,{dim:{width:g(d),height:g(h)},origWidth:o,origHeight:s,canShrink:_,canExpand:k,wPadding:e,hPadding:t,wrapSpace:h-S.outerHeight(!0),skinSpace:S.height()-E}),!y&&T.autoHeight&&E>D&&P>E&&!k&&$.height("auto")},_getPosition:function(e){var t=a.current,n=a.getViewport(),i=t.margin,r=a.wrap.width()+i[1]+i[3],o=a.wrap.height()+i[0]+i[2],s={position:"absolute",top:i[0],left:i[3]};return t.autoCenter&&t.fixed&&!e&&o<=n.h&&r<=n.w?s.position="fixed":t.locked||(s.top+=n.y,s.left+=n.x),s.top=g(Math.max(s.top,s.top+(n.h-o)*t.topRatio)),s.left=g(Math.max(s.left,s.left+(n.w-r)*t.leftRatio)),s},_afterZoomIn:function(){var e=a.current;e&&(a.isOpen=a.isOpened=!0,a.wrap.css("overflow","visible").addClass("fancybox-opened").hide().show(0),a.update(),(e.closeClick||e.nextClick&&a.group.length>1)&&a.inner.css("cursor","pointer").bind("click.fb",function(t){n(t.target).is("a")||n(t.target).parent().is("a")||(t.preventDefault(),a[e.closeClick?"close":"next"]())}),e.closeBtn&&n(e.tpl.closeBtn).appendTo(a.skin).bind("click.fb",function(e){e.preventDefault(),a.close()}),e.arrows&&a.group.length>1&&((e.loop||e.index>0)&&n(e.tpl.prev).appendTo(a.outer).bind("click.fb",a.prev),(e.loop||e.index<a.group.length-1)&&n(e.tpl.next).appendTo(a.outer).bind("click.fb",a.next)),a.trigger("afterShow"),e.loop||e.index!==e.group.length-1?a.opts.autoPlay&&!a.player.isActive&&(a.opts.autoPlay=!1,a.play(!0)):a.play(!1))},_afterZoomOut:function(e){e=e||a.current,n(".fancybox-wrap").trigger("onReset").remove(),n.extend(a,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),a.trigger("afterClose",e)}}),a.transitions={getOrigPosition:function(){var e=a.current,t=e.element,n=e.orig,i={},r=50,o=50,s=e.hPadding,l=e.wPadding,u=a.getViewport();return!n&&e.isDom&&t.is(":visible")&&(n=t.find("img:first"),n.length||(n=t)),d(n)?(i=n.offset(),n.is("img")&&(r=n.outerWidth(),o=n.outerHeight())):(i.top=u.y+(u.h-o)*e.topRatio,i.left=u.x+(u.w-r)*e.leftRatio),("fixed"===a.wrap.css("position")||e.locked)&&(i.top-=u.y,i.left-=u.x),i={top:g(i.top-s*e.topRatio),left:g(i.left-l*e.leftRatio),width:g(r+l),height:g(o+s)}},step:function(e,t){var n,i,r,o=t.prop,s=a.current,l=s.wrapSpace,u=s.skinSpace;("width"===o||"height"===o)&&(n=t.end===t.start?1:(e-t.start)/(t.end-t.start),a.isClosing&&(n=1-n),i="width"===o?s.wPadding:s.hPadding,r=e-i,a.skin[o](m("width"===o?r:r-l*n)),a.inner[o](m("width"===o?r:r-l*n-u*n)))},zoomIn:function(){var e=a.current,t=e.pos,i=e.openEffect,r="elastic"===i,o=n.extend({opacity:1},t);delete o.position,r?(t=this.getOrigPosition(),e.openOpacity&&(t.opacity=.1)):"fade"===i&&(t.opacity=.1),a.wrap.css(t).animate(o,{duration:"none"===i?0:e.openSpeed,easing:e.openEasing,step:r?this.step:null,complete:a._afterZoomIn})},zoomOut:function(){var e=a.current,t=e.closeEffect,n="elastic"===t,i={opacity:.1};n&&(i=this.getOrigPosition(),e.closeOpacity&&(i.opacity=.1)),a.wrap.animate(i,{duration:"none"===t?0:e.closeSpeed,easing:e.closeEasing,step:n?this.step:null,complete:a._afterZoomOut})},changeIn:function(){var e,t=a.current,n=t.nextEffect,i=t.pos,r={opacity:1},o=a.direction,s=200;i.opacity=.1,"elastic"===n&&(e="down"===o||"up"===o?"top":"left","down"===o||"right"===o?(i[e]=g(m(i[e])-s),r[e]="+="+s+"px"):(i[e]=g(m(i[e])+s),r[e]="-="+s+"px")),"none"===n?a._afterZoomIn():a.wrap.css(i).animate(r,{duration:t.nextSpeed,easing:t.nextEasing,complete:a._afterZoomIn})},changeOut:function(){var e=a.previous,t=e.prevEffect,i={opacity:.1},r=a.direction,o=200;"elastic"===t&&(i["down"===r||"up"===r?"top":"left"]=("up"===r||"left"===r?"-":"+")+"="+o+"px"),e.wrap.animate(i,{duration:"none"===t?0:e.prevSpeed,easing:e.prevEasing,complete:function(){n(this).trigger("onReset").remove()}})}},a.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!c,fixed:!0},overlay:null,fixed:!1,el:n("html"),create:function(e){var t;e=n.extend({},this.defaults,e),this.overlay&&this.close(),t=a.coming?a.coming.parent:e.parent,this.overlay=n('<div class="fancybox-overlay"></div>').appendTo(t&&t.length?t:"body"),this.fixed=!1,e.fixed&&a.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(e){var t=this;e=n.extend({},this.defaults,e),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(e),this.fixed||(o.bind("resize.overlay",n.proxy(this.update,this)),this.update()),e.closeClick&&this.overlay.bind("click.overlay",function(e){return n(e.target).hasClass("fancybox-overlay")?(a.isActive?a.close():t.close(),!1):void 0}),this.overlay.css(e.css).show()},close:function(){o.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(n(".fancybox-margin").removeClass("fancybox-margin"),this.el.removeClass("fancybox-lock"),o.scrollTop(this.scrollV).scrollLeft(this.scrollH)),n(".fancybox-overlay").remove().hide(),n.extend(this,{overlay:null,fixed:!1})},update:function(){var e,n="100%";this.overlay.width(n).height("100%"),l?(e=Math.max(t.documentElement.offsetWidth,t.body.offsetWidth),s.width()>e&&(n=s.width())):s.width()>o.width()&&(n=s.width()),this.overlay.width(n).height(s.height())},onReady:function(e,t){var i=this.overlay;n(".fancybox-overlay").stop(!0,!0),i||this.create(e),e.locked&&this.fixed&&t.fixed&&(t.locked=this.overlay.append(t.wrap),t.fixed=!1),e.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(e,t){t.locked&&!this.el.hasClass("fancybox-lock")&&(this.fixPosition!==!1&&n("*").filter(function(){return"fixed"===n(this).css("position")&&!n(this).hasClass("fancybox-overlay")&&!n(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin"),this.scrollV=o.scrollTop(),this.scrollH=o.scrollLeft(),this.el.addClass("fancybox-lock"),o.scrollTop(this.scrollV).scrollLeft(this.scrollH)),this.open(e)},onUpdate:function(){this.fixed||this.update()},afterClose:function(e){this.overlay&&!a.coming&&this.overlay.fadeOut(e.speedOut,n.proxy(this.close,this))}},a.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(e){var t,i,r=a.current,o=r.title,s=e.type;if(n.isFunction(o)&&(o=o.call(r.element,r)),h(o)&&""!==n.trim(o)){switch(t=n('<div class="fancybox-title fancybox-title-'+s+'-wrap">'+o+"</div>"),s){case"inside":i=a.skin;break;case"outside":i=a.wrap;break;case"over":i=a.inner;break;default:i=a.skin,t.appendTo("body"),l&&t.width(t.width()),t.wrapInner('<span class="child"></span>'),a.current.margin[2]+=Math.abs(m(t.css("margin-bottom")))}t["top"===e.position?"prependTo":"appendTo"](i)}}},n.fn.fancybox=function(e){var t,i=n(this),r=this.selector||"",o=function(o){var s,l,u=n(this).blur(),c=t;o.ctrlKey||o.altKey||o.shiftKey||o.metaKey||u.is(".fancybox-wrap")||(s=e.groupAttr||"data-fancybox-group",l=u.attr(s),l||(s="rel",l=u.get(0)[s]),l&&""!==l&&"nofollow"!==l&&(u=r.length?n(r):i,u=u.filter("["+s+'="'+l+'"]'),c=u.index(this)),e.index=c,a.open(u,e)!==!1&&o.preventDefault())};return e=e||{},t=e.index||0,r&&e.live!==!1?s.undelegate(r,"click.fb-start").delegate(r+":not('.fancybox-item, .fancybox-nav')","click.fb-start",o):i.unbind("click.fb-start").bind("click.fb-start",o),this.filter("[data-fancybox-start=1]").trigger("click"),this},s.ready(function(){var t,o;n.scrollbarWidth===i&&(n.scrollbarWidth=function(){var e=n('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),t=e.children(),i=t.innerWidth()-t.height(99).innerWidth();return e.remove(),i}),n.support.fixedPosition===i&&(n.support.fixedPosition=function(){var e=n('<div style="position:fixed;top:20px;"></div>').appendTo("body"),t=20===e[0].offsetTop||15===e[0].offsetTop;return e.remove(),t}()),n.extend(a.defaults,{scrollbarWidth:n.scrollbarWidth(),fixed:n.support.fixedPosition,parent:n("body")}),t=n(e).width(),r.addClass("fancybox-lock-test"),o=n(e).width(),r.removeClass("fancybox-lock-test"),n("<style type='text/css'>.fancybox-margin{margin-right:"+(o-t)+"px;}</style>").appendTo("head")})}(window,document,jQuery)}.apply(e,arguments)})}(this),define("components/diff/diff-actions-2",["jquery","underscore","utils/query-params","components/diff/diff","components/diff/bitbucket-side-by-side-diff","utils/gaq-push","jquery-plugins/jquery.fancybox"],function(e,t,n,i,r,o){var s=function(e,n){this.filename_=e,this.endpoint=n,this.id_=t.uniqueId("side-by-side-")};return s.prototype.decorate=function(t){var n=e('meta[name="tab-size"]').attr("content");this.$elem_=t,this.$elem_.attr("id",this.id_),this.$container_=e('<div class="bb-sbs-patch"></div>').appendTo(this.$elem_),this.$container_.attr("id",this.id_+"-content"),n&&this.$container_.addClass("tab-size-{}".format(n)),this.enterDocument()},s.prototype.withDiff=function(t){if(this.diff_)t(this.diff_);else{var r=this;e.ajax({type:"GET",data:{filename:r.filename_,meta:!0,w:n.get("w")},dataType:"json",url:r.endpoint,success:function(e){r.diff_=i.sideBySideFromData(e[0]),r.diff_.url=r.endpoint,t(r.diff_)}})}},s.prototype.withSbsDiff=function(e){var t=this;t.sbsDiff_?e(t.sbsDiff_):t.withDiff(function(n){t.sbsDiff_=new r(n),e(t.sbsDiff_)})},s.prototype.enterDocument=function(){var t=this;this.$elem_.find("a.sbs").attr("href","#"+t.id_+"-content").fancybox({autoSize:!1,margin:30,width:"97%",height:"97%",scrolling:"no",afterShow:function(){e(this.element).trigger("sbsOpen")},afterClose:function(){e(this.element).trigger("sbsClose")}}).bind("sbsOpen",function(){t.onDialogOpen_.apply(t)}).bind("sbsClose",function(){t.onDialogClose_.apply(t)})},s.prototype.handleResize=t.debounce(function(){var e=this;e.withSbsDiff(function(t){e.withDiff(function(n){t.setHeight(e.$container_.parent().height()-60-(n.hasNote()?59:0)),t.setWidth(e.$container_.parent().width())})})},400),s.prototype.onDialogOpen_=function(){var t=this;o(["atl._trackEvent","Code","Invoke SBS diff"]),e("#fancybox-wrap").css({position:"fixed",top:15,left:15}),t.withSbsDiff(function(n){t.withDiff(function(i){t.$container_.show(),n.setHeight(t.$container_.parent().height()-60-(i.hasNote()?59:0)),n.setWidth(t.$container_.parent().width()),0===t.$container_.children().length&&n.render(t.$container_),setTimeout(e.proxy(n.scrollToFirstHunk,n),0)})}),e(window).on("resize",t.handleResize.bind(t))},s.prototype.onDialogClose_=function(){this.$container_.hide(),e(window).off("resize",this.handleResize)},s}),function(e){define("jquery-plugins/jquery.chosen",["jquery"],function(){return function(){(function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,n,i,r,o,s;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),o=e.childNodes,s=[],i=0,r=o.length;r>i;i++)n=o[i],s.push(this.add_option(n,t,e.disabled));return s},e.prototype.add_option=function(e,t,n){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,data:e.dataset,attributes:e.attributes,html:e.innerHTML,selected:e.selected,disabled:n===!0?n:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e}(),e.select_to_array=function(t){var n,i,r,o,s;for(i=new e,s=t.childNodes,r=0,o=s.length;o>r;r++)n=s[r],i.add_node(n);return i.parsed},this.SelectParser=e}).call(this),function(){var e,t;t=this,e=function(){function e(t,n){this.form_field=t,this.options=null!=n?n:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.result_formatter=this.options.result_formatter||function(e){return"<span>"+e.html+"</span>"},this.inherit_select_classes=this.options.inherit_select_classes||!1},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.result_add_option=function(e){var t,n;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),n=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+n+' data-value="'+AJS.escapeHtml(e.value)+'">'+e.html+"</li>")},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.choices_count=function(){var e,t,n,i;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,i=this.form_field.options,t=0,n=i.length;n>t;t++)e=i[t],e.selected&&(this.selected_option_count+=1);return this.selected_option_count},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,n;switch(t=null!=(n=e.which)?n:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,n;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=Math.floor(Math.random()*e.length),t=e.substring(n,n+1)},e.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},e.browser_is_supported=function(){var e;return"Microsoft Internet Explorer"===window.navigator.appName?null!==(e=document.documentMode)&&e>=8:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),t.AbstractChosen=e}.call(this),function(){var e,t,n,i,r={}.hasOwnProperty,o=function(e,t){function n(){this.constructor=e}for(var i in t)r.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};n=this,e=jQuery,e.fn.extend({chosen:function(n){return AbstractChosen.browser_is_supported()?this.each(function(){var i;return i=e(this),i.hasClass("chzn-done")?void 0:i.data("chosen",new t(this,n))}):this}}),t=function(t){function r(){return i=r.__super__.constructor.apply(this,arguments)}return o(r,t),r.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},r.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},r.prototype.set_up_html=function(){var t,n;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",t=["chzn-container"],t.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chzn-rtl"),n={id:this.container_id,"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.container=e("<div />",n),this.container.html(this.is_multiple?'<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop"><ul class="chzn-results"></ul></div>':'<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chzn-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},r.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){e.container_mousedown(t)}),this.container.mouseup(function(t){e.container_mouseup(t)}),this.container.mouseenter(function(t){e.mouse_enter(t)}),this.container.mouseleave(function(t){e.mouse_leave(t)}),this.search_results.mouseup(function(t){e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel DOMMouseScroll",function(t){e.search_results_mousewheel(t)}),this.form_field_jq.bind("liszt:updated",function(t){e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){e.container_mousedown(t)}),this.search_field.blur(function(t){e.input_blur(t)}),this.search_field.keyup(function(t){e.keyup_checker(t)}),this.search_field.keydown(function(t){e.keydown_checker(t)}),this.search_field.focus(function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.click(function(t){e.choices_click(t)}):this.container.click(function(e){e.preventDefault()})},r.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},r.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chzn-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field())},r.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},r.prototype.search_results_mousewheel=function(e){var t,n,i;return t=-(null!=(n=e.originalEvent)?n.wheelDelta:void 0)||(null!=(i=e.originialEvent)?i.detail:void 0),null!=t?(e.preventDefault(),"DOMMouseScroll"===e.type&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},r.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},r.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},r.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},r.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},r.prototype.results_build=function(){var e,t,i,r,o;for(this.parsing=!0,this.selected_option_count=null,this.results_data=n.SelectParser.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),e="",o=this.results_data,i=0,r=o.length;r>i;i++)t=o[i],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").attr("data-value",t.value).text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},r.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},r.prototype.result_do_highlight=function(e){var t,n,i,r,o;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),i=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),r=i+o,n=this.result_highlight.position().top+this.search_results.scrollTop(),t=n+this.result_highlight.outerHeight(),t>=r)return this.search_results.scrollTop(t-i>0?t-i:0);if(o>n)return this.search_results.scrollTop(n)}},r.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},r.prototype.results_show=function(){if(null!=this.result_single_selected)this.result_do_highlight(this.result_single_selected);else if(this.is_multiple&&this.max_selected_options<=this.choices_count())return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1;return this.container.addClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},r.prototype.results_hide=function(){return this.result_clear_highlight(),this.container.removeClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.results_showing=!1},r.prototype.set_tab_index=function(){var e;return this.form_field_jq.attr("tabindex")?(e=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",e)):void 0},r.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.click(function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()
}):void 0},r.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},r.prototype.search_results_mouseup=function(t){var n;return n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),n.length?(this.result_highlight=n,this.result_select(t),this.search_field.focus()):void 0},r.prototype.search_results_mouseover=function(t){var n;return n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),n?this.result_do_highlight(n):void 0},r.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},r.prototype.choice_build=function(t){var n,i,r=this;return n=e("<li />",{"class":"search-choice"}).html(this.result_formatter(t)),t.disabled?n.addClass("search-choice-disabled"):(i=e("<a />",{href:"#","class":"search-choice-close",rel:t.array_index}),i.click(function(e){return r.choice_destroy_link_click(e)}),n.append(i)),this.search_container.before(n)},r.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},r.prototype.choice_destroy=function(e){return this.result_deselect(e.attr("rel"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},r.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.selected_item.find("span").text(this.default_text),this.selected_item.find("span").removeAttr("data-value"),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},r.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},r.prototype.result_select=function(e){var t,n,i,r;return this.result_highlight?(t=this.result_highlight,n=t.attr("id"),this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),r=n.substr(n.lastIndexOf("_")+1),i=this.results_data[r],i.selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):(this.selected_item.find("span").first().attr("data-value",i.value).text(i.text),this.allow_single_deselect&&this.single_deselect_control_build()),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},r.prototype.result_activate=function(e){return e.addClass("active-result")},r.prototype.result_deactivate=function(e){return e.removeClass("active-result")},r.prototype.result_deselect=function(t){var n,i;return i=this.results_data[t],this.form_field.options[i.options_index].disabled?!1:(i.selected=!1,this.form_field.options[i.options_index].selected=!1,this.selected_option_count=null,n=e("#"+this.container_id+"_o_"+t),n.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[i.options_index].value}),this.search_field_scale(),!0)},r.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},r.prototype.winnow_results=function(){var t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v,y;for(this.no_results_clear(),u=0,c=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),s=this.search_contains?"":"^",o=new RegExp(s+c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),p=new RegExp(c.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),y=this.results_data,f=0,g=y.length;g>f;f++)if(n=y[f],!n.disabled&&!n.empty)if(n.group)e("#"+n.dom_id).css("display","none");else if(!this.is_multiple||!n.selected){if(t=!1,l=n.dom_id,a=e("#"+l),o.test(n.html))t=!0,u+=1;else if(this.enable_split_word_search&&(n.html.indexOf(" ")>=0||0===n.html.indexOf("["))&&(r=n.html.replace(/\[|\]/g,"").split(" "),r.length))for(m=0,v=r.length;v>m;m++)i=r[m],o.test(i)&&(t=!0,u+=1);t?(c.length?(d=n.html.search(p),h=n.html.substr(0,d+c.length)+"</em>"+n.html.substr(d+c.length),h=h.substr(0,d)+"<em>"+h.substr(d)):h=n.html,a.html(h),this.result_activate(a),null!=n.group_array_index&&e("#"+this.results_data[n.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(a))}return 1>u&&c.length?this.no_results(c):this.winnow_results_set_highlight()},r.prototype.winnow_results_clear=function(){var t,n,i,r,o;for(this.search_field.val(""),n=this.search_results.find("li"),o=[],i=0,r=n.length;r>i;i++)t=n[i],t=e(t),o.push(t.hasClass("group-result")?t.css("display","auto"):this.is_multiple&&t.hasClass("result-selected")?void 0:this.result_activate(t));return o},r.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null==e)?void 0:this.result_do_highlight(e)},r.prototype.no_results=function(t){var n;return n=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),n.find("span").first().html(t),this.search_results.append(n)},r.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},r.prototype.keydown_arrow=function(){var t,n;return this.result_highlight?this.results_showing&&(n=this.result_highlight.nextAll("li.active-result").first(),n&&this.result_do_highlight(n)):(t=this.search_results.find("li.active-result").first(),t&&this.result_do_highlight(e(t))),this.results_showing?void 0:this.results_show()},r.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},r.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},r.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},r.prototype.keydown_checker=function(e){var t,n;switch(t=null!=(n=e.which)?n:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},r.prototype.search_field_scale=function(){var t,n,i,r,o,s,a,l;if(this.is_multiple){for(n=0,s=0,r="position:absolute; left: -1000px; top: -1000px; display:none;",o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],a=0,l=o.length;l>a;a++)i=o[a],r+=i+":"+this.search_field.css(i)+";";return t=e("<div />",{style:r}),t.text(this.search_field.val()),e("body").append(t),s=t.width()+25,t.remove(),this.f_width||(this.f_width=this.container.outerWidth()),s>this.f_width-10&&(s=this.f_width-10),this.search_field.css({width:s+"px"})}},r.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},r}(AbstractChosen),n.Chosen=t}.call(this)}.apply(e,arguments)})}(this),define("js/components/toggle-button",["marionette","underscore"],function(e,t){return e.ItemView.extend({tagName:"button",className:"aui-button",attributes:function(){return{"aria-pressed":this.isPressed}},template:function(e){return e.text},templateHelpers:function(){var e={};return e.text=this.isPressed&&this.pressedText?this.pressedText:this.text,e},events:{click:"toggle"},initialize:function(e){e=e||{},this.isPressed=t.isBoolean(e.isPressed)?e.isPressed:"true"===this.$el.attr("aria-pressed"),this.text=e.text||this.text||this.$el.text(),this.pressedText=e.pressedText||this.pressedText||this.$el.data("pressed-text"),this.on("toggle",function(){this.render()})},onRender:function(){this.$el.attr(this.attributes())},toggle:function(e){return this.isPressed=t.isBoolean(e)?e:!this.isPressed,this.trigger("toggle",this.isPressed),this}})}),define("utils/parse-compare-spec",[],function(){return function(e){var t=e.split(":");return{repo:t.shift(),hash:t.shift()||null,branch:t.join(":")||null}}}),define("components/compare",["jquery","on-ready","components/branch-selector","components/merge-dialog","components/diff/context-expander","components/diff/diff-actions-2","data/current-repo","jquery-plugins/jquery.chosen","jquery-plugins/jquery.pjax","js/components/toggle-button","utils/api-helper","utils/gaq-push","utils/parse-compare-spec","utils/query-params"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p){return t(function(){function t(e,t){var n='[data-repo="{0}"]'.format();return e.filter(n(t))}function a(e,n,i){var r=h(n),o=h(i),s=y.find("#id_source_repo"),a=y.find("#id_dest_repo"),l=e.find('[data-field="source"]'),u=e.find('[data-field="dest"]'),c=t(l,r.repo),d=t(u,o.repo);c.val(n).trigger("change"),d.val(i).trigger("change"),s.val(r.repo).trigger("bb:repo:change").trigger("change"),a.val(o.repo).trigger("bb:repo:change").trigger("change")}function l(e,t,n,i){return t!==e||i?"{0}{1}{2}".format(t,i?"+":":",encodeURIComponent(n)):encodeURIComponent(n)}function f(e,t,n){var i,r,o="{0}/{1}".format(s.owner.username,s.slug),a=h(t.val()),u=h(n.val()),c=t.data("multiple-heads")?a.hash:a.branch,d=n.data("multiple-heads")?u.hash:u.branch;return d?(i=l(o,a.repo,c),r=l(o,u.repo,d)):(i=l(o,a.repo,c,!0),r=u.repo),"{0}{1}{2}{3}".format(e,i,encodeURIComponent("\r"),r)}function m(e,t){var n=e.find('.menu-item a[href="{}"]'.format(t)).closest(".menu-item");0!==n.length&&(e.find(".menu-item.active-tab").removeClass("active-tab"),e.find(".tabs-pane.active-pane").removeClass("active-pane"),n.addClass("active-tab"),e.find(t+".tabs-pane").addClass("active-pane"))}function g(e,t){for(var n=h(e),i=null,r=0;r<t.length;++r){var o=t[r],s=h(o);if(n.repo==s.repo){if(n.hash==s.hash&&n.branch==s.branch)return o;null===i&&n.branch==s.branch&&(i=o)}}return i}var v=e("#compare-toolbar"),y=e("#compare-form");e(".compare-widget-form:not(.deleted)").each(function(){var t=e(this),i=t.find(".repo-field"),r=t.find(".repo-avatar-link"),o=t.find(".branch-field"),s='[data-repo="{0}"]'.format();i.on("bb:compare:repo:change",function(){r.hide().filter(s(i.val())).show()}),i.on("bb:repo:change",function(){e(this).trigger("bb:compare:repo:change")}),o.on("bb:branch:change",function(){e(this).trigger("bb:compare:change")}),n(i.filter(":visible"),o),i.change()});var b=e(".compare-widget-container"),w=e("#compare-content"),x=null,_=!0;w.on("pjax:error",function(e){e.preventDefault()}),w.on("pjax:start",function(){w.addClass("has-mask")}),w.on("pjax:end",function(){w.removeClass("has-mask"),w.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var t=e(this),n=t.data("filename"),i=t.data("compare-files-url");new o(n,i).decorate(t.find(".diff-actions")),new r(t.data("expand-context-url")+encodeURI(n),t.data("identifier"),!1).decorate(t)}),b.trigger("bb:compare:loaded"),e(document).trigger("bb:compare")}),b.bind("bb:compare:change",function(){var t=e(this),n=w.attr("data-full-url"),i=t.find('[name="source"] option:selected'),r=t.find('[name="dest"] option:selected'),o=p.get("w"),s=p.get("ts");if(!n){if(!i.val()||!r.val()||t.data("compare-view-disabled"))return;n=f(w.attr("data-base-url"),i,r)}if(n+=window.location.hash,v.removeClass("has-conflicts"),b.data("pjax")&&e.support.pjax)e.pjax({container:"#compare-content",url:n,push:!_,scrollTo:null,timeout:0,state:{source:i.val(),dest:r.val()}});else{x&&x.readyState<4&&(x.onreadystatechange=e.noop,x.abort());var a={},l=function(){w.trigger("pjax:start")},c=function(){w.trigger("pjax:end")},d=function(t){w.html(t),w.trigger("pjax:success"),e(document).trigger("bb:compare");var n=new u({el:"#diff-ignore-whitespace"}).render();n.on("toggle",function(e){p.update("w",e?"1":"0"),window.history.replaceState({},"",p.asUrl(window.location.href)),b.trigger("bb:compare:change")})};null!==o&&(a.w=o),s&&(a.ts=s),x=e.ajax({url:n,data:a,dataType:"html",beforeSend:l,complete:c,success:d})}_=!1}),e(window).on("hashchange",function(){m(e("#compare-tabs"),window.location.hash)}),e(document).bind("bb:compare",function(){e(function(){{var t=e("#compare-tabs"),n=e("#compare-content"),i=e("#changeset-diff"),r=e(".file-diff-placeholder"),o=b.find('[name="source"] option:selected'),a=b.find('[name="dest"] option:selected'),l=c.concat("repositories",s.owner.username,s.slug,"comparefiles").toString(),u=n.attr("data-files-url")||f(l,o,a),h=e("#compare-metadata"),p=h.data("has-conflicts");h.data("hasChanges")}1===b.length&&r.length&&new BitbucketPatch(r,u).render(i),e("#compare-toolbar .conflict-warning").tooltip(),v.toggleClass("has-conflicts",p),window.location.hash&&m(t,window.location.hash),AJS.tabs.setup(),t.find(".menu-item a").on("click",function(){window.location.hash=e(this).attr("href")}),t.on("click",'a[href="#diff"]',function(){d(["atl._trackEvent","Compare","Diff tab"])}).on("click",'a[href="#commits"]',function(){d(["atl._trackEvent","Compare","Commits tab"])})})});var k=e("#compare-create-pr"),C=e("#compare-merge"),S=b.data("pr-source-choices")||[],$=b.data("pr-dest-choices")||[];e(document).bind("bb:compare",function(){var t=e(this),n=t.find('[name="source"]').val(),i=t.find('[name="dest"]').val(),r=e("#compare-metadata").data("hasChanges");if(0!==k.length&&S&&$){var o=g(n,S),s=g(i,$);o&&s&&r?(k[0].search="source={0}&dest={1}".format(o,s),k.removeClass("disabled").removeAttr("aria-disabled")):(k[0].search="",k.addClass("disabled").attr("aria-disabled",!0))}}),e(document).bind("bb:compare",function(){var t=e("#compare-metadata"),n=t.data("hasChanges"),i=t.data("hasWrite"),r=t.data("has-branch-write");i&&n&&r?C.removeClass("disabled").removeAttr("aria-disabled"):C.addClass("disabled").attr("aria-disabled",!0)}),k.bind("click",function(t){e(this).hasClass("disabled")&&t.preventDefault()}),C.length&&i(C,{getData:function(){function t(e){return e.find('[value="{}"]'.format(e.val()))}function n(e,t){return e.filter('[data-repo="{}"]'.format(t)).find("img")}var i,r=y.find('[name="source"]'),o=e("#compare-metadata"),s=t(r),a=s.text(),l=y.find("#id_source_repo").val(),u=y.find('[name="dest"]'),c=t(u),d=c.text(),h=y.find("#id_dest_repo").val(),p=y.find('label[for="id_source_repo"] .repo-avatar-link'),f=n(p,l),m=y.find('label[for="id_dest_repo"] .repo-avatar-link'),g=n(m,h),v=o.data("has-conflicts"),b=!o.data("has-branch-close"),w=!1;return i=l==h?a:c.data("mainbranch")&&a==d?l:"{}/{}".format(l,a),l!=h||s.data("mainbranch")||b||(w=!0),{action:document.location.pathname,source:r.val(),sourceBranch:a,sourceRepo:l,sourceAvatar:f.attr("src"),sourceAvatarAltText:f.attr("alt"),dest:u.val(),destBranch:d,destRepo:h,destAvatar:g.attr("src"),destAvatarAltText:g.attr("alt"),sameRepo:l==h,canCloseBranch:w,hasConflicts:v,mergeCommands:v&&e("#merge-commands-content").html(),commitMessageSlug:i}}}),y.find("#compare-swap-link a").click(function(e){e.preventDefault();var t=y.find('[name="source"]').val(),n=y.find('[name="dest"]').val();a(y,n,t),b.trigger("bb:compare:change")}),b.trigger("bb:compare:change")})}),define("components/mathjax",["jquery","on-ready"],function(e,t){return t(function(){window.MathJax?window.MathJax.Hub.Typeset():(window.MathJax={TeX:{extensions:["mhchem.js"]}},e.getScript("https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML,Safe"))})}),define("experiment/grow1279-guide",["aui","jquery","on-ready","data/current-user","data/current-repo","jquery-plugins/jquery.cookie"],function(e,t,n,i,r){return n(function(){var n=r.slug;if("sandbox"===n&&null!==t.cookie("bb_onboarding")){var o=null,s=!1,a=i.username,l=i.avatarUrl,u="bitbucket.org"===window.location.hostname,c="//analytics."+(u?"":"stg.internal.")+"atlassian.com/analytics/event",d='<svg width="66px" height="82px" viewBox="0 0 66 82" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>illustration-trophy</title><defs></defs><g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="illustration-trophy" sketch:type="MSArtboardGroup"><g sketch:type="MSLayerGroup" id="Shape"><path d="M54.2719737,32.8017447 C60.7742763,32.741117 66,27.5738085 66,21.0949362 C66,15.3523191 61.9053947,10.4680851 56.4864474,9.59574468 L56.4473684,9.59574468 L56.4473684,1.74468085 C56.4473684,0.781180851 55.6696974,0 54.7105263,0 L11.2894737,0 C10.3303026,0 9.55263158,0.781180851 9.55263158,1.74468085 L9.55263158,9.36152128 C3.90789474,10.4414787 -0.132868421,15.2349894 -0.132868421,20.9780426 C-0.132868421,27.4569149 5.01382895,32.7454787 11.5156974,32.8021809 C13.6415921,38.6660532 17.7353289,44.4352766 25.6887632,46.5650957 L18.9558947,64.5531915 L19.0310132,64.5531915 L9.41585526,71.4093511 C8.95689474,71.7364787 8.68421053,72.2668617 8.68421053,72.8321383 L8.68421053,80.2553191 C8.68421053,81.2188191 9.46188158,82 10.4210526,82 L55.5789474,82 C56.5381184,82 57.3157895,81.2188191 57.3157895,80.2553191 L57.3157895,73.0205638 C57.3157895,72.4657553 57.0530921,71.9440957 56.6084605,71.6152234 L46.7523158,64.3307447 L40.0615658,46.468266 C48.0219474,44.3401915 52.1460789,38.6686702 54.2719737,32.8017447 L54.2719737,32.8017447 Z M56.4677763,13.2648085 C59.7834079,14.2697447 62.2002237,17.2845532 62.2002237,20.9226489 C62.2002237,24.9205851 59.2684342,28.3510638 55.4235,28.787234 L55.4195921,28.787234 C56.3188421,24.8617021 56.4473684,21.3016809 56.4473684,18.9306596 L56.4473684,13.2639362 C56.4473684,13.2648085 56.4677763,13.2648085 56.4677763,13.2648085 L56.4677763,13.2648085 Z M3.65952632,20.9780426 C3.65952632,17.3399468 6.07894737,14.2697447 9.55263158,13.2648085 L9.55263158,18.9306596 C9.55263158,21.2995 9.63903947,24.9746702 10.5304737,28.8975851 C6.68163158,28.3109362 3.65952632,24.9746702 3.65952632,20.9780426 L3.65952632,20.9780426 Z M42.0888947,64.5531915 L23.6080263,64.5531915 L30.0273947,47.3275213 C30.9331579,47.4095213 31.8645395,47.4095213 32.8493289,47.4095213 C33.8341184,47.4095213 34.7655,47.4374362 35.6703947,47.3554362 L42.0888947,64.5531915 L42.0888947,64.5531915 Z M32.8493289,43.5633723 C26.2528026,43.5633723 18.7657105,41.2917979 15.1635,32.2325426 C14.7101842,31.1338298 14.3419737,29.9212766 14.0375921,28.612766 C13.3749868,25.8845213 13.0263158,22.6830319 13.0263158,18.9306596 L13.0263158,13.0759468 L13.0263158,9.22805319 L13.0263158,3.92553191 L52.5394737,3.92553191 L52.5394737,18.9306596 C52.5394737,22.6965532 52.2424737,25.9045851 51.5833421,28.6450426 C51.5473026,28.8038085 51.5355789,28.9481809 51.4978026,29.1043298 C51.3223816,29.7817021 51.1491316,30.4311596 50.9398421,31.0500851 C50.8599474,31.2877979 50.7856974,31.5198404 50.6958158,31.749266 C47.1713289,41.2002021 39.5496316,43.5633723 32.8493289,43.5633723 L32.8493289,43.5633723 Z" fill="#CCCCCC" sketch:type="MSShapeGroup"></path><path d="M36.50625,17.7237766 L33.4190132,11.48 L30.3474079,17.7237766 L23.4473684,18.731766 L28.4420921,23.5828511 L27.2523553,30.4582021 L33.4190132,27.2130957 L39.6013026,30.4582021 L38.42025,23.5828511 L43.4062895,18.731766 L36.50625,17.7237766 Z" fill="#F79232" sketch:type="MSShapeGroup"></path></g></g></g></svg>',h='<svg width="72px" height="78px" viewBox="0 0 72 78" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>illustration-invitation</title><defs></defs><g id="Assets" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" sketch:type="MSPage"><g id="illustration-invitation" sketch:type="MSArtboardGroup"><g id="Imported-Layers" sketch:type="MSLayerGroup" transform="translate(0.000000, 1.000000)"><path d="M70.72,38.728 L40.999,62.192 C39.637,63.267 37.861,63.86 36,63.86 C34.139,63.86 32.363,63.267 31.001,62.192 L1.28,38.728 C0.9,38.428 0.455,38.032 0,37.568 L0,73 C0,75.2 1.8,77 4,77 L68,77 C70.2,77 72,75.2 72,73 L72,37.568 C71.545,38.032 71.101,38.428 70.72,38.728" id="Fill-1" fill="#CCCCCC" sketch:type="MSShapeGroup"></path><path d="M15,43 L57,43 L57,41 L15,41 L15,43 Z M68.86,24.942 L39.14,1.479 C37.413,0.115 34.587,0.115 32.86,1.479 L3.14,24.942 C1.413,26.306 0,28.842 0,30.579 C0,31.34 0.283,32.255 0.733,33.158 L9,39.684 L9,27 L63,27 L63,39.684 L71.267,33.158 C71.718,32.255 72,31.34 72,30.579 C72,28.842 70.587,26.306 68.86,24.942 L68.86,24.942 Z M15,39 L27,39 L27,37 L15,37 L15,39 Z M23.333,51 L37,51 L37,49 L20.8,49 L23.333,51 L23.333,51 Z M18.267,47 L53.733,47 L56.266,45 L15.733,45 L18.267,47 L18.267,47 Z" id="Fill-2" fill="#E9E9E9" sketch:type="MSShapeGroup"></path><path d="M70.105,25.684 C70.105,30.131 66.5,33.737 62.053,33.737 C57.605,33.737 54,30.131 54,25.684 C54,21.237 57.605,17.632 62.053,17.632 C66.5,17.632 70.105,21.237 70.105,25.684" id="Fill-3" fill="#F89232" sketch:type="MSShapeGroup"></path><path d="M61.562,29.474 L61.562,24.362 L59.684,24.362 L59.684,23.09 C60.859,23.078 61.695,22.411 61.828,21.612 L63.464,21.612 L63.464,29.474 L61.562,29.474" id="Fill-4" fill="#FFFFFF" sketch:type="MSShapeGroup"></path></g></g></g></svg>',p=function(e){jQuery.ajax({url:c,type:"POST",data:JSON.stringify({name:"bitbucket.onboarding.guide."+e,serverTime:(new Date).getTime(),product:"bitbucket",user:a,server:u?"production":"staging"}),contentType:"application/json"})},f=function(){if(0===t("#pullrequest-count").length){var e={title:"Improve readme to be more awesome",description:"Add an extra message on the end of the Readme file to test out this awesome Pull Request feature!",source:{branch:{name:"update-readme"},repository:{fullname:n}},destination:{branch:{name:"master"}},close_source_branch:!0};t.ajax({type:"POST",url:"/api/2.0/repositories/"+a+"/"+n+"/pullrequests/",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(){s=!0,p("create-pullrequest.success"),t("#pullrequest-count").length||t("#repo-pullrequests-link").prepend(t('<span class="aui-badge" title="1 open pull request" id="pullrequest-count">1</span>'))},failure:function(){p("create-pullrequest.error"),v("bb_onboarding_pr",6)}})}},m=function(n,i,r,s,a,l){if(null===o&&1===n.length){var u="undefined"!=typeof l,c={hideDelay:null,width:u?380:300,noBind:!0,addActiveClass:!1,hideCallback:function(){v(s,parseInt(t.cookie(s)||"1")+1),o=null}};t.extend(c,r),u&&(i='<div><div class="helpGraphic">'+l+"</div>"+i+"</div>"),o=e.InlineDialog(n,"help",function(e,t,n){return e.html(i),n(),!1},c),u&&o.addClass("svg"),setTimeout(function(){p(a),o.show()},500)}},g=function(){null!==o&&(o.hide(),o.remove(),o=null)},v=function(e,n){t.cookie(e,n,{expires:365,path:"/"})},y=function(){setTimeout(function(){f();var e="<div class='help-body'><h1>Welcome to your sandbox repository</h1><p>Weve cooked up this repository to highlight some powerful features you can expect to find in Bitbucket, and to give you a look at a working repository.</p></div><div class='help-footer'><a href='#' class='aui-button help-next-1'>Next</a><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>1/2</div></div>";m(t(".aui-page-header-main h1 a"),e,{gravity:"n"},"bb_onboarding","show.sandbox.1")},1e3)},b=function(){var e="<div class='help-body'><h1>Take a look around</h1><p>Lets take a look at an example of one way Bitbucket makes life better for teams. We created an active pull request example to show how easy and effective collaboration and review are in Bitbucket. </p></div><div class='help-footer'><a href='#' class='aui-button help-next-2'>OK, got it</a><div class='help-progress'>2/2</div></div>";m(t("#repo-pullrequests-link"),e,{gravity:"w"},"bb_onboarding","show.sandbox.2")},w=function(){var e="<div class='help-body'><h1>Pull requests</h1><p>Looks like you've opened a pull request for someone to review your changes. Let's have a look at it.</p></div><div class='help-footer'><a target='_blank' href='https://www.atlassian.com/git/tutorials/making-a-pull-request' class='aui-button aui-button-link help-link' help-id='learn-pr'>Learn more about pull requests</a><div class='help-progress'>1/4</div></div>";m(t(".pullrequest-list.open tr").eq(1).find(".title.text a"),e,{gravity:"n"},"bb_onboarding_pr","show.pull-request.1")},x=function(){var e=t(".reviewers-group dd.participants");e.html('<div><ol><li><a href="#" class="approved" title="Emma Eager"><span class="aui-avatar aui-avatar-medium"><span class="aui-avatar-inner"><img src="'+l+'"></span></span></a></li></ol></div>'),t(".approvals").text(1),e.addClass("participants-grow").removeClass("participants");var n="<div class='help-body'><h1>Boom! Someone's approved already</h1><p>Bitbucket lets you quickly see who the reviewers are, whos already approved or declined, and to add you own approval.</p></div><div class='help-footer'><a href='#' class='aui-button help-next-pr3'>Looks good, let's merge</a><div class='help-progress'>2/4</div></div>";m(t(".participants-grow .aui-avatar"),n,{gravity:"w"},"bb_onboarding_pr","show.pull-request.2")},_=function(){var e="<div class='help-body'><h1>Time to merge</h1><p>Get your changes merged back to the master branch now that you've got approval.</p></div><div class='help-footer'><div class='help-progress'>3/4</div></div>",n=t("#fulfill-pullrequest");m(n,e,{gravity:"n"},"bb_onboarding_pr","show.pull-request.3"),n.click(function(){var e=setInterval(function(){t("#bb-fulfill-pullrequest-dialog").find(".button-panel-button").is(":visible")&&(clearInterval(e),g(),k())},1e3)})},k=function(){var e="<div class='help-body'><h1>Merge it</h1><p>Review the details before you commit the merge and were ready to hit that button. Dont be shy, this is just what a sandbox is for, click away!</p></div><div class='help-footer'><a target='_blank' href='https://www.atlassian.com/git/tutorials/making-a-pull-request' class='aui-button aui-button-link help-link' help-id='learn-pr'>Learn more about pull requests</a><div class='help-progress'>4/4</div></div>",n=t("#bb-fulfill-pullrequest-dialog").find(".button-panel-button");m(n,e,{gravity:"n"},"bb_onboarding_pr","show.pull-request.4"),n.click(function(){g();var e=setInterval(function(){t(".pull-request-status span.aui-lozenge-success").is(":visible")&&(clearInterval(e),C())},1e3)})},C=function(){var e="<div class='help-body'><h1>Boom! Branch merged</h1><p>Congratulations on merging that pull request! Feel free to create another one and invite a team member to try it out with you.</p></div><div class='help-footer'><a target='_blank' href='https://confluence.atlassian.com/display/BITBUCKET/Grant+users+and+groups+access' class='aui-button aui-button-link help-link' help-id='learn-invite'>Learn more about inviting team members</a></div>";m(t(".pull-request-status span.aui-lozenge-success"),e,{gravity:"n"},"bb_onboarding_pr","show.pull-request.5",d)},S=function(){var e="<div class='help-body'><h1>Looking to collaborate?</h1><p>You can give people access to this repository in the 'Access management' settings.</p></div><div class='help-footer'><a href='#' class='aui-button help-next-2'>OK, got it</a></div>";m(t(".repository-settings a"),e,{gravity:"w"},"bb_onboarding_users","show.users.1")},$=function(){var e="<div class='help-body'><h1>Start collaborating</h1><p>You can invite new users or grant access to existing Bitbucket users. Up to 5 users can collaborate for free on a private repository.</p></div><div class='help-footer'><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>1/4</div></div>",n=t("#repo-admin-nav");m(n.find("ul:first li").eq(1),e,{gravity:"w"},"bb_onboarding_users","show.users.2"),n.click(function(){var e=setInterval(function(){t("input#username").is(":visible")&&(clearInterval(e),g(),T())},1e3)})},T=function(){var e="<div class='help-body'><h1>Add or invite a user</h1><p>Use an email address to invite a new user or grant access to existing Bitbucket users by typing their username or email address.</p></div><div class='help-footer'><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>2/4</div></div>",n=t("input#username");m(n,e,{gravity:"n"},"bb_onboarding_users","show.users.3"),n.blur(function(){t.cookie("bb_onboarding_users")<"6"&&setTimeout(function(){g(),A()},200),t(this).unbind("blur")});var i=setInterval(function(){var e=t("#user-access").find("tbody tr");e.length>2&&(g(),setTimeout(function(){E()},500),clearInterval(i))},500)},A=function(){var e="<div class='help-body'><h1>Set their permission</h1><p>You might not want to give them the keys to the castle yet. As an admin, you can update their level of access at any time.</p></div><div class='help-footer'><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>3/4</div></div>";m(t(".access-level.chosen").first(),e,{gravity:"n"},"bb_onboarding_users","show.users.4")},E=function(){var e,n=t("#user-access").find("tbody tr").last().children().first(),i=n.attr("class");"email"==i?(e="<div class='help-body'><h1>Invitation sent</h1><p>Nice work, you've taken the first step towards collaborating on your Bitbucket repository! If you are going to be working together often, you should think about creating a team.</p></div><div class='help-footer'><a target='_blank' href='/account/create-team/?team_source=grow1279' class='aui-button aui-button-link help-link' help-id='learn-team1'>Create a new team</a><div class='help-progress'>4/4</div></div>",m(n,e,{gravity:"n"},"bb_onboarding_users","show.users.email.5",h)):"user"==i&&(e="<div class='help-body'><h1>You're in good company</h1><p>Nice work, you've taken the first step towards collaborating on your Bitbucket repository! If you are going to be working together often, you should think about creating a team.</p></div><div class='help-footer'><a target='_blank' href='/account/create-team/?team_source=grow1279' class='aui-button aui-button-link help-link' help-id='learn-team2'>Create a new team</a><div class='help-progress'>4/4</div></div>",m(n,e,{gravity:"n"},"bb_onboarding_users","show.users.email.5",h)),v("bb_onboarding_users",6)},j=function(){var e="<div class='help-body'><h1>View and edit files online</h1><p>You can check out the contents of your repository, and even better, edit files and commit changes from the comfort of your web browser.</p></div><div class='help-footer'><a href='#' class='aui-button help-next-2'>OK, got it</a><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>1/4</div></div>";
m(t("#repo-source-link"),e,{gravity:"w"},"bb_onboarding_source","show.source.1")},D=function(){var e="<div class='help-body'><h1>View files</h1><p>You can browse the files in your project and view them in more detail. Let's have a look at the readme file.</p></div><div class='help-footer'><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>2/4</div></div>",n=t("#source-list").find("tr.iterable-item").first().find("td.name.filename a");m(n,e,{gravity:"n"},"bb_onboarding_source","show.source.2"),n.click(function(){var e=setInterval(function(){t(".edit-button.aui-button").is(":visible")&&(clearInterval(e),g(),q())},1e3)})},q=function(){var e="<div class='help-body'><h1>Edit the file</h1><p>Got a quick change to make? You can edit this file without leaving your browser.</p></div><div class='help-footer'><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>3/4</div></div>",n=t(".edit-button.aui-button");m(n,e,{gravity:"n"},"bb_onboarding_source","show.source.3"),n.click(function(){var e=setInterval(function(){t(".save-button.aui-button").is(":visible")&&(clearInterval(e),g(),P())},1e3)})},P=function(){var e="<div class='help-body'><h1>Commit your changes</h1><p>Once you're done, you can commit your changes to this branch.</p></div><div class='help-footer'><a href='#' class='aui-button aui-button-link help-skip'>Skip tour</a><div class='help-progress'>4/4</div></div>";m(t(".save-button.aui-button"),e,{gravity:"s"},"bb_onboarding_source","show.source.4")},I=function(){var e="<div class='help-body'><h1>Change committed!</h1><p>Well done, you've just made a quick change on the fly without needing to pull, commit and push!</p></div><div class='help-footer'><a href='#' class='aui-button help-next-2'>Awesome, thanks</a></div>";m(t(".commit-description span.author"),e,{gravity:"n",offsetY:60},"bb_onboarding_source","show.source.5",d)},R={bb_onboarding_pr:{1:w,2:x,3:_,4:k,5:C},bb_onboarding_users:{1:S,2:$,3:T,4:A,5:E},bb_onboarding_source:{1:j,2:D,3:q,4:P,5:I},bb_onboarding:{1:y,2:b}},M=function(){return parseInt(t.cookie("bb_onboarding"))},N=function(){return parseInt(t.cookie("bb_onboarding_pr"))||1},O=function(){return parseInt(t.cookie("bb_onboarding_source"))||1},L=function(){return parseInt(t.cookie("bb_onboarding_users"))||1},H=M(),F=N(),B=L(),U=O(),z='<span class="aui-nav-item-label" id="onboarding-help-spot"></span>';if(3>F&&3>H){var J=t("#repo-pullrequests-link");J.append(t(z)),J.addClass("help-dot"),J.hide().show(0)}if(3>B){var W=t(".repository-settings a");W.append(t(z)),W.addClass("help-dot"),W.hide().show(0)}if(3>U){var V=t("#repo-source-link");V.append(t(z)),V.addClass("help-dot"),V.hide().show(0)}H>2&&F in R.bb_onboarding_pr&&R.bb_onboarding_pr[F](),B>1&&B in R.bb_onboarding_users&&R.bb_onboarding_users[B](),U>1&&U in R.bb_onboarding_source&&R.bb_onboarding_source[U](),H in R.bb_onboarding&&R.bb_onboarding[H]();var G=t("body");G.on("click",".help-next-1",function(){g(),s&&setTimeout(b,200)}),G.on("click",".help-next-2",function(){g()}),G.on("click",".help-skip",function(){p("skipped"),g(),K(9)}),G.on("click",".help-link",function(){p("click.link."+t(this).attr("help-id"))}),G.on("click",".help-next-pr3",function(){g(),setTimeout(_,500)}),t("span#onboarding-help-spot").parent().hover(function(){null===o&&("repo-pullrequests-link"===t(this).attr("id")?M()<3&&b():"repo-source-link"===t(this).attr("id")?1===O()&&j():1===L()&&S())}),window.resetOnboarding=function(){K(1)};var K=function(e){["bb_onboarding","bb_onboarding_pr","bb_onboarding_source","bb_onboarding_users"].forEach(function(t){v(t,e)})}}})}),define("components/repo-sidebar",["aui","jquery","on-ready","data/client","data/current-user","utils/event-tracking-helper","utils/preferences","experiment/grow1279-guide"],function(e,t,n,i,r,o,s){return e.I18n.keys=e.I18n.keys||{},e.I18n.keys["aui.sidebar.expand.tooltip"]=gettext("Expand sidebar ( [ )"),e.I18n.keys["aui.sidebar.collapse.tooltip"]=gettext("Collapse sidebar ( [ )"),n(function(){function n(){return a.isCollapsed()?"Collapsed":"Expanded"}var a=e.sidebar(".aui-sidebar"),l=t(document),u=o("Repo Sidebar");t("#repo-avatar-link").on("click",function(){u("Repo Avatar - Clicked",n())}),t("#repo-owner-link").on("click",function(){u("Repo Owner - Clicked",n())}),l.on("click","#repo-clone-button",function(){u("Clone Dialog",n())}),l.on("click","#repo-fork-link",function(){u("Fork",n())}),l.on("click","#repo-compare-link",function(){u("Compare",n())}),l.on("click","#repo-create-pull-request-link",function(){u("Create Pull Request",n())}),l.on("click","#repo-create-branch-link",function(){u("Create Branch",n())}),l.on("click","#repo-clone-dialog .clone-in-sourcetree button",function(){u("Clone in Sourcetree",i.os)}),t("#repo-overview-link").on("click",function(){u("Overview",n())}),t("#repo-source-link").on("click",function(){u("Source",n())}),t("#repo-commits-link").on("click",function(){u("Commits",n())}),t("#repo-branches-link").on("click",function(){u("Branches",n())}),t("#repo-pullrequests-link").on("click",function(){u("Pull Requests",n())}),t("#repo-patch-series-link").on("click",function(){u("Patch Queue",n())}),t("#repo-issues-link").on("click",function(){u("Issues",n())}),t("#repo-wiki-link").on("click",function(){u("Wiki",n())}),t("#repo-downloads-link").on("click",function(){u("Downloads",n())}),t("#repo-settings-link").on("click",function(){u("Settings",n())}),r.isAuthenticated&&("false"!==a.$el.attr("data-aui-responsive")&&a.isViewportNarrow()&&s.set("sidebar-collapsed",a.isCollapsed()),a.on("expand-end collapse-end",function(){s.set("sidebar-collapsed",a.isCollapsed()),u("Sidebar Toggled",n())}))})}),define("data/has-sidebar",["jquery"],function(e){return e(document.body).hasClass("aui-page-sidebar")}),define("components/repo-watch/model",["jquery","backbone"],function(e,t){var n=t.Model.extend({initialize:function(e,t){this.url=t.url,this.repository=t.repository}}),i=t.Model.extend({initialize:function(e,t){this.watchUrl=t.watchUrl,this.unwatchUrl=t.unwatchUrl},loadUnwatch:function(){return e.get(this.unwatchUrl).done(function(e){this.trigger("load:unwatch",e)}.bind(this))},unwatchKind:function(t){return e.ajax({url:this.unwatchUrl+"/"+t,type:"DELETE",data:{kind:[t]},dataType:"json"})},watch:function(){this.set("watching",!0),e.post(this.watchUrl)},toggle:function(){this.set("watching",!this.get("watching"))}});return{RepoPreferences:n,RepoWatchState:i}}),define("components/repo-watch/view",["aui","jquery","backbone","underscore","data/has-sidebar","components/repo-watch/model","js/components/aui-dialog","utils/dialog-positions","utils/gaq-push","utils/mustache"],function(e,t,n,i,r,o,s,a,l,u){var c=n.View.extend({events:{'click input[type="checkbox"]':"togglePreference","follow:repo a.follow":"toggleWatching"},initialize:function(n){i.bindAll(this,"togglePreference","toggleWatching","toggleDialog","watchingChanged","onHideWatchDialog"),this.watchState=n.watchState,this.listenTo(this.watchState,"change:watching",function(){setTimeout(this.watchingChanged,0)}.bind(this)),this.watchId="watch-info-"+this.model.repository.replace(/\//,"-");var r={width:450,cacheContent:!1,calculatePositions:a.alignRight()};this.watchDialog=e.InlineDialog(n.target,this.watchId,this.toggleDialog,r),this.dialogLoaded=!1,this.dataLoaded=!1,this.model.once("sync",function(){this.dataLoaded=!0}.bind(this)),this.model.once("error",function(){this.dataLoaded=!0,this.showError=!0}.bind(this)),this.unsubscribed={},t(document).bind("hideLayer",this.onHideWatchDialog)},renderDialog:function(e,t){this.setElement(e),this.showError?this.renderError():this.render(),this.dialogLoaded=!0,t()},toggleDialog:function(t,n,i){if(e.InlineDialog.current){if(e.InlineDialog.current.id===this.watchId)return setTimeout(this.watchDialog.hide,0);e.InlineDialog.current.hide()}if(this.dialogLoaded)return void i();if(this.dataLoaded)this.renderDialog(t,i);else{var r=setTimeout(function(){this.trigger("loading")}.bind(this),300),o=function(){this.renderDialog(t,i),this.trigger("loaded"),clearTimeout(r)}.bind(this);this.model.once("sync",o),this.model.once("error",function(){this.showError=!0,o()}.bind(this))}},onHideWatchDialog:function(e,t,n){"inlineDialog"==t&&n==this.watchDialog[0].popup&&((this.unsubscribed.issues||this.unsubscribed.pullrequests)&&this.model.trigger("unsubscribe"),this.unsubscribed={})},render:function(){var e=i.extend({showRepo:this.model.get("has_repo"),showWiki:this.model.get("has_wiki"),showIssues:this.model.get("has_issues")},this.watchState.attributes);return this.watchState.get("watching")&&i.extend(e,this.model.attributes),this.$el.html(u.toHtml("watch-preferences-template",e)),this.$('input[type="checkbox"]').attr("disabled",!this.watchState.get("watching")),this.$("h4.subscribe-title").toggleClass("disabled",!this.watchState.get("watching")),this.$("a.follow").attr("href",this.watchState.watchUrl),this},renderError:function(){this.$el.html(u.toHtml("preference-error-template"))},togglePreference:function(e){var n=t(e.target),i=n.attr("name"),r=n.is(":checked");n.addClass("loading"),this.model.set(i,r),this.model.save(),this.unsubscribed[i]=!r,setTimeout(function(){n.removeClass("loading")},300),l(["atl._trackEvent","Repo Preferences",i,r?"Enabled":"Disabled"])},hideDialog:function(){this.watchDialog.hide()},watchingChanged:function(){this.render()},toggleWatching:function(){this.watchState.toggle()}}),d=n.View.extend({events:{"click a.unwatch":"unwatchObjects"},initialize:function(e){i.bindAll(this,"unwatchObjects","watchingChanged","createDialogContent","unsubscribed"),this.unwatchId="unwatch-info-"+this.model.repository.replace(/\//,"-"),this.unwatchDialog=new s({width:500,height:"auto",id:this.unwatchId,closeOnOutsideClick:!1}),this.setElement("#"+this.unwatchId,!0),this.unwatchDialog.addHeader(gettext("You're still watching a few things")),this.unwatchDialog.addPanel("panel-watching"),this.unwatchDialog.addLink(gettext("Manage all notifications"),function(){return!0},"link-manage-all"),this.unwatchDialog.addButton(gettext("Okay"),function(){this.unwatchDialog.hide()}.bind(this),"confirm-stop-watch"),this.watchState=e.watchState,this.dataLoaded=!1,this.watchState.on("change:watching",this.watchingChanged),this.watchState.on("load:unwatch",this.createDialogContent),this.model.on("unsubscribe",this.unsubscribed)},createDialogContent:function(e){var n=i.extend({},e,this.watchState.attributes),r=t(u.toHtml("stop-watching-template",n));r.appendTo(this.unwatchDialog.getCurrentPanel().body),this.$(".link-manage-all").attr("href",r.data("manageAllUrl")),this.dataLoaded=!0},showUnwatchDialog:function(){if(!this.dataLoaded||0!==this.$(".watching li:not(.hidden)").length)if(this.dataLoaded)this.trigger("show:unwatch"),this.unwatchDialog.show();else{var e=setTimeout(function(){this.trigger("loading")}.bind(this),300);this.watchState.once("load:unwatch",function(){this.trigger("loaded"),clearTimeout(e),this.trigger("show:unwatch"),this.unwatchDialog.show()}.bind(this))}},unsubscribed:function(){(!this.model.get("pullrequests")||this.model.get("has_issues")&&!this.model.get("issues"))&&this.showUnwatchDialog()},watchingChanged:function(){this.watchState.get("watching")||this.showUnwatchDialog()},unwatchObjects:function(e){function n(){clearTimeout(i),r.removeClass("loading"),r.prop("disabled",!1),r.closest("li").addClass("hidden");var e=t("."+o+"-list .follow");e.length&&e.each(function(){t(this).trigger("toggle-follow",{isNowFollowing:!1})})}e.preventDefault();var i,r=t(e.target),o=r.data("kind");r.prop("disabled")||(r.prop("disabled",!0),i=setTimeout(function(){r.addClass("loading")},300),this.watchState.unwatchKind(o).done(n))}}),h=n.View.extend({events:{mouseover:"loadData","follow:repo a.follow":"toggleWatching"},initialize:function(e){i.bindAll(this,"render","loadData","toggleWatching"),this.preferencesLoaded=!1,this.$follow=this.$("a.follow"),this.model=new o.RepoPreferences({},{url:this.$follow.data("prefsUrl"),repository:e.repository}),this.watchState=new o.RepoWatchState({watching:this.$follow.hasClass("following"),urlPullrequests:this.$follow.data("urlPullrequests"),urlIssues:this.$follow.data("urlIssues")},{watchUrl:this.$follow.attr("href"),unwatchUrl:this.$follow.data("unwatchUrl")}),this.watchState.on("change:watching",this.render)},render:function(){var e=this.watchState.get("watching"),t=gettext(e?"Stop watching this repository":"Watch this repository");return this.$follow.toggleClass("following",e).attr("title",t),this},loadData:function(){this.preferencesLoaded||(this.watchView=new c({model:this.model,watchState:this.watchState,target:this.$("a.repo-watch")}),this.unwatchView=new d({model:this.model,watchState:this.watchState}),this.unwatchView.on("show:unwatch",function(){this.watchView.hideDialog()}.bind(this)),this.model.fetch(),this.watchView.once("loading",function(){this.$follow.addClass("loading")}.bind(this)),this.watchView.once("loaded",function(){this.$follow.removeClass("loading")}.bind(this)),this.watchState.loadUnwatch(),this.unwatchView.once("loading",function(){this.$follow.addClass("loading")}.bind(this)),this.unwatchView.once("loaded",function(){this.$follow.removeClass("loading")}.bind(this)),this.preferencesLoaded=!0)},toggleWatching:function(){this.watchState.toggle()}});return{Widget:h,UnwatchView:d,PreferencesView:c}}),define("components/repo-watch/setup",["jquery","on-ready","components/repo-watch/view"],function(e,t,n){return t(function(e){var t=e.find("a.follow");new n.Widget({el:e,repository:t.attr("data-repository")})})}),define("components/typeahead/emoji/model",["underscore","components/typeahead/typeahead-model"],function(e,t){return t.extend({replacementText:function(){return this.get("name")},highlightAttrs:function(){return["name"]},sortKeys:function(e){var t=this.get("name").toLowerCase(),n=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),i=new RegExp("(\\b|_)"+n),r=new RegExp(n+"(\\b|_)");return[e.toLowerCase()!==t,!(i.test(t)&&r.test(t)),!(i.test(t)||r.test(t)),t.indexOf(e),t]},highlightSubstring:function(t,n){if(n=n.toLowerCase(),!n.length)return e.escape(t);var i=t.indexOf(n);return[e.escape(t.slice(0,i)),"<em>",e.escape(t.slice(i,i+n.length)),"</em>",e.escape(t.slice(i+n.length))].join("")},matches:function(e){return e?-1!==this.get("name").indexOf(e):!0}})}),define("components/typeahead/emoji/completion",["components/typeahead/prefix-typeahead-completion"],function(e){return e.extend({prefix:":",replaceText:function(t,n){var i=t.selectionStart===t.value.length?": ":":";e.prototype.replaceText.call(this,t,":"+n+i)}})}),define("components/typeahead/emoji/data-set",["aui","underscore","progressive-data-set"],function(e,t){return e.ProgressiveDataSet.extend({initialize:function(t,n){e.ProgressiveDataSet.prototype.initialize.apply(this,arguments),this.imageType=n.imageType||"svg"},addQueryCache:function(t,n){e.ProgressiveDataSet.prototype.addQueryCache.apply(this,arguments),this.cachedResults=n},hasQueryCache:function(){return!!this.cachedResults},findQueryCache:function(){return this.cachedResults},getQueryData:function(){return{}},shouldGetMoreResults:function(){return!this.cachedResults},getFilteredResults:function(e){var n=this.filter(function(t){return this.matcher(t,e)},this);return n=t.sortBy(n,function(t){return t.sortKeys(e)}),n=t.first(n,this._maxResults)},parse:function(e){var t,n=[],i=0;for(var r in e)t=e[r],n.push({id:i++,name:r,src:t[this.imageType]});return n}})}),define("components/typeahead/emoji/index",["on-ready","components/typeahead/emoji/model","components/typeahead/emoji/completion","components/typeahead/emoji/data-set","components/typeahead/typeahead-suggestions"],function(e,t,n,i,r){return e(function(){var e=new i([],{model:t,matcher:t.matcher,queryEndpoint:"/emoji/all.json"});new n({el:document.body,source:e,results:new r({suggestionTemplate:"emoji-result",transformModelId:function(e){return parseInt(e,10)}})}).render()})}),define("dashboard/ad-feature",["jquery","on-ready","js/global/events","utils/on-load"],function(e,t,n,i){var r=function(){var t=this;e.ajax(t.attr("data-ad-feature-url")).done(function(e){t.html(e),n.vent.trigger("change:content",t),t.removeClass("hidden-module")})};return t(function(e){i(r.bind(e))})}),define("dashboard/overview",["on-ready","jquery","components/filter/search","components/filter/status","components/paginate","utils/event-tracking-helper","jquery-plugins/jquery.pjax"],function(e,t,n,i,r,o){return e(function(e){var s=t("#repositories-container"),a=t("#repositories-pjax"),l=o("Dashboard");n({$pjaxContainer:a,$controls:t("#repo-filter"),ignoreQuery:"page"}),i({$container:s,$pjaxContainer:a,ignoreQuery:"page"}),r(s,{$pjaxContainer:a,setMask:!1}),e.on("click",".newsfeed a",function(){l("Newsfeed - Link Clicked")}).on("click",".activity .rss",function(){l("Newsfeed - Subscribe Link Clicked")})})}),define("dashboard/issues",["on-ready","jquery","components/filter/status","components/paginate","jquery-plugins/jquery.pjax"],function(e,t,n,i){return e(function(){var e=t("#issues"),r=t("#dashboard-container");n({$container:e,$pjaxContainer:r,ignoreQuery:"page"}),i(e,{$pjaxContainer:r,setMask:!1})})}),define("components/filter/select",["aui","jquery","utils/query-params","jquery-plugins/jquery.pjax"],function(e,t,n){return function(e){var i=e.$select,r=i.attr("data-url"),o=e.selectOptions||{},s=e.$pjaxContainer,a=t.extend({},e.pjaxOptions,{scrollTo:null,timeout:3e4});s.on("pjax:start",function(){s.find(".maskable").addClass("has-mask")}),s.on("pjax:end",function(){s.find(".maskable").removeClass("has-mask")}),n.ignore(e.ignoreQuery),i.auiSelect2(t.extend({dropdownAutoWidth:!0},o)),i.on("change",function(i){t.pjax(t.extend({},a,{container:s,url:n.update(e.filterTerm,i.val).asUrl(r)}))})}}),define("dashboard/pullrequests",["on-ready","jquery","components/filter/select","components/filter/status","components/paginate","jquery-plugins/jquery.pjax"],function(e,t,n,i,r){return e(function(){var e=t("#pullrequests"),o=t("#dashboard-container"),s=t("#team-select");i({$container:e,$pjaxContainer:o,ignoreQuery:"page"}),n({$pjaxContainer:o,$select:s,filterTerm:s.attr("data-filter-term"),selectOptions:{dropdownAutoWidth:!1},ignoreQuery:"page"}),r(e,{$pjaxContainer:o,setMask:!1})})}),define("dashboard/index",["jquery","on-ready","utils/gaq-push","dashboard/overview","dashboard/issues","dashboard/pullrequests","jquery-plugins/jquery.cookie","jquery-plugins/jquery.pjax"],function(e,t,n){return t(function(t){var i=e("#dashboard-tabs"),r=i.find("ul.aui-nav > li");t.on("click","ul.filter-status a",function(t){var r=i.find("li.aui-nav-selected"),o=/(\w+)-tab/.exec(r.attr("id")),s=o?o[1]:"",a=e(t.target).text();n(["atl._trackEvent","Dashboard","Filter - "+a,s])}),t.on("click","ol.paginator a",function(n){n.preventDefault(),e("body, html").animate({scrollTop:0},400),e.pjax(e.extend({url:e(this).attr("href"),push:!0},{container:t,scrollTo:null,timeout:3e4}))}),t.on("pjax:end",function(n){if(this===n.target){var i=t.find(".dashboard-section:first").attr("id"),o=t.find('ul.filter-status > li[aria-pressed="true"]').attr("id");i.indexOf("dashboard-")>-1&&(i=i.substr("dashboard-".length,i.length)),r.removeClass("aui-nav-selected"),e("#"+i+"-tab").addClass("aui-nav-selected"),e.cookie("dashboard-tab",i?i:""),e.cookie("dashboard-filter",o?o:"")}}).on("pjax:error",function(e,n,i){return n.readyState>0&&"abort"!==i?(t.html("<h2>Error</h2><p>We were unable to load this page.</p>"),!1):void 0}).on("pjax:send",function(e){this===e.target&&t.addClass("has-mask")}).on("pjax:complete",function(e){this===e.target&&t.removeClass("has-mask")}),e.support.pjax&&r.on("click","a",function(i){i.preventDefault();var o=e(i.target).closest("li"),s=/(\w+)-tab/.exec(o.attr("id")),a=s?s[1]:"";n(["atl._trackEvent","Dashboard","Tab - "+a]),e.pjax(e.extend({url:e(this).attr("href"),push:!0},{container:t,scrollTo:null,timeout:3e4})),r.removeClass("aui-nav-selected"),o.addClass("aui-nav-selected")}),t.on("click","#import-all-github-repos",function(t){t.preventDefault();var n=e(t.target);n.attr("aria-disabled","true").attr("disabled","disabled").addClass("loading"),e.post(n.attr("data-api-url"),{type:"github"},function(){window.location=n.attr("href")})}),n(["atl._trackPageview","/profile/frontpage/"])})}),define("header/help-menu",["aui","jquery","on-ready","utils/keyboard-shortcuts-dialog"],function(e,t,n,i){return n(function(){var e=t("#keyboard-shortcuts-link"),n=t("#super-touch-point-dialog")[0];e.on("click",function(e){e.preventDefault(),n.isVisible()&&n.hide(),i()}),skate.init(t("#ace-stp-menu-link").get(0)),skate.init(t("#super-touch-point-dialog").get(0))})}),define("inbox/compose",["jquery","on-ready"],function(e,t){return t(function(){var t=e("#notification-compose-form");t.on("click","#notification-compose-form a.cancel",function(){window.history.back()}),t.find("#id_recipient").addClass("bb-user-team-typeahead")})}),define("inbox/messages",["aui","jquery","on-ready","utils/check-task","utils/message-helper","utils/mustache"],function(e,t,n,i,r,o){return n(function(){function n(){h.length&&(p.empty(),d.prop("checked")&&e.messages.info(p,{body:o.toHtml("select-all-message-template",{page_count:c.length,count:f}),closeable:!1,fadeout:!0}))}function s(){t("#aui-message-bar").empty(),m.prop("disabled",!1),e.messages.error({body:"An error occurred while updating"})}var a=t("#notification-body"),l=t("#notification-form"),u=l.find("header"),c=a.find("input[type=checkbox]"),d=u.find("#select-page"),h=u.find("#select-all"),p=t("#notification-message-bar"),f=u.attr("data-total-messages"),m=u.find("button");p.on("click",".select-all-link",function(e){e.preventDefault(),h.prop("checked",!0),c.prop("disabled",!0),p.find(".undo-select-all").removeClass("hidden"),p.find(".select-all").addClass("hidden")}),p.on("click",".undo-select-all-link",function(e){e.preventDefault(),h.prop("checked",!1),c.prop("disabled",!1),p.find(".select-all").removeClass("hidden"),p.find(".undo-select-all").addClass("hidden")}),u.find("#select-page").prop("checked")&&n(),d.on("change",function(){var e=d.prop("checked");c.prop("checked",e).change(),e?n():(p.empty(),h.prop("checked",!1),c.prop("disabled",!1))}),a.on("change","input[type=checkbox]",function(){var e=t(this),n=e.parent().parent();e.prop("checked")?n.addClass("selected"):(n.removeClass("selected"),d.prop("checked",!1),h.prop("checked",!1),p.empty()),m.prop("disabled",0===a.find(":checked").length)}),l.find(":submit").click(function(n){n.preventDefault();var o=l.serialize();o+="&action={}".format(t(this).val()),m.prop("disabled",!0),t.ajax({type:"POST",url:l.attr("action"),data:o,dataType:"json",error:function(){s()},success:function(n){n.errors?s():n.result?window.location=n.result:setTimeout(function(){i(n.url).done(function(e,t){r.addMessage("{} messages updated.".format(t.count),"success")}).progress(function(n){n.count!=n.total&&(t("#aui-message-bar").empty(),e.messages.info({body:"{} of {} messages updated.".format(n.count,n.total),fadeout:!0}))}).fail(s)},1e3)}})})})}),define("js/components/omnibar/extensions",["underscore"],function(e){var t=[];return{register:function(e,n){n=n||{},t.push(new e(n))},unregister:function(n){t=e.reject(t,function(e){return e instanceof n})},get:function(n){return e.find(t,function(e){return e instanceof n})},getAll:function(){return t}}}),define("js/components/omnibar/models/result",["backbone"],function(e){return e.Model.extend({})}),define("js/components/omnibar/collections/results",["backbone","js/components/omnibar/models/result"],function(e,t){return e.Collection.extend({model:t,comparator:"weight"})}),define("js/components/omnibar/models/result-group",["backbone"],function(e){return e.Model.extend({hasResult:function(e){return!!this.get("results").get(e)},findFirstResult:function(){return this.get("results").first()},findLastResult:function(){return this.get("results").last()},findNextResult:function(e){var t=this.get("results");return t.at(t.indexOf(e)+1)},findPreviousResult:function(e){var t=this.get("results");return t.at(t.indexOf(e)-1)}})}),define("js/components/omnibar/collections/result-groups",["backbone","jquery","underscore","js/components/omnibar/extensions","js/components/omnibar/collections/results","js/components/omnibar/models/result-group"],function(e,t,n,i,r,o){return e.Collection.extend({model:o,comparator:"weight",initialize:function(){this.promises=[]},update:function(e){n.invoke(this.promises,"reject"),this.promises=[],this.reset(),this.trigger("before:update"),n.each(i.getAll(),function(t){var n=t.query(e);n.done(function(e){e&&e.get("results").length&&this.add(e)}.bind(this)),this.promises.push(n)}.bind(this)),t.when.apply(this,this.promises).always(function(){this.trigger("update")}.bind(this))},findNextResultGroup:function(e){return this.at(this.indexOf(e)+1)},findPreviousResultGroup:function(e){return this.at(this.indexOf(e)-1)},findResultGroup:function(e){return this.find(function(t){return t.hasResult(e)})},findNextResult:function(e){var t=this.findResultGroup(e),n=t.findNextResult(e);if(n)return n;var i=this.findNextResultGroup(t);return i?i.findFirstResult():this.first().findFirstResult()},findPreviousResult:function(e){var t=this.findResultGroup(e),n=t.findPreviousResult(e);if(n)return n;var i=this.findPreviousResultGroup(t);return i?i.findLastResult():this.last().findLastResult()}})}),define("utils/highlight-string",["underscore"],function(e){return function(t,n){if(!n.length)return t;var i=e.escape(t.substring(0,n[0][0]));return e.each(n,function(r,o){i+="<strong>"+e.escape(t.substring(r[0],r[1]))+"</strong>",n[o+1]&&(i+=e.escape(t.substring(r[1],n[o+1][0])))}),i+=e.escape(t.substring(n[n.length-1][1],t.length))}}),function(e){define("liquidmetal",[],function(){return function(){var t=function(){function e(e,t){var n=e.charAt(t);return n>="A"&&"Z">=n}function t(e,t){var n=e.charAt(t-1);return-1!=l.indexOf(n)}function n(e,t,n,i){for(var r=n;i>r;r++)e[r]=t;return e}var i=0,r=1,o=.8,s=.9,a=.85,l=" 	_-";return{lastScore:null,lastScoreArray:null,score:function(e,t){if(0===t.length)return o;if(t.length>e.length)return i;var n=[],r=e.toLowerCase();if(t=t.toLowerCase(),this._scoreAll(e,r,t,-1,0,[],n),0==n.length)return 0;for(var s=0,a=[],l=0;l<n.length;l++){for(var u=n[l],c=0,d=0;d<e.length;d++)c+=u[d];c>s&&(s=c,a=u)}return s/=e.length,this.lastScore=s,this.lastScoreArray=a,s},_scoreAll:function(l,u,c,d,h,p,f){if(h==c.length){var m=u.charAt(0)==c.charAt(0),g=m?s:o;return n(p,g,p.length,l.length),void f.push(p.slice(0))}var v=c.charAt(h);h++;var y=u.indexOf(v,d);if(-1!=y)for(var b=d;-1!=(y=u.indexOf(v,d+1));)t(l,y)?(p[y-1]=1,n(p,a,b+1,y-1)):e(l,y)?n(p,a,b+1,y):n(p,i,b+1,y),p[y]=r,d=y,this._scoreAll(l,u,c,d,h,p,f)}}}();return e.LiquidMetal=t}.apply(e,arguments)})}(this),define("utils/score-string",["liquidmetal","underscore"],function(e,t){function n(e,n){n=n||[];var i=[];return t.each(n,function(e,t){1===e&&i.push(t)}),i}function i(e){for(var t=e[0],n=[],i=0;i<e.length;i++)e[i+1]-e[i]!==1&&(n.push([t,e[i]+1]),t=e[i+1]);return n}return function(r,o){r=r||"",o=o||"";var s=t.clone(e),a=s.score(r.toLowerCase(),o.toLowerCase()),l=n(r,s.lastScoreArray);return{score:a,matchGroups:i(l)}}}),define("js/components/omnibar/base-extension",["jquery","marionette","underscore","js/components/omnibar/collections/results","js/components/omnibar/models/result-group","utils/highlight-string","utils/score-string"],function(e,t,n,i,r,o,s){return t.Controller.extend({maxResults:5,minQueryLength:1,initialize:function(e){this.options=e,this.weight=e.weight||0},transformData:function(e,t){return n.map(e,function(e){var n=s(e.label,t);return e.weight=n.score,e.label=o(e.label,n.matchGroups),e}).filter(function(e){return e.weight&&e.$el.length})},onExecute:function(e){e.$el[0].click()},_fetchData:function(t){var i=new e.Deferred;return i.resolve(this.transformData(n.result(this,"data"),t)),i.promise()},_getResults:function(e){return this.maxResults&&(e=e.slice(0,this.maxResults)),n.each(e,function(e){e.onExecute=this.onExecute,e.weight=-e.weight||0}.bind(this)),new r({label:n.result(this,"label"),context:n.result(this,"context"),weight:-this.weight,results:new i(e)})},onBeforeQuery:function(){return!0},query:function(t){var n=new e.Deferred;return t.length<this.minQueryLength||!this.onBeforeQuery(t)?n.resolve(null):this._fetchData(t).done(function(e){n.resolve(this._getResults(e))}.bind(this)).fail(n.reject),n}})}),define("js/components/omnibar/extensions/global-actions",["jquery","js/components/omnibar/base-extension"],function(e,t){return t.extend({label:gettext("Actions"),minQueryLength:0,maxResults:!1,data:function(){return[{label:gettext("Create repository"),$el:e("#repo-create-cta")},{label:gettext("Import repository"),$el:e("#import-repo-link")},{label:gettext("Create snippet"),$el:e("#snippet-create-cta")}]}})}),define("js/components/omnibar/async-extension",["jquery","underscore","js/components/omnibar/base-extension"],function(e,t,n){return n.extend({initialize:function(){n.prototype.initialize.apply(this,arguments),this.asyncDeferredCache={}},getUrl:function(e){return t.isFunction(this.url)?this.url(e):this.url},getAsyncDeferred:function(t){return e.ajax(this.getUrl(t))},getCacheKey:function(e){return this.getUrl(e)},getCachedAsyncDeferred:function(e){var n=this.getCacheKey(e),i=t.has(this.asyncDeferredCache,n);if(!i){var r=this.getAsyncDeferred(e);return this.asyncDeferredCache[n]=r,r}return this.asyncDeferredCache[n]},_fetchData:function(t){var n=new e.Deferred;return this.fetchData(n,t),n.promise()},fetchData:function(e,t){this.getCachedAsyncDeferred(t).done(function(n){e.resolve(this.transformData(n,t))}.bind(this)).fail(e.reject)},onExecute:function(e){window.location=e.url}})}),define("js/components/omnibar/extensions/user-issues",["underscore","js/components/omnibar/async-extension","utils/highlight-string","utils/score-string"],function(e,t,n,i){return t.extend({label:gettext("Your issues"),url:"/!api/internal/my/issues",transformData:function(t,r){return e.map(t,function(e){var t=i(e.title,r);return e.weight=t.score,e.label="#{}: {}".format(e.localId,n(e.title,t.matchGroups)),e.context=e.repo,e}).filter(function(e){return!!e.weight})}})}),define("js/components/omnibar/extensions/user-pull-requests",["underscore","js/components/omnibar/async-extension","utils/highlight-string","utils/score-string"],function(e,t,n,i){return t.extend({label:gettext("Your pull requests"),url:"/!api/internal/my/pull-requests",transformData:function(t,r){return e.map(t,function(e){var t=i(e.title,r);return e.weight=t.score,e.label="#{}: {}".format(e.localId,n(e.title,t.matchGroups)),e.context=e.repo,e}).filter(function(e){return!!e.weight})}})}),define("js/components/omnibar/extensions/user-repositories",["underscore","js/components/omnibar/async-extension","utils/repo-filter"],function(e,t,n){return t.extend({label:gettext("Your repositories"),url:"/!api/internal/my/repositories",transformData:function(t,i){return t=n.filterList(t,i),e.each(t,function(e){e.label=e.fullSlug}),t}})}),define("js/components/omnibar/views/dialog",["marionette","underscore","js/global/events"],function(e,t,n){return e.ItemView.extend({animationSpeed:100,template:!1,events:{mousedown:"mousedownHandler"},initialize:function(){n.commands.setHandler("omnibar:close",function(){this.close()}.bind(this)),$(document).on("mousedown.omnibar",function(e){this.$(e.target).length||e.target===this.el||this.close()}.bind(this))},onDestroy:function(){$(document).off(".omnibar")},open:function(){return this.trigger("before:open"),this.$el.slideDown(this.animationSpeed,function(){this.trigger("open")}.bind(this)),this},close:function(){return this.trigger("before:close"),this.$el.slideUp(this.animationSpeed,function(){this.trigger("close")}.bind(this)),this},mousedownHandler:function(e){this.$(e.target).not(":text")&&e.preventDefault()}})}),define("js/components/omnibar/views/blank-slate",["marionette"],function(e){return e.ItemView.extend({template:"#omnibar-blank-slate-template"})
}),define("js/components/omnibar/views/result-list-item",["marionette","underscore","js/global/events"],function(e,t,n){return e.ItemView.extend({template:"#omnibar-result-list-item-template",tagName:"li",className:"omnibar-result-list-item",attributes:function(){return{title:this.model.get("title")||this.model.get("label")}},events:{mouseover:"mouseoverHandler",click:"clickHandler"},initialize:function(){this.listenTo(n.vent,"omnibar:before:adjustListScrollTop",this.undelegateEvents),this.listenTo(n.vent,"omnibar:adjustListScrollTop",function(){t.delay(this.delegateEvents.bind(this),100)})},toggleActive:function(e){return this.$el.toggleClass("active",e),this},execute:function(){return this.model.get("onExecute")(this.model.toJSON()),n.commands.execute("omnibar:close"),this},getTop:function(){return this.$el.position().top},getHeight:function(){return this.$el.height()},mouseoverHandler:function(){n.commands.execute("omnibar:set:activeResult",this)},clickHandler:function(){this.execute()}})}),define("js/components/omnibar/views/result-group-list-item",["marionette","js/components/omnibar/views/result-list-item"],function(e,t){return e.CompositeView.extend({template:"#omnibar-result-group-list-item-template",tagName:"li",className:"omnibar-result-group-list-item",childViewContainer:".omnibar-result-list",childView:t,initialize:function(){this.collection=this.model.get("results")}})}),define("js/components/omnibar/views/form",["aui","marionette","underscore","js/components/omnibar/views/blank-slate","js/components/omnibar/views/result-group-list-item","js/global/events"],function(e,t,n,i,r,o){var s=250;return t.CompositeView.extend({template:"#omnibar-form-template",childViewContainer:".omnibar-result-group-list",childView:r,emptyView:i,ui:{input:".omnibar-input",resultGroupList:".omnibar-result-group-list"},events:{"input @ui.input":"inputHandler","keydown @ui.input":"keydownHandler",submit:"submitHandler"},initialize:function(){this.listenTo(this.collection,"before:update",this.beforeUpdateHandler),this.listenTo(this.collection,"update",this.updateHandler),this.on("query",this.collection.update.bind(this.collection)),o.commands.setHandler("omnibar:set:activeResult",this.setActiveResult.bind(this)),$(document).on("pjax:end.omnibar",function(){this.$el.is(":visible")&&this.focus()}.bind(this)),this.lastQuery=null},isEmpty:function(){return this.ui.input.val()&&t.CompositeView.prototype.isEmpty.call(this)},onDestroy:function(){$(document).off(".omnibar")},onAddChild:function(){this.hasNavigated?this.adjustListScrollTop():n.defer(this.selectFirstResult.bind(this))},focus:function(){return this.ui.input[0].setSelectionRange(0,this.ui.input.val().length),this.ui.input.trigger("focus"),this},getListScrollTop:function(){return this.ui.resultGroupList.scrollTop()},getListHeight:function(){return this.ui.resultGroupList.height()},setActiveResult:function(e){return this.activeResult&&this.activeResult.toggleActive(!1),e.toggleActive(!0),this.activeResult=e,this},getFirstResult:function(){return this.findResultView(this.collection.first().findFirstResult())},getLastResult:function(){return this.findResultView(this.collection.last().findLastResult())},selectFirstResult:function(){return this.collection.length&&this.setActiveResult(this.getFirstResult()),this},findResultView:function(e){var t;return this.children.find(function(n){var i=n.children.findByModel(e);return i&&(t=i),i}),t},_adjustListScrollTop:function(e){var t,n,i,r,o;this.activeResult===this.getFirstResult()?this.ui.resultGroupList.scrollTop(0):this.activeResult===this.getLastResult()?(o=this.activeResult.getTop()+this.activeResult.getHeight()+this.getListScrollTop(),n=this.getListHeight(),this.ui.resultGroupList.scrollTop(o-n)):e?(t=this.getListScrollTop(),r=this.activeResult.getTop()+t,t>r&&this.ui.resultGroupList.scrollTop(r)):(t=this.getListScrollTop(),o=this.activeResult.getTop()+this.activeResult.getHeight()+t,n=this.getListHeight(),i=t+n,o>i&&this.ui.resultGroupList.scrollTop(o-n))},adjustListScrollTop:function(e){return this.activeResult?(o.vent.trigger("omnibar:before:adjustListScrollTop"),this._adjustListScrollTop(e),o.vent.trigger("omnibar:adjustListScrollTop"),this):this},selectNextResult:function(){if(!this.collection.length)return this;var e=this.findResultView(this.collection.findNextResult(this.activeResult.model));return this.setActiveResult(e).adjustListScrollTop(),this.hasNavigated=!0,this},selectPreviousResult:function(){if(!this.collection.length)return this;var e=this.findResultView(this.collection.findPreviousResult(this.activeResult.model));return this.setActiveResult(e).adjustListScrollTop(!0),this.hasNavigated=!0,this},toggleLoading:function(e){return this.ui.input.toggleClass("loading",e),this},toggleListDisplay:function(e){return this.ui.resultGroupList.toggle(e),this},query:function(e){var t=this.ui.input.val();return(e||t!==this.lastQuery)&&(this.hasNavigated=!1,this.lastQuery=t,this.trigger("query",t)),this},inputHandler:n.debounce(function(){this.query()},s),keydownHandler:function(t){t.keyCode===e.keyCode.ESCAPE?o.commands.execute("omnibar:close"):t.keyCode===e.keyCode.DOWN||!t.shiftKey&&t.keyCode===e.keyCode.TAB?(t.preventDefault(),this.selectNextResult()):t.keyCode===e.keyCode.UP||t.shiftKey&&t.keyCode===e.keyCode.TAB?(t.preventDefault(),this.selectPreviousResult()):t.keyCode===e.keyCode.ENTER&&(t.preventDefault(),this.activeResult&&this.activeResult.execute())},submitHandler:function(e){e.preventDefault()},beforeUpdateHandler:function(){this.toggleLoading(!0)},updateHandler:function(){this.toggleLoading(!1),this.isEmpty()||this.toggleListDisplay(!!this.collection.length)}})}),define("utils/register-shortcut",["data/current-user","utils/when-i-type"],function(e,t){return function(n){e.isKbdShortcutsEnabled&&t.fromJSON(n)}}),define("js/components/omnibar/index",["aui","on-ready","js/components/omnibar/extensions","js/components/omnibar/collections/result-groups","js/components/omnibar/extensions/global-actions","js/components/omnibar/extensions/user-issues","js/components/omnibar/extensions/user-pull-requests","js/components/omnibar/extensions/user-repositories","js/components/omnibar/views/dialog","js/components/omnibar/views/form","utils/register-shortcut"],function(e,t,n,i,r,o,s,a,l,u,c){return t(function(e){function t(e){return m=new i,g=new l({el:e}).render(),v=new u({el:e.find(".omnibar-form"),collection:m}).render(),n.register(r,{weight:200}),n.register(a,{weight:120}),n.register(s,{weight:110}),n.register(o,{weight:100}),g.on("before:open",function(){v.query(!0)}),g.on("open",function(){v.focus()}),g}function d(){g||(g=t(e)),g.open()}function h(){e.attr("title",gettext('You can now search for files from the Omnibar. Press "." to open this dialog from any page.')),e.tipsy({gravity:"n",trigger:"manual"})}function p(){e.tipsy("show")}function f(){e.tipsy("hide")}var m,g,v;c([{section:gettext("Global actions"),shortcuts:[{keys:["."],description:gettext("Open the Omnibar"),op:"execute",params:[d]}]}]),c([{section:gettext("Repository actions"),shortcuts:[{keys:["f"],description:gettext("Search for file"),op:"execute",params:[function(){d(),h(),g.once("open",p),m.on("update",p),g.once("before:close",function(){f(),m.off("update",p)})}]}]}])})}),define("api/url-roots",[],function(){return{internal:"/!api/internal",1:"/!api/1.0",2:"/!api/2.0"}}),define("api/collection",["backbone","api/url-roots"],function(e,t){return e.Collection.extend({apiVersion:2,getApiRoot:function(){return t[this.apiVersion]}})}),define("api/model",["underscore","backbone","api/url-roots"],function(e,t,n){return t.Model.extend({apiVersion:2,getApiRoot:function(){return n[this.apiVersion]},get:function(n){if(arguments.length>1){var i=this;return e.each(arguments,function(e){i=i.get(e)}),i}return t.Model.prototype.get.call(this,n)},toJSON:function(){if(this._isSerializing)return this.id||this.cid;this._isSerializing=!0;var t=e.clone(this.attributes);return e.each(t,function(n,i){n&&e.isFunction(n.toJSON)&&(t[i]=n.toJSON())}),this._isSerializing=!1,t}})}),define("api/models/user",["api/model"],function(e){return e.extend({apiVersion:1,urlRoot:function(){return"{}/users".format(this.getApiRoot())},idAttribute:"username"})}),define("api/collections/users",["api/collection","api/models/user"],function(e,t){return e.extend({apiVersion:1,model:t,url:function(){return"{}/users".format(this.getApiRoot())},load:function(e){if(this.get(e))return this.get(e);var n=new t({username:e});return this.add(n),n}})}),define("api/cache/users",["api/collections/users"],function(e){return new e}),define("api/paginated-collection",["underscore","api/collection"],function(e,t){return t.extend({constructor:function(){this._page=1,t.apply(this,arguments)},_fetch:t.prototype.fetch,fetch:function(t){var n=e.clone(t||{});n.data=e.extend({page:this._page},n.data||{}),this._pagelen&&(n.data.pagelen=this._pagelen),this._fetch(n)},_parse:function(e){return this._size=e.size,this._pagelen||(this._pagelen=e.pagelen),this._pages=((this._size-1)/this._pagelen|0)+1,e.values},parse:function(e){return this._parse(e)},more:function(){return this.hasMore()?(this._page+=1,this.fetch({update:!0,remove:!1})):void 0},hasMore:function(){return this._pages&&this._page<this._pages}})}),define("api/models/branch",["api/model"],function(e){return e.extend({apiVersion:"internal",url:function(){return"{}/repositories/{}/branches/{}".format(this.getApiRoot(),this.get("repository").id,encodeURIComponent(this.get("name")))},initialize:function(){this.id="{}/branches/{}".format(this.get("repository").id,this.get("name"))},toJSON:function(){return{name:this.get("name")}}})}),define("api/models/commit",["jquery","api/model","api/models/branch","api/cache/repositories"],function(e,t,n){return t.extend({apiVersion:"internal",url:function(){return"{}/repositories/{}/oecommits/{}".format(this.getApiRoot(),this.get("repository").id,this.get("hash"))},parse:function(e){var t=require("api/cache/repositories");return e.repository=t.load(e.repository.full_name),e},save:function(){return this.has("timestamp")||this.set("timestamp",new Date),t.prototype.save.apply(this,arguments)},merge:function(t,n){return e.ajax({url:"/!api/{}/repositories/{}/merge".format(this.getApiRoot(),this.get("repository").id),type:"POST",data:JSON.stringify({parents:[this.get("hash"),t],message:n}),dataType:"json",contentType:"application/json; charset=utf-8"})},addFile:function(e){var t=this.get("files")||[];return t.push(e),this.set("files",t),this},setBranch:function(e){return this.set({branch:new n({repository:this.get("repository"),name:e})}),this},toJSON:function(){return{branch:this.get("branch","name"),files:this.get("files"),message:this.get("message"),parents:this.get("parents"),repository:this.get("repository").toJSON(),timestamp:this.get("timestamp"),"transient":!!this.get("transient")}}})}),define("api/models/pullrequest-target",["api/model"],function(e){return e.extend({initialize:function(){this.hash=this.get("commit")?this.get("commit","hash"):null,this.branch=this.get("branch")?this.get("branch","name"):null,this.repo=this.get("repository").id},toSpecString:function(){var e=this.get("commit")?this.get("commit","hash"):null,t=this.get("branch")?this.get("branch","name"):null;return"{}:{}".format(this.get("repository").id,e||t)},toJSON:function(){return{branch:this.get("branch").toJSON(),repository:this.get("repository").toJSON()}}})}),define("api/models/pullrequest",["jquery","underscore","api/model","api/url-roots","api/models/commit","api/models/branch","api/models/pullrequest-target","api/cache/repositories","api/cache/users","utils/check-task"],function(e,t,n,i,r,o,s,a,l,u){return n.extend({apiVersion:2,idAttribute:"global_id",url:function(){return"{}/repositories/{}/pullrequests/{}".format(this.getApiRoot(),this.get("destination","repository").id,this.get("local_id"))},parse:function(e){return e.local_id=e.id,e.closed_by&&(e.closed_by=l.load(e.closed_by.username)),e.user=l.load(e.author.username),t.each(["destination","source"],function(t){if(null===e[t].repository)e[t]=null;else{var n=require("api/cache/repositories"),i=n.load(e[t].repository.full_name);e[t]=new s({repository:i,commit:new r({repository:i,hash:e[t].commit.hash}),branch:new o({repository:i,name:e[t].branch.name})})}}),e},diff:function(){var t=e.Deferred();return this._revspec?t.resolve(this._revspec.diff):this.get("source","repository").revspec(this.get("source","commit","hash"),this.get("destination","repository"),this.get("destination","commit","hash")).done(function(e){this._revspec=e,t.resolve(this._revspec.diff)}.bind(this)),t},mergebase:function(){var t=e.Deferred();return this._revspec?t.resolve(this._revspec.mergebase.hash):this.get("source","repository").revspec(this.get("source","commit","hash"),this.get("destination","repository"),this.get("destination","commit","hash")).done(function(e){this._revspec=e,t.resolve(this._revspec.mergebase.hash)}.bind(this)),t},sourceDiff:function(){return this.get("source","repository").twoway(this.get("source","commit","hash"),this.get("destination","repository"),this.get("destination","commit","hash"))},destDiff:function(){var t=e.Deferred();return this.mergebase().done(function(e){this.get("destination","repository").revspec(this.get("destination","commit","hash"),this.get("source","repository"),e).done(function(e){t.resolve(e.diff)})}.bind(this)),t},getComments:function(){var t=e.Deferred();return e.ajax({url:"{}/repositories/{}/pullrequests/{}/comments".format(i[1],this.get("destination","repository").id,this.get("local_id")),type:"GET",dataType:"json"}).done(function(e){t.resolve(e)}).fail(function(){t.reject()}),t},toJSON:function(){return{source:this.get("source").toJSON(),destination:this.get("destination").toJSON(),title:this.get("title"),description:this.get("description"),close_source_branch:!!this.get("close_source_branch"),reviewers:t.map(this.get("reviewers"),function(e){return{username:e}})}},updateRef:function(){var t=new e.Deferred;return e.ajax({url:"/{}/pull-request/update/{}".format(this.get("destination","repository").id,this.get("local_id")),type:"POST",data:{_quick_update:1},dataType:"json"}).done(function(e){e.errors?t.reject():e.result?t.resolve(e.result):setTimeout(function(){u(e.url,t)},1e3)}).fail(t.reject),t.promise()},toRevSpec:function(){return"{}..{}".format(this.get("source").toSpecString(),this.get("destination").toSpecString())}})}),define("api/collections/pullrequests",["jquery","api/paginated-collection","api/models/pullrequest","api/models/pullrequest-target"],function(e,t,n,i){return t.extend({apiVersion:2,model:n,url:function(){return"{}/repositories/{}/pullrequests".format(this.getApiRoot(),this.repository.id)},load:function(e){var t=this.find(function(t){return t===e});if(void 0===t){var r=new i({repository:this.repository});t=new n({destination:r,local_id:e})}return t},initialize:function(e,t){t=t||{},this.repository=t.repository},updateRefs:function(){var t=new e.Deferred,n=this.length,i=0,r=0;return this.each(function(e){e.updateRef().done(function(){t.notify(++i,n),i===n&&t.resolve()}).always(function(){++r===n&&i!==n&&t.reject()})}),t}})}),define("api/models/repository",["jquery","underscore","api/model","api/url-roots","api/cache/users","api/collections/pullrequests"],function(e,t,n,i,r,o){var s=n.extend({apiVersion:1,urlRoot:function(){return"{}/repositories".format(this.getApiRoot())},url:function(){return"{}/repositories/{}".format(this.getApiRoot(),this.id)},initialize:function(){this.id="{}/{}".format(this.get("owner","username"),this.get("slug")),this.pullRequests=new o([],{repository:this})},parse:function(e){return e.owner=r.load(e.owner),e.fork_of&&(e.fork_of=s.fromFullSlug("{}/{}".format(e.fork_of.owner,e.fork_of.slug))),e},fork:function(t){var n=new e.Deferred,r={name:null};t&&(r.name=t);var o=function(e){e.fetch({success:function(t){"available"===t.get("state")?n.resolve(e):setTimeout(function(){o(e)},1e3)},error:function(){n.reject()}})};return e.ajax({url:"{}/repositories/{}/fork".format(i.internal,this.id),type:"POST",data:JSON.stringify(r),dataType:"json",contentType:"application/json; charset=utf-8"}).done(function(e){var t=s.fromFullSlug(e.full_name);o(t)}).fail(function(){n.reject()}),n},toJSON:function(){return{full_name:this.get("owner").get("username")+"/"+this.get("slug")}},pull:function(t){var n="{}/repositories/{}/pull".format(i.internal,this.id);return t&&(n="{}/{}".format(n,encodeURIComponent(t))),e.ajax({url:n,type:"PUT",dataType:"json"})},diff:function(e,t){return this.revspec(e,this,t)},twoway:function(t,n,r){var o=this.createRevSpec(t,n,r);return e.ajax({url:"{}/repositories/{}/twoway/{}?context=0".format(i.internal,this.id,o),type:"GET",dataType:"json",contentType:"application/json; charset=utf-8"})},revspec:function(t,n,r){var o=this.createRevSpec(t,n,r);return e.ajax({url:"{}/repositories/{}/revspec/{}?context=0".format(i.internal,this.id,o),type:"GET",dataType:"json",contentType:"application/json; charset=utf-8"})},createRevSpec:function(e,t,n){return"{}:{}..{}:{}".format(this.id,e,t.id,n)}},{fromFullSlug:function(e,n){var i=e.split("/"),o=i.pop(),s=i.length?i.pop():null,a=r.load(s),l=t.defaults({owner:a,slug:o},n);return new this(l)}});return s}),define("api/collections/repositories",["api/collection","api/models/repository"],function(e,t){return e.extend({apiVersion:1,model:t,initialize:function(e,t){t=t||{},this.owner=t.owner||null},url:function(){return"{}/repositories".format(this.getApiRoot())},load:function(e,n){if(this.get(e))return this.get(e);var i=t.fromFullSlug(e,n);return this.add(i),i}})}),define("api/cache/repositories",["api/collections/repositories"],function(e){return new e}),define("js/connect/admin/data/connect-admin-context",["jquery"],function(e){return e("#connect-admin").data("connect-admin-context")}),define("js/connect/admin/data/target-user",["jquery"],function(e){return e("#connect-admin").data("target-user")}),define("js/connect/admin/models/custom-add-on",["jquery","api/model","api/cache/repositories","data/current-repo","js/connect/admin/data/connect-admin-context","js/connect/admin/data/target-user"],function(e,t,n,i,r,o){return t.extend({apiVersion:"internal",validateDescriptor:function(){var t=this,n=t.get("url");return n=n&&n.trim()||t.getDescriptorUrl(),e.ajax({url:t.urlRoot()+"/validate",data:{url:n},success:function(e){t.set("descriptor",e)}})},getDescriptorUrl:function(){var e=this.get("links");return e&&e.descriptor&&e.descriptor.source_url&&e.descriptor.source_url.href},urlRoot:function(){switch(r){case"repository":var e=n.load(i.fullslug);return"{}/repositories/{}/addons".format(this.getApiRoot(),e.id);case"account":return"{}/account/{}/addons".format(this.getApiRoot(),o);default:throw"No context."}}})}),define("js/connect/admin/collections/custom-add-ons",["api/collection","api/cache/repositories","data/current-repo","js/connect/admin/data/connect-admin-context","js/connect/admin/data/target-user","js/connect/admin/models/custom-add-on"],function(e,t,n,i,r,o){return e.extend({apiVersion:"internal",model:o,parse:function(e){return e.values},url:function(){switch(i){case"repository":var e=t.load(n.fullslug);return"{}/repositories/{}/addons?pagelen=100".format(this.getApiRoot(),e.id);case"account":return"{}/account/{}/addons?pagelen=100".format(this.getApiRoot(),r);default:throw"No context."}}})}),define("utils/get-scopes",["jquery","underscore"],function(e,t){function n(e,n){return e.filter(function(e){return t.contains(n,e.name)})}var i=t.once(function(){return e.ajax("/site/oauth2/scopes")});return function(t){var r=e.Deferred();return i().done(function(e){t&&t.length&&(e=n(e,t)),r.resolve(e)}),r.promise()}}),define("text",["module"],function(e){"use strict";var t,n,i,r,o=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,a=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,u=l&&location.protocol&&location.protocol.replace(/\:/,""),c=l&&location.hostname,d=l&&(location.port||void 0),h={},p=e.config&&e.config()||{};return t={version:"2.0.7",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(a);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:p.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=o[t];try{e=new ActiveXObject(n)}catch(i){}if(e){o=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!s||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,s,a,l=t.xdRegExp.exec(e);return l?(o=l[2],s=l[3],s=s.split(":"),a=s[1],s=s[0],!(o&&o!==n||s&&s.toLowerCase()!==i.toLowerCase()||(a||s)&&a!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,p.isBuild&&(h[e]=i),r(i)},load:function(e,n,i,r){if(r.isBuild&&!r.inlineText)return void i();p.isBuild=r.isBuild;var o=t.parseName(e),s=o.moduleName+(o.ext?"."+o.ext:""),a=n.toUrl(s),h=p.useXhr||t.useXhr;!l||h(a,u,c,d)?t.get(a,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([s],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)})},write:function(e,n,i){if(h.hasOwnProperty(n)){var r=t.jsEscape(h[n]);i.asModule(e+"!"+n,"define(function () { return '"+r+"';});\n")}},writeFile:function(e,n,i,r,o){var s=t.parseName(n),a=s.ext?"."+s.ext:"",l=s.moduleName+a,u=i.toUrl(s.moduleName+a)+".js";t.load(l,i,function(){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},t.write(e,l,n,o)},o)}},"node"===p.env||!p.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");0===r.indexOf("")&&(r=r.substring(1)),t(r)}catch(o){i(o)}}):"xhr"===p.env||!p.env&&t.createXhr()?t.get=function(e,n,i,r){var o,s=t.createXhr();if(s.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),r[o]);p.onXhr&&p.onXhr(s,e),s.onreadystatechange=function(){var t,r;4===s.readyState&&(t=s.status,t>399&&600>t?(r=new Error(e+" HTTP status: "+t),r.xhr=s,i(r)):n(s.responseText),p.onXhrComplete&&p.onXhrComplete(s,e))},s.send(null)}:"rhino"===p.env||!p.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),l="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(s),n.append(i);l=String(n.toString())}finally{a.close()}t(l)}:("xpconnect"===p.env||!p.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),t.get=function(e,t){var n,o,s={},a=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(a,1,0,!1),o=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),o.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),o.readString(n.available(),s),o.close(),n.close(),t(s.value)}catch(l){throw new Error((a&&a.path||"")+": "+l)}}),t}),define("text!js/connect/admin/templates/access-request.mustache",[],function(){return'\n[[#accessRequestBeforeMessage]]\n  <p>[[&accessRequestBeforeMessage]]</p>\n[[/accessRequestBeforeMessage]]\n<ul class="access-request-scopes-list">\n  [[#scopes]]\n    <li>[[description]]</li>\n  [[/scopes]]\n</ul>\n[[#accessRequestAfterMessage]]\n  <p>[[&accessRequestAfterMessage]]</p>\n[[/accessRequestAfterMessage]]'}),define("js/connect/admin/views/confirm-scopes",["mustache","underscore","components/confirm-dialog","utils/get-scopes","text!js/connect/admin/templates/access-request.mustache"],function(e,t,n,i,r){function o(e,n){var i=gettext("Upon installation, the add-on <strong>%(addon_name)s</strong> will receive access to:");return r({scopes:n,accessRequestBeforeMessage:interpolate(i,{addon_name:t.escape(e)},!0)}).trim()}return r=e.compile(r),function(e,r){var s=e.get("descriptor"),a=s.scopes,l=s.name;return i(a).then(function(e){return e&&e.length?(t.extend(r,{content:o(l,e),isSafeContent:!0}),n(r)):void 0})}}),define("utils/xhr-err-handler",["aui"],function(e){var t=gettext("There was a problem processing your request."),n=function(n){var i,r=null;if(n)if("string"==typeof n)r=n;else{if(n.responseText)try{i=JSON.parse(n.responseText),r=i.error&&i.error.message}catch(o){}r=r||t}else r=t;e.messages.error({body:r,fadeout:!1})};return function(){var e=Array.prototype.slice.apply(arguments);if(0===e.length)return n();for(var t=0,i=e.length;i>t;++t)if(e[t].responseText)return n(e[t]);return n(e[0])}}),define("js/connect/admin/views/custom-add-on",["marionette","components/confirm-dialog","js/connect/admin/views/confirm-scopes","utils/xhr-err-handler"],function(e,t,n,i){return e.ItemView.extend({tagName:"tr",template:"#custom-add-on-template",className:function(){var e="connect-add-on-row";return this.model.get("enabled")||(e+=" connect-add-on-disabled"),e},ui:{actionsDropdown:".connect-add-on-actions"},modelEvents:{change:"render"},onRender:function(){this.$el.attr("class",this.className()),this.ui.actionsDropdown.on("click.addOnActions",".connect-add-on-uninstall",this.uninstallAddOn.bind(this)).on("click.addOnActions",".connect-add-on-enable",this.enableAddOn.bind(this)).on("click.addOnActions",".connect-add-on-disable",this.disableAddOn.bind(this)).on("click.addOnActions",".connect-add-on-update",this.updateAddOn.bind(this))},onDestroy:function(){this.ui.actionsDropdown.off(".addOnActions")},uninstallAddOn:function(e){e.preventDefault();var n=this,r=this.model,o=r.get("name"),s=gettext('Are you sure you wish to uninstall the add-on "%(addOnName)s"?  You may lose any settings and this cannot be undone.'),a=interpolate(s,{addOnName:o},!0),l=interpolate(gettext('Add-on "%(addOnName)s" has been uninstalled. You may need to refresh the page to see changes to navigation.'),{addOnName:o},!0);t({id:"remove-addon",title:gettext("Uninstall add-on"),content:a,buttonText:gettext("Uninstall")}).done(function(){r.destroy({wait:!0,success:function(){n.success(l)},error:i})})},updateAddOn:function(e){e.preventDefault();var t=this,r=this.model,o=r.get("name"),s=gettext("Are you sure you wish to update the add-on %(addOnName)s?  The descriptor will be re-fetched from the same url and this cannot be undone.  Any existing settings will remain."),a=interpolate(s,{addOnName:o},!0),l=interpolate(gettext('Add-on "%(addOnName)s" has been updated. You may need to refresh the page to see changes to navigation.'),{addOnName:o},!0);r.validateDescriptor().fail(i).done(function(){n(r,{id:"update-addon",title:gettext("Update add-on"),content:a,buttonText:gettext("Update")}).done(function(){r.save({},{url:r.url()+"/descriptor",data:JSON.stringify(r.get("descriptor")),wait:!0,success:function(){t.success(l)},error:i})})})},enableAddOn:function(e){e.preventDefault();var t=this.model,n=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been enabled. You may need to refresh the page to see changes to navigation.'),{addOnName:n},!0);t.save({enabled:!0},{wait:!0,success:function(){this.success(r)}.bind(this),error:i})},disableAddOn:function(e){e.preventDefault();var t=this.model,n=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been disabled. You may need to refresh the page to see changes to navigation.'),{addOnName:n},!0);t.save({enabled:!1},{wait:!0,success:function(){this.success(r)}.bind(this),error:i})},success:function(e){AJS.messages.success({body:e,fadeout:!0})}})}),define("js/connect/admin/views/custom-add-on-list",["aui","jquery","marionette","js/connect/admin/views/confirm-scopes","js/connect/admin/views/custom-add-on","utils/xhr-err-handler"],function(e,t,n,i,r,o){return n.CompositeView.extend({template:"#custom-add-ons-table-template",childView:r,childViewContainer:"tbody",initialize:function(e){this.mergeOptions(e,["autofocus"])},onRender:function(){this.autofocus&&this.focusUrlInput()},events:{submit:"onSubmit"},ui:{urlInput:"#connect-url",containerTable:"table.widget"},getUrlInputValue:function(){return this.ui.urlInput.val()},clearUrlInput:function(){this.ui.urlInput.val("")},focusUrlInput:function(){this.ui.urlInput.focus()},onSubmit:function(e){e.preventDefault(),this.installAddOn(this.getUrlInputValue())},installAddOn:function(e){var t=this,n=new this.collection.model({url:e});n.validateDescriptor().fail(o).done(function(r){i(n,{id:"install-addon",title:gettext("Install add-on"),buttonText:gettext("Install")}).done(function(){n.save({url:e,descriptor:r},{wait:!0,success:function(e){t.collection.add(n),t.clearUrlInput(),t.displayInstalledMessage(e)},error:o})})})},displayInstalledMessage:function(t){var n=t.get("name"),i=interpolate(gettext('Add-on "%(addOnName)s" has been installed. You may need to refresh the page to see changes to navigation.'),{addOnName:n},!0);e.messages.success({body:i,fadeout:!0})}})}),define("utils/masker",[],function(){return{mask:function(e,t){this.unmask(e);var n=$('<div class="plain-mask"></div>');e.append(n),t&&(t.backgroundColor&&n.css("background-color",t.backgroundColor),t.spinner&&n.spin(t.spinner))},unmask:function(e){var t=e.find(".plain-mask");t.spin(!1).remove()},spinnerSizes:{TINY:"tiny",SMALL:"small",LARGE:"large"}}}),define("js/connect/admin/index",["on-ready","js/connect/admin/collections/custom-add-ons","js/connect/admin/views/custom-add-on-list","utils/masker"],function(e,t,n,i){return e(function(e){var r=new t;r.fetch({wait:!0}).done(function(){i.unmask(e)}),i.mask(e,{spinner:"tiny"}),new n({collection:r,el:e,autofocus:!0}).render()})}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("atlassian-connect-js/dist/connect-host",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.connectHost=e()}}(function(){var e;return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return r(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./addons"),o=i(r),s=e("./content"),a=i(s),l=e("./create"),u=i(l),c=e("./dialog/api"),d=i(c),h=e("./dialog/binder"),p=i(h),f=e("./dialog/rpc"),m=i(f),g=e("./env"),v=i(g),y=e("./inline-dialog/rpc"),b=i(y),w=e("./inline-dialog/binder"),x=i(w),_=e("./loading-indicator"),k=i(_),C=e("./messages/rpc"),S=i(C),$=e("./resize"),T=i($),A=e("./rpc"),E=i(A),j=e("./status-helper"),D=i(j),q=e("../common/ui-params"),P=i(q),I=e("../common/uri"),R=i(I);window._AP||(window._AP={}),AJS.toInit(p["default"]),AJS.toInit(x["default"]),E["default"].extend(o["default"]),E["default"].extend(m["default"]),E["default"].extend(v["default"]),E["default"].extend(b["default"]),E["default"].extend(k["default"]),E["default"].extend(S["default"]),E["default"].extend(T["default"]),n["default"]={extend:E["default"].extend,init:E["default"].init,uiParams:P["default"],create:u["default"],_uriHelper:R["default"],_statusHelper:D["default"],webItemHelper:a["default"],dialog:d["default"]},t.exports=n["default"]
},{"../common/ui-params":8,"../common/uri":9,"./addons":11,"./content":13,"./create":14,"./dialog/api":15,"./dialog/binder":16,"./dialog/rpc":19,"./env":21,"./inline-dialog/binder":22,"./inline-dialog/rpc":23,"./loading-indicator":26,"./messages/rpc":28,"./resize":29,"./rpc":30,"./status-helper":31}],2:[function(e,t,n){!function(){function e(e){this.message=e}var t="undefined"!=typeof n?n:this,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.prototype=new Error,e.prototype.name="InvalidCharacterError",t.btoa||(t.btoa=function(t){for(var n,r,o=String(t),s=0,a=i,l="";o.charAt(0|s)||(a="=",s%1);l+=a.charAt(63&n>>8-s%1*8)){if(r=o.charCodeAt(s+=.75),r>255)throw new e("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|r}return l}),t.atob||(t.atob=function(t){var n=String(t).replace(/=+$/,"");if(n.length%4==1)throw new e("'atob' failed: The string to be decoded is not correctly encoded.");for(var r,o,s=0,a=0,l="";o=n.charAt(a++);~o&&(r=s%4?64*r+o:o,s++%4)?l+=String.fromCharCode(255&r>>(-2*s&6)):0)o=i.indexOf(o);return l})}()},{}],3:[function(t,n){!function(t){function i(e){return e&&(e=e.toString().replace(a.pluses,"%20"),e=decodeURIComponent(e)),e}function r(e){var t=a.uri_parser,n=["source","protocol","authority","userInfo","user","password","host","port","isColonUri","relative","path","directory","file","query","anchor"],i=t.exec(e||""),r={};return n.forEach(function(e,t){r[e]=i[t]||""}),r}function o(e){var t,n,r,o,s,l,u,c=[];if("undefined"==typeof e||null===e||""===e)return c;for(0===e.indexOf("?")&&(e=e.substring(1)),n=e.toString().split(a.query_separator),t=0,u=n.length;u>t;t++)r=n[t],o=r.indexOf("="),0!==o&&(s=i(r.substring(0,o)),l=i(r.substring(o+1)),c.push(-1===o?[r,null]:[s,l]));return c}function s(e){this.uriParts=r(e),this.queryPairs=o(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var a={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;o>i;){var s;i in r&&(s=r[i],e.call(n,s,i,r)),i++}}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){s.prototype[e]=function(t){return"undefined"!=typeof t&&(this.uriParts[e]=t),this.uriParts[e]}}),s.prototype.hasAuthorityPrefix=function(e){return"undefined"!=typeof e&&(this.hasAuthorityPrefixUserPref=e),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},s.prototype.isColonUri=function(e){return"undefined"==typeof e?!!this.uriParts.isColonUri:void(this.uriParts.isColonUri=!!e)},s.prototype.query=function(e){var t,n,i,r="";for("undefined"!=typeof e&&(this.queryPairs=o(e)),t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],r.length>0&&(r+="&"),null===n[1]?r+=n[0]:(r+=n[0],r+="=","undefined"!=typeof n[1]&&(r+=encodeURIComponent(n[1])));return r.length>0?"?"+r:r},s.prototype.getQueryParamValue=function(e){var t,n,i;for(n=0,i=this.queryPairs.length;i>n;n++)if(t=this.queryPairs[n],e===t[0])return t[1]},s.prototype.getQueryParamValues=function(e){var t,n,i,r=[];for(t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],e===n[0]&&r.push(n[1]);return r},s.prototype.deleteQueryParam=function(e,t){var n,r,o,s,a,l=[];for(n=0,a=this.queryPairs.length;a>n;n++)r=this.queryPairs[n],o=i(r[0])===i(e),s=r[1]===t,(1!==arguments.length||o)&&(2!==arguments.length||o&&s)||l.push(r);return this.queryPairs=l,this},s.prototype.addQueryParam=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},s.prototype.hasQueryParam=function(e){var t,n=this.queryPairs.length;for(t=0;n>t;t++)if(this.queryPairs[t][0]==e)return!0;return!1},s.prototype.replaceQueryParam=function(e,t,n){var r,o,s=-1,a=this.queryPairs.length;if(3===arguments.length){for(r=0;a>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)&&decodeURIComponent(o[1])===i(n)){s=r;break}s>=0&&this.deleteQueryParam(e,i(n)).addQueryParam(e,t,s)}else{for(r=0;a>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)){s=r;break}this.deleteQueryParam(e),this.addQueryParam(e,t,s)}return this},["protocol","hasAuthorityPrefix","isColonUri","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);s.prototype[t]=function(t){return this[e](t),this}}),s.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},s.prototype.origin=function(){var e=this.scheme();return this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),(this.port()||this.path()&&this.path().substr(0,1).match(/[0-9]/))&&(e+=":"+this.port())),e},s.prototype.addTrailingSlash=function(){var e=this.path()||"";return"/"!==e.substr(-1)&&this.path(e+"/"),this},s.prototype.toString=function(){var e,t=this.origin();return this.isColonUri()?this.path()&&(t+=":"+this.path()):this.path()?(e=this.path(),a.ends_with_slashes.test(t)||a.starts_with_slashes.test(e)?(t&&t.replace(a.ends_with_slashes,"/"),e=e.replace(a.starts_with_slashes,"/")):t+="/",t+=e):this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},s.prototype.clone=function(){return new s(this.toString())},"function"==typeof e&&e.amd?e(function(){return s}):"undefined"!=typeof n&&"undefined"!=typeof n.exports?n.exports=s:t.Uri=s}(this)},{}],4:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("Base64"),o=i(r);n["default"]={encode:o["default"].btoa,decode:o["default"].atob},t.exports=n["default"]},{Base64:2}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i;i=e("../host/dollar"),n["default"]=i,t.exports=n["default"]},{"../host/dollar":20}],6:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t){this._key=e,this._origin=t,this._events={},this._any=[]}function o(e,t){for(var n=0;n<e.length;++n)try{e[n].apply(null,t)}catch(i){u(i.stack||i.message||i)}}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./dollar"),a=i(s),l=window,u=l.AJS&&l.AJS.log||l.console&&l.console.log||function(){},c=r.prototype;c.on=function(e,t){return e&&t&&this._listeners(e).push(t),this},c.once=function(e,t){var n=this,i=function r(){n.off(e,r),t.apply(null,arguments)};return this.on(e,i),this},c.onAny=function(e){return this._any.push(e),this},c.off=function(e,t){var n=this._events[e];if(n){var i=a["default"].inArray(t,n);i>=0&&n.splice(i,1),0===n.length&&delete this._events[e]}return this},c.offAll=function(e){return e?delete this._events[e]:this._events={},this},c.offAny=function(e){var t=this._any,n=a["default"].inArray(e,t);return n>=0&&t.splice(n,1),this},c.emit=function(){return this._emitEvent(this._event.apply(this,arguments))},c._event=function(e){return{name:e,args:[].slice.call(arguments,1),attrs:{},source:{key:this._key,origin:this._origin}}},c._emitEvent=function(e){var t=e.args.concat(e);return o(this._listeners(e.name),t),o(this._any,[e.name].concat(t)),this},c._listeners=function(e){return this._events[e]=this._events[e]||[]},n["default"]={Events:r},t.exports=n["default"]},{"./dollar":5}],7:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return o(e).iss}function o(e){if(null===e||""===e)throw"Invalid JWT: must be neither null nor empty-string.";var t=e.indexOf("."),n=e.indexOf(".",t+1);if(0>t||t>=n)throw'Invalid JWT: must contain 2 period (".") characters.';var i=e.substring(t+1,n);if(null===i||""===i)throw"Invalid JWT: encoded claims must be neither null nor empty-string.";var r=l["default"].decode.call(window,i);return JSON.parse(r)}function s(e,t){void 0===t&&(t=60);var n=o(e),i=0,r=Math.floor(Date.now()/1e3);return n&&n.exp&&(i=n.exp),t>i-r?!0:!1}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./base64"),l=i(a);n["default"]={parseJwtIssuer:r,parseJwtClaims:o,isJwtExpired:s},t.exports=n["default"]},{"./base64":4}],8:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./base64"),o=i(r),s=e("./uri"),a=i(s);n["default"]={encode:function(e){if(e){var t=JSON.stringify(e);return o["default"].encode.call(window,t)}},fromUrl:function(e){var t=new a["default"].init(e).getQueryParamValue("ui-params");return this.decode(t)},fromWindowName:function(e,t){e=e||window;var n=this.decode(e.name);return t?n?n[t]:void 0:n},decode:function(e){var t={};if(e&&e.length>0)try{t=JSON.parse(o["default"].decode.call(window,e))}catch(n){console&&console.log&&console.log("Cannot decode passed ui params",e)}return t}},t.exports=n["default"]},{"./base64":4,"./uri":9}],9:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("jsuri"),o=i(r);n["default"]={init:o["default"]},t.exports=n["default"]},{jsuri:3}],10:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e,t,n){function i(e,t,n){try{T.postMessage(JSON.stringify({c:E,i:e,t:t,m:n}),A)}catch(i){k(x(i))}}function o(e,t,n,r){var o=Math.floor(1e9*Math.random()).toString(16);L.add(o,n,r),i(o,"request",{n:e,a:t})}function a(e,t){i(e,"done",t)}function u(e,t){i(e,"fail",t)}function d(e){try{var t=JSON.parse(e.data),n=t.i,i=t.c,r=t.t,o=t.m;if(e.source!==T&&e.origin.toLowerCase()===A&&i===E&&(T=e.source),e.source!==T||e.origin.toLowerCase()!==A||i!==E)return;if("request"===r){var s,l,c,d=o.n,h=o.a,p=M[d];if(p){s=function(e){a(n,e)},l=function(e){u(n,e)},c=(h?h.length:0)<p.length;var f=M;S.isHost===!0?(f=S,f.analytics&&f.analytics.trackBridgeMethod(d)):f.isHost=!1;try{c?p.apply(f,h.concat([s,l])):s(p.apply(f,h))}catch(m){l(x(m)),C(m)}}else _("Unhandled request:",t)}else("done"===r||"fail"===r)&&(L.invoke(r,n,o)||_("Unhandled response:",r,n,o))}catch(m){k(x(m))}}function p(t){return function(){function n(){return e.isFunction(s[s.length-1])?s.pop():void 0}var i,r,s=[].slice.call(arguments);r=n(),i=n(),i||(i=r,r=void 0),o(t,s,i,r)}}function m(e){S.isActive()?d(e.originalEvent?e.originalEvent:e):v()}function g(){e(window).bind("message",m)}function v(){e(window).unbind("message",m)}function y(e,t){return new c["default"].init(e).getQueryParamValue(t)}function b(e){return new c["default"].init(e).origin()}function w(t){if(!t.container)throw new Error("config.container must be defined");var n=document.createElement("iframe"),i="easyXDM_"+t.container+"_provider",r="";return t.uiParams&&(r=h["default"].encode(t.uiParams)),e.extend(n,{id:i,name:r,frameBorder:"0"},t.props),n.setAttribute("rel","nofollow"),e(document.getElementById(t.container)).append(n),n.src=t.remote,n}function x(e){return e.message||e.toString()}function _(){r.debug&&k.apply(I,["DEBUG:"].concat([].slice.call(arguments)))}function k(){var t=e.log||I.AJS&&I.AJS.log;t&&t.apply(I,arguments)}function C(){var e=I.AJS&&I.AJS.error;e&&e.apply(I,arguments)}var S,$,T,A,E,j,D,q,P,I=window,R=I.location.toString(),M=n.local||{},N=n.remote||[],O=b(R),L=function(){var e={};return{add:function(t,n,i){e[t]={done:n||null,fail:i||null,async:!!n}},invoke:function(t,n,i){var r;return e[n]&&(e[n][t]?(e[n][t](i),r=!0):r=!e[n].async&&"fail"!==t,delete e[n]),r}}}();if(/xdm_e/.test(R)){T=I.parent,D="local";var H=y(R,"jwt");q=H?l["default"].parseJwtIssuer(H):y(R,"oauth_consumer_key"),null===q&&(q=Math.random()),P=D,A=y(R,"xdm_e").toLowerCase(),E=y(R,"xdm_c"),j={isHost:!1,isActive:function(){return!0}}}else{e(document.getElementById(t.container)).find("iframe").trigger("ra.iframe.destroy");var F=w(t);T=F.contentWindow,D=y(t.remote,"oauth_consumer_key")||y(t.remote,"jwt"),q=t.remoteKey,P=q,A=b(t.remote).toLowerCase(),E=t.channel,j={isHost:!0,iframe:F,uiParams:t.uiParams,destroy:function(){window.clearTimeout(S.timeout),v(),S.iframe&&(e(S.iframe).remove(),delete S.iframe)},isActive:function(){return e.contains(document.documentElement,S.iframe)}},e(F).on("ra.iframe.destroy",j.destroy)}$=P+"|"+(f+=1),S=e.extend({id:$,remoteOrigin:A,channel:E,addonKey:P},j),e.each(N,function(e,t){"number"==typeof e&&(e=t),S[e]=p(e)});var B=S.events=new s["default"].Events(D,O);return B.onAny(function(){var t=arguments[arguments.length-1],n=t.trace=t.trace||{},i=S.id+"|xdm";(S.isHost&&!n[i]&&t.source.channel!==S.id||!S.isHost&&t.source.key===D)&&(n[i]=!0,t=e.extend({},t),delete t.trace,_("Forwarding "+(S.isHost?"host":"addon")+" event:",t),o("_event",[t]))}),M._event=function(e){delete e.trace,this.isHost&&(e.source={channel:this.id||$,key:this.addonKey,origin:this.remoteOrigin||A}),_("Receiving as "+(this.isHost?"host":"addon")+" event:",e),B._emitEvent(e)},g(),S}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./events"),s=i(o),a=e("./jwt"),l=i(a),u=e("./uri"),c=i(u),d=e("./ui-params"),h=i(d),p=e("../host/util"),f=(i(p),0);n["default"]=r,t.exports=n["default"]},{"../host/util":32,"./events":6,"./jwt":7,"./ui-params":8,"./uri":9}],11:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),s=e("./rpc"),a=(i(s),{});n["default"]=function(){var e={_emitEvent:function(e){o["default"].each(a[e.source.key],function(t,n){n.bus._emitEvent(e)})},remove:function(e){var t=a[e.addonKey][e.id];return t&&t.bus.offAny(t.listener),delete a[e.addonKey][e.id],this},init:function(t,n){a[n.addonKey]||(a[n.addonKey]={});var i=a[n.addonKey][n.id]={bus:n.events,listener:function(){var t=arguments[arguments.length-1],i=t.trace=t.trace||{},r=n.id+"|addon";i[r]||(i[r]=!0,e._emitEvent(t))}};i.bus.onAny(i.listener),i.bus.on("ra.iframe.destroy",function(){e.remove(n)})}};return e},t.exports=n["default"]},{"./dollar":20,"./rpc":30}],12:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}function o(e,t){var n={};this.addonKey=e,this.moduleKey=t,this.iframePerformance={start:function(){n.startLoading=r()},end:function(){var i=r()-n.startLoading;d.track("iframe.performance.load",{addonKey:e,moduleKey:t,value:i>u?"x":Math.ceil(i/c)}),delete n.startLoading},timeout:function(){d.track("iframe.performance.timeout",{addonKey:e,moduleKey:t}),this.end()},cancel:function(){d.track("iframe.performance.cancel",{addonKey:e,moduleKey:t})}}}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./dollar"),a=i(s),l=["resize","init"],u=2e4,c=100,d=o.prototype;d.getKey=function(){return this.addonKey+":"+this.moduleKey},d.track=function(e,t){var n="connect.addon."+e;if(AJS.Analytics)AJS.Analytics.triggerPrivacyPolicySafeEvent(n,t);else{if(!AJS.trigger)return!1;AJS.trigger("analyticsEvent",{name:n,data:t})}return!0},d.trackBridgeMethod=function(e){return-1!==a["default"].inArray(e,l)?!1:void this.track("bridge.invokemethod",{name:e,addonKey:this.addonKey,moduleKey:this.moduleKey})},n["default"]={get:function(e,t){return new o(e,t)}},t.exports=n["default"]},{"./dollar":20}],13:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=e.attr("class"),n=t?t.match(/ap-plugin-key-([^\s]*)/):null;return c["default"].isArray(n)?n[1]:!1}function o(e){var t=e.attr("class"),n=t?t.match(/ap-module-key-([^\s]*)/):null;return c["default"].isArray(n)?n[1]:!1}function s(e){var t=o(e),n=e.hasClass("ap-inline-dialog")?"inlineDialog":"dialog";return window._AP[n+"Options"][t]||{}}function a(e){var t=new h["default"].init(e).queryPairs,n={};return c["default"].each(t,function(e,t){n[t[0]]=t[1]}),n}function l(e,t,n){function i(e){e.preventDefault();var i=c["default"](e.target).closest(t),o=i.attr("href"),s=new h["default"].init(o),l={bindTo:i,header:i.text(),width:s.getQueryParamValue("width"),height:s.getQueryParamValue("height"),cp:s.getQueryParamValue("cp"),key:r(i),productContext:a(o)};n(o,l,e.type)}c["default"](window.document).on(e,t,i)}Object.defineProperty(n,"__esModule",{value:!0});var u=e("./dollar"),c=i(u),d=e("../common/uri"),h=i(d);n["default"]={eventHandler:l,getOptionsForWebItem:s,getWebItemPluginKey:r,getWebItemModuleKey:o},t.exports=n["default"]},{"../common/uri":9,"./dollar":20}],14:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){if(!e)throw new Error("ns undefined");return a["default"](document.getElementById("embedded-"+e))}function o(e){"object"!=typeof e.uiParams&&(e.uiParams=p["default"].fromUrl(e.src));var t=e.ns,n="embedded-"+t,i="channel-"+t,r=e.w||"100%",o=e.h||"0";"object"!=typeof e.uiParams&&(e.uiParams={}),e.general&&(e.uiParams.isGeneral=!0);var s={remote:e.src,remoteKey:e.key,container:n,channel:i,props:{width:r,height:o},uiParams:e.uiParams};e.productCtx&&!e.productContext&&(e.productContext=JSON.parse(e.productCtx)),d["default"].extend({init:function(n,i){i.analytics=u["default"].get(i.addonKey,t),i.analytics.iframePerformance.start(),i.productContext=e.productContext}}),d["default"].init(e,s)}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./dollar"),a=i(s),l=e("./analytics"),u=i(l),c=e("./rpc"),d=i(c),h=e("../common/ui-params"),p=i(h),f=e("./util"),m=(i(f),window.requestAnimationFrame||function(e){setTimeout(e,10)});n["default"]=function(e){function t(){return 0===r(e.ns).length&&10>n?void setTimeout(function(){n++,t()},50):void o(e)}var n=0;AJS.$.isReady?m(t):a["default"](t)},t.exports=n["default"]},{"../common/ui-params":8,"./analytics":12,"./dollar":20,"./rpc":30,"./util":32}],15:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){27===e.keyCode&&c&&c.hide&&(c.hide(),b["default"](document).unbind("keydown",r))}function o(e,t,n){function i(e){e.isEnabled()&&e.$el.trigger("ra.dialog.click",e.dispatch)}var r,o=["ap-aui-dialog2"];return n&&o.push("ap-aui-dialog2-chromeless"),r=b["default"](aui.dialog.dialog2({id:e.id,titleText:e.header,titleId:e.titleId,size:e.size,extraClasses:o,removeOnHide:!0,footerActionContent:!0,modal:!0})),n?r.find("header, footer").remove():(_.submit.setText(e.submitText),_.cancel.setText(e.cancelText),r.find(".aui-dialog2-footer-actions").empty().append(_.submit.$el,_.cancel.$el)),r.find(".aui-dialog2-content").append(t),t.data("ra.dialog.buttons",_),b["default"].each(_,function(e,t){t.$el.click(function(){i(t)})}),r}function s(e,t){e.append('<div id="embedded-'+t.ns+'" class="ap-dialog-container ap-content" />')}function a(e,t){if("string"==typeof e){var n=e.indexOf("%")===e.length-1;e=parseInt(e,10),n&&(e=e/100*t)}return e}function l(){u&&(u.trigger("ra.iframe.destroy").removeData("ra.dialog.buttons").unbind(),u=null),c.hide()}Object.defineProperty(n,"__esModule",{value:!0});var u,c,d,h=e("../create"),p=i(h),f=e("./button"),m=i(f),g=e("../status-helper"),v=i(g),y=e("../dollar"),b=i(y),w=b["default"](window),x=0,_={submit:m["default"].submit({done:l}),cancel:m["default"].cancel({done:l})};n["default"]={id:d,getButton:function(e){var t=u?u.data("ra.dialog.buttons"):null;return e&&t?t[e]:t},create:function(e,t){var n,i={width:"50%",height:"50%"},d=e.id||"ap-dialog-"+(x+=1),h=b["default"].extend({id:d},i,e,{dlg:1});"100%"===h.width&&"100%"===h.height&&(h.size="maximum"),h.w=a(h.width,w.width()),h.h=a(h.height,w.height()),u=b["default"]("<div />").addClass("ap-servlet-placeholder ap-container").attr("id","ap-"+e.ns).bind("ra.dialog.close",l),n=e.chrome?o(h,u):o(h,u,!0),e.size?(h.w="100%",h.h="100%"):(AJS.layer(n).changeSize(h.w,h.h),n.removeClass("aui-dialog2-medium")),c=AJS.dialog2(n),c.on("hide",l),b["default"](document).on("keydown",r),s(u,h),t!==!1&&u.append(v["default"].createStatusMessages()),e.src&&p["default"](h),c.show()},close:l},t.exports=n["default"]},{"../create":14,"../dollar":20,"../status-helper":31,"./button":17}],16:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../content"),o=i(r),s=e("./api"),a=(i(s),e("./factory")),l=i(a),u=e("../dollar"),c=i(u);n["default"]=function(){function e(e,t){var n=o["default"].getOptionsForWebItem(t.bindTo),i=o["default"].getWebItemModuleKey(t.bindTo),r=o["default"].getWebItemPluginKey(t.bindTo);c["default"].extend(t,n),t.ns||(t.ns=i),t.container||(t.container=t.ns),"string"==typeof t.chrome&&(t.chrome="false"===t.chrome.toLowerCase()?!1:!0),void 0===t.chrome&&(t.chrome=!0),l["default"]({key:r,moduleKey:i},t,t.productContext)}var t="click",n=".ap-dialog";o["default"].eventHandler(t,n,e)},t.exports=n["default"]},{"../content":13,"../dollar":20,"./api":15,"./factory":18}],17:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){this.$el=s["default"]("<button />").text(e.text).addClass("aui-button aui-button-"+e.type).addClass(e.additionalClasses),this.isEnabled=function(){return!("true"===this.$el.attr("aria-disabled"))},this.setEnabled=function(t){return e.noDisable===!0?!1:(this.$el.attr("aria-disabled",!t),!0)},this.setEnabled(!0),this.click=function(e){e?this.$el.bind("ra.dialog.click",e):this.dispatch(!0)},this.dispatch=function(t){var n=t?"done":"fail";e.actions&&e.actions[n]&&e.actions[n]()},this.setText=function(e){e&&this.$el.text(e)}}Object.defineProperty(n,"__esModule",{value:!0});var o=e("../dollar"),s=i(o);n["default"]={submit:function(e){return new r({type:"primary",text:"Submit",additionalClasses:"ap-dialog-submit",actions:e})},cancel:function(e){return new r({type:"link",text:"Cancel",noDisable:!0,additionalClasses:"ap-dialog-cancel",actions:e})}},t.exports=n["default"]},{"../dollar":20}],18:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r),s=e("../dollar"),a=i(s);n["default"]=function(e,t,n){var i,r,s=a["default"].extend({isDialog:1},e.uiParams);if(o["default"].create({id:e.id,ns:e.moduleKey||e.key,chrome:t.chrome||e.chrome,header:t.header,width:t.width,height:t.height,size:t.size,submitText:t.submitText,cancelText:t.cancelText},!1),r=a["default"](".ap-dialog-container"),e.url)throw new Error("Cannot retrieve dialog content by URL");return i=window._AP.contentResolver.resolveByParameters({addonKey:e.key,moduleKey:e.moduleKey,productContext:n,uiParams:s}),i.done(function(e){var t=a["default"](e);t.addClass("ap-dialog-container"),r.replaceWith(t)}).fail(function(e,t,n){var i=a["default"]('<p class="title" />').text("Unable to load add-on content. Please try again later.");r.html('<div class="aui-message error ap-aui-message"></div>'),r.find(".error").append(i);var o=t+(n?": "+n.toString():"");r.find(".error").text(o),AJS.log(o)}),o["default"]},t.exports=n["default"]},{"../dollar":20,"./api":15}],19:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r),s=e("./factory"),a=i(s),l=e("../dollar"),u=i(l);n["default"]=function(){return{stubs:["dialogMessage"],init:function(e,t){if("1"===e.dlg&&(t.uiParams.isDialog=!0),t.uiParams.isDialog){var n=o["default"].getButton();n&&u["default"].each(n,function(e,n){n.click(function(n,i){t.isActive()&&t.buttonListenerBound?t.dialogMessage(e,i):i(!0)})})}},internals:{dialogListenerBound:function(){this.buttonListenerBound=!0},setDialogButtonEnabled:function(e,t){o["default"].getButton(e).setEnabled(t)},isDialogButtonEnabled:function(e,t){var n=o["default"].getButton(e);t(n?n.isEnabled():void 0)},createDialog:function(e){var t={key:this.addonKey};if(e.key)t.moduleKey=e.key;else if(e.url)throw new Error("Cannot open dialog by URL, please use module key");if(0!==u["default"](".aui-dialog2 :visible").length)throw new Error("Cannot open dialog when a layer is already visible");a["default"](t,e,this.productContext)},closeDialog:function(){this.events.emit("ra.iframe.destroy"),o["default"].close()}}}},t.exports=n["default"]},{"../dollar":20,"./api":15,"./factory":18}],20:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=AJS.$,t.exports=n["default"]},{}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=function(){return{internals:{getLocation:function(){return window.location.href}}}},t.exports=n["default"]},{}],22:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../content"),o=i(r),s=e("./simple"),a=i(s),l=e("../dollar"),u=i(l);n["default"]=function(){function e(e,t,n){var i=o["default"].getOptionsForWebItem(t.bindTo);u["default"].extend(t,i),("true"===t.onHover||"click"===n)&&(t.onHover===!0&&t.bindTo.hasClass("active")||a["default"](e,t).show())}var t=".ap-inline-dialog",n="click mouseover mouseout";o["default"].eventHandler(n,t,e)},t.exports=n["default"]},{"../content":13,"../dollar":20,"./simple":24}],23:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return e.closest(".contents").data("inlineDialog")}function o(e,t,n){e.closest(".contents").css({width:t,height:n}),s(e)}function s(e){r(e).refresh()}function a(e){r(e).hide()}Object.defineProperty(n,"__esModule",{value:!0});var l=e("../dollar"),u=i(l);n["default"]=function(){return{init:function(e,t){t.uiParams.isInlineDialog&&u["default"](t.iframe).closest(".ap-container").on("resized",function(e,n){o(u["default"](t.iframe),n.width,n.height)})},internals:{hideInlineDialog:function(){a(u["default"](this.iframe))}}}},t.exports=n["default"]},{"../dollar":20}],24:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("../dollar"),o=i(r),s=e("../content"),a=i(s);n["default"]=function(e,t){function n(e,n,r){n=o["default"](n),e.data("inlineDialog",i);var s=a["default"].getWebItemPluginKey(n),l=a["default"].getWebItemModuleKey(n),u=window._AP.contentResolver.resolveByParameters({addonKey:s,moduleKey:l,isInlineDialog:!0,productContext:t.productContext,uiParams:{isInlineDialog:!0}});u.done(function(n){e.empty().append(n),(t.width||t.height)&&e.css({width:t.width,height:t.height})}).fail(function(t,n,i){var r=o["default"]('<p class="title" />').text("Unable to load add-on content. Please try again later.");e.html('<div class="aui-message error ap-aui-message"></div>'),e.find(".error").append(r);var s=n+(i?": "+i.toString():"");e.find(".error").text(s),AJS.log(s)}).always(function(){r()})}var i;if(t.bindTo&&t.bindTo.jquery){var r=t.bindTo.hasClass("ap-inline-dialog")?t.bindTo:t.bindTo.closest(".ap-inline-dialog"),s=r.attr("id");if(s){var l="ap-inline-dialog-content-"+s;return i=o["default"](document.getElementById("inline-dialog-"+l)),0!==i.length&&i.remove(),i=AJS.InlineDialog(t.bindTo,l,n,t),{id:i.attr("id"),show:function(){i.show()},hide:function(){i.hide()}}}}},t.exports=n["default"]},{"../content":13,"../dollar":20}],25:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){var t=s["default"].Deferred(function(t){var n=window._AP.contentResolver.resolveByParameters({addonKey:e.addonKey,moduleKey:e.moduleKey,productContext:e.productContext,uiParams:e.uiParams,width:e.width,height:e.height,classifier:"json"});n.done(function(e){var n=JSON.parse(e);t.resolve(n.src)})});return t}Object.defineProperty(n,"__esModule",{value:!0});var o=e("./dollar"),s=i(o),a=e("../common/jwt"),l=i(a);n["default"]={updateUrl:r,isExpired:l["default"].isJwtExpired},t.exports=n["default"]},{"../common/jwt":7,"./dollar":20}],26:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),s=e("./rpc"),a=(i(s),e("./status-helper")),l=i(a);n["default"]=function(){return{init:function(e,t){var n=o["default"](t.iframe).closest(".ap-container");l["default"].showLoadingStatus(n,0),n.find(".ap-load-timeout a.ap-btn-cancel").click(function(){l["default"].showLoadErrorStatus(n),t.analytics&&t.analytics.iframePerformance&&t.analytics.iframePerformance.cancel()}),t.timeout=setTimeout(function(){t.timeout=null,l["default"].showloadTimeoutStatus(n),t.isActive()&&t.analytics&&t.analytics.iframePerformance&&t.analytics.iframePerformance.timeout()},2e4)},internals:{init:function(){this.analytics&&this.analytics.iframePerformance&&this.analytics.iframePerformance.end();var e=o["default"](this.iframe).closest(".ap-container");l["default"].showLoadedStatus(e),clearTimeout(this.timeout),e.find(".ap-content").addClass("iframe-init")}}}},t.exports=n["default"]},{"./dollar":20,"./rpc":30,"./status-helper":31}],27:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return 0==e.search(/^ap\-message\-[0-9]+$/)}function o(){var e=l["default"]("#"+u);return e.length<1&&(e=l["default"]('<div id="'+u+'" />').appendTo("body")),e}function s(e){var t,n,i={},r=["closeable","fadeout","delay","duration","id"];for(t in r)n=r[t],n in e&&(i[n]=e[n]);return i}Object.defineProperty(n,"__esModule",{value:!0});var a=e("../dollar"),l=i(a),u="ac-message-container",c=["generic","error","warning","success","info","hint"];n["default"]={showMessage:function(e,t,n,i){var a=o();if(i=s(i),l["default"].extend(i,{title:t,body:AJS.escapeHtml(n)}),l["default"].inArray(e,c)<0)throw"Invalid message type. Must be: "+c.join(", ");r(i.id)&&(AJS.messages[e](a,i),a.css("margin-left","-"+a.innerWidth()/2+"px"))},clearMessage:function(e){r(e)&&l["default"]("#"+e).remove()}},t.exports=n["default"]},{"../dollar":20}],28:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r);n["default"]=function(){return{internals:{showMessage:function(e,t,n,i){return o["default"].showMessage(e,t,n,i)},clearMessage:function(e){return o["default"].clearMessage(e)}}}},t.exports=n["default"]},{"./api":27}],29:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});{var r=e("./dollar"),o=i(r),s=e("./rpc");i(s)}n["default"]=function(){return{init:function(e,t){t.resize=AJS.debounce(function(e,t,n){e(this.iframe).css({width:t,height:n});var i=e(this.iframe).closest(".ap-container");i.trigger("resized",{width:t,height:n})})},internals:{resize:function(e,t){this.uiParams.isDialog||this.resize(o["default"],e,t)},sizeToParent:AJS.debounce(function(){function e(e){var t=o["default"](document).height()-o["default"]("#header > nav").outerHeight()-o["default"]("#footer").outerHeight()-20;o["default"](e).css({width:"100%",height:t+"px"})}this.uiParams.isGeneral?(o["default"](this.iframe).addClass("full-size-general-page"),o["default"](window).on("resize",function(){e(this.iframe)}),e(this.iframe)):o["default"](this.iframe).addClass("full-size-general-page-fail")})}}},t.exports=n["default"]},{"./dollar":20,"./rpc":30}],30:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./dollar"),o=i(r),s=e("../common/xdm-rpc"),a=i(s),l=e("./jwt-keep-alive"),u=i(l),c=e("../common/uri"),d=i(c),h=o["default"].each,p=o["default"].extend,f=o["default"].isFunction,m=[],g={},v=[],y={},b=[];
n["default"]={extend:function(e){f(e)&&(e=e()),p(g,e.apis),p(y,e.internals),v=v.concat(e.stubs||[]);var t=e.init;return f(t)&&b.push(t),e.apis},init:function(e,t){var n,i=new d["default"].init(t.remote),r=i.getQueryParamValue("jwt");e=e||{},h(g,function(e){v.push(e)}),r&&u["default"].isExpired(r)&&(n=u["default"].updateUrl({addonKey:t.remoteKey,moduleKey:e.ns,productContext:e.productContext||{},uiParams:t.uiParams,width:t.props.width,height:t.props.height})),o["default"].when(n).always(function(n){n&&(t.remote=n);var i=new a["default"](o["default"],t,{remote:v,local:o["default"].extend({},y)});m[i.id]=i,h(b,function(t,n){try{n(p({},e),i)}catch(r){console.log(r)}})})}},t.exports=n["default"]},{"../common/uri":9,"../common/xdm-rpc":10,"./dollar":20,"./jwt-keep-alive":25}],31:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){e.data("loadingStatusTimer")&&(clearTimeout(e.data("loadingStatusTimer")),e.removeData("loadingStatusTimer")),e.find(".ap-status").addClass("hidden")}function o(e,t){r(e),e.closest(".ap-container").removeClass("hidden"),e.find(".ap-stats").removeClass("hidden"),e.find(".ap-"+t).removeClass("hidden"),setTimeout(function(){var n=e.find(".small-spinner",".ap-"+t);n.length&&n.spin&&n.spin({lines:12,length:3,width:2,radius:3,trail:60,speed:1.5,zIndex:1})},10)}function s(e){r(e)}function a(e,t){if(t){var n=setTimeout(o.bind(null,e,"loading"),t);e.data("loadingStatusTimer",n)}else o(e,"loading")}function l(e){o(e,"load-timeout")}function u(e){o(e,"load-error")}function c(){var e,t=h["default"]('<div class="ap-stats" />');for(e in p){var n=h["default"]('<div class="ap-'+e+' ap-status hidden" />');n.append("<small>"+p[e].descriptionHtml+"</small>"),t.append(n)}return t}Object.defineProperty(n,"__esModule",{value:!0});var d=e("./dollar"),h=i(d),p={loading:{descriptionHtml:'<div class="small-spinner"></div>Loading add-on...'},"load-timeout":{descriptionHtml:'<div class="small-spinner"></div>Add-on is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?'},"load-error":{descriptionHtml:"Add-on failed to load."}};n["default"]={createStatusMessages:c,showLoadingStatus:a,showloadTimeoutStatus:l,showLoadErrorStatus:u,showLoadedStatus:s},t.exports=n["default"]},{"./dollar":20}],32:[function(e,t,n){"use strict";function i(e){if(!e)throw new Error("No selector to escape");return e.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={escapeSelector:i},t.exports=n["default"]},{}]},{},[1])(1)}),define("django-connect/content-resolver",["jquery"],function(e){function t(e){return"/!api/plugins/servlet/ac/"+encodeURIComponent(e)}return{resolveByUrl:function(t){var n=e.Deferred(function(e){e.resolve(t)}).promise();return n},resolveByParameters:function(n){return e.ajax(t(n.moduleKey),{dataType:"html",data:{"product-context":JSON.stringify(n.productContext),key:n.moduleKey,uiParams:JSON.stringify(n.uiParams),width:n.width||"100%",height:n.height||"100%",classifier:n.classifier||"raw"}})}}}),define("django-connect/connect-views",["jquery","atlassian-connect-js/dist/connect-host","./content-resolver"],function(e,t,n){function i(t,n){return t=t||{},void 0!==t.containers?t.containers:void 0!==t.context?t.context.find(n):e(n)}function r(n){function r(e,t){var n=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return n?n[1]||"":""}var o=i(n,".ap-container");o.each(function(){var n=e(this).data("source"),i=e(this).data("width"),o=e(this).data("height"),s=r(n,"xdm_c").replace(/^channel-/,""),a={ns:s,key:e(this).data("key"),dlg:e(this).data("dlg"),general:e(this).data("general"),src:n,cp:e(this).data("cp")||"",productCtx:JSON.stringify({encContext:e(this).data("enc-context")})};i&&(a.w=i),o&&(a.h=o),e(this).attr("id","ap-"+s),e(this).find(".ap-content").attr("id","embedded-"+s),t.create(a)})}function o(e){var t=i(e,".ap-container-onload");t.removeClass("ap-container-onload").addClass("ap-container"),r({containers:t})}return window._AP.contentResolver=n,{init:r,initOnload:o}}),define("js/connect/host/dingle",["jquery","store","atlassian-connect-js/dist/connect-host"],function(e,t,n){function i(e){return e.split(" ").filter(s.test.bind(s)).join(" ")}var r="stp-icon-set",o=t.get(r),s=/^(aui-|ace-stp-)/i,a=e("#ace-stp-menu-icon");o&&a.removeClass().addClass(i(o)),n.extend(function(){function n(t,n){e("#super-touch-point-dialog").on("aui-layer-show",function(){n.notify("show")}).on("aui-layer-hide",function(){n.notify("hide")})}function o(e){a.removeClass().addClass(i(e))}function s(e){e&&""!==e?t.set(r,e):t.remove(r)}return{init:n,internals:{setTouchPointClasses:o,cacheTouchPointClasses:s},stubs:["notify"]}})}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("bower/atlassian-connect-js-history/dist/connect-host-history",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.connectHostHistory=e()}}(function(){var e;return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return r(n?n:t)},c,c.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./rpc"),o=i(r);n["default"]=o["default"],t.exports=n["default"]},{"./rpc":5}],2:[function(t,n){!function(t){function i(e){return e&&(e=e.toString().replace(a.pluses,"%20"),e=decodeURIComponent(e)),e}function r(e){var t=a.uri_parser,n=["source","protocol","authority","userInfo","user","password","host","port","isColonUri","relative","path","directory","file","query","anchor"],i=t.exec(e||""),r={};return n.forEach(function(e,t){r[e]=i[t]||""}),r}function o(e){var t,n,r,o,s,l,u,c=[];if("undefined"==typeof e||null===e||""===e)return c;for(0===e.indexOf("?")&&(e=e.substring(1)),n=e.toString().split(a.query_separator),t=0,u=n.length;u>t;t++)r=n[t],o=r.indexOf("="),0!==o&&(s=i(r.substring(0,o)),l=i(r.substring(o+1)),c.push(-1===o?[r,null]:[s,l]));return c}function s(e){this.uriParts=r(e),this.queryPairs=o(this.uriParts.query),this.hasAuthorityPrefixUserPref=null}var a={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*)(?::([^:@]*))?)?@)?(\[[0-9a-fA-F:.]+\]|[^:\/?#]*)(?::(\d+|(?=:)))?(:)?)((((?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};Array.prototype.forEach||(Array.prototype.forEach=function(e,t){var n,i;if(null==this)throw new TypeError(" this is null or not defined");var r=Object(this),o=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),i=0;o>i;){var s;i in r&&(s=r[i],e.call(n,s,i,r)),i++}}),["protocol","userInfo","host","port","path","anchor"].forEach(function(e){s.prototype[e]=function(t){return"undefined"!=typeof t&&(this.uriParts[e]=t),this.uriParts[e]}}),s.prototype.hasAuthorityPrefix=function(e){return"undefined"!=typeof e&&(this.hasAuthorityPrefixUserPref=e),null===this.hasAuthorityPrefixUserPref?-1!==this.uriParts.source.indexOf("//"):this.hasAuthorityPrefixUserPref},s.prototype.isColonUri=function(e){return"undefined"==typeof e?!!this.uriParts.isColonUri:void(this.uriParts.isColonUri=!!e)},s.prototype.query=function(e){var t,n,i,r="";for("undefined"!=typeof e&&(this.queryPairs=o(e)),t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],r.length>0&&(r+="&"),null===n[1]?r+=n[0]:(r+=n[0],r+="=","undefined"!=typeof n[1]&&(r+=encodeURIComponent(n[1])));return r.length>0?"?"+r:r},s.prototype.getQueryParamValue=function(e){var t,n,i;for(n=0,i=this.queryPairs.length;i>n;n++)if(t=this.queryPairs[n],e===t[0])return t[1]},s.prototype.getQueryParamValues=function(e){var t,n,i,r=[];for(t=0,i=this.queryPairs.length;i>t;t++)n=this.queryPairs[t],e===n[0]&&r.push(n[1]);return r},s.prototype.deleteQueryParam=function(e,t){var n,r,o,s,a,l=[];for(n=0,a=this.queryPairs.length;a>n;n++)r=this.queryPairs[n],o=i(r[0])===i(e),s=r[1]===t,(1!==arguments.length||o)&&(2!==arguments.length||o&&s)||l.push(r);return this.queryPairs=l,this},s.prototype.addQueryParam=function(e,t,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,this.queryPairs.length),this.queryPairs.splice(n,0,[e,t])):arguments.length>0&&this.queryPairs.push([e,t]),this},s.prototype.hasQueryParam=function(e){var t,n=this.queryPairs.length;for(t=0;n>t;t++)if(this.queryPairs[t][0]==e)return!0;return!1},s.prototype.replaceQueryParam=function(e,t,n){var r,o,s=-1,a=this.queryPairs.length;if(3===arguments.length){for(r=0;a>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)&&decodeURIComponent(o[1])===i(n)){s=r;break}s>=0&&this.deleteQueryParam(e,i(n)).addQueryParam(e,t,s)}else{for(r=0;a>r;r++)if(o=this.queryPairs[r],i(o[0])===i(e)){s=r;break}this.deleteQueryParam(e),this.addQueryParam(e,t,s)}return this},["protocol","hasAuthorityPrefix","isColonUri","userInfo","host","port","path","query","anchor"].forEach(function(e){var t="set"+e.charAt(0).toUpperCase()+e.slice(1);s.prototype[t]=function(t){return this[e](t),this}}),s.prototype.scheme=function(){var e="";return this.protocol()?(e+=this.protocol(),this.protocol().indexOf(":")!==this.protocol().length-1&&(e+=":"),e+="//"):this.hasAuthorityPrefix()&&this.host()&&(e+="//"),e},s.prototype.origin=function(){var e=this.scheme();return this.userInfo()&&this.host()&&(e+=this.userInfo(),this.userInfo().indexOf("@")!==this.userInfo().length-1&&(e+="@")),this.host()&&(e+=this.host(),(this.port()||this.path()&&this.path().substr(0,1).match(/[0-9]/))&&(e+=":"+this.port())),e},s.prototype.addTrailingSlash=function(){var e=this.path()||"";return"/"!==e.substr(-1)&&this.path(e+"/"),this},s.prototype.toString=function(){var e,t=this.origin();return this.isColonUri()?this.path()&&(t+=":"+this.path()):this.path()?(e=this.path(),a.ends_with_slashes.test(t)||a.starts_with_slashes.test(e)?(t&&t.replace(a.ends_with_slashes,"/"),e=e.replace(a.starts_with_slashes,"/")):t+="/",t+=e):this.host()&&(this.query().toString()||this.anchor())&&(t+="/"),this.query().toString()&&(t+=this.query().toString()),this.anchor()&&(0!==this.anchor().indexOf("#")&&(t+="#"),t+=this.anchor()),t},s.prototype.clone=function(){return new s(this.toString())},"function"==typeof e&&e.amd?e(function(){return s}):"undefined"!=typeof n&&"undefined"!=typeof n.exports?n.exports=s:t.Uri=s}(this)},{}],3:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function r(e){return void 0===e||null===e?"":e.toString().replace(new RegExp("^"+g),"")}function o(e){if(void 0===e||null===e)throw"You must supply text to prefix";return g+r(e)}function s(e,t){var n=new m["default"].init(window.location.href),i=new m["default"].init(window.location.href);return i.anchor(o(e)),i.anchor()!==n.anchor()?(p=i.anchor(),t?window.location.replace("#"+i.anchor()):window.location.assign("#"+i.anchor()),i.anchor()):void 0}function a(e){s(e)}function l(e){s(e,!0)}function u(e){history.go(e)}function c(e,t){var n=new m["default"].init(e.newURL),i=new m["default"].init(e.oldURL);n.anchor()!==i.anchor()&&p!==n.anchor()&&t(d(e)),p=null}function d(e){return{newURL:r(new m["default"].init(e.newURL).anchor()),oldURL:r(new m["default"].init(e.oldURL).anchor())}}function h(){var e=new m["default"].init(window.location.href),t=r(e.anchor());return t}Object.defineProperty(n,"__esModule",{value:!0});var p,f=e("./uri"),m=i(f),g="!";n["default"]={pushState:a,replaceState:l,go:u,hashChange:c,getState:h},t.exports=n["default"]},{"./uri":6}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=AJS.$,t.exports=n["default"]},{}],5:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r),s=e("./dollar"),a=i(s);n["default"]=function(){return{init:function(e,t){e.uiParams.isGeneral&&a["default"](window).on("hashchange",function(e){o["default"].hashChange(e.originalEvent,t.historyMessage)})},internals:{historyPushState:function(e){return this.uiParams.isGeneral?o["default"].pushState(e):void AJS.log("History is only available to page modules")},historyReplaceState:function(e){return this.uiParams.isGeneral?o["default"].replaceState(e):void AJS.log("History is only available to page modules")},historyGo:function(e){return this.uiParams.isGeneral?o["default"].go(e):void AJS.log("History is only available to page modules")}},stubs:["historyMessage"]}},t.exports=n["default"]},{"./api":3,"./dollar":4}],6:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("jsuri"),o=i(r);n["default"]={init:o["default"]},t.exports=n["default"]},{jsuri:2}]},{},[1])(1)}),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("bower/atlassian-connect-js-cookie/dist/connect-host-cookie",[],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.connectHostCookie=e()}}(function(){return function e(t,n,i){function r(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n?n:e)},c,c.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./rpc"),o=i(r);n["default"]=o["default"],t.exports=n["default"]},{"./rpc":3}],2:[function(e,t,n){"use strict";function i(e,t){if(!e||0===e.length)throw new Error("addon key must be defined on cookies");if(!t||0===t.length)throw new Error("Name must be defined");return e+"$$"+t}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]={saveCookie:function(e,t,n,r){AJS.Cookie.save(i(e,t),n,r)},readCookie:function(e,t,n){var r=AJS.Cookie.read(i(e,t));"function"==typeof n&&n(r)},eraseCookie:function(e,t){AJS.Cookie.erase(i(e,t))}},t.exports=n["default"]},{}],3:[function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(n,"__esModule",{value:!0});var r=e("./api"),o=i(r);n["default"]=function(){return{internals:{saveCookie:function(e,t,n){o["default"].saveCookie(this.addonKey,e,t,n)},readCookie:function(e,t){o["default"].readCookie(this.addonKey,e,t)},eraseCookie:function(e){o["default"].eraseCookie(this.addonKey,e)}}}},t.exports=n["default"]},{"./api":2}]},{},[1])(1)}),define("js/connect/host/index",["atlassian-connect-js/dist/connect-host","bower/atlassian-connect-js-history/dist/connect-host-history","bower/atlassian-connect-js-cookie/dist/connect-host-cookie"],function(e,t,n){return e.extend(t),e.extend(n),e}),define("text!js/connect/host/request-access-token/access-request.mustache",[],function(){return'<p>[[&accessRequestLabel]]</p>\n<ul class="access-request-scopes-list">\n  [[#scopes]]\n    <li>[[description]]</li>\n  [[/scopes]]\n</ul>\n<ul class="aui-nav-actions-list">\n  <li>\n    <button class="grant-access-button aui-button aui-button-link">\n      [[grantAccessLabel]]\n    </button>\n  </li>\n  <li>\n    <button class="deny-access-button aui-button aui-button-link">\n      [[denyAccessLabel]]\n    </button>\n  </li>\n</ul>\n'}),define("text!js/connect/host/request-access-token/access-granted.mustache",[],function(){return'<p>[[&accessGrantedLabel]]</p>\n<ul class="aui-nav-actions-list">\n  <li><a href="/account/user/[[username]]/api">[[managePermissionsLabel]]</a></li>\n</ul>\n'}),define("text!js/connect/host/request-access-token/access-denied.mustache",[],function(){return'<p>[[&accessDeniedLabel]]</p>\n<ul class="aui-nav-actions-list">\n  <li><a href="/account/user/[[username]]/api">[[managePermissionsLabel]]</a></li>\n</ul>\n'}),define("js/connect/host/request-access-token/index",["aui","jquery","mustache","underscore","data/current-user","atlassian-connect-js/dist/connect-host","utils/get-scopes","text!js/connect/host/request-access-token/access-request.mustache","text!js/connect/host/request-access-token/access-granted.mustache","text!js/connect/host/request-access-token/access-denied.mustache"],function(e,t,n,i,r,o,s,a,l,u){function c(e,t){var n=gettext("The add-on <strong>%(addon_name)s</strong> is requesting access to:");return a({scopes:t,accessRequestLabel:interpolate(n,{addon_name:i.escape(e)},!0),grantAccessLabel:gettext("Grant access"),denyAccessLabel:gettext("Deny access")}).trim()}function d(e){var t=gettext("The add-on <strong>%(addon_name)s</strong> has been granted access.");return l({accessGrantedLabel:interpolate(t,{addon_name:i.escape(e)},!0),managePermissionsLabel:gettext("Manage permissions"),username:r.username}).trim()}function h(e){var t=gettext("The add-on <strong>%(addon_name)s</strong> has been denied access.");return u({accessDeniedLabel:interpolate(t,{addon_name:i.escape(e)},!0),managePermissionsLabel:gettext("Manage permissions"),username:r.username}).trim()}function p(e,n){function i(e){var t={code:e,message:m[e]};g[p].fail.forEach(function(e){e(t)}),delete g[p]}function o(e,t){g[p].success.forEach(function(n){n({accessToken:e,refreshToken:t})}),delete g[p]}function a(e){o(e.access_token,e.refresh_token),v&&(v.close(),require(["aui/flag"],function(e){e({close:"auto",type:"success",body:d(b)})}))}function l(){i("access_token_request_failed"),v&&v.close()}function u(e){var n={url:"/site/oauth2/access_token",type:"POST",data:{client_id:w,grant_type:"urn:bitbucket:oauth2:session",redirect_uri:T,disallow_creation:e}};t.ajax(n).done(a).fail(l)}var p=this.addonKey;if(g[p])return g[p].success.push(e),void g[p].fail.push(n);g[p]={},g[p].success=[e],g[p].fail=[n];var v,y=t(this.iframe).closest(".ap-container"),b=y.attr("data-name"),w=y.attr("data-client-id"),x=y.attr("data-scopes"),_=y.data("userHasDenied"),k=y.attr("data-refresh-token"),C=y.attr("data-access-token"),S=y.data("accessTokenExpiresIn"),$=y.attr("data-callback-url"),T=this.iframe.src;x=x?x.split(" "):[];var A=S?f+1e3*S:null;return r.isAuthenticated?w?_?void i("user_already_denied_access"):0!==T.indexOf($)?void i("frame_src_consumer_callback_mismatch"):void(C&&k?A>Date.now()?o(C,k):u(!0):require(["aui/flag"],function(e){s(x).done(function(n){function r(){u()}function o(){v.close(),e({close:"auto",type:"error",body:h(b)}),i("user_denied_access")}v=e({type:"info",close:"never",body:c(b,n)}),t(v).on("click",".grant-access-button",r).on("click",".deny-access-button",o)})})):void i("no_oauth_consumer_client_id"):void i("user_not_authenticated")}a=n.compile(a),l=n.compile(l),u=n.compile(u);var f=Date.now(),m={user_not_authenticated:gettext("User is not authenticated"),access_token_request_failed:gettext("Request for access token failed"),no_oauth_consumer_client_id:gettext("Add-on does not have an OAuth consumer client ID"),user_already_denied_access:gettext("User has already denied access to add-on"),user_denied_access:gettext("User denied access to add-on"),frame_src_consumer_callback_mismatch:gettext("Module URL must start with the OAuth consumer callback url")},g={};o.extend(function(){return{internals:{requestAccessToken:p}}})}),define("js/connect/connect-views",["jquery","django-connect/connect-views","js/connect/host/dingle","js/connect/host/index","js/connect/host/request-access-token/index","utils/on-load"],function(e,t,n,i,r,o){e(document).ready(t.init),e(document).on("pjax:end",function(n){var i=e(n.target);t.init({context:i}),t.initOnload({context:i})}),o(t.initOnload)}),define("js/connect/super-touch-point",["django-connect/connect-views"],function(e){$(function(){$("#super-touch-point-dialog").on("aui-layer-show",function(t){e.initOnload({context:$(t.target)})})})}),define("js/components/omnibar/extensions/issue-actions",["jquery","js/components/omnibar/base-extension"],function(e,t){return t.extend({label:gettext("Issue actions"),minQueryLength:0,maxResults:!1,data:function(){var t=e("#issue-vote-count").hasClass("aui-badge-active"),n=e("#issue-watch-count").hasClass("aui-badge-active"),i=e("#issue-view").hasClass("is-spam"),r=[{label:gettext("Edit issue"),$el:e("#edit-issue")},{label:gettext(t?"Remove vote":"Vote for issue"),$el:e("#issue-vote-trigger")},{label:gettext(n?"Stop watching issue":"Watch issue"),$el:e("#issue-watch-trigger")},{label:gettext(i?"Approve issue":"Mark as spam"),$el:e("#issue-flag-spam")},{label:gettext("Delete issue"),$el:e("#issue-delete-link")},{label:gettext("Attach files"),$el:e(".issue-attach-link")}];return e("#workflow-dropdown li").each(function(){r.push({label:e(this).attr("title"),$el:e(this).find("a")})}),r},context:function(){return interpolate(gettext("Issue #%(issue_id)s"),{issue_id:this.options.localId},!0)}})}),define("js/issues/index",["on-ready","js/components/omnibar/extensions","js/components/omnibar/extensions/issue-actions"],function(e,t,n){return e(function(e){t.register(n,{weight:400,localId:e.attr("data-local-id")})})}),define("js/behaviors/disables-on-submission",["jquery","underscore","marionette"],function(e,t,n){return n.Behavior.extend({events:{submit:"disableSubmission"},disableSubmission:function(){e(this.el).find('[type="submit"]').attr("disabled",!0)}})}),define("js/login/login-form",["jquery","underscore","marionette","on-ready","js/behaviors/disables-on-submission"],function(e,t,n,i,r){return i(function(e){var t=n.ItemView.extend({behaviors:{disablesOnSubmission:{behaviorClass:r}}});new t({el:e})})}),define("js/marketplace/models/addon",["jquery","api/model"],function(e,t){return t.extend({apiVersion:"internal",validateDescriptor:function(){var t=this,n=t.get("url")||t.getDescriptorUrl();return e.ajax({url:t.urlRoot()+"/validate",data:{url:n},success:function(e){t.set("descriptor",e)}})},getDescriptorUrl:function(){var e=this.get("descriptor_url");if(!e){var t=this.get("links");e=t&&t.descriptor&&t.descriptor.source_url&&t.descriptor.source_url.href}return e},urlRoot:function(){return this.collection.urlRoot}})}),define("js/marketplace/collections/addons",["api/collection","api/cache/repositories","js/marketplace/models/addon"],function(e,t,n){return e.extend({apiVersion:"internal",model:n,parse:function(e){return e.values},initialize:function(e,n){if(this.connectContext=n.connectContext,"account"===this.connectContext)this.targetUser=n.targetUser,this.urlRoot="{}/account/{}/addons".format(this.getApiRoot(),this.targetUser);else{if("repository"!==this.connectContext)throw"No context provided.";this.repository=t.load(n.repositoryFullSlug),this.urlRoot="{}/repositories/{}/addons".format(this.getApiRoot(),this.repository.id)}},url:function(){return this.urlRoot+"?pagelen=100"}})}),define("js/marketplace/models/category",["backbone"],function(e){return e.Model.extend({})}),define("js/marketplace/collections/categories",["backbone","js/marketplace/models/category"],function(e,t){return e.Collection.extend({model:t})}),define("js/marketplace/views/addon-directory-list-item",["aui","marionette","underscore","js/connect/admin/views/confirm-scopes","js/marketplace/models/addon","utils/disable","utils/xhr-err-handler"],function(e,t,n,i,r,o,s){return t.ItemView.extend({template:"#addon-directory-list-item-template",tagName:"li",className:"directory-list-item boxed-list-item",ui:{installButton:".install-button"},events:{"click @ui.installButton":"installAddOn"},initialize:function(e){this.manageUrl=e.manageUrl,this.collection=e.collection,this.listenTo(this.model,"change:installed",this.render)},templateHelpers:function(){return{manageUrl:this.manageUrl}},displayInstalledMessage:function(t){var i=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been installed. You may need to refresh the page to see changes to navigation.'),{addOnName:n.escape(i)},!0);e.messages.success({body:r,fadeout:!0})},installAddOn:function(){var e=this,t=new r({url:e.model.get("descriptor_url")},{collection:this.collection}),n=e.ui.installButton.text();t.validateDescriptor().fail(s).fail(function(){e.ui.installButton.disable(!1,{text:n})}).done(function(r){i(t,{id:"install-addon",title:gettext("Install add-on"),buttonText:gettext("Install")}).fail(function(){e.ui.installButton.disable(!1,{text:n})}).done(function(){t.save({descriptor:r},{wait:!0,success:function(t){e.model.set({installed:!0}),e.displayInstalledMessage(t)},error:function(){e.ui.installButton.disable(!1,{text:n}),s.apply(e,arguments)}})})}),e.ui.installButton.disable(!0,{text:gettext("Installing")})}})}),define("js/marketplace/views/addon-directory-list",["marionette","underscore","js/marketplace/views/addon-directory-list-item"],function(e,t,n){return e.CollectionView.extend({childView:n,childViewOptions:function(){return{manageUrl:this.manageUrl,collection:this.collection}},addChild:function(n){(!this.category||t.contains(n.get("categories"),this.category))&&e.CollectionView.prototype.addChild.apply(this,arguments)},initialize:function(e){this.targetUser=e.targetUser,this.manageUrl=e.manageUrl},filterResults:function(e){this.category=e,this.render()}})}),define("js/marketplace/views/addon-filters",["aui","marionette"],function(e,t){return t.ItemView.extend({template:"#addon-filters-template",ui:{categoryFilter:".category-filter"},events:{"change @ui.categoryFilter":"categoryChangeHandler"},initialize:function(e){this.categories=e.categories},onRender:function(){this.ui.categoryFilter.auiSelect2()},serializeData:function(){return{categories:this.categories.toJSON()}},categoryChangeHandler:function(){this.trigger("change:category",this.ui.categoryFilter.val())}})}),define("js/marketplace/addon-directory",["on-ready","data/current-repo","js/marketplace/collections/addons","js/marketplace/collections/categories","js/marketplace/views/addon-directory-list","js/marketplace/views/addon-filters"],function(e,t,n,i,r,o){return e(function(e){var s=e.find(".addon-filters"),a=e.find(".directory-list"),l=new i(s.data("categories")),u=new n(a.data("addons"),{connectContext:"account",targetUser:a.attr("data-target-user"),repositoryFullSlug:t.fullslug}),c=new o({el:s,categories:l}),d=new r({el:a,collection:u,manageUrl:a.attr("data-manage-url")});c.render(),a.empty(),d.render(),c.on("change:category",function(e){d.filterResults(e)})})}),define("js/marketplace/views/addon-management-blank-slate",["marionette"],function(e){return e.ItemView.extend({template:"#addon-management-blank-slate-template",tagName:"li",className:"management-list-item boxed-list-item"})}),define("js/behaviors/expandable-boxed-list-item",["marionette"],function(e){return e.Behavior.extend({ui:{headingContent:".boxed-list-item-heading-content"},events:{"click @ui.headingContent":"headingHandler"},headingHandler:function(){this.triggerMethod("ToggleExpandedState")},onToggleExpandedState:function(){this.$el.toggleClass("boxed-list-item-expanded")}})}),define("js/marketplace/views/addon-management-list-item",["aui","marionette","underscore","components/confirm-dialog","js/behaviors/expandable-boxed-list-item","js/connect/admin/views/confirm-scopes","js/marketplace/models/addon","utils/xhr-err-handler","utils/disable"],function(e,t,n,i,r,o,s,a){return t.ItemView.extend({behaviors:{expandableBoxedListItem:{behaviorClass:r}},template:"#addon-management-list-item-template",tagName:"li",className:"management-list-item boxed-list-item",ui:{uninstallButton:".uninstall-button",updateButton:".update-button"},events:{"click @ui.uninstallButton":"uninstallAddOn","click @ui.updateButton":"updateAddOn"},templateHelpers:function(){return{logo:this.model.get("logo")||this.defaultLogo}},initialize:function(e){this.defaultLogo=e.defaultLogo},uninstallAddOn:function(e){e.preventDefault();var t=this,r=this.model,o=n.escape(r.get("name")),s=gettext('Are you sure you wish to uninstall the add-on "%(addOnName)s"?  You may lose any settings and this cannot be undone.'),l=interpolate(s,{addOnName:n.escape(o)},!0),u=interpolate(gettext('Add-on "%(addOnName)s" has been uninstalled. You may need to refresh the page to see changes to navigation.'),{addOnName:n.escape(o)},!0),c=this.ui.uninstallButton.text();i({id:"remove-addon",title:gettext("Uninstall add-on"),content:l,buttonText:gettext("Uninstall")}).fail(function(){t.ui.uninstallButton.disable(!1,{text:c})}).done(function(){r.destroy({wait:!0,success:function(){t.success(u)},error:function(){t.ui.uninstallButton.disable(!1,{text:c}),a.apply(t,arguments)}})}),t.ui.uninstallButton.disable(!0,{text:gettext("Uninstalling")})},updateAddOn:function(e){e.preventDefault();var t=this,i=this.model,r=n.escape(i.get("name")),s=gettext("Are you sure you wish to update the add-on %(addOnName)s?  The descriptor will be re-fetched from the same URL and this cannot be undone.  Any existing settings will remain."),l=interpolate(s,{addOnName:r},!0),u=interpolate(gettext('Add-on "%(addOnName)s" has been updated. You may need to refresh the page to see changes to navigation.'),{addOnName:r},!0),c=this.ui.updateButton.text();i.validateDescriptor(i.get("descriptor_url")).fail(a).done(function(){o(i,{id:"update-addon",title:gettext("Update add-on"),content:l,buttonText:gettext("Update")}).always(function(){t.ui.updateButton.disable(!1,{text:c})}).done(function(){i.save({},{url:i.url()+"/descriptor",data:JSON.stringify(i.get("descriptor")),wait:!0,success:function(){t.success(u)},error:function(){t.ui.updateButton.disable(!1,{text:c}),a.apply(t,arguments)}})})}),t.ui.updateButton.disable(!0,{text:gettext("Updating")})},success:function(t){e.messages.success({body:t,fadeout:!0})}})}),define("js/marketplace/views/addon-management-list",["marionette","underscore","js/marketplace/views/addon-management-blank-slate","js/marketplace/views/addon-management-list-item"],function(e,t,n,i){return e.CollectionView.extend({childView:i,childViewOptions:function(){return{defaultLogo:this.defaultLogo}},emptyView:n,addChild:function(n){(!this.category||t.contains(n.get("categories"),this.category))&&e.CollectionView.prototype.addChild.apply(this,arguments)},initialize:function(e){this.targetUser=e.targetUser,this.defaultLogo=e.defaultLogo,this.listenTo(this,"render remove:child",this.toggleBlankSlateClass)},toggleBlankSlateClass:function(){this.$el.toggleClass("blank-slate",0===this.collection.length)},filterResults:function(e){this.category=e,this.render()},toggleAddonExpandedState:function(e){this.children.findByModel(e).triggerMethod("ToggleExpandedState")}})}),define("js/marketplace/views/custom-addon-dialog",["aui","marionette","underscore","js/connect/admin/views/confirm-scopes","utils/xhr-err-handler"],function(e,t,n,i,r){return t.ItemView.extend({template:!1,ui:{dialogForm:".dialog-form",dialogCancelButton:".dialog-cancel-button",dialogInstallButton:".dialog-install-button",urlInput:"#custom-descriptor-url"},events:{"click @ui.dialogCancelButton":"cancelDialog","submit @ui.dialogForm":"installAddOn","click @ui.dialogInstallButton":"installAddOn"},initialize:function(e){this.bindUIElements(),this.dialog=e.dialog,this.collection=e.collection},cancelDialog:function(){this.clearUrlInput(),this.dialog.hide()},clearUrlInput:function(){this.ui.urlInput.val("")},installAddOn:function(e){e.preventDefault();var t=this,n=t.ui.urlInput.val(),o=new t.collection.model({url:n},{collection:t.collection});o.validateDescriptor().fail(r).done(function(e){t.dialog.hide(),i(o,{id:"install-addon",title:gettext("Install add-on"),buttonText:gettext("Install")}).done(function(){o.save({descriptor:e},{wait:!0,success:function(e){t.collection.add(e),t.clearUrlInput(),t.displayInstalledMessage(e)
},error:r})})})},displayInstalledMessage:function(t){var i=t.get("name"),r=interpolate(gettext('Add-on "%(addOnName)s" has been installed. You may need to refresh the page to see changes to navigation.'),{addOnName:n.escape(i)},!0);e.messages.success({body:r,fadeout:!0})}})}),define("js/marketplace/views/custom-addon-trigger",["aui","backbone","js/marketplace/views/custom-addon-dialog"],function(e,t,n){return t.View.extend({events:{"click .custom-addon-button":"showCustomAddonDialog"},showCustomAddonDialog:function(){this.dialog||(this.dialog=e.dialog2("#marketplace-custom-addon-dialog"),new n({el:this.dialog.$el,dialog:this.dialog,collection:this.collection})),this.dialog.show()}})}),define("js/marketplace/addon-management",["on-ready","data/current-repo","js/marketplace/collections/addons","js/marketplace/collections/categories","js/marketplace/views/addon-filters","js/marketplace/views/addon-management-list","js/marketplace/views/custom-addon-trigger","utils/query-params"],function(e,t,n,i,r,o,s,a){return e(function(e){var l=e.find(".addon-filters"),u=e.find(".management-list"),c=new i(l.data("categories")),d=new n(u.data("addons"),{connectContext:"account",targetUser:u.attr("data-target-user"),repositoryFullSlug:t.fullslug}),h=new r({el:l,categories:c}),p=(new s({el:e.find(".custom-addons"),collection:d}),new o({el:u,collection:d,defaultLogo:e.attr("data-default-logo")}));h.render(),u.empty(),p.render(),h.on("change:category",function(e){p.filterResults(e)});var f=d.findWhere({connection_key:a.get("addon")});f&&p.toggleAddonExpandedState(f)})}),define("js/components/omnibar/extensions/pull-request-actions",["jquery","js/components/omnibar/base-extension"],function(e,t){return t.extend({label:gettext("Pull request actions"),minQueryLength:0,maxResults:!1,initialize:function(e){t.prototype.initialize.apply(this,arguments),this.pullRequest=e.pullRequest},data:function(){var t=this.pullRequest.get("hasCurrentUserApproved"),n=this.pullRequest.get("isWatchedByCurrentUser"),i=[{label:gettext("Edit pull request"),$el:e("#edit-pullrequest")},{label:gettext(t?"Unapprove pull request":"Approve pull request"),$el:e("#approve-button")},{label:gettext(n?"Stop watching":"Watch"),$el:e("#watch-pullrequest a")},{label:gettext("Merge pull request"),$el:e("#fulfill-pullrequest:enabled")},{label:gettext("Decline pull request"),$el:e("#reject-pullrequest")}];return i},context:function(){return interpolate(gettext("Pull request #%(pull_request_id)s"),{pull_request_id:this.pullRequest.get("id")},!0)}})}),define("js/pullrequests/models/pullrequest",["jquery","backbone","js/pullrequests/events","js/pullrequests/collections/tasks","data/current-repo"],function(e,t,n,i,r){var o=!1;return t.Model.extend({defaults:{approvalCount:0,hasCurrentUserApproved:!1,isWatchedByCurrentUser:!1},urlRoot:"/!api/internal/repositories/{owner}/{slug}/pullrequests/".format({owner:r.owner.username,slug:r.slug}),initialize:function(){this.tasks=new i([],{pullrequest:this}),this.listenTo(n.vent,"updateApprovals",function(e){this.set("approvalCount",e)}),this.on("change:hasCurrentUserApproved",this._updateWatching,this),this.on("change:hasCurrentUserApproved",function(){n.vent.trigger("currentUserApproved")},this)},_sendRequest:function(t,n){return e.ajax({url:this.url()+(t?"/"+t:""),type:n?n:"GET"})},_setWatching:function(e){if(this.get("isWatchedByCurrentUser")!==e){var t=this._sendRequest("watch",e?"POST":"DELETE");return t.done(function(e){this.set("isWatchedByCurrentUser",e.watching)}.bind(this)),this.trigger("loading:isWatchedByCurrentUser",t),t}},_setApproved:function(e){if(this.get("hasCurrentUserApproved")!==e){var t=this._sendRequest("approve",e?"POST":"DELETE");return t.done(function(e){this.set("hasCurrentUserApproved",e.approved)}.bind(this)),this.trigger("loading:hasCurrentUserApproved",t),t}},_updateWatching:function(){var e=this._sendRequest("watch");this.trigger("loading:isWatchedByCurrentUser",e),e.done(function(e){this.set("isWatchedByCurrentUser",e.watching)}.bind(this))},approve:function(){this._setApproved(!0)},unapprove:function(){this._setApproved(!1)},watch:function(){this._setWatching(!0)},unwatch:function(){this._setWatching(!1)},fetchTasksOnce:function(){o||(o=!0,this.trigger("loading:tasks",this.tasks.fetch({remove:!1,data:{pagelen:100,fields:"values.comment.inline"}})))},createTask:function(t){var n=this.tasks.getUnsaved();n?n.trigger("edit"):t.content?this.tasks.create(e.extend({comment:t.comment},t)):this.tasks.add(e.extend({comment:t.comment},t))}})}),define("js/pullrequests/views/approve",["marionette","utils/disable","utils/loading"],function(e){return e.ItemView.extend({template:"#pullrequest-approve-button-template",modelEvents:{"change:hasCurrentUserApproved":"render","change:approvalCount":"render","loading:hasCurrentUserApproved":"loading"},events:{"click @ui.$button":"toggleApproval"},ui:{$button:"#approve-button"},initialize:function(e){this.mergeOptions(e,["showCount"])},templateHelpers:function(){return{showApprovalCount:this.showCount}},toggleApproval:function(){this.model.get("hasCurrentUserApproved")?this.model.unapprove():this.model.approve()},setEnabled:function(e){this.ui.$button.disable(!e)},loading:function(e){this.ui.$button.loading(e)}})}),define("js/pullrequests/views/collapsible-task",["underscore","js/pullrequests/events","js/pullrequests/views/task"],function(e,t,n){return n.extend({getClassNames:function(){var e=n.prototype.getClassNames.call(this);return e.push("collapsible collapsed"),e},collapsed:!0,ui:e.extend(n.prototype.ui,{description:".description"}),events:e.extend(n.prototype.events,{click:"toggleCollapsed"}),onChangeCompleted:function(){this.model.get("completed")&&this.$el.addClass("collapsed"),n.prototype.onChangeCompleted.call(this)},toggleCollapsed:function(t){if(!this.editing&&!this.model.get("completed")){var n=$(t.target),i=[this.ui.contextLink,this.ui.saveLink,this.ui.editLink,this.ui.cancelLink,this.ui.deleteLink],r=[];return e.each(i,function(e){e.selector&&r.push(e.selector)}),n.is(this.ui.status.selector)?(this.collapsed=!0,void this.$el.toggleClass("collapsed",!0)):void(n.closest(r.join(",")).length||(this.collapsed=!this.collapsed,this.$el.toggleClass("collapsed",this.collapsed)))}}})}),define("js/pullrequests/views/pullrequest-task-list",["marionette","underscore","js/pullrequests/collections/tasks","js/pullrequests/views/collapsible-task","js/pullrequests/views/task-list"],function(e,t,n,i,r){return e.LayoutView.extend({template:"#pullrequest-task-list-template",regions:{openTasks:"#open-tasks",resolvedTasks:"#resolved-tasks"},initialize:function(){this.listenTo(this.model.tasks,"add remove",this.render)},onRender:function(){this.updateTasks()},templateHelpers:function(){return{hasResolvedTasks:!!this._getTasks({completed:!0}).length}},_getTasks:function(e){return t.reject(this.model.tasks.where(e),function(e){return e.isNew()})},updateTasks:function(){this.openTasks.show(new r({collection:new n(this._getTasks({completed:!1})),childView:i})),this.resolvedTasks.show(new r({collection:new n(this._getTasks({completed:!0})),childView:i}))}})}),define("utils/dialogs",["aui"],function(e){function t(t,n){var i=e.popup.current;return t||(t=n.createDialog&&n.createDialog()),i?i===t.popup?void(n.hideDialog?n.hideDialog():t.hide()):void(n.hideOtherDialog&&(i.hide(),n.showDialog?n.showDialog():t.show())):void(n.showDialog?n.showDialog():t.show())}return{toggle:t}}),define("js/pullrequests/views/task-dialog",["aui","marionette","js/components/aui-dialog","js/pullrequests/events","js/pullrequests/views/pullrequest-task-list","utils/dialogs"],function(e,t,n,i,r,o){return t.ItemView.extend({template:!1,createDialog:function(){this.taskList=new r({model:this.model}),this.dialog=new n({id:"task-list-dialog",height:"auto",width:600,closeOnOutsideClick:!0,focusSelector:".task:first"});var e=$("<div>").addClass("dialog-hint").text(gettext("Tip: Use shift + T to open the task list."));return this.dialog.addHeader(gettext("Tasks")),this.dialog.addPanel("task-list",this.taskList.render().$el),this.dialog.addLink(gettext("Close"),function(e){e.hide()}),this.dialog.getCurrentPanel().page.buttonpanel.append(e),this.dialog},showDialog:function(){this.taskList.render(),this.dialog.show()},hideDialog:function(){this.dialog&&this.dialog.hide()},toggleDialog:function(e){e&&e.preventDefault(),o.toggle(this.dialog,this)}})}),define("js/pullrequests/views/open-task-count",["aui","marionette","js/pullrequests/events","utils/loading"],function(e,t,n){return t.ItemView.extend({template:"#pullrequest-tasks-count-template",templateHelpers:function(){return{has_tasks:!!this.model.tasks.reject(function(e){return e.isNew()}).length}},events:{"click @ui.link":"handleClick"},modelEvents:{"loading:tasks":"loading"},ui:{link:"a"},initialize:function(){n.vent.once("diff:loaded",function(){this.listenTo(this.model.tasks,"sync remove",this.render)}.bind(this))},handleClick:function(e){e.preventDefault(),n.vent.trigger("unresolvedTaskCountClicked")},onRender:function(){var e=this.model.tasks.filter(function(e){return!e.get("completed")&&!e.isNew()}).length,t=gettext("All tasks resolved");e>0&&(t=interpolate(ngettext("%(taskCount)s open task","%(taskCount)s open tasks",e),{taskCount:e},!0)),this.ui.link.text(t)},loading:function(e){this.ui.link.loading(e)}})}),define("js/pullrequests/views/watch",["marionette","utils/loading"],function(e){return e.ItemView.extend({template:"#pullrequest-watch-template",modelEvents:{"change:isWatchedByCurrentUser":"render","loading:isWatchedByCurrentUser":"loading"},events:{"click a":"toggleWatch"},toggleWatch:function(e){e.preventDefault(),this.model.get("isWatchedByCurrentUser")?this.model.unwatch():this.model.watch()},loading:function(e){this.$el.loading(e)}})}),define("data/current-pr",["jquery"],function(e){var t=e(document.body).data("currentPr")||{};return t}),define("components/outdated-comments",["aui","underscore","components/comments/line-comment","components/diff/context-expander","js/components/aui-dialog","utils/api-helper","data/current-repo","data/current-pr","utils/gaq-push"],function(e,t,n,i,r,o,s,a,l){function u(e){var t=new r({width:1e3,height:"auto",id:"eclipsed-comments-dialog-{}".format(p++),closeOnOutsideClick:!0});return t.addHeader(gettext("Comments on prior versions"),"eclipsed-comments-heading"),t.addPanel(gettext("Comments on prior versions"),e,"eclipsed-comments-panel-body"),t.addLink(gettext("Close"),function(e){e.hide()}),t}function c(e,i){e.length&&t.each(e.data("value"),function(e){t.each(e,function(e,r){i&&(e=t.intersection(e,i)),n.decorateThreads(f.toString(),e,r)})})}function d(e,t){e.html(t).removeClass("has-mask");var n=e.find(".pr-line-thread-ids"),r=e.find(".iterable-item"),o=r.map(function(){return $(this).data("commentId")});c(n,o),e.find(".bb-patch-unified .bb-udiff, .comment-content .bb-udiff").each(function(){var e=$(this),t=e.data("filename"),n=e.parent().is(".comment-content");new i(e.data("expand-context-url")+encodeURI(t),e.data("identifier"),!n,!1,f.toString()).decorate(e)})}function h(e){l(["atl._trackEvent","Pull Request","Eclipsed Comments","Viewed"]);var t=e.data("dialog"),n=new $.Deferred;if(t)return t.show(),n.resolve(),n;var i=e.closest(".commentable-diff"),r=i.data("filename"),o=i.data("eclipsed-comment-view-url"),s=$("<div></div>").addClass("maskable has-mask");return $.ajax({url:o,data:{file:r},dataType:"html"}).done(function(e){d(s,e),n.resolve()}).fail(function(){n.reject()}),t=u(s,r),e.data("dialog",t),t.show(),n}var p=0,f=o.concat("repositories",s.owner.username,s.slug,"pullrequests",a.localId,"comments");return h}),define("js/pullrequests/index",["jquery","on-ready","marionette","js/components/omnibar/extensions","js/components/omnibar/extensions/pull-request-actions","js/pullrequests/app","js/pullrequests/events","js/pullrequests/models/pullrequest","js/pullrequests/views/approve","js/pullrequests/views/task-dialog","js/pullrequests/views/open-task-count","js/pullrequests/views/watch","components/outdated-comments","utils/register-shortcut"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p){return t(function(){function t(t){var n=e('[data-filename="{}"] a.eclipsedcount'.format(t.get("comment").path)),i=h(n);i.done(function(){var e=window.location.hash;window.location.hash=" ",window.location.hash=e})}var n=e("#pullrequest"),f=e("#pullrequest-actions").find(".approve"),m=e("#watch-pullrequest"),g=new a({id:n.attr("data-local-id"),approvalCount:f.data("approvalCount"),hasCurrentUserApproved:f.data("hasCurrentUserApproved"),isWatchedByCurrentUser:m.data("isWatching")});i.register(r,{weight:400,pullRequest:g}),o.addInitializer(function(e){new d({el:m,model:e.pullrequest}).bindUIElements()}),o.addInitializer(function(e){var t=new l({el:f,model:e.pullrequest,showCount:!0});t.bindUIElements(),t.setEnabled(!0)}),o.addInitializer(function(n){new c({el:e("#pullrequest-task-list"),model:n.pullrequest}).bindUIElements();var i=new u({model:n.pullrequest});s.vent.on("unresolvedTaskCountClicked taskContextLinkClicked",function(e){n.pullrequest.fetchTasksOnce(),i.toggleDialog(),e&&e.get("comment").path&&t(e)}),g.tasks.on("remove",function(){g.tasks.length||i.hideDialog()}),p([{section:gettext("Commits / pull requests"),shortcuts:[{keys:["shift+t"],description:gettext("Show the list of tasks"),op:"execute",params:[function(){n.pullrequest.fetchTasksOnce(),i.toggleDialog()}]}]}]),e(document).on("keypress",function(e){s.vent.trigger("keypress:"+e.keyCode,e)})}),o.addInitializer(function(e){var t=e.pullrequest;s.vent.once("diff:loaded",function(){t.tasks.once("sync add remove",function(e,n,i){i&&i.xhr?i.xhr.done(function(){t.fetchTasksOnce()}):t.fetchTasksOnce()})})}),o.start({pullrequest:g})})}),define("js/repo-admin/models/default-reviewer",["backbone"],function(e){return e.Model.extend({idAttribute:"username",url:function(){return"{}/{}".format(this.collection.url(),this.get("username"))},parse:function(e){return{username:e.username,display_name:e.display_name,avatar:e.links.avatar.href}}})}),define("js/repo-admin/collections/default-reviewers",["backbone","underscore","data/current-repo","js/repo-admin/models/default-reviewer"],function(e,t,n,i){return e.Collection.extend({model:i,parse:function(e){return e.values},url:function(){return"/!api/2.0/repositories/{}/{}/default-reviewers".format(n.owner.username,n.slug)}})}),define("js/repo-admin/views/default-reviewer-item",["underscore","marionette","data/no-avatar-image"],function(e,t,n){return t.ItemView.extend({tagName:"tr",template:"#default-reviewer-template",events:{"click @ui.deleteLink":"deleteReviewer"},ui:{deleteLink:".default-reviewer-delete"},templateHelpers:function(){return{avatar:this.model.get("avatar")||n}},deleteReviewer:function(){this.model.destroy()}})}),define("js/repo-admin/views/default-reviewer-form",["aui","marionette","js/repo-admin/views/default-reviewer-item"],function(e,t,n){return t.CompositeView.extend({template:"#default-reviewers-table-template",childView:n,childViewContainer:"tbody",initialize:function(e){e=e||{},this.autofocus=e.autofocus},onRender:function(){this.autofocus&&this.focusUsernameInput()},events:{submit:"onSubmit"},ui:{usernameInput:"#username",containerTable:"table.widget"},getUsernameInputValue:function(){return this.ui.usernameInput.val()},clearUsernameInput:function(){this.ui.usernameInput.val("")},focusUsernameInput:function(){this.ui.usernameInput.focus()},onSubmit:function(e){e.preventDefault(),this.addDefaultReviewer(this.getUsernameInputValue())},addDefaultReviewer:function(t){this.collection.create({username:t},{wait:!0,success:this.clearUsernameInput.bind(this),error:function(t,n){if(n.responseText){var i=JSON.parse(n.responseText),r=i.error&&i.error.message||gettext("There was a problem processing your request.");e.messages.error({body:r,fadeout:!0})}}})}})}),define("js/repo-admin/default-reviewers",["on-ready","jquery","js/repo-admin/collections/default-reviewers","js/repo-admin/views/default-reviewer-form"],function(e,t,n,i){return e(function(e){new i({collection:new n(e.data("json")),el:e,autofocus:!0}).render()})}),define("js/source/events",["backbone.wreqr"],function(e){return e.radio.channel("source")}),define("js/source/set-changeset",["on-ready","js/source/events"],function(e,t){return e(function(e){t.vent.trigger("change:changeset",e.attr("data-hash"))})}),define("onboarding/repository-selector",["jquery","aui"],function(e){return function(t){function n(e){e||(l.val(""),u.val("")),d.toggleClass("hidden",!e)}function i(e){if(e){var n="import"==e,i=!!a.val();n?i?(t.trigger("verifying-repo.onboarding"),o(a.val(),l.val(),u.val())):i||t.trigger("invalid-repo.onboarding"):clearTimeout(s),t.trigger("type-selected.onboarding",{type:e}),n&&a.focus(),a.toggleClass("loading",n&&i),f.toggleClass("hidden",!n)}}function r(t){h.length||(h=e("<div>").addClass("error"),e("#id_url_group").append(h)),t&&h.text(t),h.toggleClass("hidden",!t)}function o(i,o,s){if(!i)return void a.removeClass("loading");a.removeClass("valid");var l={};o&&s&&(l.username=o,l.password=s),e.ajax({type:"POST",url:m.format(i),data:l,dataType:"json"}).fail(function(e){var o=e.responseText;403==e.status||404==e.status?(n(!0),404!=e.status||l.username||(o="{} Try logging in.".format(o))):500==e.status?o="{} does not appear to be a valid repository".format(i):n(!1),r(o),"import"==p.find("input:checked").val()&&t.trigger("invalid-repo.onboarding")}).done(function(n){if("svn"!==n.scm||n.trunk)e("#url-auth-fields").toggleClass("hidden",!o||!s),"import"==p.find("input:checked").val()&&t.trigger("valid-repo.onboarding",{url:i}),a.addClass("valid"),c.val(n.scm),r();else if(r("The URL does not point to trunk."),n.suggestions.length){var l=e("<span>").html('Try <a href="#trunk">{}</a>'.format(n.suggestions[0]));h.append(l)}}).complete(function(){a.removeClass("loading")})}var s,a=t.find("#id_url"),l=t.find("#id_username"),u=t.find("#id_password"),c=t.find("#id_source_scm"),d=e("#url-auth-fields"),h=e("#id_url_group").find(".error"),p=e("#action-field"),f=e("#import-fields"),m=decodeURIComponent(t.attr("data-validate-url"));p.on("change","input",function(){var t=e(this);t.is(":checked")&&i(t.val())}),i(p.find("input:checked").val());var g=function(){o(a.val(),l.val(),u.val())},v=function(e){a.is(":hidden")||9==e.keyCode||(a.addClass("loading"),t.trigger("verifying-repo.onboarding"),s&&clearTimeout(s),s=setTimeout(g,3e3))};a.on("input propertychange",v),l.on("input propertychange",v),u.on("input propertychange",v),t.on("click",'a[href="#trunk"]',function(t){t.preventDefault(),a.val(e(this).text()),a.change()}),p.find("label").tooltip({gravity:function(){return"s"},opacity:1})}}),define("experiment/grow1279-sandbox",["jquery","jquery-plugins/jquery.cookie"],function(e){return function(){if(null!==e.cookie("bb_onboarding")){var t=e("#id_name_group"),n=function(){t.hide(),t.find("input").val("Sandbox"),e("#repository-details").find("fieldset").hide(),e(".buttons button").text("Create Sandbox Repository"),e(".buttons .cancel").hide()},i=function(){t.show(),e("#repository-details").find("fieldset").show(),e(".buttons button").text("Create"),e(".buttons .cancel").show()};e(".radio.tutorial label").text("Sandbox"),n(),e(".fork.action-specific").html("<h3>What is a Sandbox?</h3><p>Weve built a sandbox as a repository you can play in, then throw away as a way to learn about Bitbucket. It comes complete with files, commits, branches, and pull requests so you can immediately get a feel for Bitbuckets capabilities. </p>"),e(".radio.tutorial [name='fork_of']").attr("value","bbhelper/sandbox");var r="bitbucket.org"===window.location.hostname,o=r?"production":"staging",s="//analytics."+(r?"":"stg.internal.")+"atlassian.com/analytics/event",a=e("body").data().currentUser.username;jQuery.ajax({url:s,type:"POST",data:JSON.stringify({name:"bitbucket.onboarding.welcome.viewed",serverTime:(new Date).getTime(),product:"bitbucket",user:a,server:o}),contentType:"application/json"});var l=e("#onboarding").find("form");e("button[type='submit']").click(function(t){t.preventDefault();var n=e("#repository-details").attr("class").replace("show ","");jQuery.ajax({url:s,type:"POST",data:JSON.stringify({name:"bitbucket.onboarding.welcome.repo."+n,serverTime:(new Date).getTime(),product:"bitbucket",user:a,server:o}),contentType:"application/json",complete:function(){l.submit()}})}),l.on("type-selected.onboarding",function(e,t){"fork"==t.type?(n(),e.preventDefault()):i()})}}}),define("onboarding/create-repo",["jquery","on-ready","onboarding/repository-selector","experiment/grow1279-sandbox","utils/disable","jquery-plugins/jquery.cookie"],function(e,t,n,i){return t(function(){function t(e){o.toggleClass("show",e),a.disable(!e)}var r=e("#repo-content").find("form"),o=r.find("#repository-details"),s=r.find("#id_name"),a=r.find("button");r.on("valid-repo.onboarding",function(e,n){if(t(!0),n&&n.url){var i=/\/([^\/]*?)(\.git)?$/.exec(n.url);i&&s.val(i[1])}}),r.on("invalid-repo.onboarding verifying-repo.onboarding",function(){t(!1)}),r.on("type-selected.onboarding",function(e,n){"import"!=n.type&&(t(!0),"fork"==n.type&&s.val("Tutorial"),"empty"==n.type&&s.val("")),o.removeClass("import fork empty"),o.addClass(n.type)}),n(r),i()})}),define("onboarding/creating",["jquery","on-ready","utils/api-helper"],function(e,t){return t(function(){var t=e("#create-progress"),n=t.attr("data-repo-url");setInterval(function(){e.ajax({url:n,dataType:"json"}).done(function(e){"available"==e.state&&window.location.reload()})},2e3)})}),define("components/importer",["aui","jquery","on-ready","underscore","utils/gaq-push","utils/mustache","jquery-plugins/jquery.localize"],function(e,t,n,i,r,o){return function(n){function r(){t.post(p,u)}function s(e){n.removeClass("error-state warning-state success-state"),m.empty(),v.find(".progress").css({width:e+"%"})}function a(){"failed"!==h&&(0===w?l("warning",gettext("Your import is currently in the queue")):100===b?(l("success",gettext("Import completed successfully")),clearInterval(d),x.resolve()):100===y||y-b>0?s(b+=10-b%10):w>b&&s(b++))}function l(t,i){n.addClass(t+"-state"),m.empty(),e.messages[t](m,{title:i,closeable:!1})}function u(e){var n,o,s=e.log.join("").replace(/\s+$/,"");switch(h=e.state,s===c?(o=g.children().last()[0],/\.\.\.$/.test(o.innerHTML)&&(o.innerHTML+=".")):(n=s.replace(c,""),c=s,y=e.percentage,w=e.percentage_upon_subtask_completion,i.each(n.replace(/\n{2,}/g,"\n").split("\n"),function(e){var n=t("<li>");g.append(n.append(e.replace(/^\[(.*)\] /,function(e,i){return n.append(t(document.createElement("time")).attr("data-relative","false").attr("datetime",i).localize("HH:MM:ss"))," "})))}),g.scrollTop(9e5)),e.state){case"running":setTimeout(r,1e3);break;case"success":y=100;break;default:l("error",gettext("Your import has failed. For more information, check the log below. You can also try your import again.")),x.reject()}}var c,d,h=n.data("status"),p=n.data("rest-url"),f=t(o.toHtml("progress-status-template")).appendTo(n),m=f.find("#progress-status-container"),g=f.find("#progress-logs"),v=f.find("#progress-bar"),y=n.data("percentage"),b=0,w=n.data("subtask-percentage"),x=t.Deferred();return"success"===h?(l("success",gettext("Import completed successfully")),r(),x.resolve(),x.promise()):"failed"===h?(r(),x.reject(),x.promise()):(s(b),a(),d=setInterval(a,500),r(),x.promise())}}),define("onboarding/importing",["jquery","underscore","on-ready","components/importer","utils/mustache","utils/api-helper","jquery-plugins/jquery.localize"],function(e,t,n,i){return n(function(){function t(){r.find("#progress-logs-container").show()}var n,r=e("#import-progress");n=setTimeout(t,1e4),i(r).done(function(){clearTimeout(n),window.location=r.attr("data-next-step-url")}).fail(t)})}),define("components/confirm-user-dialog",["jquery","aui","data/header-info","js/components/aui-dialog","utils/mustache","data/current-user"],function(e,t,n,i,r,o){function s(e,t){function n(){var e=s.getCurrentPanel().body.find("form .user input:checked").val();a.resolve(e)}var s=new i({width:450,height:"auto",id:"bb-change-plan"});return s.addPanel("main"),s.getCurrentPanel().html(r.toHtml("change-plan-dialog-template",{adminTeams:e,currentUser:{username:o.username,display_name:o.displayName,avatar:o.avatarUrl,isTarget:o.username==t}})),s.addHeader(gettext("Change plan")).addButton(gettext("Confirm"),n,"aui-button aui-style").addCancel(gettext("Cancel"),function(e){e.hide()}),s}var a=e.Deferred(),l=e.Deferred();return function(e){var t;return n.done(function(n){var i=n.teams.filter(function(t){return"admin"===t.privilege?(e==t.username&&(t.isTarget=!0),!0):void 0});i.length&&(t=s(i,e)),l.resolve(!!t)}),o.isAuthenticated||l.resolve(!1),{ready:function(){return l},show:function(){return t&&t.show(),a}}}}),define("plans",["jquery","on-ready","components/confirm-user-dialog","utils/gaq-push","utils/disable"],function(e,t,n,i){return t(function(){var t=e(".pricing").find("a");t.on("click",function(){i(["atl._trackEvent","Signup","Plans Page","Plan Boxes on Plans Page"])});var r=n(e("#plans").attr("data-target-user"));r.ready().done(function(n){t.disable(!1),n&&t.on("click",function(t){t.preventDefault();var n=e(t.target).attr("data-target-url");r.show().done(function(e){window.location=n.format(e)})})})})}),define("profile/filter",["on-ready","jquery","components/filter/status","components/filter/search","components/filter/select","components/paginate","jquery-plugins/jquery.pjax"],function(e,t,n,i,r,o){return e(function(){var e=t("#profile-repositories"),s=t("#repository-pjax"),a=t("#repository-language-select");n({$container:e,$pjaxContainer:s,filterTerm:e.find(".filter-status").attr("data-filter-term"),ignoreQuery:"page"}),i({$pjaxContainer:s,$controls:t("#repository-search"),ignoreQuery:"page"}),r({$pjaxContainer:s,$select:a,filterTerm:a.attr("data-filter-term"),ignoreQuery:"page",selectOptions:{formatResult:function(e){return"all"===e.id?a.data("noneTerm"):e.text}}}),s.on("pjax:end",function(){var e=t("#repository-list").data("repoCount");t("#profile-repositories-tab .aui-badge").text(e)}),o(e,{$pjaxContainer:s,setMask:!1})})}),define("profile/filter-user",["on-ready","jquery","components/filter/search","components/paginate","jquery-plugins/jquery.pjax"],function(e,t,n,i){return e(function(){var e=t("#filter-pjax");n({$pjaxContainer:e,$controls:t("#user-search"),ignoreQuery:"page"}),i(e)})}),define("profile/hipchat-integration-ad",["on-ready","js/global/events","utils/preferences","utils/analytics-event"],function(e,t,n,i){return e(function(e){i("bitbucket.profile.hipchat.ad.presented"),e.find(".dismiss-button").on("click",function(){i("bitbucket.profile.hipchat.ad.dismissed"),n.set("dismiss-hipchat-box-"+e.attr("data-team-username"),"true"),e.hide()}),e.find(".install-button").on("click",function(){i("bitbucket.profile.hipchat.ad.clicked")}),t.vent.on("hipchatIntegration:installed",function(){e.hide()})})}),define("profile/snippets",["on-ready","jquery","components/filter/status","components/paginate"],function(e,t,n,i){return e(function(){var e=t("#profile-snippets"),r=t("#snippets-pjax");n({$container:e,$pjaxContainer:r,ignoreQuery:"page"}),i(e,{$pjaxContainer:r})})}),define("profile/view",["jquery","on-ready","components/avatar-uploader","utils/masker","jquery-plugins/jquery.pjax"],function(e,t,n,i){return t(function(){function t(e,t){var n=e.data("follow-text")||"Follow",i=e.data("unfollow-text")||"Following";e.toggleClass("following",t).text(t?i:n)}var r=e("#edit-avatar"),o=e("#user-profile img, .aui-avatar-inner img"),s=e(".user-avatar"),a=r.data("isAtlassianId"),l=r.attr("data-submit-url"),u=r.attr("data-text-title"),c=r.attr("data-text-delete"),d=e("#profile"),h=e("#profile-tabs"),p=d.data("ownProfile");p&&h.on("follow:user","button.follow",function(t,n){var i=e("#profile-following-count").find(".count"),r=+i.text();n?r++:r--,r=0>r?0:r,i.text(r)}),e("#profile-follow-button, #blank-slate-follow-button").on("follow:user follow:team",function(n,i){var r=e("#profile-followers"),o=e(".user-list li.user:not(.hidden)").length;i&&!o?r.find("li.empty").addClass("hidden"):i||1!==o||r.find("li.empty").removeClass("hidden"),r.find("li.current-user").toggleClass("hidden",!i),t(e("#profile-follow-button"),i),t(e("#blank-slate-follow-button"),i)}),h.on("follow:user follow:team","button.follow",function(t,n){var i=e(t.target).closest(".user"),r=i.find(".followers-count"),o=+r.find(".count").text();n?o++:o--,o=0>o?0:o,r.html('<span class="count">'+o+"</span> "+(1==o?"follower":"followers"))}).on("follow:repo","button.follow",function(t,n){var i=e(t.target).closest(".repository");i.find(".followers-count").html(' <span class="count">'+n.followers+"</span> "+(1===n.followers?"follower ":"followers "))});var f=h.find("li"),m=e("#profile-tab-content");m.on("pjax:end",function(t){var n=m.find("> div:first").attr("id");f.removeClass("active-tab"),e("#"+n+"-tab").addClass("active-tab"),i.unmask(e(t.target))}).on("pjax:error",function(t,n,i){return n.readyState>0&&"abort"!==i?(e(t.target).html("<h2>Oops!</h2><p>Something has gone terribly wrong...</p>"),!1):void 0}).on("pjax:beforeSend",function(t){i.mask(e(t.target),{backgroundColor:"transparent",spinner:"large"})}),e.support.pjax&&f.on("click","a",function(t){var n=e(t.target).closest("li");t.preventDefault(),m.empty(),e.pjax({url:e(this).attr("href"),push:!0,container:m,scrollTo:null,timeout:3e4}),f.removeClass("aui-nav-selected"),n.addClass("aui-nav-selected")}),r.length&&new n({analyticsType:"Profile",avatars:o,dialogTitle:u,endpointUrl:l,isAtlassianId:a,showDelete:r.hasClass("has-avatar"),templateOptions:{deleteText:c,maskClass:"avatar256"},trigger:r,uploadIndicator:s})})}),define("registration/connect-account-button",["jquery","on-ready","utils/gaq-push"],function(e,t,n){return t(function(){e(".connect-button").on("click","button",function(){var t=/(google|facebook|twitter|github)-button/,i=t.exec(e(this).attr("class"))[1],r=e("#login").length>0?"Login":"Registration";n(["atl._trackEvent","Social registration",r,i])})})}),define("components/calculated-input",["jquery","underscore"],function(e,t){function n(e,t,n){this.$src=e,this.$dst=t,this.echo=n,this.handler=function(){this.$dst.val(this.val()),this.$dst.change()}.bind(this),this.onblur=function(){this.$dst.val()!==this.val()&&this.unbindAll()}.bind(this),this.bindAll()}return n.prototype.bindAll=function(){this.$src.bind("keyup change",this.handler),this.$dst.bind("blur",this.onblur)},n.prototype.unbindAll=function(){this.$src.unbind("keyup change",this.handler),this.$dst.unbind("blur",this.onblur)},n.prototype.val=function(){return this.echo.apply(this,t.map(this.$src,function(t){return e(t).val()}))},n}),define("components/team-members-widget",["bitbucket","jquery","underscore","data/current-user","utils/delay","utils/mustache","utils/valid"],function(e,t,n,i,r,o,s){function a(e){return e?e.split(","):[]}var l={initialUsers:[],initialAdmins:[],allowAddSelf:!0,allowDeleteSelf:!1,allowRevokeSelfAdmin:!1,allowInvitations:!1,allowTeams:!1};return function(u,c){function d(){var e=n.keys(k);v.val(e),y.val(n.filter(e,function(e){return k[e]}));var t=n.keys(_);m.val(t),g.val(n.filter(t,function(e){return _[e]}));var i=!(!t.length&&!e.length),r=!!(y.val()&&y.val().length||g.val()&&g.val().length);u.toggleClass("non-empty",i).trigger("change:members",[i,r])}c=t.extend(l,c);var h,p,f,m,g,v,y,b,w,x,_,k,C,S;h=u.find(".error").first(),p=c.userInput||u.find(".user-input"),f=c.userList||u.find("table.widget"),m=c.userField||u.find(".user-field"),g=c.adminUsersField||u.find(".admin-users-field"),y=c.adminInvitationsField||u.find(".admin-invitations-field"),c.allowInvitations&&(v=c.invitationField||u.find(".email-field")),b=c.addUserButton||u.find("button.add-user"),x=function(e){return h.text(e).show()},S=!(c.initialAdmins&&c.initialAdmins.length),_={},k={},w=function(e,n,r){var s;if(r=!!r,c.allowInvitations&&"string"==typeof e)s=t(o.toHtml("team-member-template",{isRegistered:!1,isAdmin:r,email:e})),f.append(s),k[e]=r,u.trigger("bb:userwidget.invite-added",e);
else{var a=e.username;e.isRegistered=!0,e.isAdmin=r,e.isCheckboxDisabled=!c.allowRevokeSelfAdmin&&a===i.username,s=t(t.parseHTML(o.toHtml("team-member-template",e))),c.allowDeleteSelf||a!==i.username||s.find('a[href="#delete"]').remove(),f.append(s),_[a]=r,u.trigger("bb:userwidget.user-added",e)}n&&(h.hide().text(""),p.val("").focus()),d()},C={usernames:a(m.val()),addresses:[],adminUsernames:a(g.val()),adminAddresses:a(y.val())},c.allowInvitations&&(C.addresses=a(v.val())),C.addresses.length||C.usernames.length?e.users({user:C.usernames},{error:function(){return alert("An unexpected error occurred!")},success:function(e){n.each(C.usernames,function(t){w(e[t],!1,n.contains(C.adminUsernames,t))}),n.each(C.addresses,function(e){w(e,!1,n.contains(C.adminAddresses,e))})}}):c.initialUsers.length?n.each(c.initialUsers,function(e){w(e,!1,n.contains(c.initialAdmins,e.username))}):d(),p.keypress(function(e){13===e.keyCode&&(b.click(),e.preventDefault())});var $;b.click(function(n){n.preventDefault();var o=p.val().trim();if(o){var a=t(n.target);if(!a.is(":disabled"))return a.prop({disabled:!0}),$=r(300,function(){p.addClass("loading")}),e.user(o).details({complete:function(){a.prop({disabled:!1}),clearTimeout($),p.removeClass("loading")},error:function(e){return 404!==e.status?x("An unexpected error occurred."):c.allowInvitations&&s.email(o)?Object.prototype.hasOwnProperty.call(k,o)?x("{} is already a member.".format(o)):(w(o,!0,S),void(S=!1)):x("No user named {}.".format(o))},success:function(e){return Object.prototype.hasOwnProperty.call(_,e.username)?x("{username} is already a member.".format(e)):c.allowAddSelf||e.username!==i.username?!c.allowTeams&&e.is_team?x("You cannot add a team as a member."):(w(e,!0,S),void(S=!1)):x("You cannot add yourself as a member.")}})}}),u.bind("adduser.user-widget",function(e,t){var n=t.user;Object.prototype.hasOwnProperty.call(_,n.username)?t.errorOnDuplicate&&x("{username} is already a member.".format(n)):w(n)}),u.on("change","input[name=is-admin]",function(e){var n=t(e.target),i=n.closest("tr"),r=n.prop("checked");i.hasClass("registered-user")?_[i.data("username")]=r:k[i.data("email-address")]=r,d()}),f.delegate('a[href="#delete"]',"click",function(e){var i;if(e.preventDefault(),i=t(this).closest("tr"),i.hasClass("registered-user")){var r=i.data("username");delete _[r]}else{var o=i.data("email-address");delete k[o]}return d(),S=n.isEmpty(_)&&n.isEmpty(k),i.remove()})}}),define("utils/to-username",[],function(){return function(e){return(""+e).replace(/\W/g,"").toLowerCase()}}),define("utils/validation/validators",["jquery","utils/validation/regexes"],function(e,t){function n(t){return function(n,i){var r=n.trim();return r in o?void i.passWhen(o[r],t):void e.ajax({type:"GET",dataType:"json",url:a.format(r)}).done(function(e){i.passWhen(e,t),o[r]=e}).error(function(){i.pass()})}}function i(t){return function(n,i){var r=n.trim();return r in s?void i.passWhen(s[r],t):void e.ajax({type:"GET",dataType:"json",url:l.format(r)}).done(function(e){i.passWhen(!e,t),s[r]=!e}).error(function(){i.pass()})}}function r(e,t){return function(n){return function(i,r){t?r.passWhen(!e.test(i),n):r.passWhen(e.test(i),n)}}}var o={},s={},a=e("[data-name-available-url]").attr("data-name-available-url"),l=e("[data-handle-url]").attr("data-handle-url");return{handleAvailable:n,emailAvailable:i,email:r(t.email),username:r(t.username),notEmail:r(t.email,!0)}}),define("utils/validation/validated-common-fields",["jquery","utils/validation/validated-field","utils/validation/validators"],function(e,t,n){function i(e,i){var r=new t(e,i);return r.addValidation(n.notEmail(gettext("Your username cannot be an email address"))),r.addValidation(n.username(gettext("Please enter a valid username"))),r.addValidation(n.handleAvailable(gettext("That username already exists"))),r}function r(e,i){var r=new t(e,i);return r.addValidation(n.username(gettext("Please enter a valid team ID"))),r.addValidation(n.handleAvailable(gettext("That team ID already exists"))),r}function o(e,i){var r=new t(e,i);return r.addValidation(n.email(gettext("Please enter a valid email address"))),r.addValidation(n.emailAvailable(gettext("That address is already in use"))),r}return{username:i,teamUsername:r,email:o}}),define("utils/validation/decorators/tipsy",["jquery"],function(e){function t(t){this.options=e.extend({validClass:"valid",invalidClass:"invalid"},t),this.options.tipsyOptions=e.extend({className:"registration-error",gravity:"w",opacity:1,offset:5,trigger:"manual"},this.options.tipsyOptions)}return t.prototype.onValid=function(e){e.addClass(this.options.validClass).removeClass(this.options.invalidClass).removeAttr("title").tipsy("hide")},t.prototype.onInvalid=function(e,t){e.addClass(this.options.invalidClass).removeClass(this.options.validClass).attr("title",t).tipsy(this.options.tipsyOptions).tipsy("show")},t.prototype.onClear=function(e){e.removeClass(this.options.validClass).removeClass(this.options.invalidClass).removeAttr("title").tipsy("hide")},t}),define("registration/create-team-form",["aui","jquery","on-ready","components/calculated-input","components/team-members-widget","data/current-user","utils/disable","utils/event-tracking-helper","utils/gaq-push","utils/preferences","utils/to-username","utils/validation/validated-common-fields","utils/validation/decorators/tipsy"],function(e,t,n,i,r,o,s,a,l,u,c,d,h){var p=a("Team creation");return n(function(e){function n(){var e=f.val()||m.attr("data-placeholder");m.text(e)}var s=t("#team-members"),a=t("#id_team_name"),f=t("#id_username"),m=t("#namespace"),g=e.find('[type="submit"]');new i(a,f,c);var v=d.teamUsername(f,new h).onValidate(function(e){g.disable(!e)});a.on("blur",v.validate),r(s,{allowInvitations:!0,userInput:s.find("#team-member"),userField:t("#id_usernames"),adminUsersField:t("#id_admin_usernames"),invitationField:t("#id_addresses"),adminInvitationsField:t("#id_admin_addresses"),initialUsers:o.username?[{avatar:o.avatarUrl,display_name:o.displayName,username:o.username}]:[],initialAdmins:o.username?[o.username]:[],allowAddSelf:!0}),s.bind("bb:userwidget.invite-added",function(){l(["atl._trackEvent","Share","Invitation - Create Team"])}),f.on("input propertychange change",n),n(),g.on("click",function(){p("Create button clicked")});var y=!1;e.on("submit",function(n){!y&&t("#id_hipchat").is(":checked")&&(n.preventDefault(),u.set("show-hipchat-dialog",!0).done(function(){y=!0,e.submit()}))})})}),define("registration/hipchat-integration-ad",["on-ready","js/global/events","utils/preferences","utils/analytics-event"],function(e,t,n,i){return e(function(e){i("bitbucket.registration.team.hipchat.ad.presented"),e.find("a").on("click",function(){i("bitbucket.registration.team.hipchat.ad.link.clicked")}),e.find("#id_hipchat").on("click",function(e){i("bitbucket.registration.team.hipchat.ad.checkbox.clicked",{checked:$(e.target).is(":checked")})})})}),define("registration/openid-form",["jquery","on-ready","jquery-plugins/jquery.cookie"],function(e,t){return t(function(){var t=e("#openid-form"),n=t.find("#openid-providers"),i=n.find("a"),r={expires:365};e("a.switch-login").click(function(t){t.preventDefault();var n=e(this).attr("href").slice(1),i=e(".login-box, .registration-box");i.attr("data-method",n),e.cookie("login-method",n,r)}),i.click(function(n){var o=e(this);i.removeClass("selected"),o.addClass("selected"),t.find(".provider").removeClass("selected"),n.preventDefault(),-1===o.data("url").indexOf("{id}")?(t.find(".buttons").removeClass("selected"),t.trigger("submit")):(e.cookie("openid-provider",o.attr("href"),r),t.find(".buttons").addClass("selected")),e(o.attr("href")).addClass("selected").find("input").focus()}),t.submit(function(){var i=n.find(".selected").attr("data-url"),r=t.find(".provider.selected input").val();e("#openid_provider").val(i.replace("{id}",r)),e("#openid_username").val(r)})})}),define("registration/signup-form",["jquery","on-ready","components/calculated-input","utils/query-params","utils/to-username","utils/validation/validated-common-fields","utils/validation/decorators/tipsy","utils/disable"],function(e,t,n,i,r,o,s){return t(function(){function t(){var e=p.val()||h.attr("data-placeholder");h.text(e)}function i(){var e=!m.hasClass("invalid")&&!p.hasClass("invalid")&&!g.hasClass("invalid");y.disable(!e)}function a(e,t){return e.trim().toLowerCase()===p.val().trim().toLowerCase()?t.fail(gettext("Username cannot be the same as team ID")):void t.pass()}function l(e,t){return e.trim().toLowerCase()===m.val().trim().toLowerCase()?t.fail(gettext("Team ID cannot be the same as username")):void t.pass()}function u(){p.val(""),f.val(""),t(),_.clearStyle()}function c(){u(),b.removeClass("hide-section")}function d(){u(),b.addClass("hide-section")}var h=e("#namespace"),p=e("#id_team_username"),f=e("#id_team_name"),m=e("#social_username"),g=e("#id_email"),v=e("#registration-form, #social-signup .login-form"),y=v.find('button[type="submit"]'),b=e(".team-form");m.length||(m=e("#id_username")),new n(f,p,r),p.on("input propertychange change",t),t();var w=new s,x=o.username(m,w).addValidation(a).onValidate(i).validate(),_=o.teamUsername(p,w).addValidation(l).onValidate(i).validate(),k=o.email(g,w).onValidate(i).validate();m.on("blur",_.validate),p.on("blur",x.validate),f.on("blur",_.validate),v.on("submit",function(){p.val(p.val().trim()),m.val(m.val().trim())});var C=e("#plan-selector"),S=C.find(".plan"),$=e("#signup-plans"),T=e("#id_plan"),A=e(".account-form .plan-price, .login-form .plan-price"),E=$.find("li"),j="5_users"!==T.val();$.on("click","li",function(t){t.preventDefault();var n=e(t.target).closest("li"),i=n.data("showTeam");E.removeClass("selected"),n.addClass("selected"),S.text(n.find(".users").text()),T.val(n.attr("data-plan")),A.text(n.attr("data-plan-price")),i&&!j?(c(),j=!0):!i&&j&&(d(),j=!1)});var D=e("#social-setup");D.on("click",".form-link a",function(t){t.preventDefault(),x.clearStyle(),k.clearStyle(),_.clearStyle();var n=e(this).attr("href").slice("#social-".length);D.attr("data-method",n)})})}),define("registration/team-locked",["jquery","on-ready","utils/validation/validated-field","utils/validation/decorators/tipsy","utils/validation/validators","utils/disable"],function(e,t,n,i,r){return t(function(){function t(){l.disable(o.hasClass("invalid")||s.hasClass("invalid"))}var o=e("#id_username"),s=e("#id_email"),a=e("#team-locked-form"),l=a.find('button[type="submit"]'),u=a.attr("data-team-name"),c=new i,d=new n(o,c);d.addValidation(r.notEmail(gettext("Your username cannot be an email address"))).addValidation(r.username(gettext("Please enter a valid username"))).addValidation(function(e,t){var n=e.trim().toLowerCase()===u.toLowerCase();t.passWhen(!n,gettext("Your username must be different from your team name"))}).addValidation(r.handleAvailable(gettext("That username already exists"))).onValidate(t).validate();var h=new n(s,c);h.addValidation(r.email(gettext("Please enter a valid email address"))),h.addValidation(function(t,n){e.ajax({type:"GET",dataType:"json",url:a.attr("data-handle-url"),data:{handle:t.trim()}}).done(function(e){return e?e.handle.toLowerCase()===u.toLowerCase()?n.pass():void n.fail(gettext("That email address is already in use")):n.pass()})}).onValidate(t).validate(),a.on("submit",function(){o.val(o.val().trim())}),e("#create-admin").on("click",function(t){t.preventDefault(),e(this).remove(),e(".account-form").removeClass("hide-section")})})}),define("components/repo-access/invitation",["jquery","backbone","utils/api-helper","data/current-repo"],function(e,t,n,i){var r=[i.owner.username,i.slug],o=n.concat("invitations",r),s=t.Model.extend({toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e.isEditable=!0,e[e.permission]=!0,e},url:function(){return o.toString(this.get("email"))}});return s}),define("components/repo-access/invitation-list",["jquery","backbone","underscore","components/repo-access/invitation","utils/api-helper","data/current-repo"],function(e,t,n,i,r,o){var s=[o.owner.username,o.slug],a=r.concat("invitations",s),l=t.Collection.extend({model:i,url:a.toString(),comparator:function(e){return e.get("email")},parse:function(e){return n.map(e,function(e){return e.id=e.user.email,e})}});return l}),define("components/repo-access/upgrade-required-helper",[],function(){return{getErrorText:function(e){return e.can_upgrade?$("#admin-user-access").attr("data-upgrade-required-text"):$("#admin-user-access").attr("data-upgrade-required-non-owner-text").format(e.user.username)}}}),define("components/repo-access/user",["jquery","backbone","underscore","utils/api-helper","data/current-repo","data/no-avatar-image"],function(e,t,n,i,r,o){var s=[r.owner.username,r.slug],a=i.concat("privileges",s),l=t.Model.extend({initialize:function(){var e=this.get("user"),t=e.display_name;this.set({id:e.username,avatar:e.avatar||o,name:t,username:e.username,is_staff:e.is_staff})},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return"creator"==e.privilege||"owner"==e.privilege?e.isEditable=!1:(e.isEditable=!0,e[e.privilege]=!0),e},url:function(){return a.toString(this.get("username"))},sync:function(e,n,i){return"update"===e&&(i.contentType="text/plain",i.data=n.get("privilege")),t.sync.call(this,e,n,i)}});return l}),define("components/repo-access/user-list",["jquery","backbone","underscore","components/repo-access/user","utils/api-helper","data/current-repo"],function(e,t,n,i,r,o){var s=[o.owner.username,o.slug],a=r.concat("privileges",s),l=t.Collection.extend({model:i,url:a.toString(),comparator:function(e){var t=e.get("privilege");return["owner"==t?0:1,"creator"==t?0:1,e.get("name").toLowerCase()]},parse:function(e){return n.map(e,function(e){return e.id=e.user.username,e})}});return l}),define("components/repo-access/shared-repo-properties",["components/confirm-dialog"],function(e){var t=$("body").data("base-url")!==location.origin;return{GENERIC_ERROR_MSG:gettext("There has been a technical issue. Please retry shortly."),checkAdminAccess:function(e,n){var i=e.slug;return t||(i=e.owner.username+"/"+i),$.get("/"+i+"/admin/access-check").then(function(){n.hasAccess&&n.hasAccess()}).fail(function(e){403===e.status?n.hasNoAccess&&n.hasNoAccess():n.hasAccess&&n.hasAccess()})},updateWithReversionOnFailure:function(e){var t=this,n=$(e.target).closest("tr"),i=this.model.get("privilege"),r=function(){n.find(".selected").removeClass("selected").addClass("aui-lozenge-subtle"),n.find("[data-privilege='"+i+"']").addClass("selected").removeClass("aui-lozenge-subtle"),t.model.set("privilege",i)};this.update(e,r)},confirmIfSelfRevocation:function(e){var t=this;this.isSelfRevoking().then(function(n){n?t._showRevocationConfirmationDialog(e):e.confirm(n)}).fail(function(){t._showRevocationConfirmationDialog(e)})},_showRevocationConfirmationDialog:function(t){e({content:this.SELF_REVOCATION_WARNING,buttonText:gettext("Revoke")}).done(function(){t.confirm(!0)}).fail(function(){t.decline&&t.decline()})}}}),define("utils/decorate",["underscore"],function(e){return function(t,n){return function(i){return function(){var r=e.toArray(arguments);n=n||null,t.apply(n,r),i.apply(n,r)}}}}),define("utils/sorted-insert",["underscore"],function(e){return function(t,n,i){var r=i||n.collection,o=e.sortedIndex(r.models,t,r.comparator),s=n.$ol||n.$table.find("tbody"),a=n.$table&&n.$table.find("tbody tr.form");if(a&&a.length){var l;a.length&&(0===o?a.after(t.view.el):(l=o+1,s.children(":nth-child("+l+")").after(t.view.el)))}else 0===o?s.prepend(t.view.el):s.children(":nth-child("+o+")").after(t.view.el);return{add:function(){r.add(t,{at:o})}}}}),define("components/repo-access/user-app-view",["jquery","backbone","underscore","components/repo-access/invitation-list","components/repo-access/upgrade-required-helper","components/repo-access/user","components/repo-access/user-list","components/repo-access/shared-repo-properties","components/confirm-dialog","components/upgrade-dialog","utils/mustache","utils/api-helper","utils/decorate","utils/delay","utils/sorted-insert","utils/valid","data/current-user","data/current-repo"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v){var y=[v.owner.username,v.slug],b=d.concat("privileges",y),w=t.View.extend(n.extend(a,{tagName:"tr",template:"user-access-template",events:{'click [href="#delete"]':"remove","click .access li[data-privilege]:not(.selected)":"updateWithReversionOnFailure"},SELF_REVOCATION_WARNING:gettext("You might be revoking your own admin access to this repository."),initialize:function(){this.model.on("change",this.render,this),this.model.view=this},render:function(){return this.$el.html(c.toHtml(this.template,this.model.toJSON())),this},potentiallyRevokingOwnAccess:function(e){return e===g.username&&"admin"===this.model.get("privilege")},remove:function(){if(this.locked)return this;this.locked=!0;var e=this,t=this.$el,n=t.find('a[href="#delete"]'),i=setTimeout(function(){n.addClass("loading")},200),r=function(){e.locked=!1,clearTimeout(i),n.removeClass("loading")},o=function(){return e.model.destroy({success:function(){clearTimeout(i),n.removeClass("loading"),t.slideUp(function(){t.remove()})},wait:!0,error:function(){r(),AJS.messages.error({body:e.GENERIC_ERROR_MSG,fadeout:!0})}})};return this.confirmIfSelfRevocation({confirm:function(t){o().then(function(){t&&e.checkAdminAccess(v,{hasNoAccess:location.reload.bind(location)})})},decline:function(){e.locked=!1,clearTimeout(i),n.removeClass("loading")}}),!1},isSelfRevoking:function(){return e.Deferred().resolve(this.potentiallyRevokingOwnAccess(this.model.get("username")))},update:function(t,n){var i=this;if(!this.locked)return this.confirmIfSelfRevocation({confirm:function(r){i.model.save({privilege:e(t.target).data("privilege")},{success:function(){r&&i.checkAdminAccess(v,{hasNoAccess:location.reload.bind(location)})},error:function(){n(),AJS.messages.error({body:i.GENERIC_ERROR_MSG,fadeout:!0})}})}}),this}})),x=t.View.extend({tagName:"tr",template:"user-access-template",events:{"click .resend-invitation a":"resend",'click [href="#delete"]':"remove","click .access li[data-privilege]:not(.selected)":"update"},initialize:function(){this.model.on("change",this.render,this),this.model.view=this},render:function(){return this.$el.html(c.toHtml(this.template,this.model.toJSON())),this},resend:function(t){t.preventDefault(),e.ajax({url:this.model.url(),type:"POST",data:this.model.toJSON(),dataType:"json",success:function(){e(t.target).closest(".resend-invitation").fadeOut(200,function(){var t=gettext("Invitation sent");e(this).replaceWith('<span class="aui-lozenge aui-lozenge-success">{}</span>'.format(n.escape(t))).fadeIn(200)})}.bind(this)})},remove:function(){if(this.locked)return this;this.locked=!0;var e=this,t=this.$el,n=t.find('a[href="#delete"]'),i=setTimeout(function(){n.addClass("loading")},200),r=function(){e.locked=!1,clearTimeout(i),n.removeClass("loading")};return this.model.set({id:this.model.get("email")}),this.model.destroy({wait:!0}).done(function(){clearTimeout(i),n.removeClass("loading"),t.slideUp(function(){t.remove()}),e.checkAdminAccess(v,{hasNoAccess:location.reload.bind(location)})}).fail(function(){r(),AJS.messages.error({body:e.GENERIC_ERROR_MSG,fadeout:!0})}),!1},update:function(t){var n=this;if(!this.locked)return this.model.save({id:this.model.get("email"),permission:e(t.target).data("privilege")}).fail(function(){AJS.messages.error({body:n.GENERIC_ERROR_MSG,fadeout:!0})}),this}}),_=t.View.extend({events:{'click button[type="submit"]':"create"},initialize:function(){this.$table=this.$("#user-access"),this.$table.data("initialized")||(this.$form=this.$("#grant-access"),this.$privilege=this.$("#access-level"),this.$username=this.$("#username"),this.submitDisabled=!1,this.$error=this.$(".error"),this.userCollection=new s,this.invitationCollection=new i,e.get(this.userCollection.url,function(t){var i,r,s;s=function(e){var t={avatar:e.avatarUrl},i=["username","firstName","lastName","displayName","isTeam"];return n.each(i,function(n){t[n.replace(/[A-Z]/g,"_$&").toLowerCase()]=e[n]}),t},r=new o({privilege:"owner",user:s(e("#repository-owner-userjson").data().userjson)});var a=e("#repository-creator-userjson");if(a.length>0&&a.data().priv.username!==v.owner.username&&(i=new o({privilege:"creator",user:s(a.data().priv)})),this.userCollection.add(t),this.$table.find("tr.loading").remove(),this.$table.find("tr.form").after(this.userCollection.reduce(function(e,t){var n=new w({model:t});return n.appView=this,e.add(n.render().el)}.bind(this),e())),i){this.userCollection.add(i);var l=new w({model:i,className:"creator"});l.appView=this,this.$table.find("tr.form").after(l.render().el)}this.userCollection.add(r);var u=new w({model:r,className:"owner"});u.appView=this,this.$table.find("tr.form").after(u.render().el),this.$table.attr("data-initialized",!0),this.$el.show()}.bind(this),"json"),e.get(this.invitationCollection.url,function(t){this.invitationCollection.add(t),this.$table.find("tr.loading").remove(),this.$table.append(this.invitationCollection.reduce(function(e,t){var n=new x({model:t});return n.appView=this,e.add(n.render().el)}.bind(this),e())),this.$el.show()}.bind(this),"json"))},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))},create:function(t){t.preventDefault();var n,i=this.$username.val().trim(),s=e(t.target).closest(".repo-access-form").find(".access-level select");if(!this.submitDisabled&&i){if(this.userCollection.get(i)){var a=gettext("%(username)s already has access.");return void this.respond(interpolate(a,{username:i},!0))}this.submitDisabled=!0,n=p(400,function(){this.$form.addClass("loading"),e(t.target).addClass("disabled").prop("disabled",!0).attr("aria-disabled",!0)}.bind(this));var l=h(function(){this.submitDisabled=!1,window.clearTimeout(n),this.$form.removeClass("loading"),e(t.target).removeClass("disabled").prop("disabled",!1).attr("aria-disabled",!1)},this);e.ajax({url:b.toString(i),type:"PUT",contentType:"text/plain",data:s.val(),dataType:"json",error:l(function(n){var o,a,l=!0;switch(n.status){case 404:if(m.email(i)){var c=this.invitationCollection.filter(function(e){return e.get("email")===i});if(c.length>0)o=gettext("%(username)s has already been invited"),a=interpolate(o,{username:i},!0);else{l=!1;var d=this.invitationCollection.create({email:i,permission:s.val()}),h=new x({model:d});h.appView=this,this.$table.append(h.render().el),this.respond(),this.$username.val("")}}else o=gettext('No user named "%(username)s".'),a=interpolate(o,{username:i},!0);break;case 402:var p=e.parseJSON(n.responseText).data;a=r.getErrorText(p),p.owner=g.username===p.user.username,p.can_upgrade&&u(e(t.target),{data:p});break;default:a=n.responseText}l&&this.respond(a)}),success:l(function(e){var t=new o(e[0]),n=this.userCollection.get(t.get("username"));if(n)n.set({privilege:t.get("privilege")}),n.view.render();else{var i=new w({model:t});i.appView=this,i.render(),this.userCollection.add(t),f(t,this,this.userCollection)}this.respond(),this.$username.val("").focus()}.bind(this))})}}});return _}),define("components/repo-access/group",["jquery","backbone","utils/api-helper","data/current-repo"],function(e,t,n,i){var r=[i.owner.username,i.slug],o=n.concat("group-privileges",r),s=t.Model.extend({url:function(){var e=this.get("group");return o.toString(e.owner.username,e.slug)},initialize:function(e){var t=e.group;this.set({id:t.owner.username+":"+t.slug})},toJSON:function(){var e=t.Model.prototype.toJSON.call(this);return e[e.privilege]=!0,e},sync:function(e,n,i){return"update"===e&&(i.contentType="text/plain",i.data=n.get("privilege")),t.sync.call(this,e,n,i)}});return s}),define("components/repo-access/group-list",["jquery","backbone","components/repo-access/group","utils/api-helper","data/current-repo"],function(e,t,n,i,r){var o=[r.owner.username,r.slug],s=i.concat("group-privileges",o),a=t.Collection.extend({model:n,url:s.toString(),comparator:function(e){return e.get("group").name.toLowerCase()}});return a}),define("components/repo-access/group-app-view",["jquery","backbone","underscore","components/repo-access/group","components/repo-access/group-list","components/repo-access/upgrade-required-helper","components/repo-access/shared-repo-properties","components/upgrade-dialog","utils/mustache","utils/api-helper","utils/decorate","utils/delay","utils/sorted-insert","data/current-repo","data/current-user"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p,f){var m=[p.owner.username,p.slug],g=u.concat("group-privileges",m),v=u.concat("_group-privileges-to-add",m),y=t.View.extend(n.extend(s,{tagName:"tr",template:"group-access-template",events:{'click [href="#delete"]':"clear","click .access li:not(.selected)":"updateWithReversionOnFailure"},initialize:function(){n.bindAll(this,"render"),this.model.bind("change",this.render),this.model.view=this},render:function(){return e(this.el).html(l.toHtml(this.template,this.model.toJSON())),this},remove:function(){var t=e(this.el).slideUp(function(){var n=t.siblings().length;t.remove(),n||e("#group-access").hide(),b()})},isSelfRevoking:function(){return"admin"!==this.model.get("privilege")?e.Deferred().resolve(!1):e.getJSON("/!api/1.0/groups/?group="+this.model.get("id").replace(":","/")).then(function(e){return e.length>0})},SELF_REVOCATION_WARNING:gettext("You might be revoking your own admin access to this repository."),clear:function(t){if(t.preventDefault(),this.locked)return this;this.locked=!0;var n=this,i=e(this.el).find('a[href="#delete"]'),r=setTimeout(function(){i.addClass("loading")},200),o=function(){n.locked=!1,clearTimeout(r),i.removeClass("loading")},s=function(){return n.model.destroy().done(n.remove.bind(n)).fail(function(){o(),AJS.messages.error({body:n.GENERIC_ERROR_MSG,fadeout:!0})})};return this.confirmIfSelfRevocation({confirm:function(){s().then(function(){n.checkAdminAccess(p,{hasNoAccess:location.reload.bind(location)})})},decline:o})},update:function(e,t){var n=this,i=function(){return n.model.save({privilege:e.target.innerHTML}).done(b).fail(function(){t(),AJS.messages.error({body:n.GENERIC_ERROR_MSG,fadeout:!0})})};this.confirmIfSelfRevocation({confirm:function(e){i().then(function(){e&&n.checkAdminAccess(p,{hasNoAccess:location.reload.bind(location)})})}})}})),b=e.get.bind(e,v.toString(),function(t){var i=gettext("Select a group"),r=e('<option value=""></option>').text(i),o=[r].concat(n.map(t,function(t){var n=t.owner.username+":"+t.slug;return e("<option>").val(n).text(t.name+" ("+n+")")})),s=e("#groupname").empty();s.append.apply(s,o).trigger("liszt:updated")},"json"),w=t.View.extend({events:{"click button:submit":"create"},initialize:function(){this.$table=this.$("#group-access"),this.$table.data("initialized")||(this.$form=this.$("#grant-group-access"),this.$error=this.$(".error"),b(),this.submitDisabled=!1,this.collection=new r,this.collection.fetch({success:function(t){this.$table.find("tr.loading").remove(),t.length&&(this.$table.find("tr.form").after(t.reduce(function(e,t){var n=new y({model:t});return n.parent=this,e.add(n.render().el)},e())),this.$table.attr("data-initialized",!0))}.bind(this)}))},respond:function(e,t){e?(this.$error.removeClass("hidden"),this.$error.find(".message")[t?"html":"text"](e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))},create:function(t){t.preventDefault();var n,r,s=e("#groupname").val(),l=e(t.target).closest(".repo-access-form").find(".access-level select");if(this.$form.addClass("loading"),e(".ui-autocomplete").hide(),!this.submitDisabled&&s){if(n=this.collection.get(s)){var u=gettext("%(owner)s:%(group)s already has access.");return void this.respond(interpolate(u,{owner:n.owner.username,group:n.slug},!0))}this.submitDisabled=!0,r=d(400,function(){this.$form.addClass("loading"),e(t.target).addClass("disabled").prop("disabled",!0).attr("aria-disabled",!0)}.bind(this));var p=c(function(){this.submitDisabled=!1,window.clearTimeout(r),this.$form.removeClass("loading"),e(t.target).removeClass("disabled").prop("disabled",!1).attr("aria-disabled",!1)},this);e.ajax({url:g.toString(e("#groupname").val().split(":")),type:"PUT",contentType:"text/plain",data:l.val(),dataType:"json",error:p(function(n){switch(n.status){case 402:var i=e.parseJSON(n.responseText).data,r=o.getErrorText(i);i.owner=f.username===i.user.username,i.can_upgrade&&a(e(t.target),{data:i}),this.respond(r);break;case 403:var l=gettext('<strong>Your private repositories are over their user limit.</strong> Committers have read-only access. <a href="/plans">Upgrade my plan</a>.');this.respond(l,!0);break;case 404:var l=gettext("No group named %(group_name)s.");this.respond(interpolate(l,{group_name:s},!0));break;default:this.respond(n.responseText)}}),success:p(function(e){this.respond();var t=new i(e[0]),n=new y({model:t}).render();n.parent=this,h(t,this).add(),this.$table.show(),b()})})}}});return w}),define("repo-admin/access",["on-ready","components/repo-access/user-app-view","components/repo-access/group-app-view"],function(e,t,n){return e(function(){new t({el:$("#repo-access-pane")}),new n({el:$("#repo-group-access-pane")})})}),define("components/branch-restrictions/user-rule",["backbone"],function(e){return e.Model.extend({idAttribute:"username"})}),define("components/branch-restrictions/user-rules",["backbone","components/branch-restrictions/user-rule"],function(e,t){return e.Collection.extend({model:t})}),define("components/branch-restrictions/group-rule",["backbone"],function(e){return e.Model.extend({idAttribute:"full_slug"})}),define("components/branch-restrictions/group-rules",["backbone","components/branch-restrictions/group-rule"],function(e,t){return e.Collection.extend({model:t})}),define("utils/escape-regex",[],function(){return function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}}),define("components/branch-autocomplete/branch-model",["components/typeahead/typeahead-model","utils/escape-regex"],function(e,t){var n={},i={},r=e.extend({idAttribute:"name",sortKeys:function(e){var t=e.toLowerCase(),n=this.get("name").toLowerCase();return[t!==n,n]},convertToRegex:function(e,o){var s=o?i:n;if(!s[e]){var a=t(e);a=a.replace(r.starRegex,function(e,t){return t?t+".*":".*"}),a=a.replace(r.escapedStarRegex,"\\*"),a=o?"^"+a+"$":"^"+a,s[e]=new RegExp(a)}return s[e]},highlightSubstring:function(e,t){if(t){t=this.convertToRegex(t.toLowerCase());var n=t.exec(e);if(n&&n.length)return this.highlight(e,n[0])}return _.escape(e)},matches:function(e,t,n){var i=this.convertToRegex(e,n);return i.test(this.get("name"))}},{starRegex:/^\\\*|([^\\])\\\*/g,escapedStarRegex:/\\\\\\\*/g});return r}),define("components/branch-restrictions/branch",["backbone","components/branch-restrictions/user-rules","components/branch-restrictions/group-rules","components/branch-autocomplete/branch-model","utils/escape-regex"],function(e,t,n,i,r){var o=new RegExp(i.starRegex.source),s={};return e.Model.extend({initialize:function(e){this.set(this.parse(e))},parse:function(e){e.users=new t(e.users),e.groups=new n(e.groups);var i=r(e.pattern);return e.has_wildcard=o.test(i),e},calculateMatchingBranches:function(e){var t=this.get("pattern"),n=[];return _.each(e,function(e){if(!e.disableMatching){var r=s[e.name]||new i(e);r.matches(t,null,!0)&&n.push({name:e.name}),s[e.name]=r}}),this.matching=n,n}})}),define("components/branch-restrictions/branches",["backbone","components/branch-restrictions/branch"],function(e,t){return e.Collection.extend({model:t,initialize:function(e,t){this.url=t.url,this.kind=t.kind},parse:function(e){return e.values?e.values:e},comparator:function(e){return[e.get("pattern").toLowerCase()]}})}),define("components/user-group-autocomplete/user-group-model",["components/typeahead/typeahead-model"],function(e){return e.extend({initialize:function(e){e&&this.set(this.parse(e))},parse:function(e){return e.is_user=_.has(e,"username"),e.id=e.is_user?e.username:e.full_slug,e},toJSON:function(){var t=e.prototype.toJSON.call(this);
return t.has_display_name=this.get("display_name")!=this.get("username"),t},toHighlightedJSON:function(e){var t=this.toJSON();return t.is_user?(t.display_name=this.highlightSubstring(t.display_name,e),t.username=this.highlightSubstring(t.username,e)):(t.name=this.highlightSubstring(t.name,e),t.full_slug="{}:{}".format(this.highlightSubstring(t.owner.username,e),this.highlightSubstring(t.slug,e))),t},sortKeys:function(e){var t=this.get("is_user"),n=e.toLowerCase();return[!t,t&&!(n===this.get("username").toLowerCase()),t&&this.get("display_name").toLowerCase(),t&&this.get("username").toLowerCase(),!(t||n==this.get("owner").username.toLowerCase()),!(t||n==this.get("slug").toLowerCase()),!t&&this.get("name").toLowerCase(),!t&&this.get("full_slug").toLowerCase()]},match:function(e,t){return this.startsWith(this.get(e),t)},nameMatch:function(e){return this.match("name",e)},ownerMatch:function(e){return this.startsWith(this.get("owner").username,e)},slugMatch:function(e){return this.match("slug",e)},usernameMatch:function(e){return this.match("username",e)},displayNameMatch:function(e){return this.match("display_name",e)},matches:function(e){if(this.get("selected"))return!1;if(this.get("is_user")){var t=this.usernameMatch(e),n=this.displayNameMatch(e);return t||n}return this.ownerMatch(e)||this.slugMatch(e)||this.nameMatch(e)}})}),define("components/user-group-autocomplete/user-group-view",["components/typeahead/typeahead-view"],function(e){return e.extend({extraClassNames:function(){return this.model.get("is_user")?"bb-typeahead-user":"bb-typeahead-group"},setQuery:function(e){var t=this.model.toHighlightedJSON(e);t.is_user?(this.$(".display-name").html(t.display_name),this.$(".username").html(t.username)):(this.$(".name").html(t.name),this.$(".full-slug").html(t.full_slug)),this.query=e}})}),define("components/user-group-autocomplete/user-group-completion",["underscore","components/typeahead/typeahead-completion"],function(e,t){return t.extend({className:"bb-user-group-typeahead",initialize:function(e){this.$select=e.$select,this.$chzn=e.$chzn,this.$chznChoices=this.$chzn.find(".chzn-choices").addClass("text"),this.$chznSearchInput=this.$chzn.find(".search-field input").addClass(this.className),t.prototype.initialize.call(this,e),this.$select.on("change",this.updateSource.bind(this)),this.updateSource()},showSuggestions:function(e){this.shouldSuppressSuggestions()||(this.setShowingState(e,!0),this.results.$el.is(":visible")||this.$chznChoices.attr({"aria-owns":this.results.$el.attr("id"),"aria-haspopup":"true"}).addClass("aui-dropdown2-trigger").trigger("aui-button-invoke"))},complete:function(e){var t="click"===e.type?this.currentEl:e.target,n=this.results.activeModel();this.hideSuggestions(t),this.$select.find('[value="{}"]'.format(n.get("id"))).prop("selected",!0),this.$select.change(),this.$select.trigger("liszt:updated"),setTimeout(function(){this.$chznSearchInput.focus()}.bind(this),0),this.trigger("item-selected",{model:n})},selectedWriters:function(){var e={users:[],groups:[]};return this.source.each(function(t){if(t.get("selected")){var n=t.get("is_user")?e.users:e.groups;n.push(t)}}),e},hasChanged:function(t){function n(e){return e.id}var i=this.selectedWriters(),r=t.users.map(n),o=e.map(i.users,n),s=t.groups.map(n),a=e.map(i.groups,n);return r.length!=o.length||s.length!=a.length?!0:e.intersection(o,r).length!=r.length||e.intersection(a,s).length!=s.length},isEmpty:function(){return!this.source.any(function(e){return e.get("selected")})},clear:function(){this.$select.find("option:selected").prop("selected",!1),this.$select.change(),this.$select.trigger("liszt:updated")},updateSource:function(){var e=this.source;e.each(function(e){e.set("selected",!1)}),this.$select.find("option:selected").each(function(){var t=e.get($(this).val());t.set("selected",!0)})}})}),define("components/user-group-autocomplete/index",["utils/mustache","utils/progressive-data-set","components/user-group-autocomplete/user-group-model","components/user-group-autocomplete/user-group-view","components/user-group-autocomplete/user-group-completion","jquery-plugins/jquery.chosen"],function(e,t,n,i,r){return function(o,s,a){a=a||{};var l=a.source;s=_.map(s,function(e){return new n(e)}),l||(l=new t(s,{model:n,matcher:n.matcher}));var u=a.formatResult||function(t){return e.toHtml("user-or-group-result",t.toJSON())},c=$.extend({placeholder_text:gettext("Start typing to search for a user or group"),result_formatter:function(e){var t=l.find(function(t){return t.id==e.value});return u(t)}},a.chosen),d=o.chosen(c).on("liszt:showing_dropdown",function(e,t){$(t.chosen.dropdown).addClass("hidden"),setTimeout(function(){t.chosen.results_showing=!1},0)}).data("chosen"),h=a.viewClass||function(){return r},p=o.parents("div.field-container, div.field-group");return p.addClass("user-group-autocomplete"),new(h())({source:l,el:p[0],resultView:i,callToActionText:gettext("Begin typing to search for a user or group"),resultsClasses:"user-group-suggestions",resultTemplate:"user-or-group-suggestion",$select:o,$chzn:d.container}).render()}}),define("components/branch-autocomplete/branch-progressive-data-set",["underscore","components/branch-autocomplete/branch-model","utils/progressive-data-set"],function(e,t,n){return n.extend({getFilteredResults:function(i){function r(e){return e.id===s.id}var o=n.prototype.getFilteredResults.call(this,i);if(i){var s=new t({name:i});e.find(o,r)||o.unshift(s)}return o}})}),define("components/branch-autocomplete/index",["components/branch-autocomplete/branch-model","components/typeahead/typeahead-completion","components/branch-autocomplete/branch-progressive-data-set"],function(e,t,n){return function(i,r){var o=i.parents("div.field-container, div.field-group"),s=new n(r,{model:e,matcher:e.matcher});return i.addClass("bb-typeahead-input"),i.attr("autocomplete","off"),o.addClass("branch-autocomplete"),new t({source:s,el:o[0],callToActionText:gettext("Begin typing to search for a branch or tag"),resultsClasses:"bb-typeahead-branches",resultTemplate:"branch-suggestion"}).render()}}),define("components/branch-restrictions/user-rule-view",["backbone","utils/mustache"],function(e,t){return e.View.extend({className:"user",render:function(){return this.$el.html(t.toHtml("branch-user-rule",this.model.toJSON())),this}})}),define("components/branch-restrictions/group-rule-view",["backbone","utils/mustache"],function(e,t){return e.View.extend({className:"bb-group",render:function(){return this.$el.html(t.toHtml("branch-group-rule",this.model.toJSON())),this}})}),define("components/branch-restrictions/branch-view",["jquery","backbone","underscore","utils/mustache","components/user-group-autocomplete/index","components/branch-autocomplete/index","components/branch-restrictions/user-rule-view","components/branch-restrictions/group-rule-view","js/components/aui-dialog","utils/loading","utils/disable"],function(e,t,n,i,r,o,s,a,l){return t.View.extend({tagName:"tr",className:"restriction",events:{"click .edit-link":"showEditForm","click [href=#delete]":"delete"},initialize:function(e){this.disableUsers=e.disableUsers,this.$userGroupField=e.$userGroupField,this.writers=e.writers,this.branches=e.branches,this.$error=e.$error,this.maxMatching=5,this.model.on("change",this.updateRow,this),this.model.on("change:pattern",this.countMatchingBranches,this),this.model.on("destroy",function(){this.$el.remove()},this)},showEditForm:function(t){t.preventDefault();var n;if(this.dialog)n=this.dialog.getCurrentPanel().body.find("div.user-or-group select");else{var s=this.dialog=new l({width:700,height:"auto",id:"edit-branch-{}-form".format(this.model.id)});this.$content=e("<div>"),s.addHeader(gettext("Edit branch restriction")),s.addPanel("edit-form",this.$content,"edit-form-body"),s.addButton(gettext("Save"),this.edit.bind(this),"edit-restriction-button"),this.$submitButton=this.dialog.getCurrentPanel().page.buttonpanel.find(".edit-restriction-button"),s.addCancel(gettext("Cancel"),function(e){e.hide()}),this.$content.html(i.toHtml("edit-branch-restriction",this.model.toJSON())),n=this.$userGroupField.clone(),n.attr("id","user_or_group_{}".format(this.model.id)),n.removeClass("chzn-done"),n.show(),this.$content.find(".user-or-group-autocomplete").append(n),this.autocomplete=r(n,this.writers,{chosen:{width:"100%"}}),this.$pattern=this.$content.find("input.pattern-input"),o(this.$pattern,this.branches),this.$error=this.$content.find(".aui-message"),this.$pattern.on("keyup",this.disable.bind(this)),n.on("change",this.disable.bind(this))}n.find("option").prop("selected",!1),this.model.get("users").each(function(e){n.find('option[value="{}"]'.format(e.id)).prop("selected",!0)}),this.model.get("groups").each(function(e){n.find('option[value="{}"]'.format(e.id)).prop("selected",!0)}),n.trigger("liszt:updated"),n.change(),this.$pattern.val(this.model.get("pattern")),this.disable(),this.dialog.show()},edit:function(t){var n=this.autocomplete.selectedWriters(),i=this.model.save({users:n.users,groups:n.groups,pattern:this.$pattern.val()},{wait:!0});i.done(function(){this.$error.addClass("hidden"),this.dialog.hide()}.bind(this)),i.fail(function(e){this.$error.find(".message").text(e.responseText),this.$error.removeClass("hidden")}.bind(this)),e(t.target).loading(i)},disable:function(){var e=this.$pattern.val(),t=e!=this.model.get("pattern"),n={users:this.model.get("users"),groups:this.model.get("groups")};this.$submitButton.disable(e&&!this.autocomplete.isEmpty()&&(t||this.autocomplete.hasChanged(n))?!1:!0)},renderUsersAndGroups:function(){if(!this.disableUsers){var e=this.$el.find("td.user-group div").html("");this.model.get("users").each(function(t){var n=new s({model:t}).render();e.append(n.$el)}),this.model.get("groups").each(function(t){var n=new a({model:t}).render();e.append(n.$el)})}},render:function(){var e=this.model.toJSON();return e.disableUsers=this.disableUsers,e.disableEdit=this.disableUsers,this.$el.html(i.toHtml("branch-restriction",e)),this.renderUsersAndGroups(),AJS.InlineDialog(this.$(".pattern .aui-badge"),"matching-branches-{}".format(this.model.id),this.showMatchingBranches.bind(this),{width:200}),this},updateRow:function(){this.$(".pattern .value").text(this.model.get("pattern")),this.disableUsers||this.renderUsersAndGroups()},countMatchingBranches:function(){var e=this.$(".pattern .aui-badge");if(this.model.get("has_wildcard")){var t=this.model.calculateMatchingBranches(this.branches);e.removeClass("hidden").text(t.length)}else e.addClass("hidden")},showMatchingBranches:function(e,t,n){var r={matching:this.model.matching,more:this.model.matching.length>this.maxMatching};r.more&&(r.matching=r.matching.slice(0,this.maxMatching)),e.html(i.toHtml("matching-branches",r)),n()},"delete":function(t){t.preventDefault();var n=this.model.destroy({wait:!0});n.done(function(){this.$error.addClass("hidden")}.bind(this)),n.fail(function(e){this.$error.find(".message").text(e.responseText),this.$error.removeClass("hidden")}.bind(this)),e(t.target).closest("a").loading(n)}})}),define("components/branch-restrictions/branches-view",["jquery","backbone","components/user-group-autocomplete/index","components/branch-autocomplete/index","components/branch-restrictions/branch-view","utils/loading","utils/disable"],function(e,t,n,i,r){return t.View.extend({initialize:function(e){this.$restrictionsContainer=this.$("tbody"),this.disableUsers=e.disableUsers,this.writers=e.writers,this.branches=this.filterBranches(e.branches),this.$pattern=this.$("input.pattern-input"),this.$error=this.$(".aui-message"),this.$submitButton=this.$("button"),this.views={},this.$userGroupField=this.$("select.user-or-group"),this.$userGroupField.length&&(this.userAutocomplete=n(this.$userGroupField,this.writers),this.userAutocomplete.updateSource()),i(this.$pattern,this.branches),this.collection.on("add",this.insertRule,this),this.collection.on("remove",this.removeRule,this),this.collection.on("change:pattern",this.reorderRule,this),this.toggleSubmitButton()},events:{"click button":"add","keyup input.pattern-input":"toggleSubmitButton","input input.pattern-input":"toggleSubmitButton","typeahead-completed input.pattern-input":"toggleSubmitButton","change select.user-or-group":"toggleSubmitButton"},filterBranches:function(e){var t="true"===this.$el.attr("data-bookmarks-only"),n={name:"*",disableMatching:!0};return t?(e=_.filter(e,function(e){return e.bookmark}),n.note="(All bookmarks)"):n.note="(All branches)",e.unshift(n),e},render:function(){return this.collection.each(function(e){this.insertRule(e,!1)}.bind(this)),this.$restrictionsContainer.find("tr.loading").remove(),_.each(this.views,function(e){e.countMatchingBranches()}),this},toggleSubmitButton:function(){var e=!!this.$pattern.val(),t=!this.userAutocomplete||!this.userAutocomplete.isEmpty();this.$submitButton.disable(!e||!t)},add:function(t){t.preventDefault();var n={users:[],groups:[]};this.userAutocomplete&&(n=this.userAutocomplete.selectedWriters());var i=e(t.target).loading(),r={wait:!0,success:function(){i.resolve(),this.$error.addClass("hidden"),this.userAutocomplete&&this.userAutocomplete.clear(),this.$pattern.val(""),this.toggleSubmitButton()}.bind(this),error:function(e,t){i.reject(),this.$error.find(".message").text(t.responseText),this.$error.removeClass("hidden")}.bind(this)},o=this.$pattern.val().trim(),s=this.collection.where({pattern:o});if(s.length){var a=s[0];a.save({users:a.get("users").clone().add(n.users),groups:a.get("groups").clone().add(n.groups)},r)}else this.collection.create({kind:this.collection.kind,pattern:o,users:n.users,groups:n.groups},r)},insertRule:function(e,t){var n=new r({model:e,disableUsers:this.disableUsers,$userGroupField:this.$userGroupField,$error:this.$error,writers:this.writers,branches:this.branches}).render(),i=this.collection.indexOf(e);this.$restrictionsContainer.find("tr:nth("+i+")").after(n.$el),this.views[e.id]=n,t&&n.countMatchingBranches()},removeRule:function(e){delete this.views[e.id]},reorderRule:function(e){var t=this.views[e.id];this.collection.sort();var n=this.collection.indexOf(e);t.$el.detach(),this.$restrictionsContainer.children().slice(n,n+1).after(t.$el)}})}),define("repo-admin/branch-management",["on-ready","jquery","underscore","components/branch-restrictions/branches","components/branch-restrictions/branches-view"],function(e,t,n,i,r){return e(function(){var e=t("#admin-branch-management"),n=e.find(".branch-restrictions-form");if(n.length){var o=e.data("writers"),s=e.data("branches"),a=e.data("models");n.each(function(){var n=t(this),l=n.attr("data-kind"),u=new i(a[l],{url:e.attr("data-api-url"),kind:l});new r({el:n,collection:u,disableUsers:n.hasClass("no-users"),writers:o,branches:s}).render()})}})}),define("repo-admin/delete",["on-ready","jquery","components/confirm-dialog","utils/disable"],function(e,t,n){return e(function(){var e=t("#delete-repository form");e.on("submit",function(e){e.preventDefault(),n({id:"delete-repository",title:"Delete repository?",content:"Deleting a repository is a permanent action and cannot be undone. Are you sure you wish to permanently delete this repository, and any associated issues or wikis?",buttonText:"Delete"}).done(function(){t(e.target).off("submit").submit()})}),e.find("button").disable(!1)})}),define("repo-admin/deploy-keys",["on-ready","jquery","bitbucket","components/ssh/keys","data/current-repo"],function(e,t,n,i,r){var o=n.repository(r.owner.username,r.slug);return e(function(){var e=t("#deploy-keys"),n=t("#edit-ssh-key"),r={onEdit:function(e,t){o.update_deploy_key(n.find("#ssh_pk").val(),e,t)},onCreate:function(e,t){o.create_deploy_key(e,t)},onDelete:function(e,t){o.delete_deploy_key(e,t)}};i(e,r)})}),define("repo-admin/hooks",["aui","jquery","on-ready","js/components/aui-dialog","utils/mustache"],function(e,t,n,i,r){return n(function(){function e(){var e=new i({width:500,height:300,id:"repo-hooks-dialog"});return e.addPanel("panel-hook"),e.addButton("Save",function(e){t(e.popup.element).find("form").submit()}),e.addCancel("Cancel",function(e){f.fire(),e.hide()}),e.popup.element.on("click",".change-redacted-value",function(e){e.preventDefault();var n=t(e.target);n.replaceWith(r.toHtml(n.attr("data-template"),{}))}),e}function n(e){return function(){e.find(".delete").click()}}function o(n){var i=t(n.target),r=i.closest(".hook"),o=r.find("form");n.preventDefault(),c=c||e(),c.addHeader(r.find(".hook-name").text()),c.getCurrentPanel().body.empty().append(o.clone()),c.show()}function s(t){c=e(),c.addHeader("Add POST hook"),c.getCurrentPanel().body.empty().append(t.removeClass("hidden")),c.show()}function a(e){var i=t(e.target),r=i.find('[name="add-service"]');e.preventDefault();var o=r.val();return o&&parseInt(o,10)>0&&t.ajax({type:i.attr("method")||"POST",url:i.attr("action"),data:i.serialize(),dataType:"html"}).success(function(e){var i=t(e).find("#hooks-list"),r=i.find('.hook[data-added-service="true"]');h.replaceWith(i),h=t("#hooks-list"),r.find(".edit").click(),f.add(n(r))}),!1}function l(e){var n=t(e.target).closest("a"),i=n.closest(".hook");e.preventDefault(),n.addClass("loading"),t.ajax({type:"DELETE",url:n.attr("data-url"),dataType:"json"}).success(function(){i.remove()})}function u(e){var n=t(e.target);return e.preventDefault(),t.ajax({type:"POST",url:n.attr("action"),data:n.serialize(),dataType:"html"}).success(function(e){var n=t(e).find("#hooks-list");h.replaceWith(n),h=t("#hooks-list"),c.hide(),f.empty()}),!1}var c,d=t("#admin-hooks"),h=d.find("#hooks-list"),p=t("#quick-add-hook-form"),f=t.Callbacks();t("#add-hook-form").on("submit",a),d.on("click","a.delete",l).on("click","a.edit",o),t(document).on("submit","#repo-hooks-dialog form",u),p.length&&s(p)})}),define("data/pathname",[],function(){return function(e){return(e||window.location.pathname).rstrip("/")}}),define("repo-admin/index",["aui","on-ready","data/pathname","jquery-plugins/jquery.pjax","utils/ready"],function(e,t,n,i,r){return t(function(e){var t=$("#repo-admin-nav").find("a");r(function(){var e=t.filter('a[href="'+n()+'"]');t.closest("li").removeClass("aui-nav-selected"),e.closest("li").addClass("aui-nav-selected")}),e.pjax("#repo-admin-nav a",{container:"#pjax-main",scrollTo:null}).on("pjax:beforeSend",function(){e.find("select.select2-offscreen").auiSelect2("destroy")})})}),define("components/progress-dialog",["jquery","aui","js/components/aui-dialog","utils/mustache"],function(e,t,n,i){return function(t,r){function o(e){t.on(e,h)}function s(e){var t;return t="function"==typeof r.templateData?r.templateData(e):e||r.templateData,t||{}}function a(){m||(l(),u(s())),m.show()}function l(){m=new n({width:v,height:y,id:"bb-"+g+"-dialog"}),m.addPanel("main")}function u(e){m.addHeader(e.title||r.title||gettext("Progress")).getCurrentPanel().html(i.toHtml(r.template,e)),m.popup.element.find(".dialog-button-panel").empty(),e.closeLink&&m.addCancel(gettext("Close"),function(e){e.hide()})}function c(e,t,n){u({error:n,closeLink:!0})}function d(e){a(),f(e)}function h(n){n&&n.preventDefault(),r.taskUrl=r.taskUrl||t.attr("data-url"),a(),e.ajax({type:"post",dataType:"json",url:r.taskUrl,success:function(e,t){"success"===t&&d(r.taskUrl)},error:c})}function p(e){var t=m.popup.element.find("#progress-container"),n=r.getStatus(e);t.find(".progress-message").text(n),e.pct&&(t.find(".progress").css({width:e.pct+"%"}),t.find(".progress-percent").text(e.pct+"%"))}function f(t){e.ajax({type:"get",dataType:"json",url:t,success:function(e,n,i){"ACCEPTED"==e.status||"STARTED"==e.status?(p(e),setTimeout(function(){f(t)},1e3)):"SUCCESS"==e.status?r.onComplete&&r.onComplete(m,e):"FAILURE"==e.status&&c(i,n,e.message?e.message:gettext("Unexpected error"))},error:c})}1!=arguments.length||t.jquery||(r=t,t=e());var m,g=r.id||"progress",v=r.width||600,y=r.height||"auto";return t&&t.length&&o("click"),{getDialog:function(){return m},getElement:function(){return m.popup.element},bind:function(e,n){e&&e.length&&(t=e,o(n))},start:function(e,t){r.taskUrl=e?e:r.taskUrl,"get"===t?d(e):h()},update:u}}}),define("repo-admin/issue-export",["on-ready","jquery","components/progress-dialog"],function(e,t,n){return e(function(){var e=n(t("#issue-export"),{template:"export-dialog-template",title:"Issue export",id:"issue-export",height:"210",onComplete:function(t,n){"SUCCESS"===n.status&&(n.downloadUrl=n.url,n.title="Issue export complete",n.closeLink=!0),e.update(n)},getStatus:function(e){var t="Waiting for export to start...";return e.phase&&(t="Exporting: "+e.phase),t}})})}),define("repo-admin/issue-import",["on-ready","jquery","components/progress-dialog","components/upload-handler","utils/feature-detects/has-file-reader"],function(e,t,n,i,r){return e(function(){function e(){u.start(s,"get"),t("#import-upload-file").val(""),o.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled")}var o=t("#issue-import"),s=o.attr("data-url"),a=t("#import-upload-file"),l=t("#import-upload-form"),u=n({template:"import-dialog-template",title:"Issue import",id:"issue-import",height:"210",onComplete:function(e,t){"SUCCESS"===t.status&&(t.finished=!0,t.title="Issue import complete",t.closeLink=!0),u.update(t)},getStatus:function(e){var t="Waiting for import to start...";return e.phase&&(t="Importing: "+e.phase),t}});i(a,{$dropTarget:t("#import"),uploadOnDrop:!0,complete:function(t){202===t.status?e():t.status>=400&&t.status<500&&(l.find(".error-container").empty().text(t.response),o.removeClass("loading"))},fileSelected:function(e){e.name&&(l.find(".error-container").empty(),o.removeAttr("aria-disabled").removeAttr("disabled"))}}),r&&o.attr({"aria-disabled":!0,disabled:!0}),l.on("submit",function(){t("#import-upload-target").one("load",e),o.addClass("loading").attr({"aria-disabled":!0,disabled:!0})})})}),define("repo-admin/issues",["on-ready","jquery","config/markitup","jquery-plugins/jquery.markitup"],function(e,t,n){return e(function(){function e(){"public"===o.filter(":checked").val()?a.slideDown(i):a.slideUp(i)}var i=400,r=t("#issues-admin"),o=r.find('[name="issue_tracker"]'),s=r.find('[name="new_issue_message"]'),a=r.find("#anonymous_issues_field");o.on("click",e),e(),s.markItUp(n())})}),define("components/issues-admin/table-item",["backbone","underscore","js/components/aui-dialog","utils/mustache","utils/sorted-insert"],function(e,t,n,i,r){function o(e,i){var r=new n({width:450,height:"auto",id:"bb-edit-category"});r.addPanel("main");var o=r.getCurrentPanel(),s=gettext("Name");o.html('<form class="aui"><div class="field-group">'+"<label>{}</label>".format(t.escape(s))+'<input type="text" class="text" id="edit_category_name" name="edit_category_name"/></div></form>');var a=/^(.+)s$/.exec(e)[1],l=gettext("Edit %(category)s");return r.addHeader(interpolate(l,{category:a},!0)).addButton(gettext("Edit"),i,"aui-button aui-style").addCancel(gettext("Cancel"),function(e){e.hide()}),o.body.find("form").submit(function(e){e.preventDefault(),i()}),r}return e.View.extend({tagName:"tr",events:{'click a[href="#edit"]':"rename",'click a[href="#default"]':"toggle",'click a[href="#delete"]':"destroy"},initialize:function(){this.$el.html(i.toHtml("issues-category-template",{name:this.model.get("name"),singular:/^(.+)s$/.exec(this.model.category)[1]})),this.setDefaultState()},setDefaultState:function(){this.model.get("default")?this.$el.attr({title:gettext("Remove default")}).addClass("default"):this.$el.attr({title:gettext("Set as default")}).removeClass("default")},startWaiting:function(){return this.$el.addClass("waiting")},stopWaiting:function(){return this.$el.removeClass("waiting")},rename:function(e){e.preventDefault();var t=o(this.model.category,function(){t.hide(),this.submitRename()}.bind(this));this.$input=t.getCurrentPanel().body.find("#edit_category_name"),this.$input.val(this.model.get("name")),t.show()},submitRename:function(){var e=this.$el,t=this.model.get("name"),n=this.$input.val().trim();n&&n!==t&&this.model.save({name:n},{success:function(t){this.parent.respond(),r(t,this.parent),e.find("td.name > div").text(n)}.bind(this),error:function(i,r){e.find("td.name > div").text(t),this.parent.respond(this.model.message(409===r.status?"already-exists":"unknown",n))}.bind(this),wait:!0})},toggle:function(e){e.preventDefault(),this.startWaiting(),this.model.save({"default":!this.model.get("default")},{success:function(e){e.view.stopWaiting().trigger("setdefaultitem",e.get("default")?e:null)},wait:!0})},removeRow:function(){var e=this.$el;e.slideUp(function(){this.stopWaiting(),e.remove()}.bind(this))},destroy:function(e){e.preventDefault(),this.startWaiting(),this.model.destroy({success:function(e){e.view.removeRow()},wait:!0})}})}),define("components/issues-admin/table-widget",["jquery","backbone","aui","components/issues-admin/table-item","utils/sorted-insert"],function(e,t,n,i,r){return t.View.extend({events:{setdefaultitem:"defaultItem",submit:"add"},initialize:function(){this.$table=this.$("table.widget"),this.$name=this.$("input:text"),this.$error=this.$(".error"),this.$table.find("tr.form").after(this.collection.reduce(function(e,t){var n=t.view=new i({model:t});return n.parent=this,e.add(n.el)}.bind(this),e()))},defaultItem:function(e,t){this.collection.each(function(e){e.set({"default":e===t}),e.view.setDefaultState()})},add:function(e){e.preventDefault();var t=this.$name.val().trim();if(t){var n=this.collection,o=new n.model;o.collection=n,o.save({name:t},{error:function(e,t){this.respond(t)}.bind(this),success:function(e){this.respond(),e.view=new i({model:e}),e.view.parent=this,r(e,this).add(),this.$name.val("").focus()}.bind(this),wait:!0})}},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))}})}),define("components/issues-admin/classifier",["backbone","underscore"],function(e,t){var n=e.Model.extend({initialize:function(){var e=/^(.)(.+?)s$/.exec(this.category);this.label=e[1].toUpperCase()+e[2]},messages:{"already-exists":function(e){var t=gettext('%(label)s "%(name)s" already exists!');return interpolate(t,{label:this.label,name:e},!0)},unknown:function(){return gettext("An unknown error occurred.")}},message:function(e){return this.messages[e].apply(this,t.toArray(arguments).slice(1))},validate:function(e){return this.isNew()&&this.collection.contains(e.name)?this.message("already-exists",e.name):void 0},url:function(){var e=this.collection.url();return this.id?/^(.*?)\/?$/.exec(e)[1]+"/"+this.id:e}});return n}),define("components/issues-admin/classifier-collection",["backbone","components/issues-admin/classifier"],function(e,t){var n={create:function(n){var i=e.Collection.extend(this.mixin);return i.prototype.model=t.extend({category:n}),new i},mixin:{comparator:function(e){return e.get("name").toLowerCase()},contains:function(e){return this.any(function(t){return t.get("name")===e})},url:function(){return window.location.pathname}}};return n}),define("repo-admin/issues-category",["on-ready","jquery","components/issues-admin/table-widget","components/issues-admin/classifier-collection"],function(e,t,n,i){return e(function(){var e=t("#repo-admin section"),r=e.data("category"),o=i.create(r);o.reset(e.data("json")),new n({collection:o,el:e,category:r})})}),define("components/issues-admin/email-addresses",["backbone"],function(e){var t=e.Collection.extend({comparator:function(e){return e.id.toLowerCase()},toString:function(){return this.map(function(e){return e.id}).join("\n")}});return t}),define("components/issues-admin/email-address-view",["utils/mustache","components/issues-admin/table-item"],function(e,t){var n=t.extend({initialize:function(){this.$el.html(e.toHtml("issues-notifications-template",{email:this.model.get("id")}))},destroy:function(e){e.preventDefault(),this.startWaiting().trigger("removeaddress",{model:this.model,success:function(){var e=this.stopWaiting();e.slideUp(function(){e.remove()}),this.model.collection.remove(this.model)}.bind(this)})}});return n}),define("components/issues-admin/email-address-widget",["jquery","backbone","underscore","components/issues-admin/email-addresses","components/issues-admin/email-address-view","utils/sorted-insert","utils/valid"],function(e,t,n,i,r,o,s){var a=t.View.extend({events:{removeaddress:"remove",submit:"add"},initialize:function(){this.$table=this.$("table.widget"),this.$address=this.$('input[type="text"], input[type="email"]'),this.$error=this.$(".error"),this.token=this.$('input[name="csrfmiddlewaretoken"]').val(),this.collection=new i(n.map(this.$el.data("json"),function(e){return{id:e}})),this.$table.find("tr.form").after(this.collection.reduce(function(e,t){return t.view=new r({model:t}),e.add(t.view.el)},e()))},sync:function(t,n){e.ajax({url:window.location.pathname,type:"POST",data:{addresses:t,csrfmiddlewaretoken:this.token},success:n.bind(this)})},add:function(e){e.preventDefault();var n=this.$address.val().trim();if(!s.email(n))return void this.respond("Invalid email address.");if(this.collection.get(n)){var i=gettext("%(address)s is already listed!");return void this.respond(interpolate(i,{address:n},!0))}this.sync(this.collection+"\n"+n,function(){this.respond();var e=new t.Model({id:n});e.view=new r({model:e}),o(e,this).add(),this.$address.val("")})},remove:function(e,t){var n=this.collection;this.sync(n.toString.call(n.reject(function(e){return e===t.model})),t.success)},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))}});return a}),define("repo-admin/issues-notifications",["on-ready","jquery","components/issues-admin/email-address-widget"],function(e,t,n){return e(function(){new n({el:t("#notifications")})})}),define("repo-admin/links",["on-ready","jquery","bitbucket","components/form-dialog","data/current-repo","utils/process-form-errors"],function(e,t,n,i,r,o){return e(function(){function e(e){e.preventDefault();var n=t(e.target).closest("tr"),i=n.data();l.delete_linkifier(i.id,{success:function(){n.remove(),u.find("tr").length||u.append(t("<tr><td>There are no links configured.</td><td></td><td></td></tr>"))},error:function(){t("#link-errors").text("There was an error communicating with the server, please try again.")}})}function s(e,n){new i(n,{success:function(){document.location.reload()},error:function(e,n){t(".field-group .error").remove(),t("#repo-link-errors").addClass("hidden");var i=o(n.responseText);t.each(i,function(e,n){var i=t('[name="'+e+'"]');if(0===i.length)t("#repo-link-errors").removeClass("hidden").find(".message").text(n);else{var r=t("<div>").addClass("error").text(n);i.after(r)}})}}).bind()}var a=t("#repository-links"),l=n.repository(r.owner.username,r.slug),u=a.find(".repo-links-list tbody");t(".link-action").each(s),t(".delete-link").on("click",e)})}),define("utils/validation/aui-validators",["aui/form-validation/validator-register"],function(e){e.register(["non-blank"],function(e){e.$el.val().trim()?e.validate():e.invalidate(AJS.I18n.keys["aui.validation.message.required"])})}),define("workflow/repo-form",["jquery","aui","on-ready","store","underscore","components/upgrade-dialog","data/current-user","utils/disable","utils/mustache","utils/preferences","utils/select-avatar-formatter","utils/validation/aui-validators"],function(e,t,n,i,r,o,s,a,l,u,c){return n(function(){function t(){var t=g.prop("checked");e("#id_forking_group").toggle(t),e("#id_no_public_forks").closest("fieldset").toggle(t)}var n=e(".repo-form"),i=n.find(".aui-button-primary"),a=n.data("plan-users"),l=n.data("users-required"),d=n.attr("data-owner-username"),h=n.attr("data-owner-display-name"),p=n.data("over-plan-limit"),f=n.data("can-upgrade");if(i.disable(!1),e("#id_language").auiSelect2({allowClear:!0}),e("#id_owner").auiSelect2({formatResult:c,formatSelection:c}).on("change",function(t){e("#integrations-container").toggle(e(t.target).find(":selected").data("can-administer"))}),p&&f){var m={plan_users:a,users_required:l,can_upgrade:f,user:{username:d,display_name:h}};
m.owner=s.username===m.user.username,o(i,{data:m})}var g=e("#id_is_private").change(t);t();var v=function(){var t=g.prop("checked"),i=e("#id_forking");if(i.length){var o=n.data("forking-values")[i.val()];r.each(["no_forks","no_public_forks"],function(n){e("#id_{}".format(n)).val(t?o[n]:"False")})}else t||e("#id_no_public_forks").prop("checked",!1)};n.on("aui-valid-submit",function(){i.disable(!0)});var y=e("[data-aui-validation-field]"),b=!1;n.on("submit",function(t){y.length||i.disable(!0),!b&&e("#id_hipchat").is(":checked")?(t.preventDefault(),u.set("show-hipchat-dialog",!0).done(function(){b=!0,n.submit()})):v()}),n.find("#fp_sel").change(function(){"specific"===this.value?(e("#fp_specific").show(),e("#fp_specific_input").focus()):(e("#fp_specific").hide(),e("#fp_specific_input").val(this.value))})})}),define("repo-admin/settings",["on-ready","jquery","components/avatar-uploader","workflow/repo-form"],function(e,t,n,i){return e(function(){i.onReady();var e=t("#change-logo"),r=t(".repo-avatar-container img"),o=t("#admin-settings .repo-avatar-container"),s=e.data("submitUrl"),a=e.data("textTitle"),l=e.data("textDelete");new n({analyticsType:"Repo",avatars:r,dialogTitle:a,endpointUrl:s,showDelete:e.hasClass("has-avatar"),templateOptions:{deleteText:l},trigger:e,uploadIndicator:o})})}),define("repo-admin/strip-log",["jquery","on-ready","utils/delay"],function(e,t,n){return t(function(){n(1e3,function(){e.pjax({container:"#pjax-main",url:window.location.href})})})}),define("repo-admin/transfer",["on-ready","jquery"],function(e,t){return e(function(){t("#transfer-repository #id_user").addClass("bb-user-team-typeahead")})}),define("repo-admin/transfer-upgrade-required",["on-ready","jquery","components/upgrade-dialog","utils/dialog-positions"],function(e,t,n,i){return e(function(){var e=t("#transfer-accept-button"),r=e.attr("data-users-required"),o=e.attr("data-plan-users"),s=e.attr("data-target-username"),a=e.attr("data-target-display-name");n(e,{data:{user:{display_name:a,username:s},users_required:r,plan_users:o},calculatePositions:i.alignLeft()})})}),define("components/username-mapping/mapping",["jquery","backbone","data/no-avatar-image","data/pathname"],function(e,t,n,i){return t.Model.extend({idAttribute:"alias",initialize:function(e){this.set({avatar:e.avatar||n})},url:function(){return i()+"/"+this.get("username")+"/"+encodeURIComponent(this.get("alias"))}})}),define("components/username-mapping/mapping-collection",["backbone","components/username-mapping/mapping","data/pathname"],function(e,t,n){return e.Collection.extend({model:t,comparator:function(e){return[e.get("display_name").toLowerCase(),e.get("alias")]},url:n})}),define("components/username-mapping/mapping-item",["backbone","utils/mustache"],function(e,t){return e.View.extend({tagName:"tr",events:{"click .bb-list-action-delete":"remove"},initialize:function(){this.$el.html(t.toHtml("username-mapping-template",this.model.toJSON()))},remove:function(e){e.preventDefault(),this.$(".bb-list-action-delete").addClass("loading"),this.model.destroy()}})}),define("components/username-mapping/mapping-widget",["backbone","components/username-mapping/mapping","components/username-mapping/mapping-item","utils/sorted-insert"],function(e,t,n,i){return e.View.extend({events:{submit:"add"},initialize:function(){this.$username=this.$("#username"),this.$alias=this.$("#alias"),this.$error=this.$(".error"),this.$table=this.$("table.widget"),this.$loading=this.$table.find("tr.loading"),this.$loading.length&&(this.collection.each(function(e){e.view=new n({model:e}),e.collection=this.collection,this.$table.append(e.view.el)}.bind(this)),this.$loading.remove(),this.collection.on("add",function(e){e.view=new n({model:e}),e.collection=this.collection,i(e,this)},this),this.collection.on("remove",function(e){var t=$(e.view.el);t.slideUp(function(){t.remove()})}))},add:function(e){e.preventDefault();var n=this.$username.val().trim(),i=this.$alias.val().trim(),r=[];return n||r.push("Username is required."),i||r.push("Alias is required."),r.length?this.respond(r.join(" ")):(i=new t({username:n,alias:i}),void i.save({},{success:function(e){this.collection.add({username:n,display_name:e.get("display_name"),alias:e.get("committer"),avatar:e.get("avatar")}),this.$username.val("").focus(),this.$alias.val(""),this.respond()}.bind(this),error:function(e,t){this.respond($.parseJSON(t.responseText).msg)}.bind(this),wait:!0}))},respond:function(e){e?(this.$error.removeClass("hidden"),this.$error.find(".message").text(e)):(this.$error.addClass("hidden"),this.$error.find(".message").text(""))}})}),define("repo-admin/username-mapping",["jquery","on-ready","components/username-mapping/mapping-collection","components/username-mapping/mapping-widget"],function(e,t,n,i){return t(function(){var t=e("#username-mapping");new i({collection:new n(t.find("form").data("json")),el:t})})}),define("repo/branches/compare",["aui","jquery","on-ready","underscore","components/merge-dialog","data/current-repo","utils/format-select2-with-title-text","utils/mustache","utils/parse-compare-spec"],function(e,t,n,i,r,o,s,a,l){return n(function(){function e(e,n){return s(e,n),a.toHtml("repo-avatar-template",{name:e.text,size:16,avatar_url:t(e.element).attr("data-avatar-url")})+e.text}function n(e,t,n){n.removeAttr("id").hide().filter('[data-repo="{}"]'.format(t)).attr("id","id_{}".format(e)).prev(".select2-container").show()}function i(e,n){var i=l(t("#id_{}".format(n)).val());e.find(".branch[data-field={}] .branch-badge".format(n)).find(".repo-name").attr("title",i.repo).html(a.toHtml("repo-avatar-template",{name:i.repo,size:16,avatar_url:t("#id_{}_repo option:selected".format(n)).attr("data-avatar-url")})+i.repo).end().find(".branch-name").attr("title",i.branch).text(i.branch)}function u(e){var t=e.find("#id_source option:selected"),n=e.find("#id_dest option:selected"),i=l(t.val()),r=l(n.val()),s=t.data("multiple-heads")?i.hash:i.branch,a=n.data("multiple-heads")?r.hash:r.branch;return s=encodeURIComponent(s),a=encodeURIComponent(a),(i.repo!==r.repo||i.repo!==o.fullslug)&&(s="{}:{}".format(i.repo,s),a="{}:{}".format(r.repo,a)),"{}%0D{}".format(s,a)}var c,d=t(".branch-compare"),h=d.attr("data-compare-url"),p=d.find(".compare-form"),f=p.data("auto-reload");p.find(".repo-select").auiSelect2({formatResult:e,formatSelection:e,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide",escapeMarkup:function(e){return e}}),p.find(".branch-select").auiSelect2({formatResult:s,dropdownAutoWidth:!0,dropdownCssClass:"select2-drop-wide"}),p.find(".branch").each(function(){var e=t(this),r=e.attr("data-field"),o=e.find(".repo-select"),s=e.find(".branch-select"),a=e.find("select.repo-select").val();n(r,a,s),o.on("change",function(){n(r,t(this).val(),s),i(p,r),f&&p.trigger("submit")}),s.on("change",function(){i(p,r),f&&p.trigger("submit")}),e.on("click",".toggle-link",function(i){t(i.target).remove(),e.find(".branch-badge").hide(),e.find(".select-lists").removeClass("hidden"),n(r,a,s)})}),p.find(".branch").on("click",".toggle-link",function(e){e.preventDefault()}),p.on("click",".swap-button",function(e){e.preventDefault();{var i=p.find(".branch.source"),r=p.find(".branch.destination"),o=i.find(".branch-badge").html(),s=r.find(".branch-badge").html(),a=t("#id_source"),u=t("#id_source_repo"),c=u.val(),d=a.val(),h=(l(d),t("#id_dest")),m=t("#id_dest_repo"),g=m.val(),v=h.val();l(v)}u.auiSelect2("val",g),n("source",g,i.find(".branch-select")),a.auiSelect2("val",v),i.find(".branch-badge").html(s),m.auiSelect2("val",c),n("dest",c,r.find(".branch-select")),h.auiSelect2("val",d),r.find(".branch-badge").html(o),f&&p.submit()}),p.on("submit",function(e){e.preventDefault(),c=u(p),d.addClass("has-mask").on("pjax:end",function(){d.removeClass("has-mask")}),t.pjax({url:h.replace("::spec",c),container:d,timeout:3e4})});var m=d.find(".content-container"),g=m.find(".merge-button"),v=m.find(".sync-link"),y=m.attr("data-source-repo"),b=m.attr("data-dest-repo"),w=m.attr("data-source-repo-avatar"),x=m.attr("data-dest-repo-avatar"),_=m.attr("data-source-branch"),k=m.attr("data-dest-branch"),C=m.data("source-is-mainbranch"),S=m.data("dest-is-mainbranch"),$=m.data("can-delete-dest"),T=m.attr("data-compare-source-value"),A=m.attr("data-compare-dest-value"),E=m.attr("data-merge-url"),j=m.attr("data-sync-url"),D=m.attr("data-sync-conflict-url");r(g,{getData:function(){var e;return e=y===b?_:C&&S?y:"{}/{}".format(y,_),{action:E,source:T,sourceBranch:_,sourceRepo:y,sourceAvatar:w,sourceAvatarAltText:y,dest:A,destBranch:k,destRepo:b,destAvatar:x,destAvatarAltText:b,sameRepo:y===b,canCloseBranch:y===b&&!C&&$,hasConflicts:!1,mergeCommands:t("#merge-commands-content").html(),commitMessageSlug:e}}}),r(v,{conflictUrl:D,getData:function(){var e;return e=y===b?k:C&&S?b:"{}/{}".format(b,k),{syncBranch:!0,action:j,source:A,sourceBranch:k,sourceRepo:b,sourceAvatar:x,sourceAvatarAltText:b,dest:T,destBranch:_,destRepo:y,destAvatar:w,destAvatarAltText:y,sameRepo:y===b,canCloseBranch:!1,hasConflicts:!1,mergeCommands:t("#merge-commands-content").html(),commitMessageSlug:e}}})})}),define("utils/api-utc-to-date",[],function(){return function(e){var t={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},n=/(\d{4})-(\d{2})-(\d{2})[ |T](\d{2}):(\d{2}):(\d{2})(\+\d{2}:\d{2})?/,i=e.match(n);return new Date("{} {} {} {}:{}:{} UTC".format(i[3],t[i[2]],i[1],i[4],i[5],i[6]))}}),define("components/participants/participant",["backbone","jquery","underscore","utils/api-utc-to-date","jquery-plugins/jquery.localize"],function(e,t,n,i){return e.Model.extend({idAttribute:"username",isNew:function(){return!this.get("last_updated_on")},parse:function(e){return e.user?n.extend({last_updated_on:(new Date).toISOString(),approved:e.user.approved,reviewers:!0,avatar:e.user.links.avatar.href},e.user):e},toJSON:function(){var n=e.Model.prototype.toJSON.call(this);return n.date=this.get("last_updated_on")?t.localize(i(this.get("last_updated_on"))):void 0,n.hasComments=!!this.get("comments"),n},url:function(){return this.collection.likesUrl}})}),define("components/participants/participants",["backbone","underscore","components/participants/participant","utils/api-utc-to-date"],function(e,t,n,i){return e.Collection.extend({model:n,initialize:function(e,t){t=t||{},this.url=t.url,this.likesUrl=t.likesUrl,this.noun=t.noun},comparator:function(e){var t=(new Date).getTime(),n=e.get("last_updated_on");return[e.get("approved")?1:0,n?i(n).getTime():t]},includes:function(e,n){return n=n||this,t.any(n,function(t){return t.get("username")===e})},approved:function(e){return this.some(function(t){return t.get("username")===e&&t.get("approved")})},lastNParticipants:function(e,n,i){function r(e){return e.get("username")===n}var o=this.filter(i);if(o.length<=e)return o;var s=t.tail(o,o.length-e),a=n&&this.includes(n,o);return a&&!t.find(s,r)&&(s.shift(),s.unshift(t.find(o,r))),s},remainingParticipants:function(e,n,i){function r(e){return e.get("username")===n}function o(e){return e.get("username")!==n}var s=this.filter(i);return s.length<=e?[]:(t.find(s,r)&&(s=t.filter(s,o),e-=1),t.initial(s,e))}})}),define("components/participants/helpers",["jquery","underscore","components/participants/participants","utils/api-utc-to-date","utils/dialog-positions","utils/mustache"],function(e,t,n,i,r,o){return{showParticipantsDialog:function(n,i,r,o){n.html(""),n.addClass("show-participants-dialog");var s=e("<ol></ol>");n.append(s),t.each(i,function(e){s.append(this.participantHtml(e,r))},this),o&&o()},participantHtml:function(t,n,r){var s=t.attributes;return s.date=t.get("last_updated_on")?e.localize(i(t.get("last_updated_on"))):void 0,s.size=r||"small",s.noun=n,e(o.toHtml("participant-template",s))},collectionFrom:function(t,i){var r=e.Deferred(),o=new n([],{url:t.data("participants-url"),likesUrl:t.data("likes-url"),noun:t.data("noun")});return i=i||24,o.fetch({reset:!0,data:{avatar_size:i},success:function(e){r.resolve(e)}}),r},centerAlignDialogOptions:{width:"auto",calculatePositions:r.alignCenter()},rightAlignDialogOptions:{width:"auto",calculatePositions:r.alignRight()},leftAlignDialogOptions:{width:"auto",arrowOffsetX:-8}}}),define("components/participants/participants-strip",["backbone","underscore","components/participants/helpers","utils/mustache"],function(e,t,n,i){return e.View.extend({initialize:function(e){this.condition=e.condition||function(){return!0},this.auiAvatarSize=e.auiAvatarSize,this.emptyTemplate=e.emptyTemplate,this.collection.bind("reset",this.render,this),this.collection.bind("participants:refresh",t.bind(this.refreshParticipants,this))},refreshParticipants:function(){this.collection.fetch({reset:!0})},render:function(){return this.renderAvatars(),this},processParticipantsList:function(e){return e},renderAvatarsCompleted:function(){},renderAvatars:function(){this.$el.empty(),this.$el.removeClass("loading");var e=this.collection.filter(this.condition),n=this.processParticipantsList(e);n.length?(this.$el.removeClass("empty"),n.reverse(),t.each(n,this.addAvatar,this)):(this.$el.addClass("empty"),this.emptyTemplate&&this.$el.append(i.toHtml(this.emptyTemplate))),this.renderAvatarsCompleted(e)},addAvatar:function(e){var t=n.participantHtml(e,this.collection.noun,this.auiAvatarSize);this.$el.append(t)}})}),define("components/participants/participants-strip-truncated",["aui","jquery","data/current-user","components/participants/helpers","components/participants/participants-strip"],function(e,t,n,i,r){return r.extend({initialize:function(e){r.prototype.initialize.call(this,e),this.avatarLimit=e.avatarLimit||5,this.align=e.align},events:{"show-all.participants":"showAll"},processParticipantsList:function(e){var t=n.username,i=e.length>this.avatarLimit;return i&&(e=this.collection.lastNParticipants(this.avatarLimit-1,t,this.condition)),e},renderAvatarsCompleted:function(n){var r,o=this.$el,s=n.length-(this.avatarLimit-1);s>1&&(o.append(t('<li><a class="truncated-count aui-badge" href="#">{}</a></li>'.format(s))),r="right"===this.align?i.rightAlignDialogOptions:"center"===this.align?i.centerAlignDialogOptions:i.leftAlignDialogOptions,e.InlineDialog(o.find(".truncated-count"),"remaining-participants",function(e,t,n){o.trigger("show-all.participants",{container:e,callback:n})},r))},showAll:function(e,t){var r=this.collection.remainingParticipants(this.avatarLimit-1,n.username,this.condition),o=t.container,s=t.callback;i.showParticipantsDialog(o,r,this.collection.noun,s)}})}),define("repo/branches/compare-detail-summary",["aui","jquery","on-ready","components/participants/participants","components/participants/participants-strip-truncated","utils/dialog-positions","utils/exists"],function(e,t,n,i,r,o,s){return n(function(n){function a(e,t,n,i,r){var o=e.closest("li");return o.offset().left+o.outerWidth()-n+r.offsetX}var l=t("#participants").find("ol"),u=n.data("contributors");new r({el:l,collection:new i(u),avatarLimit:5,avatarSize:24,align:"center"}).render(),s(".pr-dialog-trigger",function(t){e.InlineDialog(t,"pr-dialog",function(e,t,i){return n.find(".pr-dialog").appendTo(e).show(),i(),!1},{width:"auto",calculatePositions:o.alignTo(a)})}),s(".issue-dialog-trigger",function(t){e.InlineDialog(t,"issue-dialog",function(e,t,i){return n.find(".issue-dialog").appendTo(e).show(),i(),!1},{width:"auto",calculatePositions:o.alignTo(a)})}),n.find(".restrictions span").tooltip()})}),define("repo/branches/compare-tabs",["jquery","on-ready","js/components/toggle-button","components/diff/context-expander","components/diff/diff-actions-2","utils/deferred-image-loader","utils/mustache","utils/query-params"],function(e,t,n,i,r,o,s,a){return t(function(t){function l(){var e=window.location.hash;window.location.hash="",window.location.hash=e}function u(e){return e=e||window.location.hash,0===e.indexOf("#L")||0===e.indexOf("#chg-")}function c(){if(!v)return void f.removeClass("has-mask").html("<p>There are no changes.</p>");if(h)return f.removeClass("has-mask"),void f.append(s.toHtml("diff-too-large-template",{sourceHash:f.attr("data-source-hash"),destHash:f.attr("data-dest-hash")}));var t=e.ajax({url:a.asUrl(f.attr("data-diff-url")),type:"GET",dataType:"html"});t.done(function(t){f.removeClass("has-mask").html(t);var o=new n({el:e("#diff-ignore-whitespace")}).render();f.find(".bb-patch-unified .bb-udiff").each(function(){var t=e(this),n=t.data("filename"),o=t.data("compare-files-url");new r(n,o).decorate(t.find(".diff-actions")),new i(t.data("expand-context-url")+encodeURI(n),t.data("identifier"),!1).decorate(t)}),o.on("toggle",function(e){f.addClass("has-mask"),a.update("w",e?"1":"0"),window.history.replaceState({},"",a.asUrl(window.location.href)),c()}),u(window.location.hash)&&l()}),t.fail(function(){f.removeClass("has-mask").html("<h2>Error</h2><p>We were unable to load this page.</p>")})}function d(){var t=e.ajax({url:g.attr("data-pull-requests-url"),type:"GET",dataType:"html"});t.done(function(e){g.removeClass("has-mask").html(e),o()}),t.fail(function(){g.removeClass("has-mask").html("<h2>Error</h2><p>We were unable to load this page.</p>")})}var h=e("#commit-list-container").data("changesets-limited"),p=e("#compare-diff-tab"),f=e("#compare-diff-content"),m=e("#compare-pull-requests-tab"),g=e("#compare-pull-requests-content"),v=t.data("has-changes");"#diff"===window.location.hash||u(window.location.hash)?(AJS.tabs.change(p.find("a")),c()):p.one("click","a",c),"#pull-requests"===window.location.hash?(AJS.tabs.change(m.find("a")),d()):m.one("click","a",d),t.on("click",".menu-item",function(t){window.location.hash=e(t.target).attr("href").substr("#compare-".length)}),AJS.tabs.setup()})}),function(e){var t="object"==typeof exports&&exports,n="object"==typeof module&&module&&module.exports==t&&module,i="object"==typeof global&&global;(i.global===i||i.window===i)&&(e=i);var r={},o=r.hasOwnProperty,s=function(e,t){if(!e)return t;var n,i={};for(n in t)i[n]=o.call(e,n)?e[n]:t[n];return i},a=/[\x20-\x2C\x2E\x2F\x3B-\x40\x5B-\x5E\x60\x7B-\x7E]/,l=/[\x20\x21\x23-\x26\x28-\x2C\x2E\x2F\x3B-\x40\x5B\x5D\x5E\x60\x7B-\x7E]/,u=/(^|\\+)?(\\[A-F0-9]{1,6})\x20(?![a-fA-F0-9\x20])/g,c=function(e,t){t=s(t,c.options),"single"!=t.quotes&&"double"!=t.quotes&&(t.quotes="single");for(var n,i,r,o,d="double"==t.quotes?'"':"'",h=t.isIdentifier,p=e.charAt(0),f="",m=0,g=e.length;g>m;)i=e.charAt(m++),r=i.charCodeAt(),32>r||r>126?(r>=55296&&56319>=r&&g>m&&(o=e.charCodeAt(m++),56320==(64512&o)?r=((1023&r)<<10)+(1023&o)+65536:m--),n="\\"+r.toString(16).toUpperCase()+" "):n=t.escapeEverything?a.test(i)?"\\"+i:"\\"+r.toString(16).toUpperCase()+" ":/[\t\n\f\r\x0B:]/.test(i)?h||":"!=i?"\\"+r.toString(16).toUpperCase()+" ":i:"\\"==i||!h&&('"'==i&&d==i||"'"==i&&d==i)||h&&l.test(i)?"\\"+i:i,f+=n;return h&&(/^_/.test(f)?f="\\_"+f.slice(1):/^-[-\d]/.test(f)?f="\\-"+f.slice(1):/\d/.test(p)&&(f="\\3"+p+" "+f.slice(1))),f=f.replace(u,function(e,t,n){return t&&t.length%2?e:(t||"")+n}),!h&&t.wrap?d+f+d:f};c.options={escapeEverything:!1,isIdentifier:!1,quotes:"single",wrap:!1},c.version="0.1.0","function"==typeof define&&"object"==typeof define.amd&&define.amd?define("cssesc",[],function(){return c}):t&&!t.nodeType?n?n.exports=c:t.cssesc=c:e.cssesc=c}(this),define("components/branches/checkout-button",["underscore","utils/gaq-push"],function(e,t){return function(n,i){n.click(function(n){var r,o=e.isFunction(i.cloneUrl)?i.cloneUrl(n):i.cloneUrl,s=e.isFunction(i.branchName)?i.branchName(n):i.branchName;r=i&&"hg"===i.scm?s:"refs/heads/{}".format(s),t(["atl._trackEvent","Repo","Checkout Branch",i&&i.scm]),window.location.href="sourcetree://checkoutRef?ref={}&cloneUrl={}&type=bitbucket".format(r,o)})}}),define("components/branches/checkout-dialog",["aui","jquery","components/branches/checkout-button","data/current-user","data/current-repo","utils/mustache"],function(e,t,n,i,r,o){return function(s,a){function l(e){var n=t(e.target).closest(".sourcetree-callout");return n.attr(i.isSshEnabled?"data-ssh-url":"data-https-url")}function u(i,s,u){var d,h=e.InlineDialog.current,p=o.toHtml("branch-checkout-template",{branchName:a()});i.html(p),n(i.find("button"),{cloneUrl:l,branchName:a,scm:r.scm}),d=i.find("input"),d.focus(function(){var e=t(this);e.one("mouseup",function(e){e.preventDefault()}),e.select()}),u(),setTimeout(function(){return h&&h.id===c?void e.InlineDialog.current.hide():void d.select()},0)}var c="checkout-branch-dialog";t("#inline-dialog-checkout-branch-dialog").remove(),e.InlineDialog(s,c,u,{width:360})}}),define("components/branches/delete",["jquery","data/current-repo","components/confirm-dialog"],function(e,t,n){return function(i,r){var o,s=new e.Deferred;return i.on("click",function(i){if(i.preventDefault(),!e(i.target).hasClass("disabled")){var a;"hg"==t.scm?(o=gettext("Close branch"),a=gettext("Are you sure you want to close %(branch_name)s?")):(o=gettext("Delete branch"),a=gettext("Are you sure you want to delete %(branch_name)s?")),n({title:o,content:interpolate(a,{branch_name:r.branch},!0)}).done(function(){e.ajax(r.apiUrl,{dataType:"json",type:"DELETE"}).done(function(){s.resolve(r.branch)}).fail(function(){s.reject(r.branch)})})}}),s}}),define("components/branches/merge",["cssesc","components/merge-dialog"],function(e,t){return function(n,i){var r=new $.Deferred;return t(n,{id:"merge-"+e(i.destBranch,{isIdentifier:!0}),conflictUrl:i.conflictUrl,getData:function(){return{action:i.action,mergeEvent:i.mergeEvent||!1,source:i.source||"{}::{}".format(i.repository,i.sourceBranch),sourceBranch:i.sourceBranch,sourceRepo:i.repository,dest:i.dest||"{}::{}".format(i.repository,i.destBranch),destBranch:i.destBranch,destRepo:i.repository,sameRepo:!0,canCloseBranch:!1,hasConflicts:!1,mergeCommands:"",commitMessageSlug:i.sourceBranch,syncBranch:!!i.syncBranch}},success:function(){r.resolve(i.destBranch,i.sourceBranch)}}),r}}),define("repo/branches/detail",["cssesc","jquery","on-ready","components/alert-dialog","components/merge-dialog","components/branches/checkout-button","components/branches/checkout-dialog","components/branches/delete","components/branches/merge","data/current-repo","data/current-user","utils/exists","utils/message-helper","utils/mustache","jquery-plugins/jquery.pjax"],function(e,t,n,i,r,o,s,a,l,u,c,d,h){return n(function(){var n=t(".content-container"),p=n.attr("data-merge-url"),f=n.attr("data-sync-url"),m=n.attr("data-compare-source-value"),g=n.attr("data-compare-dest-value"),v="{}/{}".format(u.owner.username,u.slug),y=n.attr("data-source-branch"),b=n.attr("data-source-hash"),w=n.data("has-multiple-heads"),x=n.attr("data-dest-branch"),k=n.data("has-source-access"),C=n.data("has-dest-access"),S=n.data("can-delete"),$=n.data("has-conflicts");d(".blank-slate-checkout-button",function(e){o(e,{cloneUrl:e.attr(c.isSshEnabled?"data-ssh-url":"data-https-url"),branchName:y,scm:u.scm})}),d(".checkout-button",function(e){s(e,function(){return y})}),C&&r(n.find(".merge-button"),{id:"merge-"+e(x,{isIdentifier:!0}),conflictUrl:n.attr("data-merge-conflict-url"),getData:function(){return{action:p,mergeEvent:"detail:merge",source:m,sourceBranch:y,sourceRepo:v,dest:g,destBranch:x,destRepo:v,sameRepo:!0,canCloseBranch:S,hasConflicts:$,mergeCommands:$&&t("#merge-commands-content").html(),commitMessageSlug:w?"{} ({})".format(y,b):y}}}),k&&d(".sync-link",function(e){l(e,{action:f,mergeEvent:"detail:sync",repository:v,dest:m,destBranch:y,source:g,sourceBranch:x,conflictUrl:n.attr("data-sync-conflict-url"),syncBranch:!0}).done(function(){h.addMessage("{} successfully synced with {}.".format(y,x)),window.location.reload(!0)})}),S&&a(t(".delete-link"),{branch:y,apiUrl:n.attr("data-delete-url")}).done(function(e){var t;t="hg"===u.scm?"{} successfully closed.".format(e):"{} successfully deleted.".format(e),h.addMessage(t),window.location=n.attr("data-branch-list-url")}).fail(function(e){var t;t="hg"===u.scm?"Failed to close {}.".format(e):"Failed to delete {}.".format(e),i(t)}),t(".compare-choices .branch.destination").on("click",".toggle-link",function(e){e.preventDefault();var i=t(e.delegateTarget),r=n.attr("data-branches-api-url"),o=n.attr("data-branch-detail-url"),s=t("<select/>");i.addClass("loading"),t.getJSON(r).done(function(e){s.append(_.map(e,function(e){return e===x?t('<option selected="selected"/>').text(e)[0]:t("<option/>").text(e)[0]})),i.removeClass("loading").empty().append(s),s.auiSelect2()}),s.on("change",function(){var e=t("#branch-detail");e.addClass("has-mask").on("pjax:end",function(){e.removeClass("has-mask")}),t.pjax({url:"{}?dest={}".format(o,encodeURIComponent(t(this).val())),container:e,timeout:3e4})})})})}),define("repo/branches/filter",["on-ready","jquery","components/filter/status","components/filter/search","components/paginate","jquery-plugins/jquery.pjax"],function(e,t,n,i,r){return e(function(){var e=t("#list-branches"),o=t("#branch-pjax");n({$container:e,$pjaxContainer:o,ignoreQuery:"page"}),i({$pjaxContainer:o,$controls:t("#branch-search"),ignoreQuery:"page"}),r(e,{$pjaxContainer:o,setMask:!1})})}),define("repo/branches/list",["on-ready","jquery","underscore","components/branches/delete","components/branches/merge","data/current-repo","components/alert-dialog","utils/message-helper","utils/mustache"],function(e,t,n,i,r,o,s,a,l){return e(function(){function e(){var e,i=t(".ahead .value, .behind .value");i.length&&(e=t(n.max(i,function(e){return t(e).data("value")})).data("value"),i.each(function(){var n=t(this),i=100*Math.sqrt(n.data("value")/e);n.siblings(".graph").animate({width:i+"%"})}))}function u(){t.ajax({url:m}).done(function(i){"calculating"===i.status?n.delay(function(){u()},1e3):"ready"===i.status&&(c.find("tbody > tr").each(function(){var e=t(this),r=e.attr("data-branch-name"),o="{}:{}".format(r,e.attr("data-branch-hash")),s=i.data[o],a=n.extend(s,{mainbranch:f,name:r,aheadOrBehind:s.ahead>0||s.behind>0}),u=l.toHtml("behind-cell-template",a),c=l.toHtml("ahead-cell-template",a);e.find(".behind").replaceWith(u),e.find(".ahead").replaceWith(c)}),e(),d.removeClass("hidden"))})}var c=t("#list-branches"),d=t("#branch-filters");c.find("a.close-branch").each(function(e,n){var r=t(n);i(r,{branch:r.attr("data-branch"),apiUrl:r.attr("data-api-url")}).done(function(e){var t;t="hg"==o.scm?"{} successfully closed.".format(e):"{} successfully deleted.".format(e),a.addMessage(t);var n=c.find(".paginator .prev-page");0===n.length||c.find("li.branch").length>1?window.location.reload(!0):window.location.href=n.attr("href")}).fail(function(e){var t;t="hg"==o.scm?"Failed to close {}.".format(e):"Failed to delete {}.".format(e),s(t)})});var h=c.attr("data-compare-url"),p=c.attr("data-compare-slug"),f=c.attr("data-main-branch"),m=c.attr("data-meta-url"),g=c.data("has-cache");c.find("a.sync-branch").each(function(e,n){var i=t(n);r(i,{action:h,mergeEvent:"list:sync",repository:p,dest:i.attr("data-compare-value"),destBranch:i.attr("data-branch"),sourceBranch:f,conflictUrl:i.attr("data-conflict-url"),syncBranch:!0}).done(function(e,t){a.addMessage("{} successfully synced with {}.".format(e,t)),window.location.reload(!0)})}),c.find("a.merge-branch").each(function(e,n){var i=t(n);r(i,{action:h,mergeEvent:"list:merge",repository:p,destBranch:f,source:i.attr("data-compare-value"),sourceBranch:i.attr("data-branch"),conflictUrl:i.attr("data-conflict-url")}).done(function(e,t){a.addMessage("{} successfully merged into {}.".format(e,t)),window.location.reload(!0)})}),g?e():u(),d.find("a").tooltip()})}),define("repo/commits/pjax-options",[],function(){return{timeout:5e4}}),define("repo/commits/branch-selector",["jquery","on-ready","js/global/events","repo/commits/pjax-options","components/branches/checkout-dialog","jquery-plugins/jquery.pjax"],function(e,t,n,i,r){return t(function(t){function o(){var t=e("#branch-info"),n=t.attr("data-branch"),i=t.attr("data-kind");a.toggleClass("aui-iconfont-devtools-branch","tag"!==i),a.toggleClass("aui-iconfont-devtools-tag","tag"===i),l.text(n||gettext("All branches")),u.toggleClass("hidden",!n),d.toggleClass("hidden",!n),c.attr("title",t.attr("data-at")),n?(u.insertAfter(c),r(u,function(){return n})):u.detach()}var s=e(".branch-selector-pjax"),a=t.find(".branch-kind"),l=t.find(".name"),u=e("#checkout-branch-button"),c=t.find(".branch-dialog-trigger"),d=e(".show-all-branches");i.container=s,s.on("pjax:start",function(){s.addClass("has-mask")}).on("pjax:end",function(){s.removeClass("has-mask"),n.commands.execute("branchDialog:hide"),o()}),t.pjax(".show-all-branches",i),e.support.pjax&&n.vent.on("branchDialog:click",function(t){e.pjax.click(t,i)}),o()})}),define("utils/svg",[],function(){return function(e,t){function n(e,t,n){var i=document.createElementNS(c,"linearGradient"),r=u.querySelector("defs")||u.insertBefore(document.createElementNS(c,"defs"),u.firstChild);t=t||{},i.setAttribute("id",e),i.setAttribute("spreadMethod","pad"),i.setAttribute("gradientUnits","userSpaceOnUse");for(var o in t)t.hasOwnProperty(o)&&i.setAttribute(o,t[o]);for(var s=0;s<n.length;s++){var a=n[s],l=document.createElementNS(c,"stop");for(var d in a)a.hasOwnProperty(d)&&l.setAttribute(d,a[d]);i.appendChild(l)}return r.appendChild(i)}function i(e,t,n,i){var r=document.createElementNS(c,"circle");return r.setAttribute("cx",t||75),r.setAttribute("cy",n||75),r.setAttribute("r",e),r.setAttribute("fill",i||d.fill),u.appendChild(r),r}function r(e,t){var i,r=document.createElementNS(c,"path");return r.setAttributeNS(null,"d",e),t.stops&&(i="gradient-"+h++,n(i,t.coords,t.stops),t="url(#"+i+")"),r.setAttribute("fill","none"),r.setAttribute("stroke-width","1"),r.setAttribute("stroke",t||d.stroke),u.appendChild(r),r}function o(e,t){return"M"+e+","+t}function s(e,t){return"L"+e+","+t}function a(e,t,n,i){var r=e,o=(i-t)/2+t,s=n,a=i-(i-t)/2;return"C"+r+","+o+" "+s+","+a+" "+n+","+i}function l(e,t,n){var i=e[0],l=e[1],u=t[0],c=t[1],d=[];return d.push(o(i,l)),d.push(i===u||l===c?s(u,c):a(i,l,u,c)),r.call(this,d.join(" "),n)}var u=document.createElementNS("http://www.w3.org/2000/svg","svg"),c=u.namespaceURI,d={fill:"#707070",stroke:"#999999"},h=0;return u.setAttribute("id",e),t&&t.appendChild(u),{circle:i,connect:l,get:function(){return this.svg},gradient:n,path:r}}}),define("repo/commits/graph",["jquery","utils/svg"],function(e,t){return function(n){var i=[[153,153,0],[0,153,0],[0,153,153],[0,0,153],[153,0,153],[153,153,0],[0,0,0]],r=[[191,191,64],[64,191,64],[64,191,191],[64,64,191],[191,64,191],[191,191,64],[64,64,64]];this.offset=n.offset||0,this.svg=t(n.id||"commit-graph-svg",document.getElementById("commit-graph")),this.columns=0,this.bg=[0,4],this.cell=[2,0],this.topPadding=n.topPadding||2,this.rowHeight=n.rowHeight||19,this.columnWidth=n.columnWidth||8,this.isLegacy=!!n.useLegacyRendering,this.getColor=function(e,t){var n=t?i:r,o=n[e%n.length];return"rgb("+o.join(", ")+")"},this.getWidth=function(){return this.columnWidth*this.columns},this.drawCircle=function(e){return this.svg.circle(e.radius,e.x,e.y,this.getColor(e.color,!1))},this.drawPath=function(e){this.svg.connect(e.from,e.to,e.color)},this.getRowElement=function(t){return e("#chg_"+t+" :first-child")},this.drawEdge=function(e,t,n,i){var r,o=this.getRowElement(e),s=o.position().top+this.topPadding,a=this.offset+this.columnWidth*t,l=s+o.outerHeight()+1,u=this.offset+this.columnWidth*n;return this.isLegacy&&(a=400-a,u=400-u),0===e?(s-=20,r={coords:{x1:u,y1:l,x2:a,y2:s}}):e===this.commitCount-1&&(l+=20,r={coords:{x1:a,y1:s,x2:u,y2:l}}),r&&(r.stops=[{offset:0,"stop-color":this.getColor(i,!0),"stop-opacity":1},{offset:"80%","stop-color":this.getColor(i,!0),"stop-opacity":0}]),this.drawPath({from:[a,s+1],to:[u,l],color:r||this.getColor(i,!0)}),this},this.drawNode=function(e,t,n,i){var r=3,o=this.getRowElement(t),s=o.position().top+this.topPadding,a=this.offset+this.columnWidth*n;return this.isLegacy&&(a=400-a),this.drawCircle({radius:r,x:a,y:s,color:i}).setAttribute("title",e),this},this.render=function(t){var n=e("#commit-graph-svg"),i=t.length;n.empty(),this.commitCount=i;for(var r=0;i>r;++r){var o=t[r];if(o){var s=o[0],a=o[1],l=a[0],u=a[1],c=o[2],d=this.getRowElement(r);
this.cell[1]+=d.outerHeight(),this.bg[1]+=this.rowHeight,this.columns=this.columns<c.length?c.length:this.columns;for(var h=0,p=c.length;p>h;++h){var f=c[h],m=f[0],g=f[1],v=this.colorIdx||f[2];this.drawEdge(r,m,g,v)}0!=r&&this.drawNode(s,r,l,u)}}return n.attr("width",this.getWidth()),this}}}),define("repo/commits/build-graph",["jquery","on-ready","repo/commits/graph"],function(e,t,n){return t(function(t){var i,r,o=e("#commit-graph"),s=o.parent().height()+80,a="commit-graph-svg",l={id:a,topPadding:16,offset:5},u=JSON.parse(o.attr("data-graph"));u&&u.length&&(o.height(s),i=new n(l).render(u,t.hasClass("expandable")),r=i.getWidth(),e("#"+a).attr("height",s).attr("width",r),t.width(r+10))})}),define("components/participants/approve-button",["aui","backbone","data/current-user","utils/gaq-push"],function(e,t,n,i){var r=n.username;return t.View.extend({initialize:function(){this.$button=this.$el,this.collection.bind("reset",this.render,this),this.collection.bind("participants:refresh",_.bind(this.render,this))},events:{click:"toggle"},toggle:function(t){t.preventDefault();var n=this.$button,i=this.collection,o=i.approved(r);if(!n.hasClass("disabled")){n.addClass("disabled"),n.prop("disabled",!0),n.attr("aria-disabled",!0);var s=setTimeout(function(){n.addClass("loading")},300),a={success:function(){i.fetch({reset:!0,complete:function(){clearTimeout(s),n.removeClass("disabled loading"),n.prop("disabled",!1),n.attr("aria-disabled",!1)}}),i.trigger("approved",!o)},error:function(t,n){e.messages.error({body:n.responseText})},wait:!0};o?(this.analytics(!1),i.find(function(e){return e.get("username")==r}).destroy(a)):(this.analytics(!0),i.create({username:r},a))}},render:function(){var e=this.collection.approved(r);this.$button.find("span").text(gettext(e?"Unapprove":"Approve"))},analytics:function(e){i(["atl._trackEvent","Approvals",this.collection.noun,e?"Approved":"Unapproved"])}})}),define("components/diff/diff-actions",["jquery","underscore","data/current-cset","data/current-repo","components/diff/bitbucket-side-by-side-diff","utils/gaq-push","jquery-plugins/jquery.fancybox"],function(e,t,n,i,r,o){var s=function(e,n){this.diff_=e,this.filename_=n,this.sbsDiff_=new r(e),this.id_=t.uniqueId("side-by-side-"),this.$elem_=null,this.$container_=null};return s.prototype.createDom=function(){var t=gettext("side-by-side diff"),r=gettext("view file");this.$elem_=e(['<div class="diff-actions">',"<ul>",'<li class="sbs-item"><a class="execute click sbs" href="#',this.id_,'">{}</a></li>','<li class="view-file-item"><a class="view-file">{}</a></li>',"</ul>",'<div class="bb-patch" id="',this.id_,'"></div>',"</div>"].join("").format(t,r));var o=n||"tip";this.$elem_.find("a.view-file").attr("href","/"+i+"/src/"+o+"/"+this.filename_),this.$container_=this.$elem_.children("div").hide()},s.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.enterDocument()},s.prototype.enterDocument=function(){var t=this;this.$elem_.find("a.sbs").fancybox({autoSize:!1,margin:30,width:"97%",height:"97%",scrolling:"no",afterShow:function(){e(this.element).trigger("sbsOpen")},afterClose:function(){e(this.element).trigger("sbsClose")}}).bind("sbsOpen",function(){t.onDialogOpen_.apply(t)}).bind("sbsClose",function(){t.onDialogClose_.apply(t)})},s.prototype.exitDocument=function(){},s.prototype.onDialogOpen_=function(){o(["atl._trackEvent","Code","Invoke SBS diff"]),e("#fancybox-wrap").css({position:"fixed",top:15,left:15}),this.$container_.show(),this.sbsDiff_.setHeight(this.$container_.parent().height()-60-(this.diff_.hasNote()?59:0)),this.sbsDiff_.setWidth(this.$container_.parent().width()),0===this.$container_.children().length&&this.sbsDiff_.render(this.$container_),setTimeout(e.proxy(this.sbsDiff_.scrollToFirstHunk,this.sbsDiff_),0)},s.prototype.onDialogClose_=function(){this.$container_.hide()},s}),define("components/diff/file-numbers",["jquery"],function(e){var t=function(e,t){this.file_=e,this.lineHeight=t,this.$elem_=null};return t.prototype.createDom=function(){this.$elem_=e('<div class="file-numbers">'),this.file_.lineHeightPx=this.lineHeight,this.file_.numbersBoxDom=this.$elem_[0],this.file_.scrollBoxDom=e("<div>")[0]},t.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.enterDocument()},t.prototype.enterDocument=function(){},t.prototype.exitDocument=function(){},t}),define("components/diff/unified-diff",["jquery","components/diff/file-numbers","components/diff/hunk","components/diff/lined-pane","components/diff/scrollable-file-pane"],function(){var e=function(e,t){this.udiff_=e,this.numLines_=this.udiff_.to.numLines,this.lineHeight=t,this.focusOffset=5,this.pane_=LinedPane.window(this.numLines_,928,t),this.fromNumbers_=new FileNumbers(this.udiff_.from,t),this.unifiedLines_=new ScrollableFilePane(this.udiff_.to,t),this.$elem_=null};return e.prototype.createDom=function(){},e.prototype.render=function(e){this.createDom(),this.pane_.render(e),this.$elem_=this.pane_.$content().addClass("diffract diffract-udiff"),e.append(this.$elem_),this.fromNumbers_.render(this.pane_.$content()),this.unifiedLines_.render(this.pane_.$content());var t=35;this.unifiedLines_.setPaneWidth(928-t-1),this.unifiedLines_.scrollx()&&this.$elem_.css("margin-bottom",$.getScrollbarWidth()),this.showVisibleLines_(),this.enterDocument()},e.prototype.enterDocument=function(){$(this.pane_).bind("aperture-lined-pane/scroll",$.proxy(this.showVisibleLines_,this)),this.fromNumbers_.$elem_.add(this.unifiedLines_.$elem_).delegate(".skipped","click.skipped",$.proxy(this.expandSkipped_,this))},e.prototype.exitDocument=function(){$(this.pane_).unbind("aperture-lined-pane/scroll"),$([this.fromNumbers_.$elem_,this.unifiedLines_.$elem_]).undelegate("click.skipped"),this.fromNumbers_.exitDocument(),this.unifiedLines_.exitDocument(),this.pane_.exitDocument()},e.prototype.showVisibleLines_=function(){var e=this.pane_.visibleRange();e&&this.udiff_.ensureVisible(new Hunk(e,e))},e.prototype.expandSkipped_=function(e){var t=$(e.target).closest(".skipped");$(this).trigger("diffract-skipped/click",[t,t.data("skipped-index")])},e.prototype.contextFile_=function(){return this.udiff_.to},e.prototype.unifiedFile_=function(){return this.contextFile_().file_.file_},e.prototype.scrollToFromLine=function(e){var t=this.unifiedFile_().from2unified_[e];return this.scrollToUnifiedLine(t)},e.prototype.scrollToToLine=function(e){var t=this.unifiedFile_().to2unified_[e];return this.scrollToUnifiedLine(t)},e.prototype.scrollToUnifiedLine=function(e){var t=this.contextFile_(),n=t.file2viewport[e],i=t.viewport2file[n];return"number"==typeof i?(n=Math.max(1,n-this.focusOffset),this.pane_.scrollToLine(n,0,0),!0):!1},e}),define("components/diff/bitbucket-unified-diff",["aui","jquery","components/diff/diff","components/diff/heading-renderer","components/diff/diff-actions","components/diff/note-renderer","components/diff/unified-diff","utils/gaq-push"],function(e,t,n,i,r,o,s,a){var l=function(e){var t=n.ofContext(n.unified(e),l.CONTEXT),a=t.filename();this.sbsdiff=e,this.diff_=t,this.heading_=new i(a,t.hasConflicts()),this.sbsbutton_=new r(e,a),this.note_=t.hasNote()?new o(t.note):null,this.unifiedDiff_=new s(t,18),this.hoverTimeout_=null,this.$elem_=null};return l.CONTEXT=3,l.prototype.createDom=function(){this.$elem_=t('<section class="bb-udiff iterable-item"></section>')},l.prototype.render=function(e){this.createDom(),e.append(this.$elem_),this.heading_.render(this.$elem_),this.sbsbutton_&&this.sbsbutton_.render(this.heading_.$elem_),this.note_&&this.note_.render(this.$elem_),this.unifiedDiff_.render(this.$elem_),this.enterDocument()},l.prototype.enterDocument=function(){t(this.unifiedDiff_).bind("diffract-skipped/click",t.proxy(this.expandSkipped,this)),this.unifiedDiff_.$elem_.on("mouseenter",".skipped",t.proxy(this.mouseenter_,this)),this.unifiedDiff_.$elem_.on("mouseleave",".skipped",t.proxy(this.mouseleave_,this))},l.prototype.exitDocument=function(){t(this.unifiedDiff_).unbind("diffract-skipped/click")},l.prototype.replaceDiff_=function(e){this.unifiedDiff_.exitDocument(),this.unifiedDiff_.$elem_.remove(),this.diff_=e,this.unifiedDiff_=new s(this.diff_,18),this.unifiedDiff_.render(this.$elem_),this.enterDocument()},l.prototype.expandSkipped=function(e,t,i){a(["atl._trackEvent","Code","Expand unified diff"]),t.tooltip("hide"),this.replaceDiff_(n.expandSkippedSection(this.diff_,i))},l.prototype.mouseenter_=function(e){var n=t(e.target).closest(".skipped");this.hoverTimeout_=setTimeout(_.bind(this.hover_,this,n),200)},l.prototype.hover_=function(e){e.tooltip(this.tipsySettings_),e.tooltip("show")},l.prototype.mouseleave_=function(e){clearTimeout(this.hoverTimeout_);var n=t(e.target).closest(".skipped");n.tooltip("hide")},l.prototype.tipsySettings_={title:function(){return gettext("Show more lines")},gravity:"s",trigger:"manual"},l.prototype.scrollToFromLine=function(e){e>=1&&e<=this.sbsdiff.from.numLines&&(this.unifiedDiff_.scrollToFromLine(e)||(this.replaceDiff_(n.expandToInclude(this.diff_,"from",e)),this.scrollToFromLine(e)))},l.prototype.scrollToToLine=function(e){e>=1&&e<=this.sbsdiff.to.numLines&&(this.unifiedDiff_.scrollToToLine(e)||(this.replaceDiff_(n.expandToInclude(this.diff_,"to",e)),this.scrollToToLine(e)))},l}),define("components/diff/deferred-diff",["jquery","components/diff/heading-renderer","components/diff/note-renderer"],function(e,t,n){var i=function(e,i){this.filename=e,this.url=i,this.heading_=new t(e,!1),this.note_=new n("Click to load."),this.$elem_=null};return i.prototype.createDom=function(){this.$elem_=e('<section class="bb-deferred-diff iterable-item"></section>')},i.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.heading_.render(this.$elem_),this.note_.render(this.$elem_),this.enterDocument()},i.prototype.enterDocument=function(){this.note_.$elem_.bind("click.deferred-diff",e.proxy(this.load_,this))},i.prototype.exitDocument=function(){this.note_.$elem_.unbind("click.deferred-diff")},i.prototype.load_=function(){this.isLoading()||(this.note_.$elem_.addClass("loading"),this.note_.setNote("Loading..."),e(this).trigger("deferred-diff/load",[this.filename]))},i.prototype.isLoading=function(){return this.note_.$elem_.hasClass("loading")},i}),define("components/diff/note-only-diff",["jquery","components/diff/heading-renderer","components/diff/note-renderer"],function(e,t,n){var i=function(e){this.heading_=new t(e.filename(),e.hasConflicts()),this.note_=new n(e.note),this.$elem_=null};return i.prototype.createDom=function(){this.$elem_=e('<section class="bb-udiff iterable-item"></section>')},i.prototype.render=function(e){this.createDom(),this.$elem_.appendTo(e),this.heading_.render(this.$elem_),this.note_.render(this.$elem_),this.enterDocument()},i.prototype.enterDocument=function(){},i.prototype.exitDocument=function(){},i}),define("components/diff/bitbucket-patch",["jquery","data/client","data/current-repo","data/current-cset","components/diff/bitbucket-unified-diff","components/diff/deferred-diff","components/diff/diff","components/diff/note-only-diff","components/diff/permalinker","utils/api-helper"],function(e,t,n,i,r,o,s,a,l,u){var c=function(t,r){var a=this;this.filenames_={},this.diffs_=[],this.deferred_=[],this.waitForDiffToLoad=e.Deferred(),this.diffEndpoint=r||u.concat("repositories",n.owner.username,n.slug,"changesets",i,"diff").toString(),e.ajax({type:"GET",url:this.diffEndpoint,dataType:"json",success:function(n){t.each(function(t,i){var l=e(i),u=l.hasClass("deferred");if(u){var c=l.attr("data-filename"),d=new o(c,a.diffEndpoint);a.deferred_.push(d),a.filenames_[c]=d}else{var h,p=s.sideBySideFromData(n[t]);r&&(p.url=r),h=a.newDiffRenderer(p,u),a.diffs_.push(h),a.filenames_[p.filename()]=h,this.$elem_=null}}),a.waitForDiffToLoad.resolve()}}),this.$elem_=null};return c.prototype.newDiffRenderer=function(e){return e.hasNote()&&!e.hasDiffContent()?new a(e):new r(e)},c.prototype.createDom=function(){this.$elem_=e('<div class="bb-patch">')},c.prototype.render=function(e){var t=this;this.waitForDiffToLoad.done(function(){t.createDom(),t.$elem_.appendTo(e);for(var n=0;n<t.diffs_.length;n++)t.diffs_[n].render(t.$elem_);for(n=0;n<t.deferred_.length;n++)t.deferred_[n].render(t.$elem_);t.enterDocument(),t.scrollToPermalink_()})},c.prototype.enterDocument=function(){e(this.deferred_).bind("deferred-diff/load",e.proxy(this.fetchDeferred_,this)),e(document).bind("diff-load-start",e.proxy(this.loadingStart_,this)).bind("diff-load-end",e.proxy(this.loadingEnd_,this)),e(window).bind("hashchange",e.proxy(this.scrollToPermalink_,this))},c.prototype.exitDocument=function(){e(this.deferred_).unbind("deferred-diff/load")},c.prototype.fetchDeferred_=function(t,n){var i=this.filenames_[n],r=this.diffEndpoint.toString();e.ajax({type:"GET",url:i.url||r.toString(),data:{filename:n,meta:!0},dataType:"json",success:e.proxy(this.insertDeferred_,this)})},c.prototype.insertDeferred_=function(t){var n=s.sideBySideFromData(t[0]),i=this.newDiffRenderer(n),r=this.filenames_[n.filename()];r.exitDocument(),r.$elem_.empty();var o=e.inArray(this.deferred_,n.filename());o>=0&&delete this.deferred_[o],i.render(r.$elem_),r.$elem_.replaceWith(i.$elem_),this.filenames_[n.filename()]=i;var a=(new l).parse(window.location.hash);a&&a.path===n.filename()&&this.scrollToPermalink_()},c.prototype.loadingStart_=function(e,t){var n=this.filenames_[t];n&&n.$elem_.addClass("loading-diff")},c.prototype.loadingEnd_=function(e,t){var n=this.filenames_[t];n&&n.$elem_.removeClass("loading-diff")},c.prototype.scrollToPermalink_=function(e){var n=(new l).parse(window.top.location.hash);if(n){var i=this.filenames_[n.path];if(i instanceof o)this.fetchDeferred_(null,n.path);else if(i){var r=!e,s="from"===n.file?i.scrollToFromLine:i.scrollToToLine;!r||"Chrome"!==t.browser&&"Safari"!==t.browser?s.call(i,n.line):setTimeout(function(){s.call(i,n.line)},200)}}},c}),define("components/diff/commentable-diff",["aui","jquery","underscore","components/comments/comment","components/comments/comment-form","components/comments/line-comment"],function(e,t,n,i,r,o){var s=e.sidebar(".aui-sidebar"),a=function(e,t,n,i,s){this.endPoint=e,this.filename=t,this.anchor=i,this.destrev=s,this.commentForm=new r,this.$elem=null,this.threads=o.decorateThreads(e.toString(),n,t)};return a.prototype.decorate=function(e){return this.$elem=e,this.enterDocument(),this},a.prototype.calculateListWidth=function(){var e=this.$elem.find(".comment-thread-container:first");if(!e.length)return!1;var t=parseInt(e.css("padding-left").replace("px",""),10),n=parseInt(e.css("padding-right").replace("px",""),10),i=e.find(".comments-list"),r=parseInt(i.css("border-left-width").replace("px",""),10),o=parseInt(i.css("border-right-width").replace("px",""),10);return this.listWidth=this.$elem.width()-t-n-r-o,this.listWidth},a.prototype.setListWidth=function(){this.$elem.find(".comments-list").css("max-width",this.calculateListWidth())},a.prototype.enterDocument=function(){this.$elem.on("click",".add-diff-comment",t.proxy(this.showForm,this)),t(this.commentForm).bind("comment-form/cancel",t.proxy(this.hideForm,this));var e=this;n.each(this.threads,function(n){t(n).bind("line-comment/thread-deleted",t.proxy(e.cleanUpThreads,e))}),this.$elem.find(".comments-list").css("max-width",this.calculateListWidth()),t(window).on("resize",this.setListWidth.bind(this)),s.on("expand-end collapse-end",this.setListWidth.bind(this))},a.prototype.showForm=function(e){e.preventDefault(),this.hideForm();var r=t(e.target).closest(".add-diff-comment"),o={content:"",filename:this.filename,anchor:this.anchor,dest_rev:this.destrev},s=r.siblings(".line-numbers").data("fnum"),a=r.siblings(".line-numbers").data("tnum");s&&a||s?o.line_from=s:o.line_to=a;var l=new i(o,{urlRoot:this.endPoint.toString()});this.commentForm.comment=l,l.on("sync",n.once(this.insertNewComment),this);var u;if(r.hasClass("add-file-comment")){var c=r.closest(".diff-container").find(".diff-content-container");u=c.children(".comment-thread-container")}else{var d=r.closest(".udiff-line");u=d.next(".comment-thread-container")}u.length||(u=t('<div class="comment-thread-container"><ol class="comments-list"></ol></div>'),c?u.prependTo(c):d&&u.insertAfter(d),u.find(".comments-list").css("max-width",this.listWidth?this.listWidth:this.calculateListWidth())),u.removeClass("existing-comment");var h=u.find(".comments-list");this.commentForm.$elem?this.commentForm.$elem.prependTo(h):this.commentForm.render(h),this.commentForm.showAndFocus()},a.prototype.insertNewComment=function(e){var n=this.commentForm.$elem.parent(".comments-list"),i=new o(e).render(n);t(i).bind("line-comment/thread-deleted",t.proxy(this.cleanUpThreads,this)),this.threads.push(i),this.hideForm(),i.scrollTo(),this.commentForm.clearContents(),t(document).trigger("comment-added")},a.prototype.acceptLineComments=function(e){var i=this;n.each(e,function(e){t(e).bind("line-comment/thread-deleted",t.proxy(i.cleanUpThreads,i)),i.threads.push(e)})},a.prototype.cleanUpThreads=function(){n.each(this.$elem.find(".comment-thread-container:not(:has(li.comment, li.new-comment))"),function(e){t(e).remove()})},a.prototype.hideForm=function(){if(this.commentForm.$elem){var e=this.commentForm.$elem.parent(".comments-list");if(this.commentForm.$elem.detach(),!e.children().length){var t=e.parent(".comment-thread-container");t.remove()}}},a}),define("components/comments/comment-count-indicator",["jquery"],function(e){var t=function(e,t){this.$countElem=e,this.$commentContainer=t};return t.prototype.decorate=function(){this.$commentContainer.on("comment-count/create",e.proxy(this.updateCount,this)),this.$commentContainer.on("comment-count/delete",e.proxy(this.updateCount,this))},t.prototype.updateCount=function(){var e=this.$commentContainer.find("li.comment:not(.deleted)").length,t=this.$commentContainer.find(".eclipsedcount span").text();t&&(e+=parseInt(t)),this.$countElem.html(e),0===e?this.$countElem.closest(".count-badge").addClass("zero"):this.$countElem.closest(".count-badge").removeClass("zero")},t}),define("components/diff/deferred-large-diff",["jquery","underscore","components/comments/comment-count-indicator","components/diff/commentable-diff","components/diff/context-expander","components/diff/diff-actions-2","utils/mustache"],function(e,t,n,i,r,o,s){var a={};return a.setupDeferredDiffMarkers=function(a,l,u){e("#commit-files-summary li.truncated").each(function(n,i){t.defer(function(t){var n=e(t),i=n.data("file-identifier"),r=n.find("a.execute").text(),o=n.hasClass("file-conflicts"),l=n.find(".count-badge .count").text(),u={diffidentifier:i,filename:r,conflicts:o};"0"!==l&&(u.eclipsedcount=l);var c=e(s.toHtml("diff-too-big-template",u));a.append(c),n.on("click",function(){c.find(".load-diff").click()})},i)}),a.on("click",".load-diff",function(s){s.preventDefault();var a=e(s.target),c=a.closest(".bb-udiff"),d=c.data("identifier"),h=e('#commit-files-summary li[data-file-identifier="{}"]'.format(d)),p=e('<div class="mask">'),f=e("#compare"),m=f.attr("data-anchor"),g=f.attr("data-dest-rev");c.find(".too-big-message .title").append(p),p.show(),e.ajax({type:"GET",url:window.location,data:{file:d},dataType:"html",success:function(s){var a,p=e(s),f=p.find('section[data-identifier="{}"]'.format(d)),v=p.find('#commit-files-summary li[data-file-identifier="{}"]'.format(d)),y=f.data("filename"),b=f.data("compare-files-url"),w=t.keys(f.data("linecommentroots")||{});return f.length?(c.replaceWith(f),h.replaceWith(v),l&&(new n(v.find(".count-badge .count"),f).decorate(),a=new i(u,y,w,m,g).decorate(f)),new o(y,b).decorate(f.find(".diff-actions")),new r(f.data("expand-context-url")+encodeURI(y),f.data("identifier"),!0,a,u?u.toString():"").decorate(f),void f.trigger("deferred-large-diff/load",s)):(c.find(".too-big-message .try-again").hide(),c.find(".too-big-message .try-again-failed").show(),void c.find(".mask").remove())}})})},a}),define("components/comments/general-comment-form",["jquery","underscore","components/comments/comment","components/comments/comment-form","components/comments/line-comment"],function(e,t,n,i,r){var o=function(e,t){this.endPoint=e,this.comment=this.newModel(),this.commentForm=new i(this.comment),this.insertWhere=t?"before":"after",this.$elem=null};return o.prototype.newModel=function(){var e=new n({content:""},{urlRoot:this.endPoint.toString()});return e.on("sync",t.once(this.insertNewComment),this),e},o.prototype.decorate=function(e){return this.$elem=e,this.commentForm.decorate(e),this.enterDocument(),this},o.prototype.enterDocument=function(){},o.prototype.insertNewComment=function(t){new r(t).render(this.$elem,this.insertWhere),e(document).trigger("comment-added"),this.comment=this.newModel(),this.commentForm.comment=this.comment,this.commentForm.shrinkSize(),this.commentForm.clearContents()},o}),define("components/diff/index",["jquery","data/current-cset","data/current-repo","components/diff/bitbucket-patch","components/diff/commentable-diff","components/diff/diff-actions-2","components/diff/context-expander","components/diff/deferred-large-diff","components/comments/comment-count-indicator","components/comments/general-comment-form","components/comments/line-comment","utils/api-helper"],function(e,t,n,i,r,o,s,a,l,u,c,d){var h=function(){var h=e("#changeset-diff"),p=e(".file-diff-placeholder");if(1===h.length&&p.length)new i(p).render(h);else if(1==h.length&&!e("#pullrequest").length){var f=e("#comment-info"),m=f.data("comment-url"),g=f.data("general-thread-ids"),v=f.data("file-line-thread-ids"),y=h.find(".bb-patch-unified");if(y.find(".bb-udiff, .comment-content .bb-udiff").each(function(){var i,a=e(this),l=a.data("filename"),u=a.data("compare-files-url"),c=a.parent().is(".comment-content");if(v){var h=v[l]||[];i=new r(m,l,h).decorate(a)}var p=d.concat("repositories",n.owner.username,n.slug,"changesets",t,"comments").toString();new o(l,u).decorate(a.find(".diff-actions")),new s(a.data("expand-context-url")+encodeURI(l),a.data("identifier"),!c,i,p).decorate(a)}),g){new u(m,!0).decorate(e("#comments-list.line-commenting > li.new-comment")),c.decorateThreads(m,g);var b=e("#general-comments .comment-count"),w=e("#comments-list");new l(b,w).decorate()}e("#commit-files-summary").on("click",".comments-link",function(t){var n=e(t.target).data("file-path"),i=e(document.getElementById("chg-"+n)),r=i.find("li.comment").first().data("modelobj");r&&(r.scrollTo(),t.preventDefault())}),e("#commit-files-summary .count-badge").each(function(t,n){var i=e(n),r=i.find(".count"),o=e(document.getElementById("chg-"+i.find(".comments-link").data("file-path")));new l(r,o).decorate()}),a.setupDeferredDiffMarkers(y,g,m)}};e(h),e(document).on("pjax:end",h)}),define("repo/commits/commit-header",["aui","jquery","on-ready","utils/query-params","js/components/toggle-button","components/participants/approve-button","components/participants/helpers","components/participants/participants-strip-truncated","components/diff/index"],function(e,t,n,i,r,o,s,a){return n(function(){var n=t("#commit-header"),l=t("#watch-commit-icon"),u=n.find(".participants"),c=new r({el:t("#diff-ignore-whitespace")}).render();s.collectionFrom(u).done(function(e){new a({el:n.find("#participants").find("ol"),collection:e,avatarLimit:6,align:"right"}).render(),new o({el:n.find(".approve-button"),collection:e}).render(),e.bind("approved",function(e){e&&n.find("a.follow").trigger("toggle-follow",{type:"commit",isNowFollowing:!0})}),t(document).on("comment-added",function(){e.trigger("participants:refresh"),n.find("a.follow").trigger("toggle-follow",{type:"commit",isNowFollowing:!0})})}),n.on("follow:commit","a.follow",function(e,t){l.toggleClass("aui-iconfont-watch",t).toggleClass("aui-iconfont-unwatch",!t)});var d=["parents","branches","tags"];t.each(d,function(n,i){e.InlineDialog(t(".truncated-"+i+"-count"),"extra-"+this,function(e,n,r){e.append(t(".extra-"+i)),r&&r()})}),c.on("toggle",function(e){i.update("w",e?"1":"0"),window.location.href=i.asUrl(window.location.href)})})}),define("repo/commits/filter",["jquery","on-ready","components/filter/search","repo/commits/pjax-options"],function(e,t,n,i){return t(function(t){function r(){var n=e("#branch-info").attr("data-branch"),i=e("#corrected-search").attr("data-value");n?(t.addClass("hidden"),l.val("")):(t.removeClass("hidden"),i&&"tip"!=i&&!l.is(":focus")&&l.val(i))}var o=t.find(".help"),s=e("#commit-filter-help"),a=e("#commits").find(".pjax"),l=t.find("input");n({$pjaxContainer:a,$controls:t,pjaxOptions:i,ignoreQuery:"page"}),o.on("click",function(t){s.toggleClass("hidden"),e(t.target).toggleClass("bb-inline-dialog-anchor")}),t.on("submit",function(){s.addClass("hidden"),o.find("span").removeClass("bb-inline-dialog-anchor"),e(".more-action-menu.active").trigger("aui-button-invoke")}),a.on("pjax:end",r)})}),define("repo/commits/list",["aui","jquery","on-ready","repo/commits/pjax-options","components/paginate","utils/localize","utils/mustache"],function(e,t,n,i,r,o,s){return n(function(n){function a(e,n,i){c.refresh(),e.html(s.toHtml("unmapped-author-dialog",{link:t(n).attr("href"),raw_author:t(n).data("raw-author")})),i&&i()}var l=t(".commit-list"),u=t("#commits").find(".pjax"),c=e.InlineDialog(l.find("a.unmapped-user"),"unmapped-user",a);r(n,{$pjaxContainer:u}),i.container=u,n.pjax(".commit-labels a",i),n.pjax(".branch-name",i),u.on("pjax:end",function(){o()})})}),define("repo/create",["jquery","on-ready","utils/event-tracking-helper"],function(e,t,n){return t(function(){var t=e("#repo-create"),i=n("Repo Create");t.find("a.import-repo").on("click",function(){i("Import Repository Link - Clicked")}),t.find("a.doc-101").on("click",function(){i("New to Bitbucket? Link - Clicked")}),t.find("a.team-pitch").on("click",function(){i("Working in a team? Link - Clicked")}),t.find('button[type="submit"]').on("click",function(){i("Create Repository Button - Clicked")}),t.find("a.cancel").on("click",function(){i("Cancel Link - Clicked")})})}),define("repo/create-branch",["aui","jquery","on-ready","js/components/aui-dialog","utils/loading"],function(e,t,n,i){return i(function(){function e(e){var i=new n({width:600,height:"auto",id:"create-branch-dialog",closeOnOutsideClick:!0});return i.addHeader(gettext("Create branch")),i.addPanel("panel-create"),i.addButton(gettext("Create"),function(){var e=t(o.popup.element);e.find(".dialog-button-panel button").loading(),e.find("#create-branch-form").submit()},"aui-button"),i.addCancel(gettext("Cancel"),function(e){e.hide()}),r=t.ajax({type:"get",url:e.attr("href"),dataType:"html"}),i}function i(n){var i=t(n.target).closest(".create-branch-button");n.preventDefault(),o=o||e(i),i.loading(r).done(function(e){var n=t(e);n.find(".buttons").remove(),o.getCurrentPanel().body.html(n),require(["branches/create"],function(e){e.onReady()})}).fail(function(){t(o.getCurrentPanel().body).append('<p class="error">An unexpected error occurred.</p>')}).always(function(){o.show()})}var r,o;t(document).on("click",".create-branch-button",i)})}),define("repo/downloads/captcha-form",["jquery","on-ready"],function(e,t){return t(function(t){var n=t.attr("action"),i=e("#upload-file-form"),r=e("#captcha-wrong");t.submit(function(){return e.getJSON(n,e(this).serialize(),function(e){"success"===e.status?(i.find('[name="token"]').val(e.token),i.removeClass("hidden"),t.addClass("hidden")):"fail"===e.status&&r.removeClass("hidden")}),!1})})}),define("repo/downloads/index",["jquery","on-ready","components/confirm-dialog"],function(e,t,n){return t(function(t){var i=e("#downloads-count"),r=+i.text();t.find("a[data-id]").click(function(t){t.preventDefault();var o=e(this),s=o.data(),a=gettext("Permanently delete %(filename)s?");n({title:gettext("Delete download"),content:interpolate(a,{filename:s.filename},!0)}).done(function(){o.addClass("deleting"),e.post(o.attr("href"),{file_id:s.id},function(){var e=o.closest("tr");e.siblings().length?(e.remove(),i.text(r-=1)):window.location.reload()})})})})}),define("repo/downloads/upload-file-form",["jquery","on-ready","utils/disable"],function(e,t){return t(function(t){var n=t.find("#files"),i=t.find("#content-type"),r=t.find("#upload-button");r.disable(!1).click(function(e){e.preventDefault(),n.click()}),n.change(function(){var o=n.val().match(/[^\/\\]*$/)[0];i.val(e.ajax({url:"/site/mimeguess/"+o,async:!1,dataType:"json"}).responseText),t.find('input[name="Content-Disposition"]').attr("value","attachment; filename="+o),r.addClass("loading").disable(!0),t.submit()})})}),define("js/behaviors/warns-on-page-change",["jquery","underscore","marionette"],function(e,t,n){return n.Behavior.extend({initialize:function(){this._warnHandler=function(){return t.result(this.options,"condition")?t.result(this.options,"message"):void 0}.bind(this),e(window).on("beforeunload",this._warnHandler)},onDestroy:function(){e(window).off("beforeunload",this._warnHandler)},defaults:{condition:!0,message:gettext("Your changes will be lost. Are you sure you want to leave?")}})}),define("js/components/markup-language-dropdown",["marionette"],function(e){return e.ItemView.extend({languageNames:{markdown:"Markdown",creole:"Creole",rest:"reStructuredText",textile:"Textile"},events:{"click a":"updateLanguage","aui-dropdown2-show":"setActive"},initialize:function(e){this.$languageBtn=e.$languageBtn,this.language=e.language,this.on("change:language",function(e){this.language=e,this.render()})},render:function(){return this._buttonAuified||(this.auifyButton(),this._buttonAuified=!0),this.updateLabel(this.language),this},updateLanguage:function(e){e.preventDefault(),this.trigger("change:language",$(e.target).data("markupLang"))},auifyButton:function(){this.$languageBtn.removeClass("hidden").find("a").addClass("aui-dropdown2-trigger aui-dropdown2-trigger-arrowless aui-style-default").attr({"aria-haspopup":"true","aria-owns":"dropdown-wiki-lang","data-container":"#markItUpId_data"})},updateLabel:function(e){var t='<span class="aui-icon-dropdown"></span>';this.$languageBtn.find("a").text(this.languageNames[e]).append(t)},setActive:function(){this.$("li a").removeClass("active"),this.$('a[data-markup-lang="'+this.language+'"]').addClass("active")}})}),define("js/components/markup-editor",["jquery","underscore","marionette","aui","js/behaviors/warns-on-page-change","js/components/markup-language-dropdown","config/markitup","jquery-plugins/jquery.markitup"],function(e,t,n,i,r,o,s){return n.ItemView.extend({behaviors:function(){return{WarnsOnPageChange:{behaviorClass:r,condition:function(){return this.getContent()!==this.initialContent&&!this._submitting}.bind(this)}}},events:{"keydown @ui.textarea":"checkForSubmission"},ui:{textarea:"textarea"},initialize:function(){this.bindUIElements(),this.initialContent=this.getContent(),this.language=this.$el.data("markup-type")||"markdown",this.listenForSubmission()},getContent:function(){return this.ui.textarea.val()},render:function(){return this.ui.textarea.markItUp(s(t.result(this,"markItUpOptions"))),this.bindUIElements(),this},listenForSubmission:function(){var t=this.ui.textarea[0].form;t&&e(t).on("submit",function(){this._submitting=!0}.bind(this))},checkForSubmission:function(e){e.keyCode===i.keyCode.ENTER&&e.metaKey&&e.target.form&&e.target.form.submit()}})}),define("repo/editor/edit-readme",["jquery","on-ready","js/components/markup-editor"],function(e,t,n){return t(function(e){{var t=e.find(".textarea-preview");new n({el:t}).render()}})}),define("utils/pjax-with-mask",["jquery","jquery-plugins/jquery.pjax"],function(e){e.fn.pjaxWithMask=function(t){var n=e(this);return e.pjax(e.extend(t,{container:n})),n.on("pjax:send",function(){n.addClass("has-mask")}),n.on("pjax:complete",function(){n.removeClass("has-mask")}),n}}),define("repo/editor/readme-edit-button",["jquery","on-ready","jquery-plugins/jquery.pjax","utils/pjax-with-mask"],function(e,t){return t(function(t){var n=e("#readme");t.on("click",function(t){t.preventDefault(),n.pjaxWithMask({push:!1,url:e(this).attr("href"),timeout:3e4})})})}),define("repo/hipchat-integration-ad",["on-ready","js/global/events","utils/preferences","utils/analytics-event"],function(e,t,n,i){return e(function(e){i("bitbucket.repository.create.hipchat.ad.presented"),e.find("#id_hipchat").on("click",function(e){i("bitbucket.repository.create.hipchat.ad.checkbox.clicked",{checked:$(e.target).is(":checked")})
})})}),define("repo/import",["jquery","on-ready","utils/event-tracking-helper"],function(e,t,n){return t(function(){var t=e("#repo-import"),i=n("Repo Import");t.find("a.create-repo").on("click",function(){i("Create Repository Link - Clicked")}),t.find("a.import-github").on("click",function(){i("Import from GitHub Link - Clicked")}),t.find("a.team-pitch").on("click",function(){i("Working in a team? Link - Clicked")}),t.find('button[type="submit"]').on("click",function(){i("Import Repository Button - Clicked")}),t.find("a.cancel").on("click",function(){i("Cancel Link - Clicked")})})}),define("js/components/omnibar/extensions/repository-actions",["jquery","data/current-repo","js/components/omnibar/base-extension"],function(e,t,n){return n.extend({label:gettext("Repository actions"),context:t.fullslug,minQueryLength:0,maxResults:!1,data:function(){return[{label:gettext("Create branch"),$el:e("#repo-create-branch-link")},{label:gettext("Create pull request"),$el:e("#repo-create-pull-request-link")},{label:gettext("Fork repository"),$el:e("#repo-fork-link")}]}})}),define("utils/truncate-path",[],function(){return function(e,t){if(t=t||50,e.length<=t)return e;var n=e.split("/"),i=n.pop(),r=Math.ceil(t/2);i.length>=r&&(i=i.slice(0,r-3)+"...");var o=n.join("/"),s=t-i.length-1;return o.length>s&&(o=o.slice(0,s-3)+"..."),o+"/"+i}}),define("js/components/omnibar/extensions/repository-source",["jquery","underscore","js/components/omnibar/async-extension","utils/highlight-string","utils/truncate-path"],function(e,t,n,i){function r(e){return e.replace(/(^\s*)|(\s*$)/gi,"").replace(/[ ]{2,}/gi," ")}function o(e){var n="",i=r(e).split(/\*|\s|(?=[A-Z0-9]|\/|\.|-|_)/g);i=t.filter(i,function(e){return e.length});var o=i.length;if(o){n+="("+t.map(i[0].split(""),s).join("")+")";for(var a=1;o>a;a++)n+=".*?("+t.map(i[a].split(""),s).join("")+")";return new RegExp("("+n+")","g")}return null}function s(e){return e!==e.toUpperCase()?"["+a(e.toUpperCase()+e)+"]":a(e)}function a(e){return e.replace(/[\-\[\]{}()+?.,\\\^$|#\s]/g,"\\$&")}return n.extend({label:gettext("Repository source"),start:0,data:[],maxResults:10,context:function(){return this.options.repository},url:function(){return"/!api/1.0/repositories/{}/directory/{}?start={}".format(this.options.repository,this.options.hash,this.start)},getSourceUrl:function(e){var t="/{}/src/{}/{}".format(this.options.repository,this.options.hash,e);return this.options.branch&&(t+="?at={}".format(encodeURIComponent(this.options.branch))),t},transformData:function(e,n){var r=o(n);return t.filter(this.data,function(e){return r.test(e)}).map(function(e){for(var t,r=[],s=o(n);null!==(t=s.exec(e));)r.push([s.lastIndex-t[0].length,s.lastIndex]);return{label:i(e,r),title:e,url:this.getSourceUrl(e)}}.bind(this))},getAsyncDeferred:function(n){var i=e.ajax(this.getUrl(n));return i.done(function(e){this.data=t.uniq(this.data.concat(e.values))}.bind(this)),i},fetchData:function(e,t){this.getCachedAsyncDeferred(t).done(function(n){this.options.hash||(this.options.hash=n.revision);var i=this.transformData(this.data,t);!n.isLastPage&&i.length<=this.maxResults?(this.start=n.nextPageStart,this.fetchData(e,t)):e.resolve(i)}.bind(this))}})}),define("repo/index",["jquery","on-ready","data/current-cset","data/current-repo","js/components/omnibar/extensions","js/components/omnibar/extensions/repository-actions","js/components/omnibar/extensions/repository-source","js/source/events","repo/history","utils/event-tracking-helper","utils/query-params","utils/ready"],function(e,t,n,i,r,o,s,a,l,u,c,d){return t(function(){l.set(i.id),r.register(o,{weight:300}),r.register(s,{repository:i.fullslug,hash:n,branch:c.get("at")}),d(function(){r.get(s).options.branch=c.get("at")}),a.vent.on("change:changeset",function(e){r.get(s).options.hash=e});var t=u("Contextual actions");e("#create-branch-contextual").on("click",function(){t("Create branch")}),e("#create-pull-request-contextual").on("click",function(){t("Create pull request")}),e("#create-issue-contextual").on("click",function(){t("Create issue")}),e("#clone-wiki-contextual").on("click",function(){t("Clone wiki")}),e("#create-page-contextual").on("click",function(){t("Create page")})})}),define("repo/issues/attachments",["jquery","on-ready","underscore"],function(e,t,n){return t(function(){var t=e("#attachments"),i=t.find(".attachment-list");e(document).on("change","#id_attachments",function(){i.children(".pending").remove(),i.children(".empty").remove(),"undefined"!=typeof this.files&&n.each(this.files,function(t){e('<li class="pending"></li>').text(t.name).appendTo(i)})}),i.on("click",'a[href="#delete-attachment"]',function(t){if(t.preventDefault(),confirm("Are you sure you want to delete this attachment?")){var n=e(this),r=i.data("deleteUrl");e.ajax({url:r,type:"POST",data:{delete_attachment_id:n.data("id"),csrfmiddlewaretoken:e('input[name="csrfmiddlewaretoken"]').val()},dataType:"html",success:function(){n.closest("li").remove()}})}})})}),define("repo/issues/watching",["jquery"],function(e){function t(t){var n=e("#issue-watch-count"),i=parseInt(n.text(),10);i=t?i+1:i-1,n.text(i).toggleClass("aui-badge-active",t)}function n(n){var i=e("#issue-watch-trigger");n!==i.hasClass("following")&&(n?i.addClass("following").text(i.attr("data-unfollow-text")):i.removeClass("following").text(i.attr("data-follow-text")),t(n))}return{updateWatchingCount:t,toggleWatching:n}}),define("repo/issues/votes",["jquery","repo/issues/watching"],function(e,t){function n(t,n){e("#issue-vote-count").text(t).toggleClass("aui-badge-active",n)}function i(i,r){var o=e("#issue-vote-trigger");r?(o.addClass("following").text(o.attr("data-unvote-text")).data("voted",!0),t.toggleWatching(!0)):o.removeClass("following").text(o.attr("data-vote-text")).data("voted",!1),n(i,r)}function r(){e.ajax({url:e("#issue-vote-trigger").attr("href"),type:"post",dataType:"json"}).success(function(e){i(e.count,e.voted)})}function o(){return e("#issue-vote-trigger").data("voted")}return e(document).on("click","#issue-vote-trigger",function(e){e.preventDefault(),r()}),{updateVoteCount:n,toggleVote:r,toggleVoteUI:i,currentUserHasVoted:o}}),define("repo/issues/comments",["bitbucket","jquery","on-ready","underscore","components/confirm-dialog","config/markitup","data/current-repo","data/current-user","utils/edit-content","utils/mustache","repo/issues/votes","utils/disable"],function(e,t,n,i,r,o,s,a,l,u,c){return n(function(){function n(e){$editor=t(e.target),y=t("form.editor.focused"),y.find("button:submit").disable(d($editor.val())?!0:!1)}function d(e){var t=/^\s*$/;return e.match(t)?!0:!1}function h(e){e.off("input","textarea",n),e.find("textarea").val("").markItUpRemove(),e.removeClass("textarea-preview").removeClass("focused"),e.find('a[href="#submit"], button:submit').removeClass("loading").disable(!1),f.hasClass("commentable")&&(e.closest(".comment article").removeClass("editing"),e.closest(".new-comment").length||e.closest("form").detach())}function p(e,t){var n=e.find("textarea").val(),i=/^\s*\+\d+\s*$/;if(!n.match(i))return void t();var o=e.find(".editor");c.currentUserHasVoted()?r({content:gettext("You have already voted on this issue. Would you still like to submit this comment?"),id:"already-voted-vote-suggestion",buttonText:gettext("Yes")}).done(function(){t()}).fail(function(){l(o.find(".cancel"),o),h(o)}):r({content:gettext("Voting on this issue will get it more attention than a +1 alone, click to add your vote instead."),id:"vote-suggestion",buttonText:gettext("Vote"),cancelText:gettext("Comment")}).done(function(){c.toggleVote(),l(o.find(".cancel"),o),h(o),AJS.messages.success({body:gettext("Thank you for voting on this issue."),fadeout:!0})}).fail(function(){t()})}var f=t("#issues-comments"),m=t("#issue-view").data(),g=function(){window.location.reload(!0)},v=e.repository(s.owner.username,s.slug);f.find("dd.comment").each(function(){var e=t(this),n=e.text().trim(),r=[/^Duplicate of #\d+[.]$/,/^Issue #\d+ was marked as a duplicate of this issue[.]$/];i.any(r,function(e){return e.test(n)})&&e.nextUntil().remove()}),f.hasClass("commentable")&&f.append(u.toHtml("new-comment-template",{user_avatar_url:a.avatarUrl,display_name:a.displayName,content:""})),f.on("focus",".editor textarea",function(e){var i,r,s=t(e.target).closest(".editor"),a=f.find(".editor.focused");a.each(function(){s[0]!=this&&h(t(this))}),i=t(this).closest(".editor"),f.find(".focused").removeClass("focused"),i.addClass("focused"),r=i.find("textarea"),r.hasClass("markItUpEditor")||(i.addClass("textarea-preview"),r.markItUp(o()),setTimeout(function(){r.trigger("focus")},0),i.on("input","textarea",n)),d(r.val())&&i.find("button:submit").disable(!0)}),f.on("click",".editor .cancel",function(e){e.preventDefault();var n=t(this).closest(".editor");l(t(e.target),n),h(n)});var y=t("#issue-comment, .new-comment");y.on("click keydown",'a[href="#submit"], button:submit',function(e){if("keydown"!==e.type||13===e.keyCode){e.preventDefault();var t=y.find("textarea").val();p(y,function(){y.find('a[href="#submit"], button:submit').addClass("loading").disable(!0),v.create_issue_comment(m.localId,{content:t},g)})}}),f.on("click keydown",".issue-comment .aui-button-primary",function(e){var n=t(e.target).closest(".comment article");if("keydown"!==e.type||13===e.keyCode){e.preventDefault();var i=n.find("textarea").val(),r=n.data("comment-id");p(n,function(){n.find('a[href="#submit"], button:submit').addClass("loading").disable(!0),v.update_issue_comment(m.localId,r,{content:i},{success:g,error:function(e){401===e.status&&alert("You must be logged in to post a comment.")}})})}}),f.on("click",".edit-comment-link",function(e){e.preventDefault();var n=t(e.target).closest(".comment-content, .comment");if(f.hasClass("commentable")){var i,r,o,s;s=t(this).closest(".comment article"),o=s.attr("data-content");var l=t(u.toHtml("new-comment-template",{user_avatar_url:a.avatarUrl,display_name:a.displayName,content:o,convert_markup:"True"===s.data("convert-markup")}));i=l.find("form"),f.append(i),s.find(".comment-content").after(i),r=i.find("textarea"),r.data("originalComment",o),i.find(".comment_id").val(s.data("commentId")),s.addClass("editing"),r.focus()}else n.addClass("edit-comment-mode"),n.find("article").addClass("editing"),n.find(".editor textarea").focus()}),t(".edit-comment").each(function(){var e=t(this);e.find("a.button, button").click(function(){var t=e.find("textarea").val(),n=e.data("comment-id");v.update_issue_comment(m.localId,n,{content:t},{success:g,error:function(e){401===e.status&&(alert("You must be logged in to post a comment."),g())}})})}),t(".delete-link").click(function(e){e.preventDefault();var n=t(this),i=gettext("This is a destructive operation. Delete comment?");r(i).done(function(){n.closest("form").submit()})}),t(".comment-spam-link").click(function(e){e.preventDefault(),t(this).closest("form").submit()})})}),define("repo/issues/form",["aui","jquery","on-ready","config/markitup","utils/disable","utils/select-avatar-formatter","jquery-plugins/jquery.markitup"],function(e,t,n,i,r,o){return n(function(){var e=t("#issue-form"),n=e.find("#id_responsible");n.auiSelect2({allowClear:!0,formatResult:o,formatSelection:o}),t("#id_component, #id_milestone, #id_version").auiSelect2({allowClear:!0}),e.find("#id_content, #id_comment, .edit-comment textarea, #id_update_comment").markItUp(i()),e.find("#assign-to-me").click(function(e){var i=t(e.target).attr("data-username");e.preventDefault(),n.val(i).trigger("change")}),e.on("submit",function(e){t(e.target).find('button[type="submit"]').disable(!0)}),t("#select-files-button").click(function(){t("#id_attachments").click()})})}),define("repo/issues/list",["jquery","on-ready","underscore"],function(e,t,n){return t(function(){var t=e("#issues-list"),i={"~":"contains","^":"starts with",$:"ends with","!":"not"},r={},o=t.find(".issues-list").data("qs");o&&n.each(o.split("&"),function(e){var t,o,s,a;e=e.split("="),o=e[0],a=decodeURIComponent(e[1].replace(/\+/g,"%20")),t=a.substr(0,1),n.has(i,t)?(a=a.substr(1),s=i[t]+" "):s="",a="responsible"!==o||a?s+'"'+a+'"':"!"===t?"someone":"no one",(r[o]||(r[o]=[])).push(a)});var s={q:"query",reported_by:"reporter",responsible:"assignee"},a=n.map(n.keys(r).sort(),function(e){return"<b>{label!esc}:</b>\n{value!esc}".format({label:s[e]||e,value:r[e].sort().join(" or ")})});t.find("#issues-filter-criteria").html(a.join(" "))})}),define("repo/issues/query-builder",["aui","jquery","on-ready","underscore"],function(e,t,n,i){return n(function(){var e=t("#issues-query-builder"),n=e.find("form.query-form"),r=n.data(),o=e.find("#filters"),s=t("#addfilter"),a=t("#filters"),l={init:function(e,t){var n;if(e)for(n in e)"select"===e[n].type&&e[n].options.length<=0&&s.find('option[value="'+e[n].name+'"]').remove();if(s.bind("change",function(){this.selectedIndex>0&&l.create(this.options[this.selectedIndex].value)}).auiSelect2(),o.html(""),!i.isEmpty(t))for(n in t)for(var r=0;r<t[n].length;r++)l.create(n,t[n][r][0],t[n][r][1])},generate_select:function(e,t,n){""!==t[0].value&&(/^responsible\d+$/.test(e)?t.unshift({text:"unassigned",value:""}):/^(?:component|milestone|version)\d+$/.test(e)&&t.unshift({text:"unset",value:""}));var i=document.createElement("select");i.name=e;for(var r,o=0;o<t.length;o++)"object"==typeof t[o]?(r=new Option(t[o].text,t[o].value),t[o].value===n&&(r.selected=!0)):(r=new Option(t[o],t[o]),t[o]===n&&(r.selected=!0)),i.options[i.options.length]=r,i.className="nosearch";return i},generate_remove_button:function(){var e=t('<a class="icon filter-remove">Remove filter</a>');return e[0]},remove:function(){var e=t(this).parent().parent();if(e.attr("class")===e.next("li").attr("class")){var n=e.find(".filter-header").text();e.next("li").find(".filter-header").text(n)}e.remove()},generate_comp_select:function(e,t,n){var i={text:[{text:"contains",value:"~"},{text:"doesn't contain",value:"!~"},{text:"begins with",value:"^"},{text:"ends with",value:"$"},{text:"is",value:""},{text:"is not",value:"!"}],select:[{text:"is",value:""},{text:"is not",value:"!"}]};return"text"===t||"select"===t?this.generate_select(e,i[t],n):void 0},create:function(e,n,i){var r=u[e],c=!1,d=1;a.find("li").hasClass("filter_"+e)&&(c=!0,d=a.find("li.filter_"+e).length+1);var h=t("<li></li>");h.addClass("filter_"+e);var p=t('<div class="filter-header"></div>');p.text(c?"or":r.header),h.append(p);var f=t('<div class="filter-comp"></div>');if("text"===r.type||"select"===r.type){var m=l.generate_comp_select("comp_"+r.name+d,r.type,n);f.append(m),setTimeout(function(){t(m).auiSelect2()},0)}h.append(f);var g,v=t('<div class="filter-query"></div>');"text"===r.type?(g=t("<input/>"),g.attr("type","text"),g.attr("name",e+d),g.val(i?i:""),g.attr("size",30)):"select"===r.type&&(g=this.generate_select(e+d,r.options,i)),g&&(v.append(g),"select"==r.type&&setTimeout(function(){t(g).auiSelect2()},0)),h.append(v);var y=t("<div></div>"),b=this.generate_remove_button();y.append(b),h.append(y),t(b).click(l.remove),c?(a.find(".filter_"+e+":last").after(h),a.find(".filter_"+e+" div").removeClass("last-of-type"),a.find(".filter_"+e+":last div").addClass("last-of-type")):o.append(h),s.get(0).selectedIndex=0}},u={title:{name:"title",type:"text",header:"Title"},content:{name:"content",type:"text",header:"Description"},version:{name:"version",type:"select",header:"Version",options:r.versions},milestone:{name:"milestone",type:"select",header:"Milestone",options:r.milestones},component:{name:"component",type:"select",header:"Component",options:r.components},kind:{name:"kind",type:"select",header:"Type",options:r.kinds},status:{name:"status",type:"select",header:"Status",options:r.statuses},priority:{name:"priority",type:"select",header:"Priority",options:r.priorities},responsible:{name:"responsible",type:"select",header:"Assignee",options:r.responsibles},reported_by:{name:"reported_by",type:"text",header:"Reported by"}};l.init(u,r.query),e.find("#filters-filters").find(".cancel").click(function(e){e.preventDefault(),window.history.back()})})}),define("repo/issues/transition",["aui","bitbucket","jquery","on-ready","config/markitup","data/current-repo","js/components/aui-dialog","utils/mustache","utils/select-avatar-formatter","jquery-plugins/jquery.markitup"],function(e,t,n,i,r,o,s,a,l){return i(function(){function e(){c=n(a.toHtml("transition-dialog-template")),d=c.find(".error");var e=c.find("#id_responsible"),t=c.find("#assign-to-me"),o=function(e){d.removeClass("hidden"),d.find(".message").text(e)},u={dataType:"json",success:v,error:function(e){o(404===e.status?gettext("The duplicate issue does not exist"):e.responseText?e.responseText:gettext("An unexpected error occurred."))}};c.submit(function(e){e.preventDefault(),i(c,o,u)});var h=new s({width:700,height:"auto",id:"issue-transition-dialog",closeOnOutsideClick:!0});return c.find("#id_transition_comment").markItUp(r()),e.auiSelect2({allowClear:!0,formatResult:l,formatSelection:l}),t.on("click",function(t){t.preventDefault();var i=n(t.target).attr("data-username");e.auiSelect2("val",i)}),h.addHeader(gettext("Transition issue")),h.addPanel("Transition",c,"panel-body"),h.addButton(gettext("Change"),function(){i(c,o,u)},"aui-button transition-issue-button"),h.addCancel(gettext("Cancel"),function(e){e.hide()}),h}function i(e,t,i){var r=e.find("#id_transition_comment").val(),o=e.find("#id_responsible").val(),s={status:p,responsible:o,comment:r},a=h.popup.element.find(".transition-issue-button");if(a.addClass("loading").attr({"aria-disabled":!0,disabled:!0}),6===p){var l=e.find("#id_duplicate_issue").val(),u=/\d+/.exec(l);if(!u)return t(gettext("Invalid issue number")),void a.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");if(+u[0]===g.localId)return t(gettext("Invalid issue number")),void a.removeClass("loading").removeAttr("aria-disabled").removeAttr("disabled");i.type="POST",i.url=e.data("duplicateUrl"),i.dataType="html",i.data=s,s.duplicate=u[0],n.ajax(i)}else y.update_issue(g.localId,s,i)}function u(t){t.preventDefault();var i=n(this),r=i.attr("title");h||(h=e()),p=i.data("transition-to");var o=6==p;c.find(".duplicate").toggle(o),c.find(".comment").toggle(!o),d.addClass("hidden"),h.addHeader(r?r:gettext("Transition issue")),h.show()}var c,d,h,p,f=n("#workflow-dropdown"),m=n("#issue-view"),g=m.data(),v=function(){window.location.reload(!0)},y=t.repository(o.owner.username,o.slug);f.find('[data-transition-to="{curr}"], [data-transition-to="{next}"]'.format({curr:g.status,next:m.find("#change-state").find("a").data("transition-to")})).remove(),f.find("[data-transition-to]").click(u),n("#change-state").click(u)})}),define("repo/issues/view",["aui","jquery","on-ready","underscore","components/confirm-dialog","config/markitup","data/current-user","js/components/aui-dialog","utils/exists","utils/localize","utils/mustache","utils/preferences","repo/issues/votes","repo/issues/watching","jquery-plugins/jquery.markitup","jquery-plugins/jquery.fancybox"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p){return n(function(){function e(){if(f)return f;f=new a({width:700,height:"auto",id:"issue-attachment-dialog",closeOnOutsideClick:!0});var e=t(c.toHtml("attachment-dialog-template"));return e.find("textarea").markItUp(o()),f.addHeader("Attach files"),f.addPanel("Attach",e,"panel-body"),f.addButton("Attach",function(){e.submit()}),f.addCancel("Cancel",function(e){e.hide()}),f}var n=t("#issue-view"),s=(n.data(),/[(](BB-\d+)[)]/.exec(t("#issue-title").text())),h=n.find("#jira");h.toggle(location.pathname.startsWith("/site/master/")),h.length&&s&&h.text("View in JIRA").attr({href:"https://bitbucket.atlassian.net/browse/"+s[1]}),n.find("#issue-delete-link").click(function(e){e.preventDefault();var n=t(this),i=gettext("This is a destructive operation. Delete issue?");r(i).done(function(){n.closest("form").submit()})}),n.find("#issue-flag-spam").click(function(e){e.preventDefault(),t(this).closest("form").submit()}),t(document).on("follow:issue","#issue-watch-trigger",function(e,t){p.updateWatchingCount(t)}),t("ul.issue-attachment-list").find("a.image-attachment").fancybox({loop:!1,nextEffect:"fade",prevEffect:"fade",beforeLoad:function(){this.title=i.escape(t(this.element).attr("title"))}}),l("#jira-issue-box",function(e){var n=e.find("a.close");n.on("click",function(i){i.preventDefault(),d.set("dismiss-jira-box-"+n.attr("data-repo-id"),"True").done(function(){e.animate({opacity:0},200,function(){t(this).animate({height:0},200,function(){e.remove()})})})})});var f;t(".issue-attach-link").click(function(t){t.preventDefault(),e().show()}),u()})}),define("repo/overview/filterable-list-dialog",["aui","jquery","on-ready","underscore","components/key-navigation","utils/event-tracking-helper","utils/mustache","utils/quick-filter","utils/loading"],function(e,t,n,i,r,o,s,a){function l(e){i.each(e.branches||[],function(e){e.encodedName=encodeURIComponent(e.name)}),i.each(e.tags||[],function(e){e.encodedName=encodeURIComponent(e.name)})}var u=o("Repo Overview"),c=292;return n(function(n){function i(e,i,c){var d=e.find("input.filter-box");e.find(".repo-stats-dialog").length?c&&c():e.loading(t.ajax({type:"get",url:n.attr("data-url"),dataType:"json"})).done(function(t){l(t),e.append(s.toHtml(n.attr("data-template"),t)),a(e),d=e.find("input.filter-box"),r.tabbedFilter(d,e),c&&c()}),u("Stats Dialog - Displayed",o),setTimeout(function(){d.focus()},0)}var o=n.attr("id"),d={width:c};o=o.substring(0,o.length-"-trigger".length),e.InlineDialog(n,"overview-"+o,i,d)})}),define("repo/overview/followers-dialog",["aui","jquery","on-ready","underscore","utils/event-tracking-helper","utils/mustache","utils/loading"],function(e,t,n,i,r,o){function s(e,n,i){var r=t(n),s=e.find(".repo-stats-dialog");s.length&&r.attr("data-cached")?i&&i():(s.empty(),e.loading(t.ajax({type:"get",url:r.attr("data-url"),dataType:"json"})).done(function(t){var n=o.toHtml(r.attr("data-template"),t);e.removeClass("loading"),s.length?s.replaceWith(n):e.append(n),r.attr("data-cached",!0),i&&i()})),a("Stats Dialog - Displayed","followers-dialog")}var a=r("Repo Overview");return n(function(n){var i=t("a.follow"),r=t("#followers-list"),o=i.hasClass("following");t(document).on("follow:repo","a.follow",function(e,t){if(o!==t){o=t,r.find("li.current-user").toggleClass("hidden",!t);var i=n.find(".value"),s=+i.text();t?s++:s--,n.removeAttr("data-cached"),r.find("ol").toggleClass("empty",0===s),i.text(s);var a=n.html();n.html(1===s?a.replace(/Watchers/,"Watcher"):a.replace(/Watcher\b/,"Watchers"))}}),e.InlineDialog(n,"overview-followers-dialog",s,{width:292})})}),define("repo/overview/getting-started",["jquery","on-ready","components/clone/clone-in-sourcetree","utils/gaq-push"],function(e,t,n,i){return t(function(){function t(t){var n=e(t.target),s=n.attr("href").substring(1),a=r.find('[href="#'+s+'"]').closest("li");t.preventDefault(),a.length||(a=r.filter(":first")),r.removeClass("aui-nav-selected"),a.closest("li").addClass("aui-nav-selected"),o.removeClass("selected"),e("#"+s).addClass("selected");var l=["atl._trackEvent","Repo Getting Started",s];n.hasClass("next")&&l.push("Next"),i(l)}var n=e("#repo-getting-started"),r=n.find("nav li"),o=n.find(".tab-pane"),s=n.find('#invite-friends [href="#share"]'),a=e("#start-from-scratch");n.find("nav li a, a.tab-jump").click(t),s.on("click",function(){i(["atl._trackEvent","Repo Getting Started","Send an Invitation"])}),a.on("click","a",function(t){i(e(t.target).hasClass("set-up")?["atl._trackEvent","Repo Getting Started","Set Up DVCS",a.attr("data-scm")]:["atl._trackEvent","Repo Getting Started","Bitbucket 101"])}),e("#commit-and-push").on("click","a.readme",function(){i(["atl._trackEvent","Repo Getting Started","Learn Readme"])}),e(".getting-started-choice").on("click",function(t){t.preventDefault();var n=e(this);n.toggleClass("collapsed"),n.find(".aui-icon").toggleClass("aui-iconfont-expanded").toggleClass("aui-iconfont-collapsed");var r=n.hasClass("collapsed")?"closed":"open";i(["atl._trackEvent","Repo Blank Slate",n.attr("href"),r])}),e(".getting-started-choice:visible:first").click(),e("#sourcetree-download").on("click",function(){i(["atl._trackEvent","Repo Blank Slate","Download SourceTree"])})})}),define("repo/overview/cloud-ide",["jquery","on-ready","utils/mustache"],function(e,t,n){return t("#cloud-ide",function(t){e("#cloud-ide-vendors").on("click",".ide-option",function(i){i.preventDefault();var r=e(i.target);t.find(".launch-ide").replaceWith(n.toHtml("cloud-ide-button",r.data("ide")))}),t.on("click",".launch-ide",function(n){var i=e(n.target).attr("data-id");e.ajax({url:t.attr("data-api-url"),type:"POST",data:{id:i}})})})}),define("repo/overview/repo-invite",["jquery","on-ready","utils/gaq-push","utils/preferences"],function(e,t,n,i){return t(function(t){var r=t.find('a[href="#invite-repo"]'),o=t.find("a.close");r.on("click",function(){n(["atl._trackEvent","Share","Repo overview invite user button"])}),o.on("click",function(r){r.preventDefault();var s="dismiss-invite-box-"+o.data("repo-id");i.set(s,"True").done(function(){e("#invite-repo-box").animate({opacity:0},200,function(){e(this).animate({height:0},200,function(){t.remove()})}),n(["atl._trackEvent","Share","Dismiss repo overview invite panel"])})})})}),define("repo/overview/repo-stats",["jquery","on-ready","repo/overview/filterable-list-dialog","repo/overview/followers-dialog"],function(e,t){return t(function(){var t=window.location.hash.substring(1);t&&setTimeout(function(){e("#"+t+"-dialog-trigger").click()},0)})}),define("repo/overview/revoke-access",["jquery","on-ready","components/confirm-dialog"],function(e,t,n){return t(function(e){var t={title:e.attr("data-revoke-title"),content:e.attr("data-revoke-confirm"),buttonText:e.attr("data-revoke-button")};e.on("click",function(i){i.preventDefault(),n(t).done(function(){window.location.href=e.attr("href")})})})}),define("repo/overview/sourcetree-dialog",["aui","jquery","on-ready","utils/event-tracking-helper"],function(e,t,n,i){return n(function(n){var r=t("#repo-clone-sourcetree-dialog"),o=i("Repo Overview");e.InlineDialog(n,"sourcetree-clone-dialog",function(e,t,n){r.appendTo(e).removeClass("hidden"),n()},{width:360,closeOnTriggerClick:!0}),n.on("click",function(){o("Clone in SourceTree Dialog - Displayed")}),r.on("click",".aui-button",function(){o("Clone in SourceTree - Clicked")})})}),define("repo/overview/sync-repo",["jquery","on-ready","utils/event-tracking-helper","utils/message-helper","utils/preferences","components/merge-dialog"],function(e,t,n,i,r,o){return t(function(e){var t=n("Repo Overview"),s=e.find('a[href="#sync-repo"]'),a=e.find("a.close"),l=s.attr("data-conflict-url"),u=s.attr("data-source-repo"),c=s.attr("data-dest-repo");o(s,{getData:function(){var e,t=s.attr("data-source-branch"),n=s.attr("data-dest-branch");return e=t==n?u:"{}/{}".format(u,t),{action:s.attr("data-compare-url"),source:s.attr("data-source-value"),sourceBranch:t,sourceRepo:u,sourceAvatar:s.attr("data-source-avatar"),sourceAvatarAltText:s.attr("data-source-repo-name"),dest:s.attr("data-dest-value"),destBranch:n,destRepo:c,destAvatar:s.attr("data-dest-avatar"),destAvatarAltText:s.attr("data-dest-repo-name"),sameRepo:!1,canCloseBranch:!1,hasConflicts:!1,mergeCommands:"",commitMessageSlug:e,syncRepo:!0}},success:function(){i.addMessage("{} successfully synced with {}.".format(c,u)),window.location.reload(!0)},conflictUrl:l}),a.on("click",function(n){n.preventDefault();var i=a.attr("data-pref"),o=a.attr("data-pref-value");r.set(i,o).done(function(){e.animate({opacity:0},200,function(){e.animate({height:0},200,function(){e.remove()})}),t("Sync Repo Box - Dismissed")})})})}),define("repo/overview/index",["jquery","on-ready","utils/event-tracking-helper","repo/overview/cloud-ide","repo/overview/getting-started","repo/overview/repo-invite","repo/overview/repo-stats","repo/overview/revoke-access","repo/overview/sourcetree-dialog","repo/overview/sync-repo"],function(e,t,n){return t(function(){var t=n("Repo Overview");e(".clone-url-input","#repo-stats").on("focus",function(){t("Clone Url - Focused")}),e("#repo-overview-download").on("click",function(){t("Download Shortcut - Link Clicked")}),e("#repo-activity").on("click",".newsfeed a",function(){t("Newsfeed - Link Clicked")}).on("click",".subscribe",function(){t("Newsfeed - Subscribe Link Clicked")}),e(".page-actions").on("click","#repo-share-link",function(){t("Share Button - Clicked")}).on("click","a.repo-watch",function(){t("Watch Prefs Dialog")}).on("follow:repo","a.follow",function(e,n){t(n?"Watch Repo":"Unwatch Repo")})})}),define("js/pullrequests/models/reviewer",["underscore","components/mentions/typeahead-user-model"],function(e,t){return t.extend({parse:function(e){return e.avatar_url=e.avatar_url||e.avatar,e},toEscapedJSON:function(){return{avatar_url:this.get("avatar_url"),display_name:e.escape(this.get("display_name")),username:e.escape(this.get("username")),is_teammate:this.get("is_teammate"),is_team:this.get("is_team")}}})}),define("js/pullrequests/collections/reviewers",["backbone","jquery","underscore","js/pullrequests/models/reviewer","data/current-pr","data/current-user"],function(e,t,n,i,r,o){var s=r.author?r.author.username:o.username,a=e.Collection.extend({model:i});return e.Collection.extend({model:i,initialize:function(e,t){t=t||{},this.participantUsernames=t.participants||[],this.suggested=new a(t.suggested||[],{parse:!0,reset:!0})},toSelect2Data:function(){var e=n.partial(n.contains,this.participantUsernames);return this.map(function(t){return t.locked=e(t.get("username")),t})},canAdd:function(e){return e.id===s?!1:!this.contains(e)},addSuggestedReviewer:function(e){this.add(this.suggested.findWhere({username:e}))},setDestination:function(e){function i(e){n.each(e.invalid_reviewers,function(e){r.remove(r.get(e))}),r.suggested.reset(e.suggested,{reset:!0,parse:!0})}this.destinationFullslug=e;var r=this;t.ajax({url:"/{}/pull-request/xhr/reviewer-permissions/".format(this.destinationFullslug),data:{reviewers:this.pluck("username")}}).done(i)}})}),define("js/pullrequests/views/suggested-reviewer-list-item",["marionette"],function(e){return e.ItemView.extend({tagName:"li",template:"#suggested-reviewer-template",className:"suggested-reviewer-list-item",attributes:function(){return{"data-username":this.model.get("username"),"data-display-name":this.model.get("display_name")}},events:{click:"addSuggestedReviewer"},initialize:function(e){this.reviewers=e.reviewers},addSuggestedReviewer:function(){this.reviewers.add(this.model)}})}),define("js/pullrequests/views/suggested-reviewer-list",["marionette","js/pullrequests/views/suggested-reviewer-list-item"],function(e,t){return e.CompositeView.extend({childView:t,template:"#suggested-reviewers-template",childViewContainer:".suggested-reviewer-list",childViewOptions:function(){return{reviewers:this.reviewers}},addChild:function(t){this.reviewers.get(t.id)||e.CollectionView.prototype.addChild.apply(this,arguments)},isEmpty:function(){var e=this.reviewers;return this.collection.every(function(t){return e.get(t.id)})},showEmptyView:function(){this.$el.addClass("hidden")},destroyEmptyView:function(){this.$el.removeClass("hidden")},initialize:function(e){this.reviewers=e.reviewers,this.listenTo(this.collection,"reset",this.render),this.listenTo(this.reviewers,"add remove",this.render)}})}),define("utils/create-reviewer-autocomplete",["aui","jquery","underscore","utils/mustache","js/pullrequests/collections/reviewers","js/pullrequests/models/reviewer","js/pullrequests/views/suggested-reviewer-list","components/mentions/user-data-set","data/current-repo","data/settings"],function(e,t,n,i,r,o,s,a,l,u){return function(){function e(e,t){t(v.toSelect2Data())}function n(e){y.off("respond"),y.on("respond",function(t){e.callback({results:t.results})}),y.query(e.term)}function c(e,t){t.append(i.toHtml("mention-result",e.toEscapedJSON()))}function d(e,t){t.append(i.toHtml("selected-reviewer-template",e.toJSON()))}function h(e){return e.length<u.MENTIONS_MIN_QUERY_LENGTH?gettext("Continue typing to search for a user"):interpolate(gettext("Found no matches for %(query)s"),{query:e},!0)
}var p=t("#reviewers"),f=t(".suggested-reviewers"),m=t("#id_dest_repo"),g=m.length&&m.val()||l,v=new r(p.data("reviewers"),{participants:p.data("participants"),suggested:p.data("suggested"),parse:!0}),y=new a([],{model:o,matcher:function(e,t){return v.canAdd(e)?e.matches(t,this):!1},queryEndpoint:"/xhr/mentions/"+g,queryParamKey:"term"});p.auiSelect2({placeholder:gettext("Start typing to search for a user"),containerCssClass:"text long-field",dropdownCssClass:"bb-typeahead-suggestions aui-dropdown2 aui-style-default bb-user-suggestions",multiple:!0,initSelection:e,query:n,formatResult:c,formatSelection:d,formatNoMatches:h}),new s({el:f,collection:v.suggested,reviewers:v}).render(),p.on("change",function(e){e.added&&v.add(e.added.toJSON()),e.removed&&v.remove(e.removed)}),v.on("add remove",function(){p.auiSelect2("data",v.toSelect2Data())}),m.on("change",function(){var e=m.val();y._queryEndpoint="/xhr/mentions/"+e,y.queryCache={},y.reset(),v.setDestination(e)})}}),define("repo/pullrequests/form",["jquery","underscore","on-ready","config/markitup","data/current-repo","jquery-plugins/jquery.markitup","utils/check-task","utils/create-reviewer-autocomplete","utils/disable","utils/exists","utils/parse-compare-spec"],function(e,t,n,i,r,o,s,a,l,u,c){return n(function(){function n(n){var i=h.find("select[name=source]"),r=d.find("select[name=dest]");if(!(n&&e(n.target).parents("#pull-into .branch-field-container").length||0===i.length||0===r.length)){var o=c(i.val()).branch,s=r.val();if(r.find('option[value$="::"]').remove(),0===r.find('option[value$=":'+o+'"]').length){var a='<option value="{0}::">{1} (new branch)</option>'.format(),l=e(a(m.val(),o)),u=t.sortedIndex(r.find("option").get(),l.get(),function(t){return e(t).text()});0===u?l.insertBefore(r.find("option").get(0)):l.insertAfter(r.find("option").get(u-1))}r.val(s).trigger("liszt:updated")}}function o(t,n){var i=t.find(".error");i&&0!==i.length||(i=e('<div class="error"></div>'),t.append(i));var r=e("<div></div>");r.text(n),i.append(r)}var l=e("#pullrequest-form"),d=l.find("#pull-into"),h=l.find("#pull-from"),p=l.find(".compare-widget-container"),f=l.find("#id_source_repo"),m=l.find("#id_dest_repo"),g=l.find("textarea");if(g.markItUp(i()),f.prop({disabled:!0}).trigger("liszt:updated").prop({disabled:!1}),function(){var t=e("#id_title"),n=e("#id_description");if(t.length&&n.length){var i=function(e){var t=e.data();return t.val=e.val(),function(n){e.val(t.val=n)}},r=i(t),o=i(n);e(document).bind("bb:compare",function(){var i=e("#compare-metadata"),s=0!==i.data("commit-count");if(l.find("button:submit").attr({disabled:!s,"aria-disabled":!s}),!l.hasClass("update")&&!l.data("has-errors")&&t.val()===t.data("val")&&n.val()===n.data("val")){var a=p.find('[name="source"]').val(),u=p.find('[name="dest"]').val(),c='ul[data-source="{0}"][data-dest="{1}"] li'.format(a,u),d=e(c,"#updateable-prs");1===d.length?(r(d.data("title")),o(d.data("description"))):1===i.data("commit-count")?(r(e("#compare-content").find(".commit-list td.text").text().trim()),o("")):(r(""),o(""))}})}}(),p.change(n),n(),e("#id_new_branch").prop("checked")===!0){var v=h.find("select[name=source]"),y=d.find("select[name=dest]");v.length&&y.length&&(y.val(y.find('option[value$="::"]').val()),y.change())}d.on("change","select[name=dest]",function(){var t=c(e(this).val()).branch;e("#id_new_branch").prop({checked:!t})}),u("#updateable-prs",function(t){var n=t.children("ul");if(0!==n.length){var i=function(){var i=e(this),r=i.find('[name="source"]').val(),o=i.find('[name="dest"]').val();if(r&&o){var s=n.filter('[data-source="'+r+'"]').filter('[data-dest="'+o+'"]');n.not(s).hide(),s.show(),s=s.children();var a=s.length;l.find("input:submit").val(1===a?"Update pull request #"+s.data("local-id"):"Send pull request"),t.addClass("hidden"),a&&t.removeClass("hidden").find("strong").text(a>1?a+" existing pull requests will be superseded":"An existing pull request will be updated")}};p.change(i).change()}}),u("#id_reviewers_group",function(e){a(e)}),l.on("submit",function(){var n=l.find("#participants"),i=n.find(".non-reviewer").detach(),r=l.serialize(),a=l.attr("action"),u=l.find("#submitPrButton"),c=l.find("#global-errors");return u.addClass("loading").disable(!0),l.find(".error:not(#global-errors)").empty(),c.addClass("hidden"),e.ajax({type:"POST",url:a,data:r,dataType:"json"}).done(function(r){r.errors?(t.each(r.errors,function(r,s){if("__all__"==s){c.removeClass("hidden");var a=c.find(".messages").empty();t.each(r,function(t){a.append(e("<li>").text(t))})}else{var u=l.find("#id_{}_group".format(s));t.each(r,function(e){n.prepend(i),o(u,e)})}}),u.removeClass("loading").disable(!1)):r.result?window.location=r.result:setTimeout(function(){s(r.url).fail(function(e){o(u.closest(".buttons-container"),e),u.removeClass("loading").disable(!1)})},1e3)}).fail(function(){o(u.closest(".buttons-container"),gettext("Something went wrong while creating your pull request.")),u.removeClass("loading").disable(!1)}),!1}),u("#id_close_anchor_branch",function(n){function i(e){a=n.prop("checked"),n.prop({checked:!1,disabled:!0}),s.addClass("disabled").attr({title:e})}var o=e("#pullrequest-form"),s=n.next("label"),a=null,l=function(){var l=c(o.find("select[name=source]").val()),u=e("#compare-metadata"),d=o.find("select[name=dest]"),h=(c(d.val()),!u.data("hasBranchClose"));if(s.html('Close <span class="branch-name">'+t.escape(l.branch)+"</span> after the pull request is merged"),h)i("Branch deletion is disabled for this branch");else{var p=l.branch===r.mainbranch.name;p?i("You're not permitted to close the main branch"):(n.prop({disabled:!1}),null!==a&&(n.prop("checked",a),a=null),s.removeClass("disabled").removeAttr("title"))}};p.bind("bb:compare:loaded",l),i("Loading pull request details")})})}),define("repo/pullrequests/list",["on-ready","jquery","components/filter/status"],function(e,t,n){return e(function(e){n({$container:e,$pjaxContainer:t("#pullrequest-pjax"),ignoreQuery:"page"})})}),define("repo/pullrequests/helpers",["jquery","utils/mustache"],function(e,t){return{showUpdatesDialog:function(){var n,i,r="bb-last-seen-changeset",o=localStorage&&localStorage.getItem(r),s=e("#edit-pullrequest"),a=s.attr("data-changed"),l=s.attr("data-newest-changeset");a&&o!==l&&(i=e("#pullrequest-updates-dialog, #rebase-necessitates-update"),n=e(t.toHtml("pullrequest-update-dialog-template",{mostRecent:l})),i.length?i.replaceWith(n):s.after(n),s.addClass("bb-inline-dialog-anchor"),n.on("click",".close",function(e){e.preventDefault(),localStorage&&localStorage.setItem(r,l),n.remove(),s.removeClass("bb-inline-dialog-anchor")}))}}}),define("components/participants/live-update-participant",["backbone","utils/mustache"],function(e,t){return e.View.extend({tagName:"li",events:{click:"renderNextComment"},initialize:function(e){this.noun=e.noun,this.auiAvatarSize=e.auiAvatarSize,this.model.on("change",this.render,this),this.model.on("destroy",this.remove,this)},render:function(){var e=this.model.toJSON();return e.size=this.auiAvatarSize||"medium",this.$el.html(t.toHtml("participant-liveupdate-template",e)),this},renderNextComment:function(e){e.preventDefault(),this.model.get("comments")?this.trigger("render-next-comment",this.model.id):this.model.get("approved")&&this.trigger("show-approvals",this.model.id)}})}),define("components/participants/live-update",["components/participants/participants-strip","components/participants/live-update-participant"],function(e,t){return e.extend({initialize:function(t){e.prototype.initialize.call(this,t),this.collection.bind("add",this.addParticipant,this),this.collection.bind("add",this.toggleEmptyClass,this),this.collection.bind("destroy",this.toggleEmptyClass,this)},addParticipant:function(e){var n=new t({model:e,noun:this.collection.noun,auiAvatarSize:this.auiAvatarSize}).render();this.$el.append(n.$el),n.on("render-next-comment",this.renderUserComment,this),n.on("show-approvals",this.showApprovals,this)},toggleEmptyClass:function(){this.$el.toggleClass("empty",!this.collection.length)},renderUserComment:function(e){this.trigger("render-user-comment",e)},showApprovals:function(e){this.trigger("show-approvals",e)}})}),define("repo/pullrequests/live-update",["jquery","underscore","data/current-repo","data/current-pr","components/comments/comment","components/comments/line-comment","components/participants/participants","components/participants/live-update","repo/pullrequests/helpers","utils/api-helper","utils/mustache"],function(e,t,n,i,r,o,s,a,l,u,c){function d(){return L.find("li").length?!1:!H.hasClass("updated")}function h(){e.ajax({url:M,data:{since:N},dataType:"json"}).done(p)}function p(e){N=e.lastModified,(e.prDetailsModified||e.anchorMoved||e.destRevMoved)&&(H.addClass("updated"),R.removeClass("hidden")),g(e.viewers),f(e),v(e),y(),S(e)}function f(e){t.each(e.commentsAdded,function(e){z.push(e)}),t.each(e.commentsReplied,function(e){z.push(e)}),t.each(e.commentsEdited,function(e){var n=t.find(z,function(t){return e.comment.comment_id===t.comment.comment_id});n?z.splice(z.indexOf(n),1,e):$(e.comment)}),t.each(e.commentsDeleted,function(e){var n=t.find(z,function(t){return e.evt.reference_id===t.comment.comment_id});n?z.splice(z.indexOf(n),1):A(e.evt.reference_id)})}function m(e){e.set("last_updated_on",null),e.destroy()}function g(e){t.each(e,function(e){e.viewing=!0,U.add(e,{merge:!0})}),t.each(U.models,function(n){var i=t.find(e,function(e){return e.username===n.id});i||(n.get("comments")?n.set("viewing",!1):m(n))})}function v(e){t.each(e.approvalsRemoved,function(e){var t=e.user,n=U.get(t.username);n&&n.set("approved",!1)}),t.each(e.approvalsAdded,function(e){e.user.approved=!0,U.add(e.user,{merge:!0})}),(e.approvalsAdded.length||e.approvalsRemoved.length)&&P.trigger("approval-changed.pullrequest")}function y(){var e={};t.each(z,function(t){var n=t.user.username;e[n]=e[n]||{count:0,commentEvent:t},e[n].count++}),t.each(e,function(e,t){var n=U.get(t);if(n)n.set({comments:e.count,last_updated_on:e.commentEvent.comment.utc_last_updated});else{var i=e.commentEvent.user;i.comments=e.count,i.last_updated_on=e.commentEvent.comment.utc_last_updated,U.add(i)}}),t.each(U.models,function(t){e[t.get("username")]||(t.get("viewing")?t.set("comments",0):m(t))}),D()}function b(n){var i=t.find(z,function(e){return e.user.username===n});if(i){if(!e("#pr-tab-content-wrapper").hasClass("diff"))return void j(i.comment.comment_id);k(i.comment),z=t.reject(z,function(e){return e===i}),y()}}function w(t){return t.parent_id?x(t):t.filename?_(t):e("#comments-list")}function x(n){var i=e("#comment-"+n.parent_id);if(!i.length){var r=t.find(z,function(e){return e.comment.comment_id===n.parent_id});if(!r){var o=e("#compare"),s=o.attr("data-anchor"),a=o.attr("data-dest-rev"),l="CompareRevisions(anchor=u'{}', destrev=u'{}')".format(s,a),u=o.find(".pr-line-thread-ids").data("value"),c=t.reject(u,function(e,t){return t===l}).reduce(function(e,t){return e.concat(t[n.filename]||[])},[]),d=t.any(c,function(e){return e===n.parent_id});return d?e('[data-filename="{}"] a.eclipsedcount'.format(n.filename)).click():j(n.comment_id),null}i=k(r.comment),z=t.reject(z,function(e){return e===r})}return i.parents(".aui-dialog").length&&e('[data-filename="{}"] a.eclipsedcount'.format(n.filename)).click(),i.siblings(".child-comments")}function _(t){var n=e("#compare");if(n.attr("data-anchor")!==t.anchor||n.attr("data-dest-rev")!==t.dest_rev)return j(t.comment_id),null;var i=e('[data-filename="{}"]'.format(t.filename)),r=i.find('[data-tnum="{line_to}"], [data-fnum="{line_from}"]'.format({line_to:t.line_to,line_from:t.line_from})),o=i.find(".heading");if((t.line_to||t.line_from)&&!r.length)return j(t.comment_id),null;var s=r.length?r.parents(".udiff-line"):o,a=s.next();return a.hasClass("comment-thread-container")||(a=e('<div class="comment-thread-container"><ol class="comments-list"></ol></div>').insertAfter(s)),a.find(".comments-list")}function k(t){var n=e("#comment-"+t.comment_id),i=w(t),s=r.prototype.parse(t),a=new r(s,{urlRoot:B.toString()}),l=new o(a);return i?("comments-list"===i.attr("id")?l.render(i.find(".new-comment"),"before"):n.length?l.decorate(n,s.filename):l.render(i),l.$elem.addClass("highlight"),l.scrollTo({onAfter:function(){l.$elem.removeClass("highlight")}}),l.$comment):null}function C(t){e.scrollTo(e("#pull-request-header"));var n=U.get(t);n&&(n.get("viewing")?n.set({approved:!1}):m(n)),D()}function S(t){t.changed&&(e("#edit-pullrequest").attr({"data-changed":!0,"data-newest-changeset":t.changed}),l.showUpdatesDialog())}function $(t){var n,i=e("#comment-"+t.comment_id),r=i.find("header");r.find(".comment-deleted").length||(r.find(".comment-changed").remove(),n=e(F({edited:!0})),r.append(n),n.on("click","a",function(e){e.preventDefault(),i.find(".comment-content").html(t.content_rendered),n.remove()}))}function T(e,n){return t.each(e,function(e){n.push(e),T(e.children,n)}),n}function A(t){var n,i=e("#comment-"+t),r=i.find("header");r.find(".comment-changed").remove(),n=e(F({deleted:!0})),r.append(n),n.on("click","a",function(e){e.preventDefault(),E(t),n.remove()}),i.find(".comment-actions [href=#delete]").parent().remove()}function E(n){var i=e("#comment-"+n),r=i.parents(".child-comments").last().siblings("article, .deleted-comment-message"),s=r.length?[r.data("commentId")]:[n],a=o.decorateThreads(B.toString(),s),l=T(a,[]),u=t.find(l,function(e){return e.comment.id===n}),c=u.$elem.parents(".comment-thread-container");u.scrollTo({onAfter:function(){u.removeComment(),c.find("li.comment").length||c.remove()}})}function j(t){t?(z=[],y(),e("#pr-menu-activity").click(),P.one("pjax:end",function(){var n=e("#comment-"+t).parent(".comment");window.location.hash="comment-"+t,n.addClass("highlight"),n.one("transitionend webkitTransitionEnd",function(){n.removeClass("highlight")})})):window.location.reload(!0)}function D(){var e=H.hasClass("updated"),t=e?1:0;t=U.reduce(function(e,t){var n=t.get("comments");return e+=n,t.get("approved")?e+1:e},t),document.title=t>0?"({}) {}".format(t,O):O}var q=function(t,n){function i(){return(new Date).getTime()-c<u.inactivity}function r(){i()||(h=0,s()),c=(new Date).getTime()}function o(e){return Math.min(i()?u.min:e*u.multiplier,u.max)}function s(){d&&clearTimeout(d),d=setTimeout(function(){t(),s()},h=o(h))}var a=1e3,l=60*a,u=e.extend({min:20*a,max:60*l,multiplier:1.25,inactivity:5*l},n),c=(new Date).getTime(),d=null,h=0;return e(window).focus(r),e("body").click(r),{start:function(){s()},stop:function(){clearTimeout(d),d=null}}},P=e(document),I=e("#pullrequest"),R=e("#pr-toolbar"),M=I.attr("data-updates-url"),N=I.attr("data-last-updated"),O=document.title,L=I.find(".qr-notice"),H=L.find(".pr-update-notice"),F=t.partial(c.toHtml,"comment-changed-template"),B=u.concat("repositories",n.owner.username,n.slug,"pullrequests",i.localId,"comments"),U=new s([],{noun:"pull request"}),z=[],J=new a({el:L.find("ol"),collection:U,auiAvatarSize:"medium"}).render();if(J.on("render-user-comment",b),J.on("show-approvals",C),U.on("add",function(){R.removeClass("hidden")}),U.on("destroy",function(){R.toggleClass("hidden",d())}),H.on("click","a",function(e){e.preventDefault(),j()}),M&&N){var W=new q(h);W.start(),h()}}),define("repo/pullrequests/quick-update",["aui","jquery","underscore","utils/check-task"],function(e,t,n,i){t(document).on("click","#quick-update-pr",function(r){r.preventDefault();var o=t(r.target),s=o.attr("href");if(!o.hasClass("loading")){o.addClass("loading");var a=function(i){var r=t("<div></div>"),s="An error occurred while updating.",a="Try refreshing this page or editing the pull request directly.";i&&(t.isArray(i)&&i.length?(n.each(i,function(e){t("<p></p>").text(e).appendTo(r)}),a=r.html()):(s=i,a=null)),e.messages.error({title:s,body:a}),o.removeClass("loading")};t.ajax({type:"POST",url:s,data:{_quick_update:1},dataType:"json",error:function(){a()},success:function(e){e.errors?a(e.errors):e.result?window.location=e.result:setTimeout(function(){i(e.url).fail(a)},1e3)}})}})}),function(e){define("jquery-plugins/jquery.hoverIntent",["jquery"],function(){return function(){!function(e){e.fn.hoverIntent=function(t,n){var i={sensitivity:7,interval:100,timeout:0};i=e.extend(i,n?{over:t,out:n}:t);var r,o,s,a,l=function(e){r=e.pageX,o=e.pageY},u=function(t,n){return n.hoverIntent_t=clearTimeout(n.hoverIntent_t),Math.abs(s-r)+Math.abs(a-o)<i.sensitivity?(e(n).unbind("mousemove",l),n.hoverIntent_s=1,i.over.apply(n,[t])):(s=r,a=o,n.hoverIntent_t=setTimeout(function(){u(t,n)},i.interval),void 0)},c=function(e,t){return t.hoverIntent_t=clearTimeout(t.hoverIntent_t),t.hoverIntent_s=0,i.out.apply(t,[e])},d=function(t){var n=jQuery.extend({},t),r=this;r.hoverIntent_t&&(r.hoverIntent_t=clearTimeout(r.hoverIntent_t)),"mouseenter"==t.type?(s=n.pageX,a=n.pageY,e(r).bind("mousemove",l),1!=r.hoverIntent_s&&(r.hoverIntent_t=setTimeout(function(){u(n,r)},i.interval))):(e(r).unbind("mousemove",l),1==r.hoverIntent_s&&(r.hoverIntent_t=setTimeout(function(){c(n,r)},i.timeout)))};return this.bind("mouseenter",d).bind("mouseleave",d)}}(jQuery)}.apply(e,arguments)})}(this),define("repo/pullrequests/view",["aui","jquery","underscore","on-ready","js/pullrequests/events","data/current-pr","data/current-repo","components/form-dialog","components/comments/comment-count-indicator","components/comments/general-comment-form","components/comments/line-comment","components/diff/commentable-diff","components/diff/context-expander","components/diff/deferred-large-diff","components/diff/diff-actions-2","components/outdated-comments","components/participants/helpers","components/participants/participants-strip","js/components/toggle-button","cssesc","repo/pullrequests/helpers","utils/api-helper","utils/check-task","utils/dialog-positions","utils/disable","utils/exists","utils/gaq-push","utils/mustache","utils/query-params","repo/pullrequests/live-update","repo/pullrequests/quick-update","jquery-plugins/jquery.fancybox","jquery-plugins/jquery.hoverIntent","jquery-plugins/jquery.pjax"],function(e,t,n,i,r,o,s,a,l,u,c,d,h,p,f,m,g,v,y,b,w,x,_,k,C,S,$,T,A){return i(function(){function i(e,t){return function(n){n.isconflicted?e():n.mergeimpossible&&(void 0!==t?t():e())}}function C(){F.disable(),t("#fulfill-pullrequest").attr("aria-disabled",!0).attr("title",gettext("Cannot merge due to conflicts"))}function E(e){var n=location.hash;history.replaceState(null,null,location.pathname),location.hash=n;var i=e.find("#general-thread-ids"),r=t("#activity-list.line-commenting > li.new-comment");if(i.length&&c.decorateThreads(B.toString(),i.data("value")),r.length){var o=!1;new u(B,o).decorate(r)}j(e.find(".pr-line-thread-ids"))}function j(e,t){e.length&&n.each(e.data("value"),function(e){n.each(e,function(e,i){t&&(e=n.intersection(e,t)),c.decorateThreads(B.toString(),e,i)})})}function D(){var e=this.filter(function(e){return e.get("approved")});r.vent.trigger("updateApprovals",e.length)}function q(){this.fetch({reset:!0})}var P=t("#pull-request-attrs"),I=function(){this.$window=null,this.$line=null};I.prototype.regex=/(F\d+)?(T\d+)?$/,I.prototype.oldRegex=/_(oldline|newline)(\d+)$/,I.prototype.cssClass="permalinked",I.prototype.isLinePermalink=function(e){var t=this.regex.exec(e);return!(!t[1]&&!t[2])},I.prototype.translateHash=function(e){var n=this.oldRegex.exec(e);if(n[1]&&n[2]){var i=e.substring("#chg_".length);i=i.substring(0,i.length-(n[1]+n[2]).length-1);var r={oldline:"F",newline:"T"},o="L"+i+r[n[1]]+n[2];if(document.getElementById(o))return o;var s=document.getElementById("chg-"+i);if(s){var a={oldline:"data-fnum",newline:"data-tnum"},l=t(s).find("div.common").filter("[{}={}]".format(a[n[1]],n[2]));if(1===l.length)return l.find(".line-numbers").attr("id")}}return null},I.prototype.decorate=function(e){this.$window=e,this.enterDocument()},I.prototype.enterDocument=function(){this.$window.bind("hashchange",t.proxy(this.highlightLine,this))},I.prototype.highlightLine=function(){var e=window.location.hash;if(this.oldRegex.test(e)){var n=this.translateHash(e);n&&(window.location.hash=n)}else if(this.isLinePermalink(e)){var i=document.getElementById(e.substring(1));i&&(null!==this.$line&&this.$line.removeClass(this.cssClass),this.$line=t(i).addClass(this.cssClass))}};var R=t("#pullrequest.view-pullrequest");R.find(".description img:not(.emoji)").each(function(e,n){var i=t(n),r=i.attr("src");if(!i.parent().is("a")){var o=t("<a>").addClass("image-link").attr({href:r,rel:"pr-image",target:"_blank","data-fancybox-type":"image"});i.wrap(o)}}),R.find(".description a.image-link").fancybox({loop:!1,nextEffect:"fade",prevEffect:"fade"});var M=t("#fulfill-pullrequest"),N=t("#reject-pullrequest"),O=t.Deferred();if("open"===P.data("status")){var L=t(".menu-item.active-tab a","#pullrequest-navigation").attr("data-tab-link-id");"diff"===L?t(document).one("diff:loaded",function(){O.resolve({isconflicted:t("#compare").data("hasConflicts"),mergeimpossible:t("#pr-tab-info").data("mergeimpossible")})}):O=t.ajax({url:R.attr("data-conflicts-url"),type:"GET",dataType:"json",cache:!1});var H=function(){var e=t("<span>").addClass("aui-icon aui-icon-warning").attr("title",gettext("Cannot merge due to conflicts"));t("#pullrequest-actions").prepend(e.tooltip())};O.done(i(H)).fail(H)}var F=new a(M,{onUpdateContents:function(e){var n=e.popup.element,r=-(new Date).getTimezoneOffset();n.find('input[name="tzoffset"]').val(r);var o=function(){n.find("form").empty().append(t("#pull-request-header").find(".conflicts-detected")),n.find(".dialog-button-panel button").prop("disabled",!0).attr({"aria-disabled":!0,title:gettext("Cannot merge due to conflicts")})},s=function(){n.find("form").empty().append(t("#pull-request-header").find(".mergeimpossible")),n.find(".dialog-button-panel button").prop("disabled",!0).attr({"aria-disabled":!0,title:gettext("Cannot merge")})};O.done(i(o,s)).fail(s).always(function(){n.find("form.maskable").removeClass("has-mask")})},success:function(e,t){t.result?window.location=t.result:setTimeout(function(){_(t.url).fail(this.error.bind(this))}.bind(this),1e3)},error:function(e){this.complete_(),this.displayError({title:gettext("Unable to merge"),body:e,closeable:!1})},complete:function(){},dataType:"json",isStaticContent:!0,width:700,urlAttr:"data-form-url"}).bind();M.disable(!1);new a(N,{dataType:"json",isStaticContent:!0,urlAttr:"data-form-url"}).bind();N.disable(!1),w.showUpdatesDialog(),"open"===P.data("status")&&(R.hasClass("conflicts")?C():t(document).bind("bb:compare",function(){t("#compare-metadata").data("has-conflicts")&&(R.addClass("conflicts"),C())}),t(".pullrequest-metadata time").localize());var B=x.concat("repositories",s.owner.username,s.slug,"pullrequests",o.localId,"comments");S("#activity-list",function(){var e=t("#pr-tab-content");E(e)}),g.collectionFrom(R,64).done(function(e){e.on("participants:refresh",D,e),e.on("reset",D,e),r.vent.on("currentUserApproved",q,e),S(".reviewers-group .participants ol",function(t){new v({el:t,collection:e,condition:function(e){return e.get("username")!=o.author.username},auiAvatarSize:"medium",emptyTemplate:"no-reviewers-template"}).render()}),S(".author ol",function(t){new v({el:t,collection:e,condition:function(e){return e.get("username")==o.author.username},auiAvatarSize:"medium"}).render()}),e.bind("approved",function(e){e&&R.find("a.follow").trigger("toggle-follow",{type:"pullrequest",isNowFollowing:!0})}),t(document).on("comment-added approval-changed.pullrequest",function(t){e.trigger("participants:refresh"),"comment-added"==t.type&&R.find("a.follow").trigger("toggle-follow",{type:"pullrequest",isNowFollowing:!0})})}),R.find(".compare-widget-container .compare-widget").each(function(n,i){var r=t(i),o=!1;e.InlineDialog(r,"repo-details-"+n,function(e,n,i){o||e.addClass("pullrequest-branch-details-dialog").append(t(T.toHtml("branch-details-template",{display_name:r.attr("data-user-display-name"),username:r.attr("data-user-name"),user_avatar:r.attr("data-user-avatar"),user_url:r.attr("data-user-url"),repo_name:r.attr("data-repo-name"),repo_avatar:r.attr("data-repo-avatar"),repo_url:r.attr("data-repo-url"),branch_name:r.attr("data-branch-name"),branch_url:r.attr("data-branch-url"),branch_state:r.attr("data-branch-state"),commit_id:r.attr("data-commit-id"),commit_url:r.attr("data-commit-url"),size:24}))),o=!0,i&&i()},{arrowOffsetX:-8,width:"auto"})}),S("#pullrequest-navigation .tabs-menu",function(e){var i=t("#pr-tab-content"),o=e.find(".menu-item"),s=!0;(new I).decorate(t(window));var a=null,g=function(){var e,u,c=o.filter(".active-tab").find("a").data("tab-link-id"),g=t("#pr-tab-content"),v=t("#pr-tab-content-wrapper"),w=t("#diff-tab-preload"),x=i.find(".pr-line-thread-ids"),_=i.find(".bb-udiff"),k=t("#compare");if(g.trigger("diff:loaded"),null===a&&(a=t("#general-comments")),"diff"===c?(e=k.attr("data-anchor"),u=k.attr("data-dest-rev"),t("#general-comments").length||a.appendTo(w)):a.detach(),g.removeClass("has-mask"),v.removeClass("diff commits activity"),v.addClass(c),location.hash){var C="#"+b(location.hash.substr(1),{isIdentifier:!0}),S=t(C).parent("li.comment");if(document.getElementById(location.hash.substr(1)))S.addClass("highlight");else if("diff"===c){var T=x.data("value")||{},j=n.any(n.values(T),function(e){return n.any(n.values(e),function(e){return n.any(e,function(e){return"#comment-{}".format(e)===location.hash})})});if(j){var D=t("#pr-menu-activity"),q=location.hash,P=D.attr("href"),I=P.split("#");return I.length>1&&(I=[I.shift()]),I.push(q),D.attr("href",I.join("")).click(),void D.attr("href",P)}}}var R=k.attr("data-owner"),M=k.attr("data-slug"),N=k.attr("data-destination-owner"),O=k.attr("data-destination-slug"),L=k.data("local-id"),H=k.data("is-writer"),F=k.data("has-push-access"),q=k.attr("data-hash"),U=k.attr("data-branch"),z=k.attr("data-multiple-error");if(_.each(function(){var i,r=t(this),o=r.attr("data-filename"),s=r.attr("data-compare-files-url"),a=!!r.parent(".comment-content").length;if("diff"===c){var l=[],p=r.data("filename");x.length&&n.each(x.data("value"),function(e){l=n.union(l,e[p])}),i=new d(B,p,l,e,u).decorate(r)}new f(o,s).decorate(r.find(".diff-actions")),new h(r.data("expand-context-url")+encodeURI(o),r.data("identifier"),!a,i,B.toString()).decorate(r);var m=r.attr("data-path"),g=r.attr("data-source-url");require(["components/editor/editable-diff"],function(e){new e({el:r,owner:R,slug:M,destinationOwner:N,destinationSlug:O,localID:L,isWriter:H,hasPushAccess:F,isPullRequest:!0,hash:q,branch:U,path:m,sourceUrl:g,multipleError:z})})}),"diff"===c){var J=new y({el:t("#diff-ignore-whitespace")});J.on("toggle",function(e){var n={container:t("#pr-tab-content"),scrollTo:null,timeout:3e4},i=t("#pr-menu-diff");A.update("w",e?"1":"0");var r=A.asUrl(i.attr("href"));s=!0,i.attr("href",r),t.pjax(t.extend({url:r,replace:!0},n))}).render(),t(".comments-link").on("click",function(e){var n=t(e.target).closest("a.comments-link").data("file-path"),i=t(document.getElementById("chg-"+n)),r=i.find(".comment").find("article").first();0===r.length&&(r=i),t(window).scrollTo(r,500,{axis:"y",offset:-50}),e.preventDefault()}),t(".eclipsedcount").hoverIntent({over:t.noop,out:function(){$(["atl._trackEvent","Pull Request","Eclipsed Comments","Hovered icon"])}}).on("click",function(e){e.which>1||e.metaKey||e.ctrlKey||(e.preventDefault(),m(t(e.target)))});var W=t("#general-comments").find(".comment-count"),V=t("#comments-list");new l(W,V).decorate(),t("#commit-files-summary").find(".count-badge").each(function(e,n){var i=t(n),r=i.find(".count"),o=t(document.getElementById("chg-"+i.find(".comments-link").data("file-path")));new l(r,o).decorate()}),p.setupDeferredDiffMarkers(i.find(".bb-patch-unified"),!0,B),r.vent.trigger("diff:loaded")}"activity"===c&&E(i)};if(t("#diff-tab-preload").length){var v=t("#general-thread-ids"),w=t("#comments-list.line-commenting > li.new-comment");if(v.length&&c.decorateThreads(B.toString(),v.data("value")),w.length){var x=!0;new u(B,x).decorate(w)}}i.on("pjax:end",g),i.on("pjax:error",function(e,t,n){return t.readyState>0&&"abort"!==n?(i.html("<h2>Error</h2><p>We were unable to load this page.</p>"),!1):void 0}),i.on("pjax:beforeSend",function(){var e=t("#pr-tab-content-wrapper"),n=t("#pr-tab-content");n.addClass("has-mask"),s||e.removeClass("diff commits activity"),s=!1});var _={container:i,scrollTo:null,timeout:3e4},k=t("#pr-tab-info").data("active-tab-on-load"),C=t("#pr-menu-{}".format(k));if(C.length){var S=C.attr("href");location.hash&&(S+=location.hash),t.support.pjax?t.pjax(t.extend({url:S,replace:!0},_)):i.load(S+"?_ajax=1",g)}t.support.pjax&&e.on("click","li a",function(n){n.which>1||n.metaKey||n.ctrlKey||n.shiftKey||n.altKey||(n.preventDefault(),e.find("li").removeClass("active-tab"),t(this).closest(".menu-item").addClass("active-tab"),i.detach().empty(),i.appendTo(t("#pr-tab-content-wrapper")),t.pjax(t.extend({url:t(this).attr("href"),push:!0},_)))})}),R.on("follow:pullrequest",".sidebar a.follow",function(e,n){var i=t(this).siblings(".aui-icon");i.toggleClass("aui-iconfont-watch",n),i.toggleClass("aui-iconfont-unwatch",!n)}),S(".issue-dialog-trigger",function(n){e.InlineDialog(n,1,function(e,n,i){return t(".issue-dialog").appendTo(e).show(),i(),!1},{width:"auto",calculatePositions:k.alignLeft()})})})}),define("repo/qseries",["jquery","on-ready"],function(e,t){return t(function(){function t(e){e.closest("div.radio").prevAll().addClass("apply")}var n=e("#qseries form"),i=n.find("div.radio input");i.change(function(){var n=e(this);e("div.radio").removeClass("apply"),n.is(":checked")&&t(n)}),t(i.filter(":checked"))})}),define("components/share/share-dialog",["aui","backbone","jquery","js/components/aui-dialog","utils/mustache"],function(e,t,n,i,r){return t.View.extend({className:"share-dialog",template:"share-dialog-template",events:{tabSelect:"onChangeTab"},initialize:function(e){this.shareButtonText=e.shareButtonText||gettext("Share")},createDialog:function(){this.dialog=new i({width:800,height:"auto",id:this.id+"-dialog",closeOnOutsideClick:!0}),this.dialog.addHeader(gettext("Share")).addPanel(gettext("Share"),this.$el,"panel-body").addLink(gettext("Manage this team"),null,"share-manage-link left").addButton(this.shareButtonText,this.onShare.bind(this),"aui-button aui-style").addCancel(gettext("Cancel"),this.onCancel.bind(this)),this.$share=n(this.dialog.page[0].button[1].item[0]),this.$manage=n(this.dialog.page[0].button[0].item[0])},renderPanels:function(e){return this.panels=e,this.panels.forEach(function(e){e.on("sending",function(){this.enableDialog(!1)},this),e.on("success",function(){this.enableDialog(!0),this.dialog.hide()},this),e.on("error",function(){this.enableDialog(!0)},this)}.bind(this)),this.render()},render:function(){if(!this.panels)throw new Error("panels must be set before rendering");this.dialog||this.createDialog(),this.dialog.popup.element.toggleClass("has-tabs",this.panels.length>1);var t=this.panels[0];if(1===this.panels.length)return this.$el.html(t.render().el),this.setPanel(t),this;var i=this.dialog,o=this.panels.map(function(e){return n.extend(e,{tabId:"{}-{}".format(i.id,e.display)})});return this.$el.html(r.toHtml(this.template,{panels:o})),this.panels.forEach(function(e){this.$("#{}-{}".format(i.id,e.display)).append(e.render().el)}.bind(this)),this.$(".tabs-pane:first").addClass("active-pane"),this.$(".menu-item:first").addClass("active-tab"),e.tabs.setup(),this.setPanel(t),this},enableDialog:function(e){this.$share.prop("disabled",!e)},onShare:function(){this.activePanel.share()},onCancel:function(){this.dialog.hide()},onChangeTab:function(e,t){var n=t.pane.selector.slice(1);this.panels.forEach(function(e){e.tabId===n&&this.setPanel(e)}.bind(this))},setPanel:function(e){this.activePanel=e,this.dialog.addHeader(e.action),this.$manage.attr("href",e.getManageLink()),this.$manage.text(e.manageText)},show:function(){this.dialog.show()}})}),define("components/share/share-detail",["backbone","underscore"],function(e,t){var n=e.View.extend({tagName:"tr",template:"share-detail-template",events:{"click .delete":"destroyModel"},initialize:function(){this.events&&(this.events=t.defaults(this.events,n.prototype.events)),this.delegateEvents(this.events),t.bindAll(this,"render","remove"),this.model.on("change",this.render),this.model.on("destroy",this.remove)
},destroyModel:function(e){e.preventDefault(),this.model.destroy()},remove:function(){this.$el.remove()}});return n}),define("components/share/repo-share-detail",["jquery","underscore","components/share/share-detail","utils/mustache"],function(e,t,n,i){return n.extend({events:{"click .permission":"setPermission"},initialize:function(){n.prototype.initialize.call(this),t.bindAll(this,"setPermission")},render:function(){var e=this.model.toJSON();return e[this.model.get("permission")]=!0,this.$el.html(i.toHtml(this.template,e)),this},setPermission:function(t){this.model.set({permission:e(t.target).data("permission")})}})}),define("components/share/share",["backbone","bitbucket","jquery","data/current-repo","data/current-user","utils/api-helper"],function(e,t,n,i,r,o){return e.Model.extend({initialize:function(e){this.teamName=e.teamName||i.owner.username},save:function(){var e;if(this.get("email")){if(this.get("permission"))e=t.send_invitation(this.get("email"),this.get("permission"),i.toString());else if(this.get("group")){var s=t.user(this.teamName),a=s.username+"/"+this.get("group");e=s.invite(this.get("email"),a)}}else this.get("username")&&(this.get("permission")?e=n.ajax({url:o.concat("privileges",i.owner.username,i.slug,this.get("username")),type:"PUT",data:this.get("permission"),dataType:"json"}):this.get("group")&&(e=n.ajax({url:o.concat("groups",this.teamName,this.get("group"),"members",this.get("username")),type:"PUT",data:JSON.stringify(this.get("bbUserObject")),dataType:"json"})));e.error(function(e){if(500===e.status)this.set({error:gettext("There was a problem processing your request.")});else if(402===e.status){var t=n.parseJSON(e.responseText).data;if(t.user.username===r.username)this.set({error:gettext("You are already at your plan limit and will need to upgrade your plan before adding more users.")});else{var i=gettext("This account (%(username)s) is at its plan limit and will need to be upgraded before adding more users.");this.set({error:interpolate(i,{username:t.user.username},!0)})}}else 409!==e.status&&this.set({error:e.responseText})}.bind(this)).complete(function(){this.trigger("save",this)}.bind(this))}})}),define("components/share/share-collection",["backbone","components/share/share"],function(e,t){return e.Collection.extend({model:t,add:function(t){var n=this.any(function(e){return t.get("username")?t.get("username")===e.get("username"):t.get("email")?t.get("email")===e.get("email"):void 0});return n?!1:void e.Collection.prototype.add.call(this,t)}})}),define("components/share/share-form",["aui","backbone","bitbucket","jquery","underscore","components/share/share","components/share/share-collection","utils/gaq-push","utils/mustache","utils/valid"],function(e,t,n,i,r,o,s,a,l,u){return t.View.extend({template:"share-form-template",events:{"submit form":"add","keyup .user-or-email":"toggleAddButton"},initialize:function(e){r.bindAll(this,"render","renderShare","toggleAddButton","hideError","showError","add","send"),this.groups=e.groups,this.collection=new s,this.collection.on("add",this.renderShare),this.collection.on("reset",this.render),this.errors=[],this.on("send",this.send)},render:function(){var e={disabled:this.disabled};return this.$el.html(l.toHtml(this.template,e)),this.$error=this.$(".error"),this.$userOrEmail=this.$(".user-or-email"),this.$addButton=this.$("button"),this.collection.each(function(e){this.renderShare(e)}.bind(this)),this},renderShare:function(e){var t=new this.DetailView({groups:this.groups,hasCustomGroups:this.hasCustomGroups,model:e});this.$("tbody").append(t.render().el)},toggleAddButton:function(){""!==this.$userOrEmail.val()?this.$addButton.removeAttr("disabled"):this.$addButton.attr("disabled","disabled")},hideError:function(){this.$error.addClass("hidden")},isValid:function(){return!0},getFormError:function(){return this.errors.length?this.errors.pop():gettext("An unknown error occurred")},showError:function(e,t){var n=t?"html":"text";this.$error.find(".message")[n](e).end().removeClass("hidden")},add:function(e){e.preventDefault();var t=this.$userOrEmail.val(),i=r.clone(this.modelSkeleton),s=function(){this.hideError(),this.$userOrEmail.val(""),this.collection.add(new o(i))}.bind(this);return t?void(u.email(t)?(i.email=t,s()):n.user(t).details(function(e){i=r.extend(i,{username:e.username,displayName:e.display_name,avatar:e.avatar,bbUserObject:e}),this.isValid(e)?s():this.showError(this.getFormError())}.bind(this)).error(function(){var e=gettext('User "%(user_or_email)s" does not exist.');this.showError(interpolate(e,{user_or_email:t},!0))}.bind(this))):!1},send:function(){if(0===this.collection.length)return this.showError(gettext("Add a user or email address.")),!1;this.trigger("sending"),this.disabled=!0,this.render();var e=this.collection.length,t=e,n="repo"===this.shareType?"Repo Share":"Team Share";this.collection.each(function(e){var t=e.get("username")?"Existing User":"New User";a(["atl._trackEvent","Share",n,t]),e.save()}),this.collection.on("save",function(n){--e,n.get("error")||n.destroy(),0>=e&&(this.collection.length?(this.trigger("error"),this.disabled=!1,this.render(),this.showError(n.get("error")),this.off("success")):(this.disabled=!1,this.render(),this.trigger("success",{inviteCount:t})))}.bind(this))}})}),define("components/share/repo-share-form",["aui","components/share/repo-share-detail","components/share/share-form","data/current-repo","utils/gaq-push"],function(e,t,n,i,r){return n.extend({initialize:function(e){this.DetailView=t,this.modelSkeleton={permission:"read"},this.shareType="repo",n.prototype.initialize.call(this,e)},add:function(e){var t=this.$userOrEmail.val();if(i.owner&&t===i.owner.username||i.creator&&t===i.creator.username){var r=gettext('User "%(user_or_email)s" already has access to this repository');return this.showError(interpolate(r,{user_or_email:t},!0)),!1}n.prototype.add.call(this,e)},send:function(){this.on("success",function(){r(["atl._trackEvent","Share","Share repo"]),e.messages.success({body:gettext("You have successfully shared this repository"),fadeout:!0})}),n.prototype.send.call(this)}})}),define("components/share/panel/repo",["backbone","underscore","components/share/repo-share-form","utils/mustache"],function(e,t,n,i){return e.View.extend({className:"share-panel-repo",display:gettext("Repository"),action:gettext("Share"),manageText:gettext("Manage this repository"),template:"share-repo-template",render:function(){return this.$el.html(i.toHtml(this.template)),this.form=new n({el:this.$(".share-form")}).render(),this.form.on("all",function(e,t){this.trigger(e,t)},this),this},share:function(){this.form.send()},getManageLink:function(){return this.$(".manage-repo-link").attr("data-manage-link")}})}),define("components/share/team-share-detail",["underscore","components/share/share-detail","utils/mustache"],function(e,t,n){return t.extend({events:{"click .admin":"toggleAdmin","change .group":"setGroup"},initialize:function(n){t.prototype.initialize.call(this,n),this.groups=n.groups,this.hasCustomGroups=n.hasCustomGroups,e.bindAll(this,"toggleAdmin","setGroup")},render:function(){var t=this.model.toJSON();return t.hasCustomGroups=this.hasCustomGroups,this.hasCustomGroups&&(t.groups=e.map(this.groups,function(e){return{name:e.name,slug:e.slug,isSelected:e.slug===this.model.get("group")}}.bind(this)),t.noGroupChoices=t.groups.length<=1),t.isAdmin="administrators"===this.model.get("group"),this.$el.html(n.toHtml(this.template,t)),this},toggleAdmin:function(){var e=this.$(".admin").is(":checked")?"administrators":"developers";this.setGroup(null,e)},setGroup:function(e,t){this.model.set({group:t?t:this.$(".group").val()})}})}),define("components/share/team-share-form",["aui","underscore","components/share/team-share-detail","components/share/share-form","utils/gaq-push","data/current-user"],function(e,t,n,i,r,o){return i.extend({initialize:function(e){this.DetailView=n,this.modelSkeleton={group:e.groups.length?e.groups[0].slug:"developers",teamName:e.teamName},this.shareType="team",this.hasCustomGroups=function(){if(2===e.groups.length){var n=!1,i=!1;if(t.each(e.groups,function(e){"Administrators"===e.name&&"admin"===e.permission?n=!0:"Developers"===e.name&&"write"===e.permission&&(i=!0)}),n&&i)return!1}return!0}.bind(this)(),i.prototype.initialize.call(this,e)},isValid:function(e){return e.username===this.modelSkeleton.teamName?(this.errors.push(gettext("You cannot invite a team to join itself.")),!1):e.username===o.username?(this.errors.push(gettext("You cannot invite yourself.")),!1):e.is_team?(this.errors.push(gettext("You cannot invite another team.")),!1):!0},send:function(){this.on("success",function(){r(["atl._trackEvent","Share","Share team"]),e.messages.success({body:gettext("You have successfully shared this team")})}),i.prototype.send.call(this)}})}),define("components/share/panel/team",["jquery","backbone","underscore","components/share/team-share-form","utils/api-helper","utils/mustache","utils/loading"],function(e,t,n,i,r,o){return t.View.extend({className:"share-panel-team maskable",display:gettext("Team"),action:gettext("Invite"),manageText:gettext("Manage this team"),template:"share-team-template",initialize:function(e){this.teamName=e.name,this.teamDisplay=e.display,this.teamAvatar=e.avatar,this.manageUrl=e.manageUrl},render:function(){return this.loadGroupsDeferred=this.loadGroupsDeferred||e.ajax({url:r.concat("groups",this.teamName),dataType:"json"}),this.$el.loading(this.loadGroupsDeferred,{mask:!0}).done(function(e){this.$el.html(o.toHtml(this.template,{display_name:this.teamDisplay,avatar:this.teamAvatar})),this.form=new i({el:this.$(".share-form"),groups:this.filterGroups(e),teamName:this.teamName}).render(),this.form.on("all",function(e,t){this.trigger(e,t)},this)}.bind(this)),this},filterGroups:function(e){return e},share:function(){this.form.send()},getManageLink:function(){return this.manageUrl}})}),define("repo/share",["jquery","on-ready","components/share/share-dialog","components/share/panel/repo","components/share/panel/team"],function(e,t,n,i,r){return t(function(){var t=e("#repo-share-link"),o=!!t.attr("data-team-name"),s=new n({id:"share-repo"}),a=[new i],l=e("a.share");o&&a.unshift(new r({name:t.attr("data-team-name"),display:t.attr("data-team-display"),avatar:t.attr("data-team-avatar"),manageUrl:t.attr("data-team-manage-link")})),l.on("click",function(e){e.preventDefault(),s.show()}).on("mouseover.share-dialog",function(){s.renderPanels(a),l.off("mouseover.share-dialog")})})}),define("repo/source/create-file",["backbone","jquery","on-ready","underscore","utils/mustache","utils/query-params","utils/ready","jquery-plugins/jquery.pjax"],function(e,t,n,i,r,o){return n(function(){require(["js/components/code-editor/modes","components/editor/edit-form"],function(n,s){var a=t("#editor-container"),l=a.attr("data-owner"),u=a.attr("data-slug"),c=a.data("is-writer"),d=a.data("has-push-access"),h=a.attr("data-hash"),p=a.attr("data-branch"),f=a.attr("data-path"),m=a.attr("data-source-url"),g=t(r.toHtml("edit-form-template",{owner:l,slug:u,isCreate:!0,isWriter:c,hasPushAccess:d,hash:h,branch:p,path:f,encodedPath:encodeURIComponent(this.path),content:"",syntaxes:i.sortBy(n,function(e){return e.name.toLowerCase()})})).appendTo(a),v=new s({el:g,source:"",isParentValid:function(){return t("#filename").val().trim()}.bind(this)}),y=new e.Collection,b=e.View.extend({id:"path",events:{"keydown #filename":"keydownHandler","keyup #filename":"keyupHandler"},initialize:function(e){this.editForm=e.editForm,this.initialPath=e.initialPath,this.sourceUrl=e.sourceUrl},render:function(){var e=this.collection;return this.$(".path-part").each(function(){e.add({path:t(this).text()})}),new w({el:this.$(".path-parts"),collection:this.collection}),this.$filename=this.$("#filename"),this.$filename.focus(),(this.collection.length||o.get("filename"))&&this.editForm.on("ready",this.updatePath.bind(this)),this},getFilename:function(){return this.$filename.val().trim()},setFilename:function(e){this.$filename.val(e)},getFullPath:function(){var e=this.collection.pluck("path");return e.push(this.getFilename()),this.initialPath+e.join("/")},keydownHandler:function(e){this.checkForSlash(e),this.checkForDelete(e)},keyupHandler:function(){this.updatePath()},checkForSlash:function(e){if(191===e.keyCode){e.preventDefault();var t=this.getFilename();t&&(this.collection.add({path:t}),this.setFilename(""))}},checkForDelete:function(e){if(8===e.keyCode&&!this.getFilename()){var t=this.collection.pop();t&&(e.preventDefault(),this.setFilename(t.get("path")))}},updatePath:function(){var e=this.getFullPath();this.updateEditorPath(e),this.editForm.setCommitEnabled(!0),e&&this.getFilename()?this.checkForPathExistence(e):(this.$("#duplicate-file-error").remove(),this.editForm.setCommitEnabled(!1))},updateEditorPath:function(e){return this.editForm.setPath(e),this.editForm.updatePathBasedSyntax(e),this},checkForPathExistence:i.debounce(function(e){t.ajax({url:this.sourceUrl+e,type:"GET"}).always(function(e,n){if(this.$("#duplicate-file-error").remove(),"success"===n){var i=gettext("A file with this name already exists.");t('<span class="error" id="duplicate-file-error"/>').text(i).insertAfter(this.$filename),this.editForm.setCommitEnabled(!1)}}.bind(this))},100)}),w=e.View.extend({tagName:"ul",className:"path-parts",initialize:function(e){this.collection=e.collection,this.collection.on("add remove",this.render.bind(this))},render:function(){return this.$el.empty().append(this.collection.map(function(e){return new x({model:e}).render().el})),this}}),x=e.View.extend({tagName:"li",className:"path-part",render:function(){return this.$el.text(this.model.get("path")),this}});new b({el:t("#path"),collection:y,editForm:v,initialPath:f,sourceUrl:m}).render(),v.on("ready",function(){a.removeClass("has-mask")})})})}),define("components/editor/commit-merge-error",["backbone","jquery","underscore","utils/mustache"],function(e,t,n,i){return e.View.extend({template:"commit-merge-error-template",initialize:function(e){n.bindAll(this,"render"),this.repository=e.repository,this.commit=e.commit,this.path=e.path},render:function(){var e={owner:this.repository.get("owner").get("username"),slug:this.repository.get("slug"),hash:this.commit.get("hash"),path:this.path,branch:this.commit.get("branch").get("name"),encodedBranch:encodeURIComponent(this.commit.get("branch").get("name"))};return this.$el.html(i.toHtml(this.template,e)),this}})}),define("components/editor/commit-form",["aui","backbone","jquery","underscore","api/models/branch","api/models/commit","api/models/pullrequest","api/models/pullrequest-target","components/editor/commit-merge-error","data/current-user","js/components/aui-dialog","utils/create-reviewer-autocomplete","utils/mustache"],function(e,t,n,i,r,o,s,a,l,u,c,d,h){return t.View.extend({template:"commit-form-template",events:{"keyup #id_path":"checkPath","click #id_create-pullrequest":"createPullRequestHandler","focusout #id_branch-name":"slugifyBranchName","click .create-pull-request-link":"createPullRequest","submit .commit-form":"commitChanges","click .commit-button":"commitChanges","click .cancel-link":"hide"},initialize:function(e){i.bindAll(this,"createPullRequestHandler","slugifyBranchName","createPullRequest","commitChanges","hide","updateCreatePRCheckbox");var r=new c({width:700,height:"auto",id:"commit-form"}),o=n(h.toHtml(this.template,{}));r.addHeader(o.attr("data-title")),r.addPanel("main","","commit-form-body"),r.addButton(o.attr("data-cta-label"),null,"commit-button"),r.addLink(o.attr("data-cancel-label"),null,"cancel-link"),this.dialog=r,this.setElement(r.popup.element[0]),this.$commitFormBody=this.$(".commit-form-body"),this.$cancelLinkTemplate=this.$(".cancel-link").clone(),this.$cancelPlaceholderTemplate=n('<span class="cancel-placeholder" />').text(this.$cancelLinkTemplate.text()),this.originalRepository=e.repository,this.destinationRepository=e.destinationRepository,this.localID=e.localID,this.isDelete=e.isDelete,this.isCreate=e.isCreate,this.isRename=e.isRename,this.isWriter=e.isWriter,this.hasPushAccess=e.hasPushAccess,this.isPullRequest=e.isPullRequest,this.originalHash=e.hash,this.originalBranch=e.branch,this.originalPath=e.path,this.sourceUrl=e.sourceUrl,this.state=new t.Model,this.state.on("change:createPullRequest",this.updateCreatePRCheckbox)},render:function(){var e={owner:this.originalRepository.get("owner").get("username"),slug:this.originalRepository.get("slug"),path:this.originalPath,filename:this.originalPath.split("/").pop(),isCreate:this.isCreate,isDelete:this.isDelete,isRename:this.isRename,isWriter:this.isWriter,hasPushAccess:this.hasPushAccess,isPullRequest:this.isPullRequest};this.$commitFormBody.html(h.toHtml(this.template,e)),this.$error=this.$(".aui-message.error"),this.$info=this.$(".aui-message.info"),this.$path=this.$("#id_path"),this.$prFields=this.$("#pr-fields"),this.$commitButton=this.$(".commit-button");var t=this.$(".commit-form");return this.defaultMessage=t.attr("data-default-message"),this.forkError=t.attr("data-fork-error"),this.commitError=t.attr("data-commit-error"),this.pullRequestError=t.attr("data-pull-request-error"),this.updateError=t.attr("data-update-error"),this.branchConflictError=t.attr("data-branch-conflict-error"),this.forkingMessage=t.attr("data-forking-message"),this.committingMessage=t.attr("data-committing-message"),this.mergingMessage=t.attr("data-merging-message"),this.creatingPRMessage=t.attr("data-creating-pr-message"),this.updatingPRMessage=t.attr("data-updating-pr-message"),this.$commitButton.addClass("aui-button"),this.$("#id_message").val(this.defaultMessage),this.$message||(n('<div class="message" />').prependTo(this.$(".dialog-button-panel")),this.$message=this.$(".dialog-button-panel").find(".message")),this.state.set({autocompleteInitialized:!1,createPullRequest:!this.isWriter||!this.hasPushAccess}),this.updateCreatePRCheckbox(this.state,this.state.get("createPullRequest")),this},getPath:function(){return this.$path.val()&&this.$path.val().trim()||this.originalPath},getMessage:function(){return this.$("#id_message").val()||this.defaultMessage},getCommit:function(){var e=new o({repository:this.originalRepository,parents:[this.originalHash],branch:new r({repository:this.originalRepository,name:this.originalBranch})});return this.isRename?(e.addFile({path:this.originalPath,content:null}),e.addFile({path:this.getPath(),content:this.content})):e.addFile({path:this.originalPath,content:this.content}),e},getPullRequest:function(){var e=this.getMessage(),t=this.commit.get("repository").id!==this.originalRepository.id?!1:!0;return new s({source:new a({repository:this.commit.get("repository"),branch:this.commit.get("branch")}),destination:new a({repository:this.originalRepository,branch:new r({repository:this.originalRepository,name:this.originalBranch})}),title:e.split("\n")[0],description:e,close_source_branch:t})},setContent:function(e){return this.content=e,this},generateBranchName:function(){return"{}/{}".format(u.username,this.getMessage().replace(/[^\w\s]/g,"").substring(0,40).replace(/\s+/g,"-").toLowerCase()+"-"+Date.now())},slugify:function(e){return e.replace(/[^\w\s/-]/g,"").replace(/\s+/g,"-")},slugifyBranchName:function(e){var t=n(e.target);t.val(this.slugify(t.val()))},redirect:function(e){var t=e.html.href;n(window).off(".editor"),window.location=t},commit:function(){var e=function(){this.isWriter?this.saveCommit(t):this.forkAndCommit(t)}.bind(this),t=this.getCommit();if(this.disable(),t.set({message:this.getMessage()}),this.state.get("createPullRequest")){var n=this.$("#id_branch-name").val();t.setBranch(n||this.generateBranchName()),t.get("branch").fetch().fail(e.bind(this)).done(function(){this.enable().showError(this.branchConflictError)}.bind(this))}else e()},saveCommit:function(e){this.showMessage(this.committingMessage),e.save(null,{success:function(){this.commit=e,this.state.get("createPullRequest")?this.createPullRequest():this.isPullRequest?this.updatePullRequest():this.redirect(e.get("links"))}.bind(this),error:function(t,n){this.state.get("createPullRequest")||409!==n.status?this.showError(this.commitError).enable():this.branchAndMerge(e)}.bind(this)})},updatePullRequest:function(){this.showMessage(this.updatingPRMessage);var e=this.getPullRequest();e.set({local_id:this.localID}),e.get("destination").set({repository:this.destinationRepository}),e.updateRef().done(function(e){n(window).off(".editor"),window.location=e}).fail(function(){this.hide(),this.showError(this.updateError)}.bind(this))},forkAndCommit:function(e){this.showMessage(this.forkingMessage),this.originalRepository.fork().done(function(t){e.set({repository:t}),this.saveCommit(e)}.bind(this)).fail(function(){this.showError(this.forkError).enable()}.bind(this))},branchAndMerge:function(e){this.showMessage(this.mergingMessage),e.setBranch(this.generateBranchName()).save(null,{success:function(){this.commit=e;var t={hash:e.get("hash").slice(0,13),branch:this.originalBranch,message:e.get("message")},n=h.toHtml("merge-message-template",t);this.commit.merge(this.originalBranch,n).done(function(e){this.isPullRequest?this.updatePullRequest():this.redirect(e.links)}.bind(this)).fail(function(){this.showError(new l({repository:this.originalRepository,commit:this.commit,path:this.originalPath}).render().$el.html()),this.$commitButton.removeClass("loading")}.bind(this))}.bind(this),error:function(){this.showError(this.commitError).enable()}.bind(this)})},createPullRequest:function(e){e&&(e.preventDefault(),this.enable(),this.$("#id_create-pullrequest").prop("checked",!0),this.disable()),this.showMessage(this.creatingPRMessage);var t=this.getPullRequest();t.set({reviewers:this.$("#reviewers").val().split(",")}),t.save(null,{success:function(e){this.redirect(e.get("links"))}.bind(this),error:function(){this.showError(this.pullRequestError).enable()}.bind(this)})},disable:function(e){return this.disabled=!0,this.$commitButton.addClass("loading"),e?this.$commitButton.attr({disabled:"disabled","aria-disabled":!0}):(this.$(":input").attr({disabled:"disabled","aria-disabled":!0}),this.$(".cancel-link").replaceWith(this.$cancelPlaceholderTemplate.clone())),this},enable:function(){return this.disabled=!1,this.$commitButton.removeClass("loading"),this.$(":input").removeAttr("disabled aria-disabled"),this.$(".cancel-placeholder").replaceWith(this.$cancelLinkTemplate.clone()),this},showError:function(e){return this.hideMessage().$error.removeClass("hidden").find(".message").html(e),this},hideError:function(){return this.$error.addClass("hidden"),this},showMessage:function(e){return this.$message.stop().fadeOut(200,function(){this.$message.html("{}&hellip;".format(e)),this.$message.fadeIn(200)}.bind(this)),this},hideMessage:function(){return this.$message.stop().hide(),this},updateCreatePRCheckbox:function(e,t){this.$("#id_create-pullrequest").prop("checked",t),this.$prFields&&this.$prFields.length&&(t?(this.$prFields.slideDown(200).find("#id_branch-name").val(this.generateBranchName()),this.isPullRequest||this.state.get("autocompleteInitialized")||i.defer(function(){d(this.$("#reviewers-group")),this.state.set({autocompleteInitialized:!0})}.bind(this))):this.$prFields.slideUp(200))},createPullRequestHandler:function(e){this.state.set({createPullRequest:n(e.target).is(":checked")})},commitChanges:function(e){e&&e.preventDefault(),this.disabled||this.commit()},show:function(e){e&&e.preventDefault(),this.render().checkPath(),this.dialog.show()},hide:function(e){e&&e.preventDefault(),this.dialog.hide()},checkPath:i.debounce(function(){if(this.isRename){this.$("#path-error").remove(),this.disable(!0);var e=this.$path.val().trim();if(e===this.originalPath)return void this.$commitButton.removeClass("loading");if(""===e)return n('<span class="error" id="path-error">You must specify a path.</span>').insertAfter(this.$path),void this.$commitButton.removeClass("loading");var t=this.sourceUrl.slice(0,this.sourceUrl.lastIndexOf("/")+1);n.get(t+e).always(function(e,t){"success"===t?(n('<span class="error" id="path-error">A file with this name already exists.</span>').insertAfter(this.$path),this.$commitButton.removeClass("loading")):this.enable()}.bind(this))}},100)})}),define("repo/source/delete-file",["jquery","on-ready","api/cache/repositories","components/editor/commit-form","utils/gaq-push"],function(e,t,n,i,r){return t(function(){e("#editor-container").find(".delete-link").click(function(){var t=e("#editor-container"),o=n.load("{}/{}".format(t.attr("data-owner"),t.attr("data-slug"))),s=t.attr("data-hash"),a=(t.attr("data-branch"),t.data("is-writer")),l=t.data("has-push-access"),u=t.attr("data-path"),c=new i({repository:o,isDelete:!0,isWriter:a,hasPushAccess:l,hash:s,branch:t.attr("data-branch"),path:u});c.show(),r(["atl._trackEvent","Online editing","Delete file"])})})}),define("components/changeset-selector",["aui","jquery","data/current-repo","utils/api-helper","utils/localize","utils/mustache","utils/masker"],function(e,t,n,i,r,o,s){return function(a,l,u){function c(){C||S||(C=!0,m.addClass("loading"),t.ajax({url:_,data:{page:k},dataType:"json",success:function(e){var n,i=e.changesets?e.changesets:e;if(!i.length){var s=u.noMoreText||gettext("No more commits");return n=t('<li class="end"></li>').text(s),S=!0,m.removeClass("loading"),void m.append(n)}for(var a=0,l=i.length;l>a;a++){var c=i[a];c.selected=w&&(w.startsWith(c.node)||c.node.startsWith(w)),c.path=b,n=t("<li></li>").html(o.toHtml("source-changeset",c)),g.before(n),k++}m.removeClass("loading"),r()},error:function(t,n){var i;i=$[t.status]?$[t.status]:n,f.hide(),m.remove(),m=null,e.messages.error({body:"{!esc}".format(i)})},complete:function(){C=!1}}))}function d(e,n,i){return m&&m.length?void(i&&i()):(m=t("<ul></ul>").addClass("file-history-widget"),g=t("<li></li>").addClass("loading-item"),m.append(g),e.append(m),c(),m.scroll(function(){m[0].scrollHeight-m.scrollTop()<=m.outerHeight()&&c()}),m.on("click","a",function(e){if(u.onSelect){var n=t(e.target).closest("a"),i=n.attr("data-hash"),s=w;if(e.preventDefault(),n.hasClass("highlight"))return;w=i;var a=u.onSelect(n);if(a){var l={hash:i.substring(0,7),utctimestamp:n.find("time").attr("datetime"),avatar:n.find("img").attr("src"),display_name:n.find("author").text()};m.find(".highlight").removeClass("highlight"),n.addClass("highlight"),v.html(t(o.toHtml("source-changeset-trigger",l))),r()}else w=s}f.hide()}),void(i&&i()))}function h(){f=e.InlineDialog(v,l,d,{initCallback:function(){this.show(),setTimeout(function(){s.mask(g,{spinner:s.spinnerSizes.TINY,background:"transparent"})},x)},hideCallback:function(){s.unmask(g,{spinner:s.spinnerSizes.TINY,background:"transparent"})},showDelay:x})}function p(){return w}u=u||{};var f,m,g,v=t(a),y=v.data("changeset"),b=v.data("path"),w=v.data("current"),x=0,_=u.url||i.concat("repositories",n.owner.username,n.slug,"filehistory",y)+b,k=0,C=!1,S=!1,$={500:gettext("An error occurred while processing your request."),404:gettext("Unable to find changesets for this file.")};return{init:h,getSelectedChangeset:p}}}),define("repo/source/diff-file",["jquery","on-ready","components/changeset-selector","jquery-plugins/jquery.pjax"],function(e,t,n){return t(function(){function t(){var t=i.getSelectedChangeset(),n=r.getSelectedChangeset();return t.startsWith(n)||n.startsWith(t)?(l.removeClass("hidden"),l.find(".message").text("You cannot diff the same commit."),!1):(l.text(""),e.pjax({container:"#source-container",url:window.location.pathname,data:{diff1:t,diff2:n,at:u||""},success:function(t){e("#source-container").html(t)}}),!0)}var i,r,o=e("#source-diff"),s=o.find("#diff1-history-trigger"),a=o.find("#diff2-history-trigger"),l=o.find(".error"),u=o.data("at");i=n(s,"diff-dialog-diff1",{onSelect:t}),i.init(),r=n(a,"diff-dialog-diff2",{onSelect:t}),r.init()})}),define("repo/source/editor",["jquery","on-ready"],function(e,t){return t(function(){var t=e("#editor-container"),n=t.data("owner"),i=t.data("slug"),r=t.data("is-writer"),o=t.data("has-push-access"),s=t.data("hash"),a=t.data("branch"),l=t.data("path"),u=t.data("source-url"),c=t.data("create-file");require(["components/editor/editable-source"],function(e){new e({el:t,owner:n,slug:i,isWriter:r,hasPushAccess:o,hash:s,branch:a,path:l,sourceUrl:u,createFile:c})})})}),define("repo/source/embed",["aui","jquery","on-ready","utils/dialog-positions","utils/mustache"],function(e,t,n,i,r){return n(function(){function n(e,n,i){var o=t(n);if(!e.find(".embed").length){var s=r.toHtml("embed-template",{url:o.attr("href")});e.append(s)}i&&i(),setTimeout(function(){t("#embed-code").select()},0)}var o=t("#embed-link");e.InlineDialog(o,"embed-dialog",n,{calculatePositions:i.alignRight()})})}),define("repo/source/list",["jquery","on-ready","utils/localize"],function(e,t,n){return t(function(){var t=e("#source-list"),i=t.find(".date.deferred").first();i.length<1||(i.addClass("loading"),e.ajax({url:t.attr("data-lastmod-url"),success:function(i){e(i).each(function(){var n,i,r;return n=e(this),r=n.data("for"),r?(i=t.find(r),i.removeClass("deferred"),i.html(n)):void 0}),n()},complete:function(){i.removeClass("loading")}}))})}),define("repo/source/rename-file",["jquery","on-ready","api/cache/repositories","components/editor/commit-form","utils/gaq-push"],function(e,t,n,i,r){return t(function(){e("#editor-container").find(".rename-link").click(function(){var t=e("#editor-container"),o=n.load("{}/{}".format(t.attr("data-owner"),t.attr("data-slug"))),s=t.attr("data-hash"),a=(t.attr("data-branch"),t.data("is-writer")),l=t.data("has-push-access"),u=t.attr("data-path"),c=t.attr("data-source-url");e.ajax({url:c,type:"GET",dataType:"json"}).done(function(e){var n=new i({repository:o,isRename:!0,isWriter:a,hasPushAccess:l,hash:s,branch:t.attr("data-branch"),path:u,sourceUrl:c});n.setContent(e.data),n.show()}),r(["atl._trackEvent","Online editing","Rename file"])})})}),define("repo/source/view-file",["jquery","on-ready","components/changeset-selector","jquery-plugins/jquery.pjax"],function(e,t,n){return t(function(){var t=e("#source-view"),i=t.find("#file-history-trigger"),r=n(i,"changesets-dialog");r.init(),t.find(".edit-button-overlay").tooltip()})}),define("repo/source/index",["aui","jquery","on-ready","components/branches/checkout-dialog","utils/dialog-positions","utils/localize","utils/mustache","utils/ready","utils/gaq-push","repo/index","repo/source/create-file","repo/source/delete-file","repo/source/diff-file","repo/source/editor","repo/source/embed","repo/source/list","repo/source/rename-file","repo/source/view-file","components/diff/index"],function(e,t,n,i,r,o,s,a,l){return n(function(){var n=t(document),u=t("#source-container");a("#new-file-button",function(e){e.on("click",function(){l(["atl._trackEvent","Online editing","New file"])})});var c={container:"#source-container",timeout:5e3};u.pjax(".pjax-trigger",c),u.on("pjax:send",function(){u.addClass("has-mask")}),u.on("pjax:complete",function(){u.removeClass("has-mask")}),n.pjax("#inline-dialog-changesets-dialog .file-history-widget a",c),n.pjax("#inline-dialog-branch-dialog .filter-list a",c),n.on("pjax:start",function(){t("#inline-dialog-branch-dialog").remove(),t("#inline-dialog-changesets-dialog").remove(),t("#inline-dialog-diff-dialog-diff1").remove(),t("#inline-dialog-diff-dialog-diff2").remove()}),n.on("pjax:timeout",function(){l(["atl._trackEvent","Source Browser","pjax timeout"])}),n.on("pjax:end",function(){o(),t(".tipsy:last").remove()}),a("#embed-link",function(n){function i(e,n,i){var r=t(n);if(!e.find(".embed").length){var o=s.toHtml("embed-template",{url:r.attr("href")});e.append(o)}i&&i(),setTimeout(function(){t("#embed-code").select()},0)}e.InlineDialog(n,"embed-dialog",i,{calculatePositions:r.alignRight()})}),a("#source-path",function(e){e.find(".add-file-link").tooltip({gravity:"w"})}),a("#checkout-branch-button",function(e){i(e,function(){return e.closest(".aui-buttons").find(".branch-dialog-trigger").attr("title")})})})}),define("js/components/wiki-markup-editor",["marionette","js/components/markup-editor","js/components/markup-language-dropdown"],function(e,t,n){return t.extend({markItUpOptions:function(){return{syntax:this.language,isWiki:!0}
},initialize:function(){t.prototype.initialize.call(this)},render:function(){return t.prototype.render.call(this),this._createDropdown(),this},setLanguage:function(e){this.language=e,this.$el.attr("data-markup-type",e).find("[class^=markup-type]").removeClass().addClass("markup-type-"+e),this.trigger("change:language",e)},_createDropdown:function(){this.languageDropdown=new n({el:$("#dropdown-wiki-lang"),$languageBtn:this.$(".markItUpButton.language"),language:this.language}).render(),this.listenTo(this.languageDropdown,"change:language",this.setLanguage)}})}),define("repo/wiki/edit",["on-ready","js/components/wiki-markup-editor"],function(e,t){return e(function(e){var n=e.find(".textarea-preview"),i=e.data("isCreate"),r=e.find("#id_markup_type"),o=new t({el:n}).render();o.on("change:language",function(e){r.val(e)}),i&&e.find("#id_path").focus()})}),define("utils/chosen",["jquery","jquery-plugins/jquery.chosen"],function(e){return function(t,n){t.find("select:not(.disable-chzn)").each(function(){var t=e(this);t.hasClass("chzn-done")&&(t.show().removeClass("chzn-done"),e("#"+t.attr("id")+"_chzn").remove()),t.data("placeholder",t.attr("placeholder"));var n=t.find("option").first();n.val()||"---------"!==n.text()||n.text("")}).chosen(n)}}),define("search",["jquery","on-ready","utils/chosen"],function(e,t,n){return t(function(){n(e("#repo-search-nav"),{allow_single_deselect:!0});var t=e("#search-language-trigger"),i=t.closest("li"),r=i.find("select");t.on("click",function(e){e.preventDefault(),r.trigger("liszt:updated"),i.addClass("has-value")}),r.on("change",function(t){var n=e(t.target).val();e("#search-language").val(n),e("#repo-search-form").submit()});var o=e("#repo-search-form");o.on("submit",function(t){var n=e(t.target).find("#search-language");n.val()||n.remove()});var s=e("#search-query-input")[0];s.focus(),s.setSelectionRange(s.selectionEnd,s.selectionEnd)})}),define("snippets/list",["jquery","on-ready","components/filter/status","components/paginate"],function(e,t,n,i){return t(function(t){var r=t,o=e("#snippets-pjax");n({$container:r,$pjaxContainer:o,ignoreQuery:"page"}),i(r,{$pjaxContainer:o})})}),define("snippets/history",["data/current-user","utils/recent-history"],function(e,t){return t({key:"snippet-history-"+e.id,url:"/api/internal/snippets/user/history/"})}),define("snippets/recent-list",["jquery","on-ready","snippets/history","utils/mustache"],function(e,t,n,i){return t(function(t){n.get().done(function(n){function r(e){return e.map(function(e){return e.name=e.title||e.id+": "+gettext("Untitled"),e})}(n.updated||n.recent)&&e("#snippets-dropdown-trigger").one("mouseover",function(){n.recent&&t.append(i.toHtml("snippet-dropdown-template",{sectionTitle:gettext("Recently viewed"),snippets:r(n.recent)})),n.updated&&t.append(i.toHtml("snippet-dropdown-template",{sectionTitle:gettext("Recently updated"),snippets:r(n.updated)}))})})})}),define("snippets/source",["jquery","on-ready","components/changeset-selector","components/comments/line-comment","components/comments/general-comment-form"],function(e,t,n,i,r){return t(function(){var t=e("#view-snippet"),n=t.attr("data-comments-api-url"),o=e("#comments-list > .new-comment"),s=t.find("#general-thread-ids"),a=e(".snippet-header .follow");s.length&&i.decorateThreads(n,s.data("value")),o.length&&new r(n,!0).decorate(o),e(document).on("comment-added",function(){a.trigger("toggle-follow",{type:"snippet",isNowFollowing:!0})})})}),define("snippets/view",["jquery","on-ready","components/alert-dialog","components/confirm-dialog","snippets/history","utils/message-helper"],function(e,t,n,i,r,o){return t(function(t){var s=e("#snippet-view-tabs").find("li"),a=e("#repo-content"),l=e(".delete-button");r.set(t.attr("data-id")),a.on("pjax:end",function(t){var n=a.find("> div:first").attr("id"),i=e("#"+n+"-tab");i.hasClass("aui-nav-selected")||(s.removeClass("aui-nav-selected"),i.addClass("aui-nav-selected")),e(t.target).removeClass("has-mask")}).on("pjax:error",function(t,n,i){return n.readyState>0&&"abort"!==i?(e(t.target).html("<h2>{}</h2>".format(gettext("An unexpected error occurred"))),!1):void 0}).on("pjax:beforeSend",function(t){e(t.target).addClass("has-mask")}),e.support.pjax&&s.on("click","a",function(t){var n=e(t.target).closest("li");t.preventDefault(),e.pjax({url:e(this).attr("href"),push:!0,container:a,scrollTo:null,timeout:3e4}),a.empty(),s.removeClass("aui-nav-selected"),n.addClass("aui-nav-selected")}),l.on("click",function(){i({dialog2:!0,warning:!0,size:"small",buttonText:gettext("Delete"),title:l.attr("data-confirm-title"),content:l.attr("data-confirm-content")}).done(function(){e.ajax({url:l.attr("data-delete-url"),type:"DELETE"}).done(function(){o.addMessage(gettext("Snippet successfully deleted.")),window.location=l.attr("data-snippet-list-url")}).fail(function(){n(gettext("Failed to delete snippet."))})})})})}),define("support/git-gc",["on-ready","jquery","utils/check-task"],function(e,t,n){return e(function(){var e=t("#git-gc");e.on("click",function(i){if(i.preventDefault(),!e.hasClass("loading")){e.addClass("loading");var r=function(){e.removeClass("loading"),alert("git gc failed")},o=function(t,n){e.removeClass("loading"),alert("git gc succeeded (size: "+n.old_size+" -> "+n.size+")")};t.ajax({type:"POST",url:e.attr("href"),error:r,success:function(e,t,i){setTimeout(function(){n(i.getResponseHeader("Location")).done(o).fail(r)},1e3)}})}})})}),define("text!support/read-only-dialog.mustache",[],function(){return'<div><input name="reason" value="content" type="radio" id="ro-reason-content" disabled="disabled"><label for="ro-reason-content">Content violates TOS (notifies owner)</label></div>\n<div><input name="reason" value="size" type="radio" id="ro-reason-size" disabled="disabled"><label for="ro-reason-size">Repository size is excessive (notifies owner)</label></div>\n<div><input name="reason" value="none" type="radio" id="ro-reason-none" checked="checked"><label for="ro-reason-none">None; I\'m just on a power trip</label></div>'}),define("support/repository-info",["aui","mustache","on-ready","components/confirm-dialog","js/components/aui-dialog","text!support/read-only-dialog.mustache"],function(e,t,n,i,r,o){var s=0,a=function(e,t){var n=e.id||s++,i=new r({width:e.width||450,height:e.height||"auto",id:"bb-support-"+n+"-confirmation-dialog"}),o=$("<div></div>").html(e.content),a=e.buttonText||gettext("Okay");return e.title&&i.addHeader(e.title),i.addPanel("main",o,"confirmation-dialog-body"),i.addButton(a,function(e){t.resolve(),e.remove()}),i};return n(function(){e.$("#repository-tabs").on("tabSelect",function(e,t){var n=t.pane,i=n.attr("data-iframe-url"),r=n.children("iframe");i&&!r.length&&$('<iframe width="100%" height="600px">').appendTo(n).attr("src",i)}),e.$("#change-read-only").on("click",function(e){e.preventDefault();var n,r,s=$(e.currentTarget).attr("data-read-only");return"false"===s?(r=$.Deferred(),n=a({title:"Reason for marking read-only",content:t.to_html(o)},r),n.addCancel("Cancel",function(){n.remove()}),n.show(),r.done(function(){var e=n.popup.element.find("input:radio[checked=checked]").val(),t=$("#readonly-form"),i=$("#readonly-form-reason"),r=$("#readonly-form-readonly");r.val("true"),i.val(e),t.submit()})):i("Make read-write?").done(function(){var e=$("#readonly-form"),t=$("#readonly-form-readonly");t.val("false"),e.submit()}),!1}),e.$("#change-staff-access").on("click",function(e){e.preventDefault(),$("#staff-access-form").submit()})})}),define("support-admin",["aui","on-ready","components/filter/search","support/git-gc","support/repository-info"],function(e,t,n){return t(function(){e.$("#is-ondemand, .title-tip").tooltip(),n({$pjaxContainer:e.$("#disk-usage-pjax"),$controls:e.$(".filter-search")})})}),define("support/clear-sessions",["on-ready","jquery","aui","utils/check-task"],function(e,t,n){return e(function(){$clearSessionsBtn=t("#support-clear-user-sessions"),$clearSessionsBtn.on("click",function(e){e.preventDefault(),$clearSessionsBtn.addClass("loading");var i=function(e){$clearSessionsBtn.removeClass("loading"),n.messages.error({title:gettext("Error clearing sessions"),body:"<p>{}</p>".format(e.error.messages)})},r=function(){$clearSessionsBtn.removeClass("loading"),n.messages.success({title:gettext("Sessions cleared!")})};t.ajax({type:"PUT",dataType:"json",url:$clearSessionsBtn.attr("href"),success:r,error:i})})})}),define("support/delete-user",["on-ready","jquery","aui","utils/check-task"],function(e,t,n,i){return e(function(){$deleteButton=t("#support-delete-user-button"),$nukeDialog=t("#nuke-user-dialog"),AJSnukeDialog=n.dialog2($nukeDialog),$reallyNukeButton=$nukeDialog.find("#really-nuke-user"),$deleteButton.on("click",function(e){e.preventDefault(),AJSnukeDialog.show()}),$nukeDialog.find("#dialog-close-button").on("click",function(e){e.preventDefault(),AJSnukeDialog.hide()}),$reallyNukeButton.on("click",function(e){e.preventDefault(),$reallyNukeButton.addClass("loading");var n=function(e,n){$reallyNukeButton.removeClass("loading"),respJSON=t.parseJSON(n),alert(respJSON.error.message),AJSnukeDialog.hide()},r=function(e,n){$reallyNukeButton.removeClass("loading"),$searchLink=t("#support-search-link").attr("href"),alert("User "+n.username+" deleted by "+n.request_user),window.location.replace($searchLink)};t.ajax({type:"DELETE",url:t("#nuke-user-link").attr("href"),success:function(e,t,o){setTimeout(function(){i(o.getResponseHeader("Location")).done(r).fail(n)},1e3)}})})})}),define("utils/atlassian-analytics",["jquery","on-ready","data/debug","utils/load-ace"],function(e,t,n,i){return t(function(){n||i()})}),define("workflow/cloning-repo",["on-ready","utils/gaq-push"],function(e,t){return e(function(){t(["atl._trackPageview","/repo/cloned"])})}),define("workflow/fork-form",["jquery","on-ready","components/upgrade-dialog","data/current-user","utils/disable"],function(e,t,n,i){return t(function(){function t(e){var t=!("OK"===e.status);t&&c.text("Inheriting permissions exceeds the user limit for {}.".format(e.user.username)),e.can_upgrade&&n(d,{data:e}),c.toggleClass("hidden",!t),d.disable(t)}function r(){var n=e.ajax({url:s,type:"PUT",data:{is_private:l.is(":checked"),inherit:u.is(":checked"),target_user:a.find(":selected").text()||i.username}});d.loading(n),n.done(function(e){t(e)}),n.fail(function(e){402===e.status&&t(JSON.parse(e.responseText).data)})}var o=e("#fork-form"),s=o.attr("data-fork-overflow-url"),a=e("#id_owner"),l=e("#id_is_private"),u=e("#id_inherit"),c=e("#inherit-error"),d=o.find('button[type="submit"]');e("#id_owner, #id_is_private, #id_inherit").on("change",r),r()})}),define("components/github-import/import-states",["backbone"],function(e){return e.Collection.extend({initialize:function(e,t){this.url=t.url}})}),define("components/github-import/repositories-view",["jquery","underscore","backbone","utils/mustache"],function(e,t,n,i){return n.View.extend({initialize:function(){this.collection.bind("add",this.insert,this),this.collection.bind("reset",this.update,this),this.collection.bind("reset",this.poll,this)},statusTemplate:t.bind(i.toHtml,null,"github-import-progress"),buttonTemplate:t.bind(i.toHtml,null,"github-import-finished-button"),events:{"click button.github-start-import":"start","click button.github-import-all":"importAll"},pollDelayMs:1e3,spinnerDelayMs:500,poll:function(){var e=this.collection;e.any(function(e){return e.get("running")})&&setTimeout(function(){e.fetch({reset:!0})},this.pollDelayMs)},start:function(t){var n=this;1===n.$("button.github-start-import:enabled").length&&n.disableImportAll();var i=e(t.target);i.attr("aria-disabled","true").attr("disabled","disabled");var r=setTimeout(function(){i.addClass("loading")},this.spinnerDelayMs);this.collection.create({url:i.data("url"),type:i.data("type")},{wait:!0,complete:function(){clearTimeout(r),n.poll()}})},importAll:function(n){var i=this,r=e(n.target).attr("data-type");i.disableImportAll();var o=i.$("button.github-start-import");o.attr("aria-disabled","true").attr("disabled","disabled");var s=setTimeout(function(){o.addClass("loading")},this.spinnerDelayMs);e.post(i.collection.url,{type:r},function(e){clearTimeout(s),t.each(e,function(e){i.collection.add(e)}),i.poll()})},disableImportAll:function(){var e=this.$("button.github-import-all");e.attr("aria-disabled","true").attr("disabled","disabled")},$buttonForModel:function(t){var n=t.get("url");return this.$("button.github-start-import").filter(function(){return e(this).attr("data-url")===n})},insert:function(t){var n=this.$buttonForModel(t),i=n.closest("article").find("h1"),r=i.find(".name").text(),o=t.get("succeeded")?"repository_html_url":"html_url",s=e("<a>").attr("href",t.get(o));i.find(".name").html(s.text(r)),i.append(this.statusTemplate(t.toJSON()))},update:function(){var n=this,i=t.map(n.$(".github-import-status"),function(t){return e(t).data("id")}),r=t.difference(i,n.collection.map(function(e){return e.get("id")}));t.each(r,function(e){var t=n.$("#github-import-status-"+e),i=t.closest("article").find(".github-start-import"),r=n.failedJSON(e,t.attr("href"));t.replaceWith(n.statusTemplate(r)),i.removeClass("loading").fadeOut(300,function(){i.replaceWith(n.buttonTemplate(r))})}),n.collection.each(function(t){var i=n.$("#github-import-status-"+t.get("id")),r=i.closest("article").find("h1"),o=i.closest("article").find(".github-start-import"),s=r.find(".name").text(),a=t.get("succeeded")?"repository_html_url":"html_url",l=e("<a>").attr("href",t.get(a));r.find(".name").html(l.text(s));var u=i.data("queued")&&!t.get("queued");u?setTimeout(function(){i.replaceWith(n.statusTemplate(t.toJSON()))},n.pollDelayMs/2):i.replaceWith(n.statusTemplate(t.toJSON()));var c=i.data("running")&&!t.get("running");c&&o.removeClass("loading").fadeOut(300,function(){o.replaceWith(n.buttonTemplate(t.toJSON()))})})},failedJSON:function(e,t){return{id:e,html_url:t,queued:!1,running:!1,succeeded:!1,failed:!0}}})}),define("workflow/github-import",["jquery","on-ready","utils/localize","components/github-import/import-states","components/github-import/repositories-view"],function(e,t,n,i,r){return t(function(){var t=e("#github-repositories"),o=t.find(".mask");e.get(t.attr("data-html-url"),function(s){var a=e(s);n(a.find("time")),o.replaceWith(a);var l=new i(a.children(".github-import-data").data("imports"),{url:t.data("api-url")});new r({el:t,collection:l}).render(),l.fetch()})})}),define("workflow/importing",["jquery","on-ready","components/importer","utils/delay","utils/gaq-push"],function(e,t,n,i,r){return t(function(){var t=e("#importing"),o=t.attr("data-success-url");n(t).done(function(){i(1e3,function(){location.href=o})}),function(){function e(){if(analyticsData=analyticsData||{},"source-goog"===analyticsData.source)return"Google Code, "+analyticsData.scm;var e=[analyticsData.scm,analyticsData.auth?"auth":"no auth"];return"svn"===analyticsData.scm&&e.push("no history"),e.join(", ")}r(["atl._trackEvent","Importer",e()])}()})}),define("workflow/invite-form",["jquery","on-ready","utils/validation/validated-common-fields","utils/validation/decorators/tipsy","utils/disable"],function(e,t,n,i){return t(function(){function t(){var e=o.val()&&!o.hasClass("invalid")&&s.val()&&!s.hasClass("invalid")&&a.val();l.disable(!e)}e("#logout-button").on("click",function(t){t.preventDefault();var n=e(this);e.get(n.data("logoutUrl")).complete(function(){window.location=n.attr("href")})});var r=e(".signup-form"),o=e("#id_username"),s=e("#id_email"),a=e("#id_password1"),l=r.find("button");if(r.length){var u=new i;n.username(o,u).onValidate(t).validate(),n.email(s,u).onValidate(t).validate(),a.on("input blur",t),t()}})}),define("workflow/plan-upgrade",["jquery","on-ready","utils/event-push"],function(e,t,n){return t(function(){e(".upgrade-button").on("click",function(t){n("upgrade_button_clicked",{user:e(t.target).attr("data-target-user")})})})}),define("components/repo-import/base",["jquery"],function(e){var t=function(){};return t.prototype={canAuth:function(){return!0},bind:function(){},scm:function(){return"not-implemented"},onSourceScmChange_:function(){e(document).trigger("source-scm-change")},showSource:function(){this.onSourceScmChange_()},hideSource:function(){}},t}),define("components/repo-import/svn",["jquery","underscore","components/repo-import/base"],function(e,t,n){var i=function(){this.$help_=null};return i.prototype=t.extend(new n,{scm:function(){return"svn"},showSource:function(){this.onSourceScmChange_(),this.$help_.show()},hideSource:function(){this.$help_.hide()},bind:function(){this.$help_=e("#source-fields-subversion")}}),i}),define("components/repo-import/hg",["underscore","components/repo-import/base"],function(e,t){var n=function(){};return n.prototype=e.extend(new t,{scm:function(){return"hg"}}),n}),define("components/repo-import/git",["jquery","underscore","components/repo-import/base"],function(e,t,n){var i=function(){this.$name_=null,this.$url_=null};return i.prototype=t.extend(new n,{bind:function(){this.$name_=e("#id_name"),this.$url_=e("#id_url"),this.$url_.change(this.onUrlChange_.bind(this))},scm:function(){return"git"},onUrlChange_:function(){var e=this.$url_.val().trim(),t=/\/([^\/]*?)(\.git)?$/.exec(e);t&&""===this.$name_.val()&&this.$name_.val(t[1])}}),i}),define("components/repo-import/base-hosted",["jquery","underscore","components/repo-import/base","utils/delay"],function(e,t,n,i){var r=function(e){this.repositoryImporter=e,this.idleVerifyUrlTimeout_=null,this.$form_=null,this.$auth_=null,this.$url_=null,this.$container_=null,this.$projectName_=null,this.$scm_=null};return r.prototype=t.extend(new n,{template_:{},bind:function(t){this.$form_=t,this.$auth_=e("#id_auth").closest("div.checkbox"),this.$name_=e("#id_name"),this.$url_=e("#id_url"),this.bindSourceFields_(t);var n=e(this.inputElements_());n.keydown(this.onKeyDown_.bind(this)),n.keyup(this.onKeyUp_.bind(this)),n.change(this.onProjectNameChange_.bind(this)),n.blur(this.cancelIdleUrlVerification_.bind(this)),this.$scm_.change(this.renderAndVerifyUrl_.bind(this)),this.$scm_.change(this.onSourceScmChange_.bind(this))},inputElements_:function(){return this.$projectName_[0]},getProjectName_:function(){return this.$projectName_.val()},bindSourceFields_:function(){},canAuth:function(){return!1},onKeyDown_:function(e){if(8===e.keyCode){var t=this.$projectName_.val();t.startsWith(this.$name_.val())&&this.$name_.val(t.rstrip(/./))}},cancelIdleUrlVerification_:function(){window.clearTimeout(this.idleVerifyUrlTimeout_)},onKeyUp_:function(){this.cancelIdleUrlVerification_(),this.idleVerifyUrlTimeout_=i(2e3,this.renderAndVerifyUrl_.bind(this)),this.repositoryImporter.renderUrl(this.url());var e=this.$projectName_.val();e.startsWith(this.$name_.val())&&this.$name_.val(e)},onProjectNameChange_:function(){this.repositoryImporter.renderUrl(this.url()),this.repositoryImporter.verifyUrl()},renderAndVerifyUrl_:function(){this.repositoryImporter.renderUrl(this.url()),this.repositoryImporter.verifyUrl()},url:function(){var e=this.getProjectName_().trim();return e?this.template_[this.scm()]({projectName:e}):""},scm:function(){return this.$scm_.filter(":checked").val()},showSource:function(e){this.onSourceScmChange_(),this.$url_.prop({readonly:!0}),this.$url_.val(""),this.$container_.is(":visible")||(e?(this.$container_.show(),this.canAuth()?this.$auth_.show():this.$auth_.hide()):(this.$container_.slideDown(),this.canAuth()?this.$auth_.slideDown():this.$auth_.slideUp()))},hideSource:function(e){this.$container_.is(":visible")&&(e?(this.$container_.hide(),this.$auth_.show()):(this.$container_.slideUp(),this.$auth_.slideDown())),this.$url_.prop({readonly:!1})}}),r}),define("components/repo-import/google-code",["jquery","underscore","components/repo-import/base-hosted"],function(e,t,n){var i=function(e){n.call(this,e)};return i.prototype=t.extend(new n,{template_:{hg:t.template("https://<%= projectName %>.googlecode.com/hg/"),svn:t.template("http://<%= projectName %>.googlecode.com/svn/trunk"),git:t.template("https://code.google.com/p/<%= projectName %>/")},bindSourceFields_:function(){this.$container_=e("#source-fields-goog"),this.$projectName_=e("#id_goog_project_name"),this.$scm_=e('[name="goog_scm"]')}}),i}),define("components/repo-import/source-forge",["jquery","underscore","components/repo-import/base-hosted"],function(e,t,n){var i=function(e){n.call(this,e)},r={legacy:{hg:t.template("http://<%= projectName %>.hg.sourceforge.net:8000/hgroot/<%= projectName %>"),svn:t.template("https://<%= projectName %>.svn.sourceforge.net/svnroot/<%= projectName %>")},recent:{hg:t.template("http://hg.code.sf.net/p/<%= projectName %>/<%= mountPoint %>"),svn:t.template("http://svn.code.sf.net/p/<%= projectName %>/<%= mountPoint %>")}};return i.prototype=t.extend(new n,{inputElements_:function(){return[this.$projectName_[0],this.$mountPoint_[0]]},url:function(){var e=this.getProjectName_().trim();if(!e)return"";var t=this.$mountPoint_.val().trim(),n=t?"recent":"legacy";return r[n][this.scm()]({projectName:e,mountPoint:t})},bindSourceFields_:function(){this.$container_=e("#source-fields-sourceforge"),this.$projectName_=e("#id_sourceforge_project_name"),this.$mountPoint_=e("#id_sourceforge_mount_point"),this.$scm_=e('[name="sourceforge_scm"]')}}),i}),define("components/repo-import/codeplex",["jquery","underscore","components/repo-import/base-hosted"],function(e,t,n){var i=function(e){n.call(this,e)};return i.prototype=t.extend(new n,{template_:{hg:t.template("https://hg01.codeplex.com/<%= projectName %>/"),svn:t.template("https://<%= projectName %>.svn.codeplex.com/svn/")},bindSourceFields_:function(){this.$container_=e("#source-fields-codeplex"),this.$projectName_=e("#id_codeplex_project_name"),this.$scm_=e('[name="codeplex_scm"]')}}),i}),define("components/repo-import/form",["jquery","underscore","components/repo-import/svn","components/repo-import/hg","components/repo-import/git","components/repo-import/google-code","components/repo-import/source-forge","components/repo-import/codeplex","utils/api-helper","utils/delay"],function(e,t,n,i,r,o,s,a,l,u){var c=function(){this.sources_={"source-svn":new n(this),"source-hg":new i(this),"source-goog":new o(this),"source-sourceforge":new s(this),"source-codeplex":new a(this),"source-git":new r(this)},this.source_=null,this.previousUrl_=null,this.urlTimeout_=null,this.ajax_=null,this.$message_=e("<div></div>"),this.$form_=null,this.$url_=null,this.$source_=null,this.$scm_=null};return c.prototype={bind:function(t){this.$form_=t,this.$sourceScm_=e("#id_source_scm"),this.$url_=e("#id_url"),this.$source_=e("#id_source"),this.$auth_=e("#id_auth"),this.$authFields_=e("#url-auth-fields"),this.$username_=e("#id_username"),this.$password_=e("#id_password"),this.$submitButton_=this.$form_.find("button[type=submit]"),this.$scm_=t.find("input[name=scm]"),this.$url_.add(this.$username_).add(this.$password_).change(this.verifyUrl.bind(this)),this.$source_.change(this.onSourceChange_.bind(this)),this.$auth_.change(this.onAuthChange_.bind(this)),this.$submitButton_.click(this.disableButtonAndSubmit_.bind(this)),e(document).bind("source-scm-change",this.onSourceScmChange_.bind(this));for(var n in this.sources_)this.sources_[n].bind(t);this.$auth_.is(":checked")&&!this.$authFields_.is(":visible")&&this.$authFields_.show(),this.onSourceChange_(null,!0),this.$message_.delegate("a.suggestion","click",this.useSuggestedUrl_.bind(this)).hide().appendTo(this.$url_.closest("div"))},renderUrl:function(e){this.$url_.val(e),e!==this.previousUrl_&&this.resetUrlStatus_(),this.previousUrl_=e},verifyUrl:function(){var t=this.$url_.val();if(""!==t){this.ajax_&&this.ajax_.abort();var n=this.$url_;this.urlTimeout_=u(300,function(){n.removeClass("valid invalid").addClass("loading")});var i={};this.source_.canAuth()&&this.$auth_.is(":checked")&&e.extend(i,{username:e("#id_username").val(),password:e("#id_password").val()}),this.ajax_=e.ajax({url:"/!api/1.0/_import/{}/{}".format(this.source_.scm(),encodeURIComponent(t)),type:"POST",data:i,dataType:"json",timeout:3e4,complete:this.ajaxComplete_.bind(this),success:this.ajaxSuccess_.bind(this)})}},useSuggestedUrl_:function(t){t.preventDefault();var n=e(t.target).attr("href");this.renderUrl(n),this.verifyUrl()},resetUrlStatus_:function(){this.$url_.removeClass("valid invalid"),this.$message_.hide().removeClass("error")},ajaxComplete_:function(e,t){if(clearTimeout(this.urlTimeout_),this.$url_.removeClass("loading"),"timeout"===t)this.$url_.addClass("invalid"),this.$message_.addClass("error").text(gettext("Connecting to the URL timed out.")).slideDown();else switch(e.status){case 400:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(e.responseText).slideDown();break;case 404:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(e.responseText).slideDown();break;case 401:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(gettext("Authentication failed.")).slideDown();break;case 403:this.$url_.addClass("invalid"),this.$message_.addClass("error").text(e.responseText).slideDown()}},ajaxSuccess_:function(e,t,n){if(200===n.status)if(e.svn)if(e.trunk)this.$url_.removeClass("invalid").addClass("valid"),this.$message_.slideUp();else{this.$url_.removeClass("valid").addClass("invalid");var i,r=gettext("The URL does not point to trunk."),o=gettext('The URL does not point to trunk. <a class="suggestion" href="%(suggest_url)s">Use trunk instead?</a>');i=0===e.suggestions.length?r:interpolate(o,{suggest_url:e.suggestions[0]},!0),this.$message_.addClass("error").html(i).slideDown()}else this.$message_.slideUp(),this.$url_.removeClass("invalid").addClass("valid")},disableButtonAndSubmit_:function(){this.$submitButton_.attr({disabled:"disabled"}),this.$sourceScm_.val(this.source_.scm()),this.$form_.submit()},onAuthChange_:function(){this.$authFields_.slideToggle(),this.verifyUrl()},onSourceChange_:function(e,t){this.source_&&this.source_.hideSource(t),this.source_=this.sources_[this.$source_.val()],this.source_.showSource(t),this.verifyUrl()},onSourceScmChange_:function(){var e=this.source_.scm();this.$form_.find("#hidden_scm_input").remove(),"git"===e||"hg"===e?(this.$scm_.prop({disabled:!0}),this.$scm_.prop({checked:!1}).filter("[value="+e+"]").prop({checked:!0}).change(),this.$form_.append('<input id="hidden_scm_input" type="hidden" name="scm" value="'+e+'"/>')):this.$scm_.prop({disabled:!1})}},c}),define("workflow/repo-import",["jquery","on-ready","components/repo-import/form","workflow/repo-form"],function(e,t,n,i){return t(function(){i.onReady();var t=e("#import-form");1===t.length&&((new n).bind(t),t.find("input[type=submit]").removeAttr("disabled"));var r=e("#repo-import .sidebar a.import-github"),o=r.find("form.connect-button");o.length&&r.on("click",function(e){e.preventDefault(),o.submit()})})}),define("workflow/social-error",["on-ready","utils/gaq-push"],function(e,t){return e(function(){t(["atl._trackEvent","Social registration","Reject"])})}),function(e){define("jquery-plugins/jquery.client",["jquery"],function(){return function(){!function(){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"An unknown browser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version",this.OS=this.searchString(this.dataOS)||"an unknown OS"},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,i=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,n){if(-1!=n.indexOf(e[t].subString))return e[t].identity}else if(i)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],dataOS:[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone/iPod"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};e.init(),window.jQuery.client={os:e.OS,browser:e.browser}}()}.apply(e,arguments)})}(this),define("workflow/social-wizard",["aui","jquery","on-ready","data/current-user","js/components/aui-dialog","utils/exists","utils/gaq-push","jquery-plugins/jquery.client"],function(e,t,n,i,r,o,s){return n(function(){var n=t("#social-wizard"),a=function(e,n,i,o,s,a){var l=new r({width:i,height:"auto",id:e,closeOnOutsideClick:!0});return l.addHeader(o),l.addPanel("body",n,"panel-body"),l.addButton("Save",s.save,"save-button"),l.addCancel("Cancel",s.cancel),n.show(),n.on("submit",function(e){e.preventDefault(),t(l.popup.element).find(".save-button").trigger("click")}),a.on("click",function(){l.show()}),l},l=function(e){var n=t(e.popup.element);n.find(".error").addClass("hidden"),n.find("input, textarea").val("")};e.bind("show.dialog",function(e,t){l(t.dialog)});var u=function(e,n){t(e.popup.element).find(".error").removeClass("hidden").find(".message").text(n)},c=function(e){t(e.popup.element).find(".save-button").prop("disabled",!0)},d=function(e){t(e.popup.element).find(".save-button").removeProp("disabled")},h=function(){n.find('[href="/"]').addClass("aui-button").addClass("aui-button-primary").text("Go to dashboard")};n.find('[href="/"]').on("click",function(){"Do this later"===t(this).text()&&s(["atl._trackEvent","Social registration","Wizard","Do this later"])}),o("#add-ssh-key-form",function(e){var n=a("ssh-key-dialog",e,840,"Add an SSH key",{save:function(){if(!t("#id_key").val())return void u(n,"Please enter an SSH key before saving.");c(n);var r=bitbucket.user(i.username);r.add_ssh_key(e.serializeArray()).success(function(){h(),n.hide(),t("#account-ssh-key").addClass("completed"),s(["atl._trackEvent","Social registration","Wizard","Set key"])}).error(function(){u(n,"The SSH key entered is invalid.")}).complete(function(){d(n)})},cancel:function(e){e.hide()}},t("#set-ssh-key"))}),o("#account-ssh-key[data-import-url]",function(n){var i=n.data("import-url");t("#import-ssh-keys").on("click",function(){n.addClass("loading"),t.ajax({url:i,dataType:"json"}).success(function(t){n.removeClass("loading"),t.length>0?(h(),n.find(".key-count").text(t.length).end().addClass("completed"),s(["atl._trackEvent","Social registration","Wizard","Import keys"])):e.messages.warning({body:"Import failed. Are your SSH keys already associated with another Bitbucket account?"})})})});var p=t("#choose-password-form"),f=a("password-dialog",p,400,"Choose a password",{save:function(){return t("#id_new_password1").val()&&t("#id_new_password2").val()?t("#id_new_password1").val()!==t("#id_new_password2").val()?void u(f,"The values entered do not match"):(c(f),void t.ajax({url:p.attr("action"),type:"POST",data:p.serialize(),dataType:"html"}).success(function(){h(),f.hide(),t("#account-password").addClass("completed"),s(["atl._trackEvent","Social registration","Wizard","Set password"])}).error(function(){u(f,"There was a problem processing your request.")}).complete(function(){d(f)})):void u(f,"Please complete both fields before saving")},cancel:function(e){e.hide()}},t("#set-password"));t(".ssh-key-copy-help").hide().filter("."+t.client.os.toLowerCase()).show();var m=function(t,n,i){e.InlineDialog(t,n,function(e,t,r){s(["atl._trackEvent","Social registration","Wizard",n]),e.html(i.html()),r&&r()
})};m(t("#ssh-key-help-trigger"),"ssh-key-help",t("#ssh-key-help")),m(t("#password-help-trigger"),"password-help",t("#password-help"))})});
//# sourceMappingURL=main.js
//# sourceMappingURL=main.js.map